function $S(s,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in s)){const l=Object.getOwnPropertyDescriptor(n,a);l&&Object.defineProperty(s,a,l.get?l:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();function rf(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function LS(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var t=s.default;if(typeof t=="function"){var r=function n(){var a=!1;try{a=this instanceof n}catch{}return a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var a=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return s[n]}})}),r}var $h={exports:{}},Ao={},Lh={exports:{}},ot={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bx;function MS(){if(Bx)return ot;Bx=1;var s=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function w(W){return W===null||typeof W!="object"?null:(W=p&&W[p]||W["@@iterator"],typeof W=="function"?W:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,y={};function b(W,se,we){this.props=W,this.context=se,this.refs=y,this.updater=we||v}b.prototype.isReactComponent={},b.prototype.setState=function(W,se){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,se,"setState")},b.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function C(){}C.prototype=b.prototype;function E(W,se,we){this.props=W,this.context=se,this.refs=y,this.updater=we||v}var S=E.prototype=new C;S.constructor=E,j(S,b.prototype),S.isPureReactComponent=!0;var O=Array.isArray,R=Object.prototype.hasOwnProperty,k={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function F(W,se,we){var _e,Le={},He=null,de=null;if(se!=null)for(_e in se.ref!==void 0&&(de=se.ref),se.key!==void 0&&(He=""+se.key),se)R.call(se,_e)&&!P.hasOwnProperty(_e)&&(Le[_e]=se[_e]);var Ne=arguments.length-2;if(Ne===1)Le.children=we;else if(1<Ne){for(var Ve=Array(Ne),Ye=0;Ye<Ne;Ye++)Ve[Ye]=arguments[Ye+2];Le.children=Ve}if(W&&W.defaultProps)for(_e in Ne=W.defaultProps,Ne)Le[_e]===void 0&&(Le[_e]=Ne[_e]);return{$$typeof:s,type:W,key:He,ref:de,props:Le,_owner:k.current}}function ee(W,se){return{$$typeof:s,type:W.type,key:se,ref:W.ref,props:W.props,_owner:W._owner}}function ne(W){return typeof W=="object"&&W!==null&&W.$$typeof===s}function pe(W){var se={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(we){return se[we]})}var re=/\/+/g;function H(W,se){return typeof W=="object"&&W!==null&&W.key!=null?pe(""+W.key):se.toString(36)}function G(W,se,we,_e,Le){var He=typeof W;(He==="undefined"||He==="boolean")&&(W=null);var de=!1;if(W===null)de=!0;else switch(He){case"string":case"number":de=!0;break;case"object":switch(W.$$typeof){case s:case t:de=!0}}if(de)return de=W,Le=Le(de),W=_e===""?"."+H(de,0):_e,O(Le)?(we="",W!=null&&(we=W.replace(re,"$&/")+"/"),G(Le,se,we,"",function(Ye){return Ye})):Le!=null&&(ne(Le)&&(Le=ee(Le,we+(!Le.key||de&&de.key===Le.key?"":(""+Le.key).replace(re,"$&/")+"/")+W)),se.push(Le)),1;if(de=0,_e=_e===""?".":_e+":",O(W))for(var Ne=0;Ne<W.length;Ne++){He=W[Ne];var Ve=_e+H(He,Ne);de+=G(He,se,we,Ve,Le)}else if(Ve=w(W),typeof Ve=="function")for(W=Ve.call(W),Ne=0;!(He=W.next()).done;)He=He.value,Ve=_e+H(He,Ne++),de+=G(He,se,we,Ve,Le);else if(He==="object")throw se=String(W),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.");return de}function ge(W,se,we){if(W==null)return W;var _e=[],Le=0;return G(W,_e,"","",function(He){return se.call(we,He,Le++)}),_e}function ie(W){if(W._status===-1){var se=W._result;se=se(),se.then(function(we){(W._status===0||W._status===-1)&&(W._status=1,W._result=we)},function(we){(W._status===0||W._status===-1)&&(W._status=2,W._result=we)}),W._status===-1&&(W._status=0,W._result=se)}if(W._status===1)return W._result.default;throw W._result}var xe={current:null},X={transition:null},te={ReactCurrentDispatcher:xe,ReactCurrentBatchConfig:X,ReactCurrentOwner:k};function oe(){throw Error("act(...) is not supported in production builds of React.")}return ot.Children={map:ge,forEach:function(W,se,we){ge(W,function(){se.apply(this,arguments)},we)},count:function(W){var se=0;return ge(W,function(){se++}),se},toArray:function(W){return ge(W,function(se){return se})||[]},only:function(W){if(!ne(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},ot.Component=b,ot.Fragment=r,ot.Profiler=a,ot.PureComponent=E,ot.StrictMode=n,ot.Suspense=m,ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=te,ot.act=oe,ot.cloneElement=function(W,se,we){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var _e=j({},W.props),Le=W.key,He=W.ref,de=W._owner;if(se!=null){if(se.ref!==void 0&&(He=se.ref,de=k.current),se.key!==void 0&&(Le=""+se.key),W.type&&W.type.defaultProps)var Ne=W.type.defaultProps;for(Ve in se)R.call(se,Ve)&&!P.hasOwnProperty(Ve)&&(_e[Ve]=se[Ve]===void 0&&Ne!==void 0?Ne[Ve]:se[Ve])}var Ve=arguments.length-2;if(Ve===1)_e.children=we;else if(1<Ve){Ne=Array(Ve);for(var Ye=0;Ye<Ve;Ye++)Ne[Ye]=arguments[Ye+2];_e.children=Ne}return{$$typeof:s,type:W.type,key:Le,ref:He,props:_e,_owner:de}},ot.createContext=function(W){return W={$$typeof:c,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:l,_context:W},W.Consumer=W},ot.createElement=F,ot.createFactory=function(W){var se=F.bind(null,W);return se.type=W,se},ot.createRef=function(){return{current:null}},ot.forwardRef=function(W){return{$$typeof:d,render:W}},ot.isValidElement=ne,ot.lazy=function(W){return{$$typeof:f,_payload:{_status:-1,_result:W},_init:ie}},ot.memo=function(W,se){return{$$typeof:h,type:W,compare:se===void 0?null:se}},ot.startTransition=function(W){var se=X.transition;X.transition={};try{W()}finally{X.transition=se}},ot.unstable_act=oe,ot.useCallback=function(W,se){return xe.current.useCallback(W,se)},ot.useContext=function(W){return xe.current.useContext(W)},ot.useDebugValue=function(){},ot.useDeferredValue=function(W){return xe.current.useDeferredValue(W)},ot.useEffect=function(W,se){return xe.current.useEffect(W,se)},ot.useId=function(){return xe.current.useId()},ot.useImperativeHandle=function(W,se,we){return xe.current.useImperativeHandle(W,se,we)},ot.useInsertionEffect=function(W,se){return xe.current.useInsertionEffect(W,se)},ot.useLayoutEffect=function(W,se){return xe.current.useLayoutEffect(W,se)},ot.useMemo=function(W,se){return xe.current.useMemo(W,se)},ot.useReducer=function(W,se,we){return xe.current.useReducer(W,se,we)},ot.useRef=function(W){return xe.current.useRef(W)},ot.useState=function(W){return xe.current.useState(W)},ot.useSyncExternalStore=function(W,se,we){return xe.current.useSyncExternalStore(W,se,we)},ot.useTransition=function(){return xe.current.useTransition()},ot.version="18.3.1",ot}var qx;function nf(){return qx||(qx=1,Lh.exports=MS()),Lh.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hx;function FS(){if(Hx)return Ao;Hx=1;var s=nf(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(d,m,h){var f,p={},w=null,v=null;h!==void 0&&(w=""+h),m.key!==void 0&&(w=""+m.key),m.ref!==void 0&&(v=m.ref);for(f in m)n.call(m,f)&&!l.hasOwnProperty(f)&&(p[f]=m[f]);if(d&&d.defaultProps)for(f in m=d.defaultProps,m)p[f]===void 0&&(p[f]=m[f]);return{$$typeof:t,type:d,key:w,ref:v,props:p,_owner:a.current}}return Ao.Fragment=r,Ao.jsx=c,Ao.jsxs=c,Ao}var Vx;function US(){return Vx||(Vx=1,$h.exports=FS()),$h.exports}var e=US(),Rc={},Mh={exports:{}},Cs={},Fh={exports:{}},Uh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gx;function zS(){return Gx||(Gx=1,(function(s){function t(X,te){var oe=X.length;X.push(te);e:for(;0<oe;){var W=oe-1>>>1,se=X[W];if(0<a(se,te))X[W]=te,X[oe]=se,oe=W;else break e}}function r(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var te=X[0],oe=X.pop();if(oe!==te){X[0]=oe;e:for(var W=0,se=X.length,we=se>>>1;W<we;){var _e=2*(W+1)-1,Le=X[_e],He=_e+1,de=X[He];if(0>a(Le,oe))He<se&&0>a(de,Le)?(X[W]=de,X[He]=oe,W=He):(X[W]=Le,X[_e]=oe,W=_e);else if(He<se&&0>a(de,oe))X[W]=de,X[He]=oe,W=He;else break e}}return te}function a(X,te){var oe=X.sortIndex-te.sortIndex;return oe!==0?oe:X.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;s.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();s.unstable_now=function(){return c.now()-d}}var m=[],h=[],f=1,p=null,w=3,v=!1,j=!1,y=!1,b=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(X){for(var te=r(h);te!==null;){if(te.callback===null)n(h);else if(te.startTime<=X)n(h),te.sortIndex=te.expirationTime,t(m,te);else break;te=r(h)}}function O(X){if(y=!1,S(X),!j)if(r(m)!==null)j=!0,ie(R);else{var te=r(h);te!==null&&xe(O,te.startTime-X)}}function R(X,te){j=!1,y&&(y=!1,C(F),F=-1),v=!0;var oe=w;try{for(S(te),p=r(m);p!==null&&(!(p.expirationTime>te)||X&&!pe());){var W=p.callback;if(typeof W=="function"){p.callback=null,w=p.priorityLevel;var se=W(p.expirationTime<=te);te=s.unstable_now(),typeof se=="function"?p.callback=se:p===r(m)&&n(m),S(te)}else n(m);p=r(m)}if(p!==null)var we=!0;else{var _e=r(h);_e!==null&&xe(O,_e.startTime-te),we=!1}return we}finally{p=null,w=oe,v=!1}}var k=!1,P=null,F=-1,ee=5,ne=-1;function pe(){return!(s.unstable_now()-ne<ee)}function re(){if(P!==null){var X=s.unstable_now();ne=X;var te=!0;try{te=P(!0,X)}finally{te?H():(k=!1,P=null)}}else k=!1}var H;if(typeof E=="function")H=function(){E(re)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,ge=G.port2;G.port1.onmessage=re,H=function(){ge.postMessage(null)}}else H=function(){b(re,0)};function ie(X){P=X,k||(k=!0,H())}function xe(X,te){F=b(function(){X(s.unstable_now())},te)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(X){X.callback=null},s.unstable_continueExecution=function(){j||v||(j=!0,ie(R))},s.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<X?Math.floor(1e3/X):5},s.unstable_getCurrentPriorityLevel=function(){return w},s.unstable_getFirstCallbackNode=function(){return r(m)},s.unstable_next=function(X){switch(w){case 1:case 2:case 3:var te=3;break;default:te=w}var oe=w;w=te;try{return X()}finally{w=oe}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(X,te){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var oe=w;w=X;try{return te()}finally{w=oe}},s.unstable_scheduleCallback=function(X,te,oe){var W=s.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?W+oe:W):oe=W,X){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=oe+se,X={id:f++,callback:te,priorityLevel:X,startTime:oe,expirationTime:se,sortIndex:-1},oe>W?(X.sortIndex=oe,t(h,X),r(m)===null&&X===r(h)&&(y?(C(F),F=-1):y=!0,xe(O,oe-W))):(X.sortIndex=se,t(m,X),j||v||(j=!0,ie(R))),X},s.unstable_shouldYield=pe,s.unstable_wrapCallback=function(X){var te=w;return function(){var oe=w;w=te;try{return X.apply(this,arguments)}finally{w=oe}}}})(Uh)),Uh}var Yx;function WS(){return Yx||(Yx=1,Fh.exports=zS()),Fh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kx;function BS(){if(Kx)return Cs;Kx=1;var s=nf(),t=WS();function r(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,u=1;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function l(i,o){c(i,o),c(i+"Capture",o)}function c(i,o){for(a[i]=o,i=0;i<o.length;i++)n.add(o[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function w(i){return m.call(p,i)?!0:m.call(f,i)?!1:h.test(i)?p[i]=!0:(f[i]=!0,!1)}function v(i,o,u,g){if(u!==null&&u.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return g?!1:u!==null?!u.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function j(i,o,u,g){if(o===null||typeof o>"u"||v(i,o,u,g))return!0;if(g)return!1;if(u!==null)switch(u.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function y(i,o,u,g,_,N,T){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=g,this.attributeNamespace=_,this.mustUseProperty=u,this.propertyName=i,this.type=o,this.sanitizeURL=N,this.removeEmptyString=T}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){b[i]=new y(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];b[o]=new y(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){b[i]=new y(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){b[i]=new y(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){b[i]=new y(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){b[i]=new y(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){b[i]=new y(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){b[i]=new y(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){b[i]=new y(i,5,!1,i.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function E(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(C,E);b[o]=new y(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(C,E);b[o]=new y(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(C,E);b[o]=new y(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){b[i]=new y(i,1,!1,i.toLowerCase(),null,!1,!1)}),b.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){b[i]=new y(i,1,!1,i.toLowerCase(),null,!0,!0)});function S(i,o,u,g){var _=b.hasOwnProperty(o)?b[o]:null;(_!==null?_.type!==0:g||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(j(o,u,_,g)&&(u=null),g||_===null?w(o)&&(u===null?i.removeAttribute(o):i.setAttribute(o,""+u)):_.mustUseProperty?i[_.propertyName]=u===null?_.type===3?!1:"":u:(o=_.attributeName,g=_.attributeNamespace,u===null?i.removeAttribute(o):(_=_.type,u=_===3||_===4&&u===!0?"":""+u,g?i.setAttributeNS(g,o,u):i.setAttribute(o,u))))}var O=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),k=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),ne=Symbol.for("react.provider"),pe=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),ge=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),xe=Symbol.for("react.offscreen"),X=Symbol.iterator;function te(i){return i===null||typeof i!="object"?null:(i=X&&i[X]||i["@@iterator"],typeof i=="function"?i:null)}var oe=Object.assign,W;function se(i){if(W===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);W=o&&o[1]||""}return`
`+W+i}var we=!1;function _e(i,o){if(!i||we)return"";we=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Z){var g=Z}Reflect.construct(i,[],o)}else{try{o.call()}catch(Z){g=Z}i.call(o.prototype)}else{try{throw Error()}catch(Z){g=Z}i()}}catch(Z){if(Z&&g&&typeof Z.stack=="string"){for(var _=Z.stack.split(`
`),N=g.stack.split(`
`),T=_.length-1,A=N.length-1;1<=T&&0<=A&&_[T]!==N[A];)A--;for(;1<=T&&0<=A;T--,A--)if(_[T]!==N[A]){if(T!==1||A!==1)do if(T--,A--,0>A||_[T]!==N[A]){var U=`
`+_[T].replace(" at new "," at ");return i.displayName&&U.includes("<anonymous>")&&(U=U.replace("<anonymous>",i.displayName)),U}while(1<=T&&0<=A);break}}}finally{we=!1,Error.prepareStackTrace=u}return(i=i?i.displayName||i.name:"")?se(i):""}function Le(i){switch(i.tag){case 5:return se(i.type);case 16:return se("Lazy");case 13:return se("Suspense");case 19:return se("SuspenseList");case 0:case 2:case 15:return i=_e(i.type,!1),i;case 11:return i=_e(i.type.render,!1),i;case 1:return i=_e(i.type,!0),i;default:return""}}function He(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case P:return"Fragment";case k:return"Portal";case ee:return"Profiler";case F:return"StrictMode";case H:return"Suspense";case G:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case pe:return(i.displayName||"Context")+".Consumer";case ne:return(i._context.displayName||"Context")+".Provider";case re:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case ge:return o=i.displayName||null,o!==null?o:He(i.type)||"Memo";case ie:o=i._payload,i=i._init;try{return He(i(o))}catch{}}return null}function de(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return He(o);case 8:return o===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Ne(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ve(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ye(i){var o=Ve(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),g=""+i[o];if(!i.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var _=u.get,N=u.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return _.call(this)},set:function(T){g=""+T,N.call(this,T)}}),Object.defineProperty(i,o,{enumerable:u.enumerable}),{getValue:function(){return g},setValue:function(T){g=""+T},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function tt(i){i._valueTracker||(i._valueTracker=Ye(i))}function ut(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),g="";return i&&(g=Ve(i)?i.checked?"true":"false":i.value),i=g,i!==u?(o.setValue(i),!0):!1}function gt(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function J(i,o){var u=o.checked;return oe({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??i._wrapperState.initialChecked})}function ue(i,o){var u=o.defaultValue==null?"":o.defaultValue,g=o.checked!=null?o.checked:o.defaultChecked;u=Ne(o.value!=null?o.value:u),i._wrapperState={initialChecked:g,initialValue:u,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function be(i,o){o=o.checked,o!=null&&S(i,"checked",o,!1)}function Ce(i,o){be(i,o);var u=Ne(o.value),g=o.type;if(u!=null)g==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+u):i.value!==""+u&&(i.value=""+u);else if(g==="submit"||g==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?ke(i,o.type,u):o.hasOwnProperty("defaultValue")&&ke(i,o.type,Ne(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function je(i,o,u){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var g=o.type;if(!(g!=="submit"&&g!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,u||o===i.value||(i.value=o),i.defaultValue=o}u=i.name,u!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,u!==""&&(i.name=u)}function ke(i,o,u){(o!=="number"||gt(i.ownerDocument)!==i)&&(u==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+u&&(i.defaultValue=""+u))}var Je=Array.isArray;function z(i,o,u,g){if(i=i.options,o){o={};for(var _=0;_<u.length;_++)o["$"+u[_]]=!0;for(u=0;u<i.length;u++)_=o.hasOwnProperty("$"+i[u].value),i[u].selected!==_&&(i[u].selected=_),_&&g&&(i[u].defaultSelected=!0)}else{for(u=""+Ne(u),o=null,_=0;_<i.length;_++){if(i[_].value===u){i[_].selected=!0,g&&(i[_].defaultSelected=!0);return}o!==null||i[_].disabled||(o=i[_])}o!==null&&(o.selected=!0)}}function me(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(r(91));return oe({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function $e(i,o){var u=o.value;if(u==null){if(u=o.children,o=o.defaultValue,u!=null){if(o!=null)throw Error(r(92));if(Je(u)){if(1<u.length)throw Error(r(93));u=u[0]}o=u}o==null&&(o=""),u=o}i._wrapperState={initialValue:Ne(u)}}function Re(i,o){var u=Ne(o.value),g=Ne(o.defaultValue);u!=null&&(u=""+u,u!==i.value&&(i.value=u),o.defaultValue==null&&i.defaultValue!==u&&(i.defaultValue=u)),g!=null&&(i.defaultValue=""+g)}function Ge(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function ae(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?ae(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var at,xt=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,u,g,_){MSApp.execUnsafeLocalFunction(function(){return i(o,u,g,_)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(at=at||document.createElement("div"),at.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=at.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function We(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var Mr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wl=["Webkit","ms","Moz","O"];Object.keys(Mr).forEach(function(i){wl.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Mr[o]=Mr[i]})});function $i(i,o,u){return o==null||typeof o=="boolean"||o===""?"":u||typeof o!="number"||o===0||Mr.hasOwnProperty(i)&&Mr[i]?(""+o).trim():o+"px"}function Fr(i,o){i=i.style;for(var u in o)if(o.hasOwnProperty(u)){var g=u.indexOf("--")===0,_=$i(u,o[u],g);u==="float"&&(u="cssFloat"),g?i.setProperty(u,_):i[u]=_}}var _l=oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mr(i,o){if(o){if(_l[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(r(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(r(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(r(61))}if(o.style!=null&&typeof o.style!="object")throw Error(r(62))}}function Qa(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ja=null;function Li(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Mi=null,un=null,fr=null;function Ys(i){if(i=yo(i)){if(typeof Mi!="function")throw Error(r(280));var o=i.stateNode;o&&(o=Vl(o),Mi(i.stateNode,i.type,o))}}function bl(i){un?fr?fr.push(i):fr=[i]:un=i}function Qe(){if(un){var i=un,o=fr;if(fr=un=null,Ys(i),o)for(i=0;i<o.length;i++)Ys(o[i])}}function jt(i,o){return i(o)}function bt(){}var hs=!1;function js(i,o,u){if(hs)return i(o,u);hs=!0;try{return jt(i,o,u)}finally{hs=!1,(un!==null||fr!==null)&&(bt(),Qe())}}function ws(i,o){var u=i.stateNode;if(u===null)return null;var g=Vl(u);if(g===null)return null;u=g[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(i=i.type,g=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!g;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var Ks=!1;if(d)try{var ss={};Object.defineProperty(ss,"passive",{get:function(){Ks=!0}}),window.addEventListener("test",ss,ss),window.removeEventListener("test",ss,ss)}catch{Ks=!1}function pr(i,o,u,g,_,N,T,A,U){var Z=Array.prototype.slice.call(arguments,3);try{o.apply(u,Z)}catch(he){this.onError(he)}}var Za=!1,Nl=null,Sl=!1,tu=null,Bb={onError:function(i){Za=!0,Nl=i}};function qb(i,o,u,g,_,N,T,A,U){Za=!1,Nl=null,pr.apply(Bb,arguments)}function Hb(i,o,u,g,_,N,T,A,U){if(qb.apply(this,arguments),Za){if(Za){var Z=Nl;Za=!1,Nl=null}else throw Error(r(198));Sl||(Sl=!0,tu=Z)}}function ti(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function hp(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function mp(i){if(ti(i)!==i)throw Error(r(188))}function Vb(i){var o=i.alternate;if(!o){if(o=ti(i),o===null)throw Error(r(188));return o!==i?null:i}for(var u=i,g=o;;){var _=u.return;if(_===null)break;var N=_.alternate;if(N===null){if(g=_.return,g!==null){u=g;continue}break}if(_.child===N.child){for(N=_.child;N;){if(N===u)return mp(_),i;if(N===g)return mp(_),o;N=N.sibling}throw Error(r(188))}if(u.return!==g.return)u=_,g=N;else{for(var T=!1,A=_.child;A;){if(A===u){T=!0,u=_,g=N;break}if(A===g){T=!0,g=_,u=N;break}A=A.sibling}if(!T){for(A=N.child;A;){if(A===u){T=!0,u=N,g=_;break}if(A===g){T=!0,g=N,u=_;break}A=A.sibling}if(!T)throw Error(r(189))}}if(u.alternate!==g)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?i:o}function fp(i){return i=Vb(i),i!==null?pp(i):null}function pp(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=pp(i);if(o!==null)return o;i=i.sibling}return null}var gp=t.unstable_scheduleCallback,xp=t.unstable_cancelCallback,Gb=t.unstable_shouldYield,Yb=t.unstable_requestPaint,zt=t.unstable_now,Kb=t.unstable_getCurrentPriorityLevel,su=t.unstable_ImmediatePriority,vp=t.unstable_UserBlockingPriority,El=t.unstable_NormalPriority,Xb=t.unstable_LowPriority,yp=t.unstable_IdlePriority,Cl=null,gr=null;function Qb(i){if(gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(Cl,i,void 0,(i.current.flags&128)===128)}catch{}}var Xs=Math.clz32?Math.clz32:eN,Jb=Math.log,Zb=Math.LN2;function eN(i){return i>>>=0,i===0?32:31-(Jb(i)/Zb|0)|0}var Tl=64,kl=4194304;function eo(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Ol(i,o){var u=i.pendingLanes;if(u===0)return 0;var g=0,_=i.suspendedLanes,N=i.pingedLanes,T=u&268435455;if(T!==0){var A=T&~_;A!==0?g=eo(A):(N&=T,N!==0&&(g=eo(N)))}else T=u&~_,T!==0?g=eo(T):N!==0&&(g=eo(N));if(g===0)return 0;if(o!==0&&o!==g&&(o&_)===0&&(_=g&-g,N=o&-o,_>=N||_===16&&(N&4194240)!==0))return o;if((g&4)!==0&&(g|=u&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=g;0<o;)u=31-Xs(o),_=1<<u,g|=i[u],o&=~_;return g}function tN(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sN(i,o){for(var u=i.suspendedLanes,g=i.pingedLanes,_=i.expirationTimes,N=i.pendingLanes;0<N;){var T=31-Xs(N),A=1<<T,U=_[T];U===-1?((A&u)===0||(A&g)!==0)&&(_[T]=tN(A,o)):U<=o&&(i.expiredLanes|=A),N&=~A}}function ru(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function jp(){var i=Tl;return Tl<<=1,(Tl&4194240)===0&&(Tl=64),i}function nu(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function to(i,o,u){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-Xs(o),i[o]=u}function rN(i,o){var u=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var g=i.eventTimes;for(i=i.expirationTimes;0<u;){var _=31-Xs(u),N=1<<_;o[_]=0,g[_]=-1,i[_]=-1,u&=~N}}function iu(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var g=31-Xs(u),_=1<<g;_&o|i[g]&o&&(i[g]|=o),u&=~_}}var wt=0;function wp(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var _p,au,bp,Np,Sp,ou=!1,Rl=[],hn=null,mn=null,fn=null,so=new Map,ro=new Map,pn=[],nN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ep(i,o){switch(i){case"focusin":case"focusout":hn=null;break;case"dragenter":case"dragleave":mn=null;break;case"mouseover":case"mouseout":fn=null;break;case"pointerover":case"pointerout":so.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ro.delete(o.pointerId)}}function no(i,o,u,g,_,N){return i===null||i.nativeEvent!==N?(i={blockedOn:o,domEventName:u,eventSystemFlags:g,nativeEvent:N,targetContainers:[_]},o!==null&&(o=yo(o),o!==null&&au(o)),i):(i.eventSystemFlags|=g,o=i.targetContainers,_!==null&&o.indexOf(_)===-1&&o.push(_),i)}function iN(i,o,u,g,_){switch(o){case"focusin":return hn=no(hn,i,o,u,g,_),!0;case"dragenter":return mn=no(mn,i,o,u,g,_),!0;case"mouseover":return fn=no(fn,i,o,u,g,_),!0;case"pointerover":var N=_.pointerId;return so.set(N,no(so.get(N)||null,i,o,u,g,_)),!0;case"gotpointercapture":return N=_.pointerId,ro.set(N,no(ro.get(N)||null,i,o,u,g,_)),!0}return!1}function Cp(i){var o=si(i.target);if(o!==null){var u=ti(o);if(u!==null){if(o=u.tag,o===13){if(o=hp(u),o!==null){i.blockedOn=o,Sp(i.priority,function(){bp(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Pl(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=cu(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(u===null){u=i.nativeEvent;var g=new u.constructor(u.type,u);Ja=g,u.target.dispatchEvent(g),Ja=null}else return o=yo(u),o!==null&&au(o),i.blockedOn=u,!1;o.shift()}return!0}function Tp(i,o,u){Pl(i)&&u.delete(o)}function aN(){ou=!1,hn!==null&&Pl(hn)&&(hn=null),mn!==null&&Pl(mn)&&(mn=null),fn!==null&&Pl(fn)&&(fn=null),so.forEach(Tp),ro.forEach(Tp)}function io(i,o){i.blockedOn===o&&(i.blockedOn=null,ou||(ou=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,aN)))}function ao(i){function o(_){return io(_,i)}if(0<Rl.length){io(Rl[0],i);for(var u=1;u<Rl.length;u++){var g=Rl[u];g.blockedOn===i&&(g.blockedOn=null)}}for(hn!==null&&io(hn,i),mn!==null&&io(mn,i),fn!==null&&io(fn,i),so.forEach(o),ro.forEach(o),u=0;u<pn.length;u++)g=pn[u],g.blockedOn===i&&(g.blockedOn=null);for(;0<pn.length&&(u=pn[0],u.blockedOn===null);)Cp(u),u.blockedOn===null&&pn.shift()}var Fi=O.ReactCurrentBatchConfig,Il=!0;function oN(i,o,u,g){var _=wt,N=Fi.transition;Fi.transition=null;try{wt=1,lu(i,o,u,g)}finally{wt=_,Fi.transition=N}}function lN(i,o,u,g){var _=wt,N=Fi.transition;Fi.transition=null;try{wt=4,lu(i,o,u,g)}finally{wt=_,Fi.transition=N}}function lu(i,o,u,g){if(Il){var _=cu(i,o,u,g);if(_===null)Eu(i,o,g,Al,u),Ep(i,g);else if(iN(_,i,o,u,g))g.stopPropagation();else if(Ep(i,g),o&4&&-1<nN.indexOf(i)){for(;_!==null;){var N=yo(_);if(N!==null&&_p(N),N=cu(i,o,u,g),N===null&&Eu(i,o,g,Al,u),N===_)break;_=N}_!==null&&g.stopPropagation()}else Eu(i,o,g,null,u)}}var Al=null;function cu(i,o,u,g){if(Al=null,i=Li(g),i=si(i),i!==null)if(o=ti(i),o===null)i=null;else if(u=o.tag,u===13){if(i=hp(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Al=i,null}function kp(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Kb()){case su:return 1;case vp:return 4;case El:case Xb:return 16;case yp:return 536870912;default:return 16}default:return 16}}var gn=null,du=null,Dl=null;function Op(){if(Dl)return Dl;var i,o=du,u=o.length,g,_="value"in gn?gn.value:gn.textContent,N=_.length;for(i=0;i<u&&o[i]===_[i];i++);var T=u-i;for(g=1;g<=T&&o[u-g]===_[N-g];g++);return Dl=_.slice(i,1<g?1-g:void 0)}function $l(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Ll(){return!0}function Rp(){return!1}function Os(i){function o(u,g,_,N,T){this._reactName=u,this._targetInst=_,this.type=g,this.nativeEvent=N,this.target=T,this.currentTarget=null;for(var A in i)i.hasOwnProperty(A)&&(u=i[A],this[A]=u?u(N):N[A]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?Ll:Rp,this.isPropagationStopped=Rp,this}return oe(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ll)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ll)},persist:function(){},isPersistent:Ll}),o}var Ui={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uu=Os(Ui),oo=oe({},Ui,{view:0,detail:0}),cN=Os(oo),hu,mu,lo,Ml=oe({},oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pu,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==lo&&(lo&&i.type==="mousemove"?(hu=i.screenX-lo.screenX,mu=i.screenY-lo.screenY):mu=hu=0,lo=i),hu)},movementY:function(i){return"movementY"in i?i.movementY:mu}}),Pp=Os(Ml),dN=oe({},Ml,{dataTransfer:0}),uN=Os(dN),hN=oe({},oo,{relatedTarget:0}),fu=Os(hN),mN=oe({},Ui,{animationName:0,elapsedTime:0,pseudoElement:0}),fN=Os(mN),pN=oe({},Ui,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),gN=Os(pN),xN=oe({},Ui,{data:0}),Ip=Os(xN),vN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wN(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=jN[i])?!!o[i]:!1}function pu(){return wN}var _N=oe({},oo,{key:function(i){if(i.key){var o=vN[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=$l(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?yN[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pu,charCode:function(i){return i.type==="keypress"?$l(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?$l(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),bN=Os(_N),NN=oe({},Ml,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ap=Os(NN),SN=oe({},oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pu}),EN=Os(SN),CN=oe({},Ui,{propertyName:0,elapsedTime:0,pseudoElement:0}),TN=Os(CN),kN=oe({},Ml,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ON=Os(kN),RN=[9,13,27,32],gu=d&&"CompositionEvent"in window,co=null;d&&"documentMode"in document&&(co=document.documentMode);var PN=d&&"TextEvent"in window&&!co,Dp=d&&(!gu||co&&8<co&&11>=co),$p=" ",Lp=!1;function Mp(i,o){switch(i){case"keyup":return RN.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fp(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var zi=!1;function IN(i,o){switch(i){case"compositionend":return Fp(o);case"keypress":return o.which!==32?null:(Lp=!0,$p);case"textInput":return i=o.data,i===$p&&Lp?null:i;default:return null}}function AN(i,o){if(zi)return i==="compositionend"||!gu&&Mp(i,o)?(i=Op(),Dl=du=gn=null,zi=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Dp&&o.locale!=="ko"?null:o.data;default:return null}}var DN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Up(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!DN[i.type]:o==="textarea"}function zp(i,o,u,g){bl(g),o=Bl(o,"onChange"),0<o.length&&(u=new uu("onChange","change",null,u,g),i.push({event:u,listeners:o}))}var uo=null,ho=null;function $N(i){ig(i,0)}function Fl(i){var o=Vi(i);if(ut(o))return i}function LN(i,o){if(i==="change")return o}var Wp=!1;if(d){var xu;if(d){var vu="oninput"in document;if(!vu){var Bp=document.createElement("div");Bp.setAttribute("oninput","return;"),vu=typeof Bp.oninput=="function"}xu=vu}else xu=!1;Wp=xu&&(!document.documentMode||9<document.documentMode)}function qp(){uo&&(uo.detachEvent("onpropertychange",Hp),ho=uo=null)}function Hp(i){if(i.propertyName==="value"&&Fl(ho)){var o=[];zp(o,ho,i,Li(i)),js($N,o)}}function MN(i,o,u){i==="focusin"?(qp(),uo=o,ho=u,uo.attachEvent("onpropertychange",Hp)):i==="focusout"&&qp()}function FN(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Fl(ho)}function UN(i,o){if(i==="click")return Fl(o)}function zN(i,o){if(i==="input"||i==="change")return Fl(o)}function WN(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Qs=typeof Object.is=="function"?Object.is:WN;function mo(i,o){if(Qs(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),g=Object.keys(o);if(u.length!==g.length)return!1;for(g=0;g<u.length;g++){var _=u[g];if(!m.call(o,_)||!Qs(i[_],o[_]))return!1}return!0}function Vp(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Gp(i,o){var u=Vp(i);i=0;for(var g;u;){if(u.nodeType===3){if(g=i+u.textContent.length,i<=o&&g>=o)return{node:u,offset:o-i};i=g}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Vp(u)}}function Yp(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Yp(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Kp(){for(var i=window,o=gt();o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=gt(i.document)}return o}function yu(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function BN(i){var o=Kp(),u=i.focusedElem,g=i.selectionRange;if(o!==u&&u&&u.ownerDocument&&Yp(u.ownerDocument.documentElement,u)){if(g!==null&&yu(u)){if(o=g.start,i=g.end,i===void 0&&(i=o),"selectionStart"in u)u.selectionStart=o,u.selectionEnd=Math.min(i,u.value.length);else if(i=(o=u.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var _=u.textContent.length,N=Math.min(g.start,_);g=g.end===void 0?N:Math.min(g.end,_),!i.extend&&N>g&&(_=g,g=N,N=_),_=Gp(u,N);var T=Gp(u,g);_&&T&&(i.rangeCount!==1||i.anchorNode!==_.node||i.anchorOffset!==_.offset||i.focusNode!==T.node||i.focusOffset!==T.offset)&&(o=o.createRange(),o.setStart(_.node,_.offset),i.removeAllRanges(),N>g?(i.addRange(o),i.extend(T.node,T.offset)):(o.setEnd(T.node,T.offset),i.addRange(o)))}}for(o=[],i=u;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<o.length;u++)i=o[u],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var qN=d&&"documentMode"in document&&11>=document.documentMode,Wi=null,ju=null,fo=null,wu=!1;function Xp(i,o,u){var g=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;wu||Wi==null||Wi!==gt(g)||(g=Wi,"selectionStart"in g&&yu(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),fo&&mo(fo,g)||(fo=g,g=Bl(ju,"onSelect"),0<g.length&&(o=new uu("onSelect","select",null,o,u),i.push({event:o,listeners:g}),o.target=Wi)))}function Ul(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var Bi={animationend:Ul("Animation","AnimationEnd"),animationiteration:Ul("Animation","AnimationIteration"),animationstart:Ul("Animation","AnimationStart"),transitionend:Ul("Transition","TransitionEnd")},_u={},Qp={};d&&(Qp=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function zl(i){if(_u[i])return _u[i];if(!Bi[i])return i;var o=Bi[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in Qp)return _u[i]=o[u];return i}var Jp=zl("animationend"),Zp=zl("animationiteration"),eg=zl("animationstart"),tg=zl("transitionend"),sg=new Map,rg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xn(i,o){sg.set(i,o),l(o,[i])}for(var bu=0;bu<rg.length;bu++){var Nu=rg[bu],HN=Nu.toLowerCase(),VN=Nu[0].toUpperCase()+Nu.slice(1);xn(HN,"on"+VN)}xn(Jp,"onAnimationEnd"),xn(Zp,"onAnimationIteration"),xn(eg,"onAnimationStart"),xn("dblclick","onDoubleClick"),xn("focusin","onFocus"),xn("focusout","onBlur"),xn(tg,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var po="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GN=new Set("cancel close invalid load scroll toggle".split(" ").concat(po));function ng(i,o,u){var g=i.type||"unknown-event";i.currentTarget=u,Hb(g,o,void 0,i),i.currentTarget=null}function ig(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var g=i[u],_=g.event;g=g.listeners;e:{var N=void 0;if(o)for(var T=g.length-1;0<=T;T--){var A=g[T],U=A.instance,Z=A.currentTarget;if(A=A.listener,U!==N&&_.isPropagationStopped())break e;ng(_,A,Z),N=U}else for(T=0;T<g.length;T++){if(A=g[T],U=A.instance,Z=A.currentTarget,A=A.listener,U!==N&&_.isPropagationStopped())break e;ng(_,A,Z),N=U}}}if(Sl)throw i=tu,Sl=!1,tu=null,i}function Tt(i,o){var u=o[Pu];u===void 0&&(u=o[Pu]=new Set);var g=i+"__bubble";u.has(g)||(ag(o,i,2,!1),u.add(g))}function Su(i,o,u){var g=0;o&&(g|=4),ag(u,i,g,o)}var Wl="_reactListening"+Math.random().toString(36).slice(2);function go(i){if(!i[Wl]){i[Wl]=!0,n.forEach(function(u){u!=="selectionchange"&&(GN.has(u)||Su(u,!1,i),Su(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Wl]||(o[Wl]=!0,Su("selectionchange",!1,o))}}function ag(i,o,u,g){switch(kp(o)){case 1:var _=oN;break;case 4:_=lN;break;default:_=lu}u=_.bind(null,o,u,i),_=void 0,!Ks||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(_=!0),g?_!==void 0?i.addEventListener(o,u,{capture:!0,passive:_}):i.addEventListener(o,u,!0):_!==void 0?i.addEventListener(o,u,{passive:_}):i.addEventListener(o,u,!1)}function Eu(i,o,u,g,_){var N=g;if((o&1)===0&&(o&2)===0&&g!==null)e:for(;;){if(g===null)return;var T=g.tag;if(T===3||T===4){var A=g.stateNode.containerInfo;if(A===_||A.nodeType===8&&A.parentNode===_)break;if(T===4)for(T=g.return;T!==null;){var U=T.tag;if((U===3||U===4)&&(U=T.stateNode.containerInfo,U===_||U.nodeType===8&&U.parentNode===_))return;T=T.return}for(;A!==null;){if(T=si(A),T===null)return;if(U=T.tag,U===5||U===6){g=N=T;continue e}A=A.parentNode}}g=g.return}js(function(){var Z=N,he=Li(u),fe=[];e:{var ce=sg.get(i);if(ce!==void 0){var Ee=uu,Oe=i;switch(i){case"keypress":if($l(u)===0)break e;case"keydown":case"keyup":Ee=bN;break;case"focusin":Oe="focus",Ee=fu;break;case"focusout":Oe="blur",Ee=fu;break;case"beforeblur":case"afterblur":Ee=fu;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=Pp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=uN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=EN;break;case Jp:case Zp:case eg:Ee=fN;break;case tg:Ee=TN;break;case"scroll":Ee=cN;break;case"wheel":Ee=ON;break;case"copy":case"cut":case"paste":Ee=gN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=Ap}var Ae=(o&4)!==0,Wt=!Ae&&i==="scroll",Y=Ae?ce!==null?ce+"Capture":null:ce;Ae=[];for(var B=Z,K;B!==null;){K=B;var ve=K.stateNode;if(K.tag===5&&ve!==null&&(K=ve,Y!==null&&(ve=ws(B,Y),ve!=null&&Ae.push(xo(B,ve,K)))),Wt)break;B=B.return}0<Ae.length&&(ce=new Ee(ce,Oe,null,u,he),fe.push({event:ce,listeners:Ae}))}}if((o&7)===0){e:{if(ce=i==="mouseover"||i==="pointerover",Ee=i==="mouseout"||i==="pointerout",ce&&u!==Ja&&(Oe=u.relatedTarget||u.fromElement)&&(si(Oe)||Oe[Ur]))break e;if((Ee||ce)&&(ce=he.window===he?he:(ce=he.ownerDocument)?ce.defaultView||ce.parentWindow:window,Ee?(Oe=u.relatedTarget||u.toElement,Ee=Z,Oe=Oe?si(Oe):null,Oe!==null&&(Wt=ti(Oe),Oe!==Wt||Oe.tag!==5&&Oe.tag!==6)&&(Oe=null)):(Ee=null,Oe=Z),Ee!==Oe)){if(Ae=Pp,ve="onMouseLeave",Y="onMouseEnter",B="mouse",(i==="pointerout"||i==="pointerover")&&(Ae=Ap,ve="onPointerLeave",Y="onPointerEnter",B="pointer"),Wt=Ee==null?ce:Vi(Ee),K=Oe==null?ce:Vi(Oe),ce=new Ae(ve,B+"leave",Ee,u,he),ce.target=Wt,ce.relatedTarget=K,ve=null,si(he)===Z&&(Ae=new Ae(Y,B+"enter",Oe,u,he),Ae.target=K,Ae.relatedTarget=Wt,ve=Ae),Wt=ve,Ee&&Oe)t:{for(Ae=Ee,Y=Oe,B=0,K=Ae;K;K=qi(K))B++;for(K=0,ve=Y;ve;ve=qi(ve))K++;for(;0<B-K;)Ae=qi(Ae),B--;for(;0<K-B;)Y=qi(Y),K--;for(;B--;){if(Ae===Y||Y!==null&&Ae===Y.alternate)break t;Ae=qi(Ae),Y=qi(Y)}Ae=null}else Ae=null;Ee!==null&&og(fe,ce,Ee,Ae,!1),Oe!==null&&Wt!==null&&og(fe,Wt,Oe,Ae,!0)}}e:{if(ce=Z?Vi(Z):window,Ee=ce.nodeName&&ce.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&ce.type==="file")var De=LN;else if(Up(ce))if(Wp)De=zN;else{De=FN;var Be=MN}else(Ee=ce.nodeName)&&Ee.toLowerCase()==="input"&&(ce.type==="checkbox"||ce.type==="radio")&&(De=UN);if(De&&(De=De(i,Z))){zp(fe,De,u,he);break e}Be&&Be(i,ce,Z),i==="focusout"&&(Be=ce._wrapperState)&&Be.controlled&&ce.type==="number"&&ke(ce,"number",ce.value)}switch(Be=Z?Vi(Z):window,i){case"focusin":(Up(Be)||Be.contentEditable==="true")&&(Wi=Be,ju=Z,fo=null);break;case"focusout":fo=ju=Wi=null;break;case"mousedown":wu=!0;break;case"contextmenu":case"mouseup":case"dragend":wu=!1,Xp(fe,u,he);break;case"selectionchange":if(qN)break;case"keydown":case"keyup":Xp(fe,u,he)}var qe;if(gu)e:{switch(i){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else zi?Mp(i,u)&&(Ke="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Ke="onCompositionStart");Ke&&(Dp&&u.locale!=="ko"&&(zi||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&zi&&(qe=Op()):(gn=he,du="value"in gn?gn.value:gn.textContent,zi=!0)),Be=Bl(Z,Ke),0<Be.length&&(Ke=new Ip(Ke,i,null,u,he),fe.push({event:Ke,listeners:Be}),qe?Ke.data=qe:(qe=Fp(u),qe!==null&&(Ke.data=qe)))),(qe=PN?IN(i,u):AN(i,u))&&(Z=Bl(Z,"onBeforeInput"),0<Z.length&&(he=new Ip("onBeforeInput","beforeinput",null,u,he),fe.push({event:he,listeners:Z}),he.data=qe))}ig(fe,o)})}function xo(i,o,u){return{instance:i,listener:o,currentTarget:u}}function Bl(i,o){for(var u=o+"Capture",g=[];i!==null;){var _=i,N=_.stateNode;_.tag===5&&N!==null&&(_=N,N=ws(i,u),N!=null&&g.unshift(xo(i,N,_)),N=ws(i,o),N!=null&&g.push(xo(i,N,_))),i=i.return}return g}function qi(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function og(i,o,u,g,_){for(var N=o._reactName,T=[];u!==null&&u!==g;){var A=u,U=A.alternate,Z=A.stateNode;if(U!==null&&U===g)break;A.tag===5&&Z!==null&&(A=Z,_?(U=ws(u,N),U!=null&&T.unshift(xo(u,U,A))):_||(U=ws(u,N),U!=null&&T.push(xo(u,U,A)))),u=u.return}T.length!==0&&i.push({event:o,listeners:T})}var YN=/\r\n?/g,KN=/\u0000|\uFFFD/g;function lg(i){return(typeof i=="string"?i:""+i).replace(YN,`
`).replace(KN,"")}function ql(i,o,u){if(o=lg(o),lg(i)!==o&&u)throw Error(r(425))}function Hl(){}var Cu=null,Tu=null;function ku(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ou=typeof setTimeout=="function"?setTimeout:void 0,XN=typeof clearTimeout=="function"?clearTimeout:void 0,cg=typeof Promise=="function"?Promise:void 0,QN=typeof queueMicrotask=="function"?queueMicrotask:typeof cg<"u"?function(i){return cg.resolve(null).then(i).catch(JN)}:Ou;function JN(i){setTimeout(function(){throw i})}function Ru(i,o){var u=o,g=0;do{var _=u.nextSibling;if(i.removeChild(u),_&&_.nodeType===8)if(u=_.data,u==="/$"){if(g===0){i.removeChild(_),ao(o);return}g--}else u!=="$"&&u!=="$?"&&u!=="$!"||g++;u=_}while(u);ao(o)}function vn(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function dg(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return i;o--}else u==="/$"&&o++}i=i.previousSibling}return null}var Hi=Math.random().toString(36).slice(2),xr="__reactFiber$"+Hi,vo="__reactProps$"+Hi,Ur="__reactContainer$"+Hi,Pu="__reactEvents$"+Hi,ZN="__reactListeners$"+Hi,eS="__reactHandles$"+Hi;function si(i){var o=i[xr];if(o)return o;for(var u=i.parentNode;u;){if(o=u[Ur]||u[xr]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=dg(i);i!==null;){if(u=i[xr])return u;i=dg(i)}return o}i=u,u=i.parentNode}return null}function yo(i){return i=i[xr]||i[Ur],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Vi(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(r(33))}function Vl(i){return i[vo]||null}var Iu=[],Gi=-1;function yn(i){return{current:i}}function kt(i){0>Gi||(i.current=Iu[Gi],Iu[Gi]=null,Gi--)}function Et(i,o){Gi++,Iu[Gi]=i.current,i.current=o}var jn={},as=yn(jn),_s=yn(!1),ri=jn;function Yi(i,o){var u=i.type.contextTypes;if(!u)return jn;var g=i.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===o)return g.__reactInternalMemoizedMaskedChildContext;var _={},N;for(N in u)_[N]=o[N];return g&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=_),_}function bs(i){return i=i.childContextTypes,i!=null}function Gl(){kt(_s),kt(as)}function ug(i,o,u){if(as.current!==jn)throw Error(r(168));Et(as,o),Et(_s,u)}function hg(i,o,u){var g=i.stateNode;if(o=o.childContextTypes,typeof g.getChildContext!="function")return u;g=g.getChildContext();for(var _ in g)if(!(_ in o))throw Error(r(108,de(i)||"Unknown",_));return oe({},u,g)}function Yl(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||jn,ri=as.current,Et(as,i),Et(_s,_s.current),!0}function mg(i,o,u){var g=i.stateNode;if(!g)throw Error(r(169));u?(i=hg(i,o,ri),g.__reactInternalMemoizedMergedChildContext=i,kt(_s),kt(as),Et(as,i)):kt(_s),Et(_s,u)}var zr=null,Kl=!1,Au=!1;function fg(i){zr===null?zr=[i]:zr.push(i)}function tS(i){Kl=!0,fg(i)}function wn(){if(!Au&&zr!==null){Au=!0;var i=0,o=wt;try{var u=zr;for(wt=1;i<u.length;i++){var g=u[i];do g=g(!0);while(g!==null)}zr=null,Kl=!1}catch(_){throw zr!==null&&(zr=zr.slice(i+1)),gp(su,wn),_}finally{wt=o,Au=!1}}return null}var Ki=[],Xi=0,Xl=null,Ql=0,Fs=[],Us=0,ni=null,Wr=1,Br="";function ii(i,o){Ki[Xi++]=Ql,Ki[Xi++]=Xl,Xl=i,Ql=o}function pg(i,o,u){Fs[Us++]=Wr,Fs[Us++]=Br,Fs[Us++]=ni,ni=i;var g=Wr;i=Br;var _=32-Xs(g)-1;g&=~(1<<_),u+=1;var N=32-Xs(o)+_;if(30<N){var T=_-_%5;N=(g&(1<<T)-1).toString(32),g>>=T,_-=T,Wr=1<<32-Xs(o)+_|u<<_|g,Br=N+i}else Wr=1<<N|u<<_|g,Br=i}function Du(i){i.return!==null&&(ii(i,1),pg(i,1,0))}function $u(i){for(;i===Xl;)Xl=Ki[--Xi],Ki[Xi]=null,Ql=Ki[--Xi],Ki[Xi]=null;for(;i===ni;)ni=Fs[--Us],Fs[Us]=null,Br=Fs[--Us],Fs[Us]=null,Wr=Fs[--Us],Fs[Us]=null}var Rs=null,Ps=null,Pt=!1,Js=null;function gg(i,o){var u=qs(5,null,null,0);u.elementType="DELETED",u.stateNode=o,u.return=i,o=i.deletions,o===null?(i.deletions=[u],i.flags|=16):o.push(u)}function xg(i,o){switch(i.tag){case 5:var u=i.type;return o=o.nodeType!==1||u.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Rs=i,Ps=vn(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Rs=i,Ps=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(u=ni!==null?{id:Wr,overflow:Br}:null,i.memoizedState={dehydrated:o,treeContext:u,retryLane:1073741824},u=qs(18,null,null,0),u.stateNode=o,u.return=i,i.child=u,Rs=i,Ps=null,!0):!1;default:return!1}}function Lu(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Mu(i){if(Pt){var o=Ps;if(o){var u=o;if(!xg(i,o)){if(Lu(i))throw Error(r(418));o=vn(u.nextSibling);var g=Rs;o&&xg(i,o)?gg(g,u):(i.flags=i.flags&-4097|2,Pt=!1,Rs=i)}}else{if(Lu(i))throw Error(r(418));i.flags=i.flags&-4097|2,Pt=!1,Rs=i}}}function vg(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Rs=i}function Jl(i){if(i!==Rs)return!1;if(!Pt)return vg(i),Pt=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!ku(i.type,i.memoizedProps)),o&&(o=Ps)){if(Lu(i))throw yg(),Error(r(418));for(;o;)gg(i,o),o=vn(o.nextSibling)}if(vg(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"){if(o===0){Ps=vn(i.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++}i=i.nextSibling}Ps=null}}else Ps=Rs?vn(i.stateNode.nextSibling):null;return!0}function yg(){for(var i=Ps;i;)i=vn(i.nextSibling)}function Qi(){Ps=Rs=null,Pt=!1}function Fu(i){Js===null?Js=[i]:Js.push(i)}var sS=O.ReactCurrentBatchConfig;function jo(i,o,u){if(i=u.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(r(309));var g=u.stateNode}if(!g)throw Error(r(147,i));var _=g,N=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===N?o.ref:(o=function(T){var A=_.refs;T===null?delete A[N]:A[N]=T},o._stringRef=N,o)}if(typeof i!="string")throw Error(r(284));if(!u._owner)throw Error(r(290,i))}return i}function Zl(i,o){throw i=Object.prototype.toString.call(o),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function jg(i){var o=i._init;return o(i._payload)}function wg(i){function o(Y,B){if(i){var K=Y.deletions;K===null?(Y.deletions=[B],Y.flags|=16):K.push(B)}}function u(Y,B){if(!i)return null;for(;B!==null;)o(Y,B),B=B.sibling;return null}function g(Y,B){for(Y=new Map;B!==null;)B.key!==null?Y.set(B.key,B):Y.set(B.index,B),B=B.sibling;return Y}function _(Y,B){return Y=kn(Y,B),Y.index=0,Y.sibling=null,Y}function N(Y,B,K){return Y.index=K,i?(K=Y.alternate,K!==null?(K=K.index,K<B?(Y.flags|=2,B):K):(Y.flags|=2,B)):(Y.flags|=1048576,B)}function T(Y){return i&&Y.alternate===null&&(Y.flags|=2),Y}function A(Y,B,K,ve){return B===null||B.tag!==6?(B=Oh(K,Y.mode,ve),B.return=Y,B):(B=_(B,K),B.return=Y,B)}function U(Y,B,K,ve){var De=K.type;return De===P?he(Y,B,K.props.children,ve,K.key):B!==null&&(B.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===ie&&jg(De)===B.type)?(ve=_(B,K.props),ve.ref=jo(Y,B,K),ve.return=Y,ve):(ve=bc(K.type,K.key,K.props,null,Y.mode,ve),ve.ref=jo(Y,B,K),ve.return=Y,ve)}function Z(Y,B,K,ve){return B===null||B.tag!==4||B.stateNode.containerInfo!==K.containerInfo||B.stateNode.implementation!==K.implementation?(B=Rh(K,Y.mode,ve),B.return=Y,B):(B=_(B,K.children||[]),B.return=Y,B)}function he(Y,B,K,ve,De){return B===null||B.tag!==7?(B=mi(K,Y.mode,ve,De),B.return=Y,B):(B=_(B,K),B.return=Y,B)}function fe(Y,B,K){if(typeof B=="string"&&B!==""||typeof B=="number")return B=Oh(""+B,Y.mode,K),B.return=Y,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case R:return K=bc(B.type,B.key,B.props,null,Y.mode,K),K.ref=jo(Y,null,B),K.return=Y,K;case k:return B=Rh(B,Y.mode,K),B.return=Y,B;case ie:var ve=B._init;return fe(Y,ve(B._payload),K)}if(Je(B)||te(B))return B=mi(B,Y.mode,K,null),B.return=Y,B;Zl(Y,B)}return null}function ce(Y,B,K,ve){var De=B!==null?B.key:null;if(typeof K=="string"&&K!==""||typeof K=="number")return De!==null?null:A(Y,B,""+K,ve);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case R:return K.key===De?U(Y,B,K,ve):null;case k:return K.key===De?Z(Y,B,K,ve):null;case ie:return De=K._init,ce(Y,B,De(K._payload),ve)}if(Je(K)||te(K))return De!==null?null:he(Y,B,K,ve,null);Zl(Y,K)}return null}function Ee(Y,B,K,ve,De){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return Y=Y.get(K)||null,A(B,Y,""+ve,De);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case R:return Y=Y.get(ve.key===null?K:ve.key)||null,U(B,Y,ve,De);case k:return Y=Y.get(ve.key===null?K:ve.key)||null,Z(B,Y,ve,De);case ie:var Be=ve._init;return Ee(Y,B,K,Be(ve._payload),De)}if(Je(ve)||te(ve))return Y=Y.get(K)||null,he(B,Y,ve,De,null);Zl(B,ve)}return null}function Oe(Y,B,K,ve){for(var De=null,Be=null,qe=B,Ke=B=0,es=null;qe!==null&&Ke<K.length;Ke++){qe.index>Ke?(es=qe,qe=null):es=qe.sibling;var yt=ce(Y,qe,K[Ke],ve);if(yt===null){qe===null&&(qe=es);break}i&&qe&&yt.alternate===null&&o(Y,qe),B=N(yt,B,Ke),Be===null?De=yt:Be.sibling=yt,Be=yt,qe=es}if(Ke===K.length)return u(Y,qe),Pt&&ii(Y,Ke),De;if(qe===null){for(;Ke<K.length;Ke++)qe=fe(Y,K[Ke],ve),qe!==null&&(B=N(qe,B,Ke),Be===null?De=qe:Be.sibling=qe,Be=qe);return Pt&&ii(Y,Ke),De}for(qe=g(Y,qe);Ke<K.length;Ke++)es=Ee(qe,Y,Ke,K[Ke],ve),es!==null&&(i&&es.alternate!==null&&qe.delete(es.key===null?Ke:es.key),B=N(es,B,Ke),Be===null?De=es:Be.sibling=es,Be=es);return i&&qe.forEach(function(On){return o(Y,On)}),Pt&&ii(Y,Ke),De}function Ae(Y,B,K,ve){var De=te(K);if(typeof De!="function")throw Error(r(150));if(K=De.call(K),K==null)throw Error(r(151));for(var Be=De=null,qe=B,Ke=B=0,es=null,yt=K.next();qe!==null&&!yt.done;Ke++,yt=K.next()){qe.index>Ke?(es=qe,qe=null):es=qe.sibling;var On=ce(Y,qe,yt.value,ve);if(On===null){qe===null&&(qe=es);break}i&&qe&&On.alternate===null&&o(Y,qe),B=N(On,B,Ke),Be===null?De=On:Be.sibling=On,Be=On,qe=es}if(yt.done)return u(Y,qe),Pt&&ii(Y,Ke),De;if(qe===null){for(;!yt.done;Ke++,yt=K.next())yt=fe(Y,yt.value,ve),yt!==null&&(B=N(yt,B,Ke),Be===null?De=yt:Be.sibling=yt,Be=yt);return Pt&&ii(Y,Ke),De}for(qe=g(Y,qe);!yt.done;Ke++,yt=K.next())yt=Ee(qe,Y,Ke,yt.value,ve),yt!==null&&(i&&yt.alternate!==null&&qe.delete(yt.key===null?Ke:yt.key),B=N(yt,B,Ke),Be===null?De=yt:Be.sibling=yt,Be=yt);return i&&qe.forEach(function(DS){return o(Y,DS)}),Pt&&ii(Y,Ke),De}function Wt(Y,B,K,ve){if(typeof K=="object"&&K!==null&&K.type===P&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case R:e:{for(var De=K.key,Be=B;Be!==null;){if(Be.key===De){if(De=K.type,De===P){if(Be.tag===7){u(Y,Be.sibling),B=_(Be,K.props.children),B.return=Y,Y=B;break e}}else if(Be.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===ie&&jg(De)===Be.type){u(Y,Be.sibling),B=_(Be,K.props),B.ref=jo(Y,Be,K),B.return=Y,Y=B;break e}u(Y,Be);break}else o(Y,Be);Be=Be.sibling}K.type===P?(B=mi(K.props.children,Y.mode,ve,K.key),B.return=Y,Y=B):(ve=bc(K.type,K.key,K.props,null,Y.mode,ve),ve.ref=jo(Y,B,K),ve.return=Y,Y=ve)}return T(Y);case k:e:{for(Be=K.key;B!==null;){if(B.key===Be)if(B.tag===4&&B.stateNode.containerInfo===K.containerInfo&&B.stateNode.implementation===K.implementation){u(Y,B.sibling),B=_(B,K.children||[]),B.return=Y,Y=B;break e}else{u(Y,B);break}else o(Y,B);B=B.sibling}B=Rh(K,Y.mode,ve),B.return=Y,Y=B}return T(Y);case ie:return Be=K._init,Wt(Y,B,Be(K._payload),ve)}if(Je(K))return Oe(Y,B,K,ve);if(te(K))return Ae(Y,B,K,ve);Zl(Y,K)}return typeof K=="string"&&K!==""||typeof K=="number"?(K=""+K,B!==null&&B.tag===6?(u(Y,B.sibling),B=_(B,K),B.return=Y,Y=B):(u(Y,B),B=Oh(K,Y.mode,ve),B.return=Y,Y=B),T(Y)):u(Y,B)}return Wt}var Ji=wg(!0),_g=wg(!1),ec=yn(null),tc=null,Zi=null,Uu=null;function zu(){Uu=Zi=tc=null}function Wu(i){var o=ec.current;kt(ec),i._currentValue=o}function Bu(i,o,u){for(;i!==null;){var g=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,g!==null&&(g.childLanes|=o)):g!==null&&(g.childLanes&o)!==o&&(g.childLanes|=o),i===u)break;i=i.return}}function ea(i,o){tc=i,Uu=Zi=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(Ns=!0),i.firstContext=null)}function zs(i){var o=i._currentValue;if(Uu!==i)if(i={context:i,memoizedValue:o,next:null},Zi===null){if(tc===null)throw Error(r(308));Zi=i,tc.dependencies={lanes:0,firstContext:i}}else Zi=Zi.next=i;return o}var ai=null;function qu(i){ai===null?ai=[i]:ai.push(i)}function bg(i,o,u,g){var _=o.interleaved;return _===null?(u.next=u,qu(o)):(u.next=_.next,_.next=u),o.interleaved=u,qr(i,g)}function qr(i,o){i.lanes|=o;var u=i.alternate;for(u!==null&&(u.lanes|=o),u=i,i=i.return;i!==null;)i.childLanes|=o,u=i.alternate,u!==null&&(u.childLanes|=o),u=i,i=i.return;return u.tag===3?u.stateNode:null}var _n=!1;function Hu(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ng(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Hr(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function bn(i,o,u){var g=i.updateQueue;if(g===null)return null;if(g=g.shared,(vt&2)!==0){var _=g.pending;return _===null?o.next=o:(o.next=_.next,_.next=o),g.pending=o,qr(i,u)}return _=g.interleaved,_===null?(o.next=o,qu(g)):(o.next=_.next,_.next=o),g.interleaved=o,qr(i,u)}function sc(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194240)!==0)){var g=o.lanes;g&=i.pendingLanes,u|=g,o.lanes=u,iu(i,u)}}function Sg(i,o){var u=i.updateQueue,g=i.alternate;if(g!==null&&(g=g.updateQueue,u===g)){var _=null,N=null;if(u=u.firstBaseUpdate,u!==null){do{var T={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};N===null?_=N=T:N=N.next=T,u=u.next}while(u!==null);N===null?_=N=o:N=N.next=o}else _=N=o;u={baseState:g.baseState,firstBaseUpdate:_,lastBaseUpdate:N,shared:g.shared,effects:g.effects},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}function rc(i,o,u,g){var _=i.updateQueue;_n=!1;var N=_.firstBaseUpdate,T=_.lastBaseUpdate,A=_.shared.pending;if(A!==null){_.shared.pending=null;var U=A,Z=U.next;U.next=null,T===null?N=Z:T.next=Z,T=U;var he=i.alternate;he!==null&&(he=he.updateQueue,A=he.lastBaseUpdate,A!==T&&(A===null?he.firstBaseUpdate=Z:A.next=Z,he.lastBaseUpdate=U))}if(N!==null){var fe=_.baseState;T=0,he=Z=U=null,A=N;do{var ce=A.lane,Ee=A.eventTime;if((g&ce)===ce){he!==null&&(he=he.next={eventTime:Ee,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});e:{var Oe=i,Ae=A;switch(ce=o,Ee=u,Ae.tag){case 1:if(Oe=Ae.payload,typeof Oe=="function"){fe=Oe.call(Ee,fe,ce);break e}fe=Oe;break e;case 3:Oe.flags=Oe.flags&-65537|128;case 0:if(Oe=Ae.payload,ce=typeof Oe=="function"?Oe.call(Ee,fe,ce):Oe,ce==null)break e;fe=oe({},fe,ce);break e;case 2:_n=!0}}A.callback!==null&&A.lane!==0&&(i.flags|=64,ce=_.effects,ce===null?_.effects=[A]:ce.push(A))}else Ee={eventTime:Ee,lane:ce,tag:A.tag,payload:A.payload,callback:A.callback,next:null},he===null?(Z=he=Ee,U=fe):he=he.next=Ee,T|=ce;if(A=A.next,A===null){if(A=_.shared.pending,A===null)break;ce=A,A=ce.next,ce.next=null,_.lastBaseUpdate=ce,_.shared.pending=null}}while(!0);if(he===null&&(U=fe),_.baseState=U,_.firstBaseUpdate=Z,_.lastBaseUpdate=he,o=_.shared.interleaved,o!==null){_=o;do T|=_.lane,_=_.next;while(_!==o)}else N===null&&(_.shared.lanes=0);ci|=T,i.lanes=T,i.memoizedState=fe}}function Eg(i,o,u){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var g=i[o],_=g.callback;if(_!==null){if(g.callback=null,g=u,typeof _!="function")throw Error(r(191,_));_.call(g)}}}var wo={},vr=yn(wo),_o=yn(wo),bo=yn(wo);function oi(i){if(i===wo)throw Error(r(174));return i}function Vu(i,o){switch(Et(bo,o),Et(_o,i),Et(vr,wo),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:le(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=le(o,i)}kt(vr),Et(vr,o)}function ta(){kt(vr),kt(_o),kt(bo)}function Cg(i){oi(bo.current);var o=oi(vr.current),u=le(o,i.type);o!==u&&(Et(_o,i),Et(vr,u))}function Gu(i){_o.current===i&&(kt(vr),kt(_o))}var $t=yn(0);function nc(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Yu=[];function Ku(){for(var i=0;i<Yu.length;i++)Yu[i]._workInProgressVersionPrimary=null;Yu.length=0}var ic=O.ReactCurrentDispatcher,Xu=O.ReactCurrentBatchConfig,li=0,Lt=null,Vt=null,Jt=null,ac=!1,No=!1,So=0,rS=0;function os(){throw Error(r(321))}function Qu(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!Qs(i[u],o[u]))return!1;return!0}function Ju(i,o,u,g,_,N){if(li=N,Lt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ic.current=i===null||i.memoizedState===null?oS:lS,i=u(g,_),No){N=0;do{if(No=!1,So=0,25<=N)throw Error(r(301));N+=1,Jt=Vt=null,o.updateQueue=null,ic.current=cS,i=u(g,_)}while(No)}if(ic.current=cc,o=Vt!==null&&Vt.next!==null,li=0,Jt=Vt=Lt=null,ac=!1,o)throw Error(r(300));return i}function Zu(){var i=So!==0;return So=0,i}function yr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?Lt.memoizedState=Jt=i:Jt=Jt.next=i,Jt}function Ws(){if(Vt===null){var i=Lt.alternate;i=i!==null?i.memoizedState:null}else i=Vt.next;var o=Jt===null?Lt.memoizedState:Jt.next;if(o!==null)Jt=o,Vt=i;else{if(i===null)throw Error(r(310));Vt=i,i={memoizedState:Vt.memoizedState,baseState:Vt.baseState,baseQueue:Vt.baseQueue,queue:Vt.queue,next:null},Jt===null?Lt.memoizedState=Jt=i:Jt=Jt.next=i}return Jt}function Eo(i,o){return typeof o=="function"?o(i):o}function eh(i){var o=Ws(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=i;var g=Vt,_=g.baseQueue,N=u.pending;if(N!==null){if(_!==null){var T=_.next;_.next=N.next,N.next=T}g.baseQueue=_=N,u.pending=null}if(_!==null){N=_.next,g=g.baseState;var A=T=null,U=null,Z=N;do{var he=Z.lane;if((li&he)===he)U!==null&&(U=U.next={lane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),g=Z.hasEagerState?Z.eagerState:i(g,Z.action);else{var fe={lane:he,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null};U===null?(A=U=fe,T=g):U=U.next=fe,Lt.lanes|=he,ci|=he}Z=Z.next}while(Z!==null&&Z!==N);U===null?T=g:U.next=A,Qs(g,o.memoizedState)||(Ns=!0),o.memoizedState=g,o.baseState=T,o.baseQueue=U,u.lastRenderedState=g}if(i=u.interleaved,i!==null){_=i;do N=_.lane,Lt.lanes|=N,ci|=N,_=_.next;while(_!==i)}else _===null&&(u.lanes=0);return[o.memoizedState,u.dispatch]}function th(i){var o=Ws(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=i;var g=u.dispatch,_=u.pending,N=o.memoizedState;if(_!==null){u.pending=null;var T=_=_.next;do N=i(N,T.action),T=T.next;while(T!==_);Qs(N,o.memoizedState)||(Ns=!0),o.memoizedState=N,o.baseQueue===null&&(o.baseState=N),u.lastRenderedState=N}return[N,g]}function Tg(){}function kg(i,o){var u=Lt,g=Ws(),_=o(),N=!Qs(g.memoizedState,_);if(N&&(g.memoizedState=_,Ns=!0),g=g.queue,sh(Pg.bind(null,u,g,i),[i]),g.getSnapshot!==o||N||Jt!==null&&Jt.memoizedState.tag&1){if(u.flags|=2048,Co(9,Rg.bind(null,u,g,_,o),void 0,null),Zt===null)throw Error(r(349));(li&30)!==0||Og(u,o,_)}return _}function Og(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=Lt.updateQueue,o===null?(o={lastEffect:null,stores:null},Lt.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function Rg(i,o,u,g){o.value=u,o.getSnapshot=g,Ig(o)&&Ag(i)}function Pg(i,o,u){return u(function(){Ig(o)&&Ag(i)})}function Ig(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!Qs(i,u)}catch{return!0}}function Ag(i){var o=qr(i,1);o!==null&&sr(o,i,1,-1)}function Dg(i){var o=yr();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:i},o.queue=i,i=i.dispatch=aS.bind(null,Lt,i),[o.memoizedState,i]}function Co(i,o,u,g){return i={tag:i,create:o,destroy:u,deps:g,next:null},o=Lt.updateQueue,o===null?(o={lastEffect:null,stores:null},Lt.updateQueue=o,o.lastEffect=i.next=i):(u=o.lastEffect,u===null?o.lastEffect=i.next=i:(g=u.next,u.next=i,i.next=g,o.lastEffect=i)),i}function $g(){return Ws().memoizedState}function oc(i,o,u,g){var _=yr();Lt.flags|=i,_.memoizedState=Co(1|o,u,void 0,g===void 0?null:g)}function lc(i,o,u,g){var _=Ws();g=g===void 0?null:g;var N=void 0;if(Vt!==null){var T=Vt.memoizedState;if(N=T.destroy,g!==null&&Qu(g,T.deps)){_.memoizedState=Co(o,u,N,g);return}}Lt.flags|=i,_.memoizedState=Co(1|o,u,N,g)}function Lg(i,o){return oc(8390656,8,i,o)}function sh(i,o){return lc(2048,8,i,o)}function Mg(i,o){return lc(4,2,i,o)}function Fg(i,o){return lc(4,4,i,o)}function Ug(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function zg(i,o,u){return u=u!=null?u.concat([i]):null,lc(4,4,Ug.bind(null,o,i),u)}function rh(){}function Wg(i,o){var u=Ws();o=o===void 0?null:o;var g=u.memoizedState;return g!==null&&o!==null&&Qu(o,g[1])?g[0]:(u.memoizedState=[i,o],i)}function Bg(i,o){var u=Ws();o=o===void 0?null:o;var g=u.memoizedState;return g!==null&&o!==null&&Qu(o,g[1])?g[0]:(i=i(),u.memoizedState=[i,o],i)}function qg(i,o,u){return(li&21)===0?(i.baseState&&(i.baseState=!1,Ns=!0),i.memoizedState=u):(Qs(u,o)||(u=jp(),Lt.lanes|=u,ci|=u,i.baseState=!0),o)}function nS(i,o){var u=wt;wt=u!==0&&4>u?u:4,i(!0);var g=Xu.transition;Xu.transition={};try{i(!1),o()}finally{wt=u,Xu.transition=g}}function Hg(){return Ws().memoizedState}function iS(i,o,u){var g=Cn(i);if(u={lane:g,action:u,hasEagerState:!1,eagerState:null,next:null},Vg(i))Gg(o,u);else if(u=bg(i,o,u,g),u!==null){var _=fs();sr(u,i,g,_),Yg(u,o,g)}}function aS(i,o,u){var g=Cn(i),_={lane:g,action:u,hasEagerState:!1,eagerState:null,next:null};if(Vg(i))Gg(o,_);else{var N=i.alternate;if(i.lanes===0&&(N===null||N.lanes===0)&&(N=o.lastRenderedReducer,N!==null))try{var T=o.lastRenderedState,A=N(T,u);if(_.hasEagerState=!0,_.eagerState=A,Qs(A,T)){var U=o.interleaved;U===null?(_.next=_,qu(o)):(_.next=U.next,U.next=_),o.interleaved=_;return}}catch{}finally{}u=bg(i,o,_,g),u!==null&&(_=fs(),sr(u,i,g,_),Yg(u,o,g))}}function Vg(i){var o=i.alternate;return i===Lt||o!==null&&o===Lt}function Gg(i,o){No=ac=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function Yg(i,o,u){if((u&4194240)!==0){var g=o.lanes;g&=i.pendingLanes,u|=g,o.lanes=u,iu(i,u)}}var cc={readContext:zs,useCallback:os,useContext:os,useEffect:os,useImperativeHandle:os,useInsertionEffect:os,useLayoutEffect:os,useMemo:os,useReducer:os,useRef:os,useState:os,useDebugValue:os,useDeferredValue:os,useTransition:os,useMutableSource:os,useSyncExternalStore:os,useId:os,unstable_isNewReconciler:!1},oS={readContext:zs,useCallback:function(i,o){return yr().memoizedState=[i,o===void 0?null:o],i},useContext:zs,useEffect:Lg,useImperativeHandle:function(i,o,u){return u=u!=null?u.concat([i]):null,oc(4194308,4,Ug.bind(null,o,i),u)},useLayoutEffect:function(i,o){return oc(4194308,4,i,o)},useInsertionEffect:function(i,o){return oc(4,2,i,o)},useMemo:function(i,o){var u=yr();return o=o===void 0?null:o,i=i(),u.memoizedState=[i,o],i},useReducer:function(i,o,u){var g=yr();return o=u!==void 0?u(o):o,g.memoizedState=g.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},g.queue=i,i=i.dispatch=iS.bind(null,Lt,i),[g.memoizedState,i]},useRef:function(i){var o=yr();return i={current:i},o.memoizedState=i},useState:Dg,useDebugValue:rh,useDeferredValue:function(i){return yr().memoizedState=i},useTransition:function(){var i=Dg(!1),o=i[0];return i=nS.bind(null,i[1]),yr().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,u){var g=Lt,_=yr();if(Pt){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),Zt===null)throw Error(r(349));(li&30)!==0||Og(g,o,u)}_.memoizedState=u;var N={value:u,getSnapshot:o};return _.queue=N,Lg(Pg.bind(null,g,N,i),[i]),g.flags|=2048,Co(9,Rg.bind(null,g,N,u,o),void 0,null),u},useId:function(){var i=yr(),o=Zt.identifierPrefix;if(Pt){var u=Br,g=Wr;u=(g&~(1<<32-Xs(g)-1)).toString(32)+u,o=":"+o+"R"+u,u=So++,0<u&&(o+="H"+u.toString(32)),o+=":"}else u=rS++,o=":"+o+"r"+u.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},lS={readContext:zs,useCallback:Wg,useContext:zs,useEffect:sh,useImperativeHandle:zg,useInsertionEffect:Mg,useLayoutEffect:Fg,useMemo:Bg,useReducer:eh,useRef:$g,useState:function(){return eh(Eo)},useDebugValue:rh,useDeferredValue:function(i){var o=Ws();return qg(o,Vt.memoizedState,i)},useTransition:function(){var i=eh(Eo)[0],o=Ws().memoizedState;return[i,o]},useMutableSource:Tg,useSyncExternalStore:kg,useId:Hg,unstable_isNewReconciler:!1},cS={readContext:zs,useCallback:Wg,useContext:zs,useEffect:sh,useImperativeHandle:zg,useInsertionEffect:Mg,useLayoutEffect:Fg,useMemo:Bg,useReducer:th,useRef:$g,useState:function(){return th(Eo)},useDebugValue:rh,useDeferredValue:function(i){var o=Ws();return Vt===null?o.memoizedState=i:qg(o,Vt.memoizedState,i)},useTransition:function(){var i=th(Eo)[0],o=Ws().memoizedState;return[i,o]},useMutableSource:Tg,useSyncExternalStore:kg,useId:Hg,unstable_isNewReconciler:!1};function Zs(i,o){if(i&&i.defaultProps){o=oe({},o),i=i.defaultProps;for(var u in i)o[u]===void 0&&(o[u]=i[u]);return o}return o}function nh(i,o,u,g){o=i.memoizedState,u=u(g,o),u=u==null?o:oe({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var dc={isMounted:function(i){return(i=i._reactInternals)?ti(i)===i:!1},enqueueSetState:function(i,o,u){i=i._reactInternals;var g=fs(),_=Cn(i),N=Hr(g,_);N.payload=o,u!=null&&(N.callback=u),o=bn(i,N,_),o!==null&&(sr(o,i,_,g),sc(o,i,_))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var g=fs(),_=Cn(i),N=Hr(g,_);N.tag=1,N.payload=o,u!=null&&(N.callback=u),o=bn(i,N,_),o!==null&&(sr(o,i,_,g),sc(o,i,_))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=fs(),g=Cn(i),_=Hr(u,g);_.tag=2,o!=null&&(_.callback=o),o=bn(i,_,g),o!==null&&(sr(o,i,g,u),sc(o,i,g))}};function Kg(i,o,u,g,_,N,T){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(g,N,T):o.prototype&&o.prototype.isPureReactComponent?!mo(u,g)||!mo(_,N):!0}function Xg(i,o,u){var g=!1,_=jn,N=o.contextType;return typeof N=="object"&&N!==null?N=zs(N):(_=bs(o)?ri:as.current,g=o.contextTypes,N=(g=g!=null)?Yi(i,_):jn),o=new o(u,N),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=dc,i.stateNode=o,o._reactInternals=i,g&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=_,i.__reactInternalMemoizedMaskedChildContext=N),o}function Qg(i,o,u,g){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,g),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,g),o.state!==i&&dc.enqueueReplaceState(o,o.state,null)}function ih(i,o,u,g){var _=i.stateNode;_.props=u,_.state=i.memoizedState,_.refs={},Hu(i);var N=o.contextType;typeof N=="object"&&N!==null?_.context=zs(N):(N=bs(o)?ri:as.current,_.context=Yi(i,N)),_.state=i.memoizedState,N=o.getDerivedStateFromProps,typeof N=="function"&&(nh(i,o,N,u),_.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(o=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),o!==_.state&&dc.enqueueReplaceState(_,_.state,null),rc(i,u,_,g),_.state=i.memoizedState),typeof _.componentDidMount=="function"&&(i.flags|=4194308)}function sa(i,o){try{var u="",g=o;do u+=Le(g),g=g.return;while(g);var _=u}catch(N){_=`
Error generating stack: `+N.message+`
`+N.stack}return{value:i,source:o,stack:_,digest:null}}function ah(i,o,u){return{value:i,source:null,stack:u??null,digest:o??null}}function oh(i,o){try{console.error(o.value)}catch(u){setTimeout(function(){throw u})}}var dS=typeof WeakMap=="function"?WeakMap:Map;function Jg(i,o,u){u=Hr(-1,u),u.tag=3,u.payload={element:null};var g=o.value;return u.callback=function(){xc||(xc=!0,_h=g),oh(i,o)},u}function Zg(i,o,u){u=Hr(-1,u),u.tag=3;var g=i.type.getDerivedStateFromError;if(typeof g=="function"){var _=o.value;u.payload=function(){return g(_)},u.callback=function(){oh(i,o)}}var N=i.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(u.callback=function(){oh(i,o),typeof g!="function"&&(Sn===null?Sn=new Set([this]):Sn.add(this));var T=o.stack;this.componentDidCatch(o.value,{componentStack:T!==null?T:""})}),u}function ex(i,o,u){var g=i.pingCache;if(g===null){g=i.pingCache=new dS;var _=new Set;g.set(o,_)}else _=g.get(o),_===void 0&&(_=new Set,g.set(o,_));_.has(u)||(_.add(u),i=NS.bind(null,i,o,u),o.then(i,i))}function tx(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function sx(i,o,u,g,_){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(o=Hr(-1,1),o.tag=2,bn(u,o,1))),u.lanes|=1),i):(i.flags|=65536,i.lanes=_,i)}var uS=O.ReactCurrentOwner,Ns=!1;function ms(i,o,u,g){o.child=i===null?_g(o,null,u,g):Ji(o,i.child,u,g)}function rx(i,o,u,g,_){u=u.render;var N=o.ref;return ea(o,_),g=Ju(i,o,u,g,N,_),u=Zu(),i!==null&&!Ns?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~_,Vr(i,o,_)):(Pt&&u&&Du(o),o.flags|=1,ms(i,o,g,_),o.child)}function nx(i,o,u,g,_){if(i===null){var N=u.type;return typeof N=="function"&&!kh(N)&&N.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(o.tag=15,o.type=N,ix(i,o,N,g,_)):(i=bc(u.type,null,g,o,o.mode,_),i.ref=o.ref,i.return=o,o.child=i)}if(N=i.child,(i.lanes&_)===0){var T=N.memoizedProps;if(u=u.compare,u=u!==null?u:mo,u(T,g)&&i.ref===o.ref)return Vr(i,o,_)}return o.flags|=1,i=kn(N,g),i.ref=o.ref,i.return=o,o.child=i}function ix(i,o,u,g,_){if(i!==null){var N=i.memoizedProps;if(mo(N,g)&&i.ref===o.ref)if(Ns=!1,o.pendingProps=g=N,(i.lanes&_)!==0)(i.flags&131072)!==0&&(Ns=!0);else return o.lanes=i.lanes,Vr(i,o,_)}return lh(i,o,u,g,_)}function ax(i,o,u){var g=o.pendingProps,_=g.children,N=i!==null?i.memoizedState:null;if(g.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Et(na,Is),Is|=u;else{if((u&1073741824)===0)return i=N!==null?N.baseLanes|u:u,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Et(na,Is),Is|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=N!==null?N.baseLanes:u,Et(na,Is),Is|=g}else N!==null?(g=N.baseLanes|u,o.memoizedState=null):g=u,Et(na,Is),Is|=g;return ms(i,o,_,u),o.child}function ox(i,o){var u=o.ref;(i===null&&u!==null||i!==null&&i.ref!==u)&&(o.flags|=512,o.flags|=2097152)}function lh(i,o,u,g,_){var N=bs(u)?ri:as.current;return N=Yi(o,N),ea(o,_),u=Ju(i,o,u,g,N,_),g=Zu(),i!==null&&!Ns?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~_,Vr(i,o,_)):(Pt&&g&&Du(o),o.flags|=1,ms(i,o,u,_),o.child)}function lx(i,o,u,g,_){if(bs(u)){var N=!0;Yl(o)}else N=!1;if(ea(o,_),o.stateNode===null)hc(i,o),Xg(o,u,g),ih(o,u,g,_),g=!0;else if(i===null){var T=o.stateNode,A=o.memoizedProps;T.props=A;var U=T.context,Z=u.contextType;typeof Z=="object"&&Z!==null?Z=zs(Z):(Z=bs(u)?ri:as.current,Z=Yi(o,Z));var he=u.getDerivedStateFromProps,fe=typeof he=="function"||typeof T.getSnapshotBeforeUpdate=="function";fe||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(A!==g||U!==Z)&&Qg(o,T,g,Z),_n=!1;var ce=o.memoizedState;T.state=ce,rc(o,g,T,_),U=o.memoizedState,A!==g||ce!==U||_s.current||_n?(typeof he=="function"&&(nh(o,u,he,g),U=o.memoizedState),(A=_n||Kg(o,u,A,g,ce,U,Z))?(fe||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(o.flags|=4194308)):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=g,o.memoizedState=U),T.props=g,T.state=U,T.context=Z,g=A):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),g=!1)}else{T=o.stateNode,Ng(i,o),A=o.memoizedProps,Z=o.type===o.elementType?A:Zs(o.type,A),T.props=Z,fe=o.pendingProps,ce=T.context,U=u.contextType,typeof U=="object"&&U!==null?U=zs(U):(U=bs(u)?ri:as.current,U=Yi(o,U));var Ee=u.getDerivedStateFromProps;(he=typeof Ee=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(A!==fe||ce!==U)&&Qg(o,T,g,U),_n=!1,ce=o.memoizedState,T.state=ce,rc(o,g,T,_);var Oe=o.memoizedState;A!==fe||ce!==Oe||_s.current||_n?(typeof Ee=="function"&&(nh(o,u,Ee,g),Oe=o.memoizedState),(Z=_n||Kg(o,u,Z,g,ce,Oe,U)||!1)?(he||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(g,Oe,U),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(g,Oe,U)),typeof T.componentDidUpdate=="function"&&(o.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof T.componentDidUpdate!="function"||A===i.memoizedProps&&ce===i.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&ce===i.memoizedState||(o.flags|=1024),o.memoizedProps=g,o.memoizedState=Oe),T.props=g,T.state=Oe,T.context=U,g=Z):(typeof T.componentDidUpdate!="function"||A===i.memoizedProps&&ce===i.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&ce===i.memoizedState||(o.flags|=1024),g=!1)}return ch(i,o,u,g,N,_)}function ch(i,o,u,g,_,N){ox(i,o);var T=(o.flags&128)!==0;if(!g&&!T)return _&&mg(o,u,!1),Vr(i,o,N);g=o.stateNode,uS.current=o;var A=T&&typeof u.getDerivedStateFromError!="function"?null:g.render();return o.flags|=1,i!==null&&T?(o.child=Ji(o,i.child,null,N),o.child=Ji(o,null,A,N)):ms(i,o,A,N),o.memoizedState=g.state,_&&mg(o,u,!0),o.child}function cx(i){var o=i.stateNode;o.pendingContext?ug(i,o.pendingContext,o.pendingContext!==o.context):o.context&&ug(i,o.context,!1),Vu(i,o.containerInfo)}function dx(i,o,u,g,_){return Qi(),Fu(_),o.flags|=256,ms(i,o,u,g),o.child}var dh={dehydrated:null,treeContext:null,retryLane:0};function uh(i){return{baseLanes:i,cachePool:null,transitions:null}}function ux(i,o,u){var g=o.pendingProps,_=$t.current,N=!1,T=(o.flags&128)!==0,A;if((A=T)||(A=i!==null&&i.memoizedState===null?!1:(_&2)!==0),A?(N=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(_|=1),Et($t,_&1),i===null)return Mu(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(T=g.children,i=g.fallback,N?(g=o.mode,N=o.child,T={mode:"hidden",children:T},(g&1)===0&&N!==null?(N.childLanes=0,N.pendingProps=T):N=Nc(T,g,0,null),i=mi(i,g,u,null),N.return=o,i.return=o,N.sibling=i,o.child=N,o.child.memoizedState=uh(u),o.memoizedState=dh,i):hh(o,T));if(_=i.memoizedState,_!==null&&(A=_.dehydrated,A!==null))return hS(i,o,T,g,A,_,u);if(N){N=g.fallback,T=o.mode,_=i.child,A=_.sibling;var U={mode:"hidden",children:g.children};return(T&1)===0&&o.child!==_?(g=o.child,g.childLanes=0,g.pendingProps=U,o.deletions=null):(g=kn(_,U),g.subtreeFlags=_.subtreeFlags&14680064),A!==null?N=kn(A,N):(N=mi(N,T,u,null),N.flags|=2),N.return=o,g.return=o,g.sibling=N,o.child=g,g=N,N=o.child,T=i.child.memoizedState,T=T===null?uh(u):{baseLanes:T.baseLanes|u,cachePool:null,transitions:T.transitions},N.memoizedState=T,N.childLanes=i.childLanes&~u,o.memoizedState=dh,g}return N=i.child,i=N.sibling,g=kn(N,{mode:"visible",children:g.children}),(o.mode&1)===0&&(g.lanes=u),g.return=o,g.sibling=null,i!==null&&(u=o.deletions,u===null?(o.deletions=[i],o.flags|=16):u.push(i)),o.child=g,o.memoizedState=null,g}function hh(i,o){return o=Nc({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function uc(i,o,u,g){return g!==null&&Fu(g),Ji(o,i.child,null,u),i=hh(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function hS(i,o,u,g,_,N,T){if(u)return o.flags&256?(o.flags&=-257,g=ah(Error(r(422))),uc(i,o,T,g)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(N=g.fallback,_=o.mode,g=Nc({mode:"visible",children:g.children},_,0,null),N=mi(N,_,T,null),N.flags|=2,g.return=o,N.return=o,g.sibling=N,o.child=g,(o.mode&1)!==0&&Ji(o,i.child,null,T),o.child.memoizedState=uh(T),o.memoizedState=dh,N);if((o.mode&1)===0)return uc(i,o,T,null);if(_.data==="$!"){if(g=_.nextSibling&&_.nextSibling.dataset,g)var A=g.dgst;return g=A,N=Error(r(419)),g=ah(N,g,void 0),uc(i,o,T,g)}if(A=(T&i.childLanes)!==0,Ns||A){if(g=Zt,g!==null){switch(T&-T){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(g.suspendedLanes|T))!==0?0:_,_!==0&&_!==N.retryLane&&(N.retryLane=_,qr(i,_),sr(g,i,_,-1))}return Th(),g=ah(Error(r(421))),uc(i,o,T,g)}return _.data==="$?"?(o.flags|=128,o.child=i.child,o=SS.bind(null,i),_._reactRetry=o,null):(i=N.treeContext,Ps=vn(_.nextSibling),Rs=o,Pt=!0,Js=null,i!==null&&(Fs[Us++]=Wr,Fs[Us++]=Br,Fs[Us++]=ni,Wr=i.id,Br=i.overflow,ni=o),o=hh(o,g.children),o.flags|=4096,o)}function hx(i,o,u){i.lanes|=o;var g=i.alternate;g!==null&&(g.lanes|=o),Bu(i.return,o,u)}function mh(i,o,u,g,_){var N=i.memoizedState;N===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:g,tail:u,tailMode:_}:(N.isBackwards=o,N.rendering=null,N.renderingStartTime=0,N.last=g,N.tail=u,N.tailMode=_)}function mx(i,o,u){var g=o.pendingProps,_=g.revealOrder,N=g.tail;if(ms(i,o,g.children,u),g=$t.current,(g&2)!==0)g=g&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&hx(i,u,o);else if(i.tag===19)hx(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}g&=1}if(Et($t,g),(o.mode&1)===0)o.memoizedState=null;else switch(_){case"forwards":for(u=o.child,_=null;u!==null;)i=u.alternate,i!==null&&nc(i)===null&&(_=u),u=u.sibling;u=_,u===null?(_=o.child,o.child=null):(_=u.sibling,u.sibling=null),mh(o,!1,_,u,N);break;case"backwards":for(u=null,_=o.child,o.child=null;_!==null;){if(i=_.alternate,i!==null&&nc(i)===null){o.child=_;break}i=_.sibling,_.sibling=u,u=_,_=i}mh(o,!0,u,null,N);break;case"together":mh(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function hc(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Vr(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),ci|=o.lanes,(u&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(r(153));if(o.child!==null){for(i=o.child,u=kn(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=kn(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function mS(i,o,u){switch(o.tag){case 3:cx(o),Qi();break;case 5:Cg(o);break;case 1:bs(o.type)&&Yl(o);break;case 4:Vu(o,o.stateNode.containerInfo);break;case 10:var g=o.type._context,_=o.memoizedProps.value;Et(ec,g._currentValue),g._currentValue=_;break;case 13:if(g=o.memoizedState,g!==null)return g.dehydrated!==null?(Et($t,$t.current&1),o.flags|=128,null):(u&o.child.childLanes)!==0?ux(i,o,u):(Et($t,$t.current&1),i=Vr(i,o,u),i!==null?i.sibling:null);Et($t,$t.current&1);break;case 19:if(g=(u&o.childLanes)!==0,(i.flags&128)!==0){if(g)return mx(i,o,u);o.flags|=128}if(_=o.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),Et($t,$t.current),g)break;return null;case 22:case 23:return o.lanes=0,ax(i,o,u)}return Vr(i,o,u)}var fx,fh,px,gx;fx=function(i,o){for(var u=o.child;u!==null;){if(u.tag===5||u.tag===6)i.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},fh=function(){},px=function(i,o,u,g){var _=i.memoizedProps;if(_!==g){i=o.stateNode,oi(vr.current);var N=null;switch(u){case"input":_=J(i,_),g=J(i,g),N=[];break;case"select":_=oe({},_,{value:void 0}),g=oe({},g,{value:void 0}),N=[];break;case"textarea":_=me(i,_),g=me(i,g),N=[];break;default:typeof _.onClick!="function"&&typeof g.onClick=="function"&&(i.onclick=Hl)}mr(u,g);var T;u=null;for(Z in _)if(!g.hasOwnProperty(Z)&&_.hasOwnProperty(Z)&&_[Z]!=null)if(Z==="style"){var A=_[Z];for(T in A)A.hasOwnProperty(T)&&(u||(u={}),u[T]="")}else Z!=="dangerouslySetInnerHTML"&&Z!=="children"&&Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&Z!=="autoFocus"&&(a.hasOwnProperty(Z)?N||(N=[]):(N=N||[]).push(Z,null));for(Z in g){var U=g[Z];if(A=_?.[Z],g.hasOwnProperty(Z)&&U!==A&&(U!=null||A!=null))if(Z==="style")if(A){for(T in A)!A.hasOwnProperty(T)||U&&U.hasOwnProperty(T)||(u||(u={}),u[T]="");for(T in U)U.hasOwnProperty(T)&&A[T]!==U[T]&&(u||(u={}),u[T]=U[T])}else u||(N||(N=[]),N.push(Z,u)),u=U;else Z==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,A=A?A.__html:void 0,U!=null&&A!==U&&(N=N||[]).push(Z,U)):Z==="children"?typeof U!="string"&&typeof U!="number"||(N=N||[]).push(Z,""+U):Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&(a.hasOwnProperty(Z)?(U!=null&&Z==="onScroll"&&Tt("scroll",i),N||A===U||(N=[])):(N=N||[]).push(Z,U))}u&&(N=N||[]).push("style",u);var Z=N;(o.updateQueue=Z)&&(o.flags|=4)}},gx=function(i,o,u,g){u!==g&&(o.flags|=4)};function To(i,o){if(!Pt)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:g.sibling=null}}function ls(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,g=0;if(o)for(var _=i.child;_!==null;)u|=_.lanes|_.childLanes,g|=_.subtreeFlags&14680064,g|=_.flags&14680064,_.return=i,_=_.sibling;else for(_=i.child;_!==null;)u|=_.lanes|_.childLanes,g|=_.subtreeFlags,g|=_.flags,_.return=i,_=_.sibling;return i.subtreeFlags|=g,i.childLanes=u,o}function fS(i,o,u){var g=o.pendingProps;switch($u(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ls(o),null;case 1:return bs(o.type)&&Gl(),ls(o),null;case 3:return g=o.stateNode,ta(),kt(_s),kt(as),Ku(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(i===null||i.child===null)&&(Jl(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Js!==null&&(Sh(Js),Js=null))),fh(i,o),ls(o),null;case 5:Gu(o);var _=oi(bo.current);if(u=o.type,i!==null&&o.stateNode!=null)px(i,o,u,g,_),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!g){if(o.stateNode===null)throw Error(r(166));return ls(o),null}if(i=oi(vr.current),Jl(o)){g=o.stateNode,u=o.type;var N=o.memoizedProps;switch(g[xr]=o,g[vo]=N,i=(o.mode&1)!==0,u){case"dialog":Tt("cancel",g),Tt("close",g);break;case"iframe":case"object":case"embed":Tt("load",g);break;case"video":case"audio":for(_=0;_<po.length;_++)Tt(po[_],g);break;case"source":Tt("error",g);break;case"img":case"image":case"link":Tt("error",g),Tt("load",g);break;case"details":Tt("toggle",g);break;case"input":ue(g,N),Tt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!N.multiple},Tt("invalid",g);break;case"textarea":$e(g,N),Tt("invalid",g)}mr(u,N),_=null;for(var T in N)if(N.hasOwnProperty(T)){var A=N[T];T==="children"?typeof A=="string"?g.textContent!==A&&(N.suppressHydrationWarning!==!0&&ql(g.textContent,A,i),_=["children",A]):typeof A=="number"&&g.textContent!==""+A&&(N.suppressHydrationWarning!==!0&&ql(g.textContent,A,i),_=["children",""+A]):a.hasOwnProperty(T)&&A!=null&&T==="onScroll"&&Tt("scroll",g)}switch(u){case"input":tt(g),je(g,N,!0);break;case"textarea":tt(g),Ge(g);break;case"select":case"option":break;default:typeof N.onClick=="function"&&(g.onclick=Hl)}g=_,o.updateQueue=g,g!==null&&(o.flags|=4)}else{T=_.nodeType===9?_:_.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=ae(u)),i==="http://www.w3.org/1999/xhtml"?u==="script"?(i=T.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof g.is=="string"?i=T.createElement(u,{is:g.is}):(i=T.createElement(u),u==="select"&&(T=i,g.multiple?T.multiple=!0:g.size&&(T.size=g.size))):i=T.createElementNS(i,u),i[xr]=o,i[vo]=g,fx(i,o,!1,!1),o.stateNode=i;e:{switch(T=Qa(u,g),u){case"dialog":Tt("cancel",i),Tt("close",i),_=g;break;case"iframe":case"object":case"embed":Tt("load",i),_=g;break;case"video":case"audio":for(_=0;_<po.length;_++)Tt(po[_],i);_=g;break;case"source":Tt("error",i),_=g;break;case"img":case"image":case"link":Tt("error",i),Tt("load",i),_=g;break;case"details":Tt("toggle",i),_=g;break;case"input":ue(i,g),_=J(i,g),Tt("invalid",i);break;case"option":_=g;break;case"select":i._wrapperState={wasMultiple:!!g.multiple},_=oe({},g,{value:void 0}),Tt("invalid",i);break;case"textarea":$e(i,g),_=me(i,g),Tt("invalid",i);break;default:_=g}mr(u,_),A=_;for(N in A)if(A.hasOwnProperty(N)){var U=A[N];N==="style"?Fr(i,U):N==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,U!=null&&xt(i,U)):N==="children"?typeof U=="string"?(u!=="textarea"||U!=="")&&We(i,U):typeof U=="number"&&We(i,""+U):N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&N!=="autoFocus"&&(a.hasOwnProperty(N)?U!=null&&N==="onScroll"&&Tt("scroll",i):U!=null&&S(i,N,U,T))}switch(u){case"input":tt(i),je(i,g,!1);break;case"textarea":tt(i),Ge(i);break;case"option":g.value!=null&&i.setAttribute("value",""+Ne(g.value));break;case"select":i.multiple=!!g.multiple,N=g.value,N!=null?z(i,!!g.multiple,N,!1):g.defaultValue!=null&&z(i,!!g.multiple,g.defaultValue,!0);break;default:typeof _.onClick=="function"&&(i.onclick=Hl)}switch(u){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return ls(o),null;case 6:if(i&&o.stateNode!=null)gx(i,o,i.memoizedProps,g);else{if(typeof g!="string"&&o.stateNode===null)throw Error(r(166));if(u=oi(bo.current),oi(vr.current),Jl(o)){if(g=o.stateNode,u=o.memoizedProps,g[xr]=o,(N=g.nodeValue!==u)&&(i=Rs,i!==null))switch(i.tag){case 3:ql(g.nodeValue,u,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&ql(g.nodeValue,u,(i.mode&1)!==0)}N&&(o.flags|=4)}else g=(u.nodeType===9?u:u.ownerDocument).createTextNode(g),g[xr]=o,o.stateNode=g}return ls(o),null;case 13:if(kt($t),g=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Pt&&Ps!==null&&(o.mode&1)!==0&&(o.flags&128)===0)yg(),Qi(),o.flags|=98560,N=!1;else if(N=Jl(o),g!==null&&g.dehydrated!==null){if(i===null){if(!N)throw Error(r(318));if(N=o.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[xr]=o}else Qi(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ls(o),N=!1}else Js!==null&&(Sh(Js),Js=null),N=!0;if(!N)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=u,o):(g=g!==null,g!==(i!==null&&i.memoizedState!==null)&&g&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||($t.current&1)!==0?Gt===0&&(Gt=3):Th())),o.updateQueue!==null&&(o.flags|=4),ls(o),null);case 4:return ta(),fh(i,o),i===null&&go(o.stateNode.containerInfo),ls(o),null;case 10:return Wu(o.type._context),ls(o),null;case 17:return bs(o.type)&&Gl(),ls(o),null;case 19:if(kt($t),N=o.memoizedState,N===null)return ls(o),null;if(g=(o.flags&128)!==0,T=N.rendering,T===null)if(g)To(N,!1);else{if(Gt!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(T=nc(i),T!==null){for(o.flags|=128,To(N,!1),g=T.updateQueue,g!==null&&(o.updateQueue=g,o.flags|=4),o.subtreeFlags=0,g=u,u=o.child;u!==null;)N=u,i=g,N.flags&=14680066,T=N.alternate,T===null?(N.childLanes=0,N.lanes=i,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=T.childLanes,N.lanes=T.lanes,N.child=T.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=T.memoizedProps,N.memoizedState=T.memoizedState,N.updateQueue=T.updateQueue,N.type=T.type,i=T.dependencies,N.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),u=u.sibling;return Et($t,$t.current&1|2),o.child}i=i.sibling}N.tail!==null&&zt()>ia&&(o.flags|=128,g=!0,To(N,!1),o.lanes=4194304)}else{if(!g)if(i=nc(T),i!==null){if(o.flags|=128,g=!0,u=i.updateQueue,u!==null&&(o.updateQueue=u,o.flags|=4),To(N,!0),N.tail===null&&N.tailMode==="hidden"&&!T.alternate&&!Pt)return ls(o),null}else 2*zt()-N.renderingStartTime>ia&&u!==1073741824&&(o.flags|=128,g=!0,To(N,!1),o.lanes=4194304);N.isBackwards?(T.sibling=o.child,o.child=T):(u=N.last,u!==null?u.sibling=T:o.child=T,N.last=T)}return N.tail!==null?(o=N.tail,N.rendering=o,N.tail=o.sibling,N.renderingStartTime=zt(),o.sibling=null,u=$t.current,Et($t,g?u&1|2:u&1),o):(ls(o),null);case 22:case 23:return Ch(),g=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==g&&(o.flags|=8192),g&&(o.mode&1)!==0?(Is&1073741824)!==0&&(ls(o),o.subtreeFlags&6&&(o.flags|=8192)):ls(o),null;case 24:return null;case 25:return null}throw Error(r(156,o.tag))}function pS(i,o){switch($u(o),o.tag){case 1:return bs(o.type)&&Gl(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return ta(),kt(_s),kt(as),Ku(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return Gu(o),null;case 13:if(kt($t),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Qi()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return kt($t),null;case 4:return ta(),null;case 10:return Wu(o.type._context),null;case 22:case 23:return Ch(),null;case 24:return null;default:return null}}var mc=!1,cs=!1,gS=typeof WeakSet=="function"?WeakSet:Set,Te=null;function ra(i,o){var u=i.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(g){Ft(i,o,g)}else u.current=null}function ph(i,o,u){try{u()}catch(g){Ft(i,o,g)}}var xx=!1;function xS(i,o){if(Cu=Il,i=Kp(),yu(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var g=u.getSelection&&u.getSelection();if(g&&g.rangeCount!==0){u=g.anchorNode;var _=g.anchorOffset,N=g.focusNode;g=g.focusOffset;try{u.nodeType,N.nodeType}catch{u=null;break e}var T=0,A=-1,U=-1,Z=0,he=0,fe=i,ce=null;t:for(;;){for(var Ee;fe!==u||_!==0&&fe.nodeType!==3||(A=T+_),fe!==N||g!==0&&fe.nodeType!==3||(U=T+g),fe.nodeType===3&&(T+=fe.nodeValue.length),(Ee=fe.firstChild)!==null;)ce=fe,fe=Ee;for(;;){if(fe===i)break t;if(ce===u&&++Z===_&&(A=T),ce===N&&++he===g&&(U=T),(Ee=fe.nextSibling)!==null)break;fe=ce,ce=fe.parentNode}fe=Ee}u=A===-1||U===-1?null:{start:A,end:U}}else u=null}u=u||{start:0,end:0}}else u=null;for(Tu={focusedElem:i,selectionRange:u},Il=!1,Te=o;Te!==null;)if(o=Te,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,Te=i;else for(;Te!==null;){o=Te;try{var Oe=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Oe!==null){var Ae=Oe.memoizedProps,Wt=Oe.memoizedState,Y=o.stateNode,B=Y.getSnapshotBeforeUpdate(o.elementType===o.type?Ae:Zs(o.type,Ae),Wt);Y.__reactInternalSnapshotBeforeUpdate=B}break;case 3:var K=o.stateNode.containerInfo;K.nodeType===1?K.textContent="":K.nodeType===9&&K.documentElement&&K.removeChild(K.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(ve){Ft(o,o.return,ve)}if(i=o.sibling,i!==null){i.return=o.return,Te=i;break}Te=o.return}return Oe=xx,xx=!1,Oe}function ko(i,o,u){var g=o.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var _=g=g.next;do{if((_.tag&i)===i){var N=_.destroy;_.destroy=void 0,N!==void 0&&ph(o,u,N)}_=_.next}while(_!==g)}}function fc(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var u=o=o.next;do{if((u.tag&i)===i){var g=u.create;u.destroy=g()}u=u.next}while(u!==o)}}function gh(i){var o=i.ref;if(o!==null){var u=i.stateNode;switch(i.tag){case 5:i=u;break;default:i=u}typeof o=="function"?o(i):o.current=i}}function vx(i){var o=i.alternate;o!==null&&(i.alternate=null,vx(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[xr],delete o[vo],delete o[Pu],delete o[ZN],delete o[eS])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function yx(i){return i.tag===5||i.tag===3||i.tag===4}function jx(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||yx(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function xh(i,o,u){var g=i.tag;if(g===5||g===6)i=i.stateNode,o?u.nodeType===8?u.parentNode.insertBefore(i,o):u.insertBefore(i,o):(u.nodeType===8?(o=u.parentNode,o.insertBefore(i,u)):(o=u,o.appendChild(i)),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Hl));else if(g!==4&&(i=i.child,i!==null))for(xh(i,o,u),i=i.sibling;i!==null;)xh(i,o,u),i=i.sibling}function vh(i,o,u){var g=i.tag;if(g===5||g===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(g!==4&&(i=i.child,i!==null))for(vh(i,o,u),i=i.sibling;i!==null;)vh(i,o,u),i=i.sibling}var rs=null,er=!1;function Nn(i,o,u){for(u=u.child;u!==null;)wx(i,o,u),u=u.sibling}function wx(i,o,u){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(Cl,u)}catch{}switch(u.tag){case 5:cs||ra(u,o);case 6:var g=rs,_=er;rs=null,Nn(i,o,u),rs=g,er=_,rs!==null&&(er?(i=rs,u=u.stateNode,i.nodeType===8?i.parentNode.removeChild(u):i.removeChild(u)):rs.removeChild(u.stateNode));break;case 18:rs!==null&&(er?(i=rs,u=u.stateNode,i.nodeType===8?Ru(i.parentNode,u):i.nodeType===1&&Ru(i,u),ao(i)):Ru(rs,u.stateNode));break;case 4:g=rs,_=er,rs=u.stateNode.containerInfo,er=!0,Nn(i,o,u),rs=g,er=_;break;case 0:case 11:case 14:case 15:if(!cs&&(g=u.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){_=g=g.next;do{var N=_,T=N.destroy;N=N.tag,T!==void 0&&((N&2)!==0||(N&4)!==0)&&ph(u,o,T),_=_.next}while(_!==g)}Nn(i,o,u);break;case 1:if(!cs&&(ra(u,o),g=u.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=u.memoizedProps,g.state=u.memoizedState,g.componentWillUnmount()}catch(A){Ft(u,o,A)}Nn(i,o,u);break;case 21:Nn(i,o,u);break;case 22:u.mode&1?(cs=(g=cs)||u.memoizedState!==null,Nn(i,o,u),cs=g):Nn(i,o,u);break;default:Nn(i,o,u)}}function _x(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var u=i.stateNode;u===null&&(u=i.stateNode=new gS),o.forEach(function(g){var _=ES.bind(null,i,g);u.has(g)||(u.add(g),g.then(_,_))})}}function tr(i,o){var u=o.deletions;if(u!==null)for(var g=0;g<u.length;g++){var _=u[g];try{var N=i,T=o,A=T;e:for(;A!==null;){switch(A.tag){case 5:rs=A.stateNode,er=!1;break e;case 3:rs=A.stateNode.containerInfo,er=!0;break e;case 4:rs=A.stateNode.containerInfo,er=!0;break e}A=A.return}if(rs===null)throw Error(r(160));wx(N,T,_),rs=null,er=!1;var U=_.alternate;U!==null&&(U.return=null),_.return=null}catch(Z){Ft(_,o,Z)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)bx(o,i),o=o.sibling}function bx(i,o){var u=i.alternate,g=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(tr(o,i),jr(i),g&4){try{ko(3,i,i.return),fc(3,i)}catch(Ae){Ft(i,i.return,Ae)}try{ko(5,i,i.return)}catch(Ae){Ft(i,i.return,Ae)}}break;case 1:tr(o,i),jr(i),g&512&&u!==null&&ra(u,u.return);break;case 5:if(tr(o,i),jr(i),g&512&&u!==null&&ra(u,u.return),i.flags&32){var _=i.stateNode;try{We(_,"")}catch(Ae){Ft(i,i.return,Ae)}}if(g&4&&(_=i.stateNode,_!=null)){var N=i.memoizedProps,T=u!==null?u.memoizedProps:N,A=i.type,U=i.updateQueue;if(i.updateQueue=null,U!==null)try{A==="input"&&N.type==="radio"&&N.name!=null&&be(_,N),Qa(A,T);var Z=Qa(A,N);for(T=0;T<U.length;T+=2){var he=U[T],fe=U[T+1];he==="style"?Fr(_,fe):he==="dangerouslySetInnerHTML"?xt(_,fe):he==="children"?We(_,fe):S(_,he,fe,Z)}switch(A){case"input":Ce(_,N);break;case"textarea":Re(_,N);break;case"select":var ce=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!N.multiple;var Ee=N.value;Ee!=null?z(_,!!N.multiple,Ee,!1):ce!==!!N.multiple&&(N.defaultValue!=null?z(_,!!N.multiple,N.defaultValue,!0):z(_,!!N.multiple,N.multiple?[]:"",!1))}_[vo]=N}catch(Ae){Ft(i,i.return,Ae)}}break;case 6:if(tr(o,i),jr(i),g&4){if(i.stateNode===null)throw Error(r(162));_=i.stateNode,N=i.memoizedProps;try{_.nodeValue=N}catch(Ae){Ft(i,i.return,Ae)}}break;case 3:if(tr(o,i),jr(i),g&4&&u!==null&&u.memoizedState.isDehydrated)try{ao(o.containerInfo)}catch(Ae){Ft(i,i.return,Ae)}break;case 4:tr(o,i),jr(i);break;case 13:tr(o,i),jr(i),_=i.child,_.flags&8192&&(N=_.memoizedState!==null,_.stateNode.isHidden=N,!N||_.alternate!==null&&_.alternate.memoizedState!==null||(wh=zt())),g&4&&_x(i);break;case 22:if(he=u!==null&&u.memoizedState!==null,i.mode&1?(cs=(Z=cs)||he,tr(o,i),cs=Z):tr(o,i),jr(i),g&8192){if(Z=i.memoizedState!==null,(i.stateNode.isHidden=Z)&&!he&&(i.mode&1)!==0)for(Te=i,he=i.child;he!==null;){for(fe=Te=he;Te!==null;){switch(ce=Te,Ee=ce.child,ce.tag){case 0:case 11:case 14:case 15:ko(4,ce,ce.return);break;case 1:ra(ce,ce.return);var Oe=ce.stateNode;if(typeof Oe.componentWillUnmount=="function"){g=ce,u=ce.return;try{o=g,Oe.props=o.memoizedProps,Oe.state=o.memoizedState,Oe.componentWillUnmount()}catch(Ae){Ft(g,u,Ae)}}break;case 5:ra(ce,ce.return);break;case 22:if(ce.memoizedState!==null){Ex(fe);continue}}Ee!==null?(Ee.return=ce,Te=Ee):Ex(fe)}he=he.sibling}e:for(he=null,fe=i;;){if(fe.tag===5){if(he===null){he=fe;try{_=fe.stateNode,Z?(N=_.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none"):(A=fe.stateNode,U=fe.memoizedProps.style,T=U!=null&&U.hasOwnProperty("display")?U.display:null,A.style.display=$i("display",T))}catch(Ae){Ft(i,i.return,Ae)}}}else if(fe.tag===6){if(he===null)try{fe.stateNode.nodeValue=Z?"":fe.memoizedProps}catch(Ae){Ft(i,i.return,Ae)}}else if((fe.tag!==22&&fe.tag!==23||fe.memoizedState===null||fe===i)&&fe.child!==null){fe.child.return=fe,fe=fe.child;continue}if(fe===i)break e;for(;fe.sibling===null;){if(fe.return===null||fe.return===i)break e;he===fe&&(he=null),fe=fe.return}he===fe&&(he=null),fe.sibling.return=fe.return,fe=fe.sibling}}break;case 19:tr(o,i),jr(i),g&4&&_x(i);break;case 21:break;default:tr(o,i),jr(i)}}function jr(i){var o=i.flags;if(o&2){try{e:{for(var u=i.return;u!==null;){if(yx(u)){var g=u;break e}u=u.return}throw Error(r(160))}switch(g.tag){case 5:var _=g.stateNode;g.flags&32&&(We(_,""),g.flags&=-33);var N=jx(i);vh(i,N,_);break;case 3:case 4:var T=g.stateNode.containerInfo,A=jx(i);xh(i,A,T);break;default:throw Error(r(161))}}catch(U){Ft(i,i.return,U)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function vS(i,o,u){Te=i,Nx(i)}function Nx(i,o,u){for(var g=(i.mode&1)!==0;Te!==null;){var _=Te,N=_.child;if(_.tag===22&&g){var T=_.memoizedState!==null||mc;if(!T){var A=_.alternate,U=A!==null&&A.memoizedState!==null||cs;A=mc;var Z=cs;if(mc=T,(cs=U)&&!Z)for(Te=_;Te!==null;)T=Te,U=T.child,T.tag===22&&T.memoizedState!==null?Cx(_):U!==null?(U.return=T,Te=U):Cx(_);for(;N!==null;)Te=N,Nx(N),N=N.sibling;Te=_,mc=A,cs=Z}Sx(i)}else(_.subtreeFlags&8772)!==0&&N!==null?(N.return=_,Te=N):Sx(i)}}function Sx(i){for(;Te!==null;){var o=Te;if((o.flags&8772)!==0){var u=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:cs||fc(5,o);break;case 1:var g=o.stateNode;if(o.flags&4&&!cs)if(u===null)g.componentDidMount();else{var _=o.elementType===o.type?u.memoizedProps:Zs(o.type,u.memoizedProps);g.componentDidUpdate(_,u.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var N=o.updateQueue;N!==null&&Eg(o,N,g);break;case 3:var T=o.updateQueue;if(T!==null){if(u=null,o.child!==null)switch(o.child.tag){case 5:u=o.child.stateNode;break;case 1:u=o.child.stateNode}Eg(o,T,u)}break;case 5:var A=o.stateNode;if(u===null&&o.flags&4){u=A;var U=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":U.autoFocus&&u.focus();break;case"img":U.src&&(u.src=U.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Z=o.alternate;if(Z!==null){var he=Z.memoizedState;if(he!==null){var fe=he.dehydrated;fe!==null&&ao(fe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}cs||o.flags&512&&gh(o)}catch(ce){Ft(o,o.return,ce)}}if(o===i){Te=null;break}if(u=o.sibling,u!==null){u.return=o.return,Te=u;break}Te=o.return}}function Ex(i){for(;Te!==null;){var o=Te;if(o===i){Te=null;break}var u=o.sibling;if(u!==null){u.return=o.return,Te=u;break}Te=o.return}}function Cx(i){for(;Te!==null;){var o=Te;try{switch(o.tag){case 0:case 11:case 15:var u=o.return;try{fc(4,o)}catch(U){Ft(o,u,U)}break;case 1:var g=o.stateNode;if(typeof g.componentDidMount=="function"){var _=o.return;try{g.componentDidMount()}catch(U){Ft(o,_,U)}}var N=o.return;try{gh(o)}catch(U){Ft(o,N,U)}break;case 5:var T=o.return;try{gh(o)}catch(U){Ft(o,T,U)}}}catch(U){Ft(o,o.return,U)}if(o===i){Te=null;break}var A=o.sibling;if(A!==null){A.return=o.return,Te=A;break}Te=o.return}}var yS=Math.ceil,pc=O.ReactCurrentDispatcher,yh=O.ReactCurrentOwner,Bs=O.ReactCurrentBatchConfig,vt=0,Zt=null,qt=null,ns=0,Is=0,na=yn(0),Gt=0,Oo=null,ci=0,gc=0,jh=0,Ro=null,Ss=null,wh=0,ia=1/0,Gr=null,xc=!1,_h=null,Sn=null,vc=!1,En=null,yc=0,Po=0,bh=null,jc=-1,wc=0;function fs(){return(vt&6)!==0?zt():jc!==-1?jc:jc=zt()}function Cn(i){return(i.mode&1)===0?1:(vt&2)!==0&&ns!==0?ns&-ns:sS.transition!==null?(wc===0&&(wc=jp()),wc):(i=wt,i!==0||(i=window.event,i=i===void 0?16:kp(i.type)),i)}function sr(i,o,u,g){if(50<Po)throw Po=0,bh=null,Error(r(185));to(i,u,g),((vt&2)===0||i!==Zt)&&(i===Zt&&((vt&2)===0&&(gc|=u),Gt===4&&Tn(i,ns)),Es(i,g),u===1&&vt===0&&(o.mode&1)===0&&(ia=zt()+500,Kl&&wn()))}function Es(i,o){var u=i.callbackNode;sN(i,o);var g=Ol(i,i===Zt?ns:0);if(g===0)u!==null&&xp(u),i.callbackNode=null,i.callbackPriority=0;else if(o=g&-g,i.callbackPriority!==o){if(u!=null&&xp(u),o===1)i.tag===0?tS(kx.bind(null,i)):fg(kx.bind(null,i)),QN(function(){(vt&6)===0&&wn()}),u=null;else{switch(wp(g)){case 1:u=su;break;case 4:u=vp;break;case 16:u=El;break;case 536870912:u=yp;break;default:u=El}u=Lx(u,Tx.bind(null,i))}i.callbackPriority=o,i.callbackNode=u}}function Tx(i,o){if(jc=-1,wc=0,(vt&6)!==0)throw Error(r(327));var u=i.callbackNode;if(aa()&&i.callbackNode!==u)return null;var g=Ol(i,i===Zt?ns:0);if(g===0)return null;if((g&30)!==0||(g&i.expiredLanes)!==0||o)o=_c(i,g);else{o=g;var _=vt;vt|=2;var N=Rx();(Zt!==i||ns!==o)&&(Gr=null,ia=zt()+500,ui(i,o));do try{_S();break}catch(A){Ox(i,A)}while(!0);zu(),pc.current=N,vt=_,qt!==null?o=0:(Zt=null,ns=0,o=Gt)}if(o!==0){if(o===2&&(_=ru(i),_!==0&&(g=_,o=Nh(i,_))),o===1)throw u=Oo,ui(i,0),Tn(i,g),Es(i,zt()),u;if(o===6)Tn(i,g);else{if(_=i.current.alternate,(g&30)===0&&!jS(_)&&(o=_c(i,g),o===2&&(N=ru(i),N!==0&&(g=N,o=Nh(i,N))),o===1))throw u=Oo,ui(i,0),Tn(i,g),Es(i,zt()),u;switch(i.finishedWork=_,i.finishedLanes=g,o){case 0:case 1:throw Error(r(345));case 2:hi(i,Ss,Gr);break;case 3:if(Tn(i,g),(g&130023424)===g&&(o=wh+500-zt(),10<o)){if(Ol(i,0)!==0)break;if(_=i.suspendedLanes,(_&g)!==g){fs(),i.pingedLanes|=i.suspendedLanes&_;break}i.timeoutHandle=Ou(hi.bind(null,i,Ss,Gr),o);break}hi(i,Ss,Gr);break;case 4:if(Tn(i,g),(g&4194240)===g)break;for(o=i.eventTimes,_=-1;0<g;){var T=31-Xs(g);N=1<<T,T=o[T],T>_&&(_=T),g&=~N}if(g=_,g=zt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*yS(g/1960))-g,10<g){i.timeoutHandle=Ou(hi.bind(null,i,Ss,Gr),g);break}hi(i,Ss,Gr);break;case 5:hi(i,Ss,Gr);break;default:throw Error(r(329))}}}return Es(i,zt()),i.callbackNode===u?Tx.bind(null,i):null}function Nh(i,o){var u=Ro;return i.current.memoizedState.isDehydrated&&(ui(i,o).flags|=256),i=_c(i,o),i!==2&&(o=Ss,Ss=u,o!==null&&Sh(o)),i}function Sh(i){Ss===null?Ss=i:Ss.push.apply(Ss,i)}function jS(i){for(var o=i;;){if(o.flags&16384){var u=o.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var g=0;g<u.length;g++){var _=u[g],N=_.getSnapshot;_=_.value;try{if(!Qs(N(),_))return!1}catch{return!1}}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Tn(i,o){for(o&=~jh,o&=~gc,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var u=31-Xs(o),g=1<<u;i[u]=-1,o&=~g}}function kx(i){if((vt&6)!==0)throw Error(r(327));aa();var o=Ol(i,0);if((o&1)===0)return Es(i,zt()),null;var u=_c(i,o);if(i.tag!==0&&u===2){var g=ru(i);g!==0&&(o=g,u=Nh(i,g))}if(u===1)throw u=Oo,ui(i,0),Tn(i,o),Es(i,zt()),u;if(u===6)throw Error(r(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,hi(i,Ss,Gr),Es(i,zt()),null}function Eh(i,o){var u=vt;vt|=1;try{return i(o)}finally{vt=u,vt===0&&(ia=zt()+500,Kl&&wn())}}function di(i){En!==null&&En.tag===0&&(vt&6)===0&&aa();var o=vt;vt|=1;var u=Bs.transition,g=wt;try{if(Bs.transition=null,wt=1,i)return i()}finally{wt=g,Bs.transition=u,vt=o,(vt&6)===0&&wn()}}function Ch(){Is=na.current,kt(na)}function ui(i,o){i.finishedWork=null,i.finishedLanes=0;var u=i.timeoutHandle;if(u!==-1&&(i.timeoutHandle=-1,XN(u)),qt!==null)for(u=qt.return;u!==null;){var g=u;switch($u(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Gl();break;case 3:ta(),kt(_s),kt(as),Ku();break;case 5:Gu(g);break;case 4:ta();break;case 13:kt($t);break;case 19:kt($t);break;case 10:Wu(g.type._context);break;case 22:case 23:Ch()}u=u.return}if(Zt=i,qt=i=kn(i.current,null),ns=Is=o,Gt=0,Oo=null,jh=gc=ci=0,Ss=Ro=null,ai!==null){for(o=0;o<ai.length;o++)if(u=ai[o],g=u.interleaved,g!==null){u.interleaved=null;var _=g.next,N=u.pending;if(N!==null){var T=N.next;N.next=_,g.next=T}u.pending=g}ai=null}return i}function Ox(i,o){do{var u=qt;try{if(zu(),ic.current=cc,ac){for(var g=Lt.memoizedState;g!==null;){var _=g.queue;_!==null&&(_.pending=null),g=g.next}ac=!1}if(li=0,Jt=Vt=Lt=null,No=!1,So=0,yh.current=null,u===null||u.return===null){Gt=1,Oo=o,qt=null;break}e:{var N=i,T=u.return,A=u,U=o;if(o=ns,A.flags|=32768,U!==null&&typeof U=="object"&&typeof U.then=="function"){var Z=U,he=A,fe=he.tag;if((he.mode&1)===0&&(fe===0||fe===11||fe===15)){var ce=he.alternate;ce?(he.updateQueue=ce.updateQueue,he.memoizedState=ce.memoizedState,he.lanes=ce.lanes):(he.updateQueue=null,he.memoizedState=null)}var Ee=tx(T);if(Ee!==null){Ee.flags&=-257,sx(Ee,T,A,N,o),Ee.mode&1&&ex(N,Z,o),o=Ee,U=Z;var Oe=o.updateQueue;if(Oe===null){var Ae=new Set;Ae.add(U),o.updateQueue=Ae}else Oe.add(U);break e}else{if((o&1)===0){ex(N,Z,o),Th();break e}U=Error(r(426))}}else if(Pt&&A.mode&1){var Wt=tx(T);if(Wt!==null){(Wt.flags&65536)===0&&(Wt.flags|=256),sx(Wt,T,A,N,o),Fu(sa(U,A));break e}}N=U=sa(U,A),Gt!==4&&(Gt=2),Ro===null?Ro=[N]:Ro.push(N),N=T;do{switch(N.tag){case 3:N.flags|=65536,o&=-o,N.lanes|=o;var Y=Jg(N,U,o);Sg(N,Y);break e;case 1:A=U;var B=N.type,K=N.stateNode;if((N.flags&128)===0&&(typeof B.getDerivedStateFromError=="function"||K!==null&&typeof K.componentDidCatch=="function"&&(Sn===null||!Sn.has(K)))){N.flags|=65536,o&=-o,N.lanes|=o;var ve=Zg(N,A,o);Sg(N,ve);break e}}N=N.return}while(N!==null)}Ix(u)}catch(De){o=De,qt===u&&u!==null&&(qt=u=u.return);continue}break}while(!0)}function Rx(){var i=pc.current;return pc.current=cc,i===null?cc:i}function Th(){(Gt===0||Gt===3||Gt===2)&&(Gt=4),Zt===null||(ci&268435455)===0&&(gc&268435455)===0||Tn(Zt,ns)}function _c(i,o){var u=vt;vt|=2;var g=Rx();(Zt!==i||ns!==o)&&(Gr=null,ui(i,o));do try{wS();break}catch(_){Ox(i,_)}while(!0);if(zu(),vt=u,pc.current=g,qt!==null)throw Error(r(261));return Zt=null,ns=0,Gt}function wS(){for(;qt!==null;)Px(qt)}function _S(){for(;qt!==null&&!Gb();)Px(qt)}function Px(i){var o=$x(i.alternate,i,Is);i.memoizedProps=i.pendingProps,o===null?Ix(i):qt=o,yh.current=null}function Ix(i){var o=i;do{var u=o.alternate;if(i=o.return,(o.flags&32768)===0){if(u=fS(u,o,Is),u!==null){qt=u;return}}else{if(u=pS(u,o),u!==null){u.flags&=32767,qt=u;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Gt=6,qt=null;return}}if(o=o.sibling,o!==null){qt=o;return}qt=o=i}while(o!==null);Gt===0&&(Gt=5)}function hi(i,o,u){var g=wt,_=Bs.transition;try{Bs.transition=null,wt=1,bS(i,o,u,g)}finally{Bs.transition=_,wt=g}return null}function bS(i,o,u,g){do aa();while(En!==null);if((vt&6)!==0)throw Error(r(327));u=i.finishedWork;var _=i.finishedLanes;if(u===null)return null;if(i.finishedWork=null,i.finishedLanes=0,u===i.current)throw Error(r(177));i.callbackNode=null,i.callbackPriority=0;var N=u.lanes|u.childLanes;if(rN(i,N),i===Zt&&(qt=Zt=null,ns=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||vc||(vc=!0,Lx(El,function(){return aa(),null})),N=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||N){N=Bs.transition,Bs.transition=null;var T=wt;wt=1;var A=vt;vt|=4,yh.current=null,xS(i,u),bx(u,i),BN(Tu),Il=!!Cu,Tu=Cu=null,i.current=u,vS(u),Yb(),vt=A,wt=T,Bs.transition=N}else i.current=u;if(vc&&(vc=!1,En=i,yc=_),N=i.pendingLanes,N===0&&(Sn=null),Qb(u.stateNode),Es(i,zt()),o!==null)for(g=i.onRecoverableError,u=0;u<o.length;u++)_=o[u],g(_.value,{componentStack:_.stack,digest:_.digest});if(xc)throw xc=!1,i=_h,_h=null,i;return(yc&1)!==0&&i.tag!==0&&aa(),N=i.pendingLanes,(N&1)!==0?i===bh?Po++:(Po=0,bh=i):Po=0,wn(),null}function aa(){if(En!==null){var i=wp(yc),o=Bs.transition,u=wt;try{if(Bs.transition=null,wt=16>i?16:i,En===null)var g=!1;else{if(i=En,En=null,yc=0,(vt&6)!==0)throw Error(r(331));var _=vt;for(vt|=4,Te=i.current;Te!==null;){var N=Te,T=N.child;if((Te.flags&16)!==0){var A=N.deletions;if(A!==null){for(var U=0;U<A.length;U++){var Z=A[U];for(Te=Z;Te!==null;){var he=Te;switch(he.tag){case 0:case 11:case 15:ko(8,he,N)}var fe=he.child;if(fe!==null)fe.return=he,Te=fe;else for(;Te!==null;){he=Te;var ce=he.sibling,Ee=he.return;if(vx(he),he===Z){Te=null;break}if(ce!==null){ce.return=Ee,Te=ce;break}Te=Ee}}}var Oe=N.alternate;if(Oe!==null){var Ae=Oe.child;if(Ae!==null){Oe.child=null;do{var Wt=Ae.sibling;Ae.sibling=null,Ae=Wt}while(Ae!==null)}}Te=N}}if((N.subtreeFlags&2064)!==0&&T!==null)T.return=N,Te=T;else e:for(;Te!==null;){if(N=Te,(N.flags&2048)!==0)switch(N.tag){case 0:case 11:case 15:ko(9,N,N.return)}var Y=N.sibling;if(Y!==null){Y.return=N.return,Te=Y;break e}Te=N.return}}var B=i.current;for(Te=B;Te!==null;){T=Te;var K=T.child;if((T.subtreeFlags&2064)!==0&&K!==null)K.return=T,Te=K;else e:for(T=B;Te!==null;){if(A=Te,(A.flags&2048)!==0)try{switch(A.tag){case 0:case 11:case 15:fc(9,A)}}catch(De){Ft(A,A.return,De)}if(A===T){Te=null;break e}var ve=A.sibling;if(ve!==null){ve.return=A.return,Te=ve;break e}Te=A.return}}if(vt=_,wn(),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(Cl,i)}catch{}g=!0}return g}finally{wt=u,Bs.transition=o}}return!1}function Ax(i,o,u){o=sa(u,o),o=Jg(i,o,1),i=bn(i,o,1),o=fs(),i!==null&&(to(i,1,o),Es(i,o))}function Ft(i,o,u){if(i.tag===3)Ax(i,i,u);else for(;o!==null;){if(o.tag===3){Ax(o,i,u);break}else if(o.tag===1){var g=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Sn===null||!Sn.has(g))){i=sa(u,i),i=Zg(o,i,1),o=bn(o,i,1),i=fs(),o!==null&&(to(o,1,i),Es(o,i));break}}o=o.return}}function NS(i,o,u){var g=i.pingCache;g!==null&&g.delete(o),o=fs(),i.pingedLanes|=i.suspendedLanes&u,Zt===i&&(ns&u)===u&&(Gt===4||Gt===3&&(ns&130023424)===ns&&500>zt()-wh?ui(i,0):jh|=u),Es(i,o)}function Dx(i,o){o===0&&((i.mode&1)===0?o=1:(o=kl,kl<<=1,(kl&130023424)===0&&(kl=4194304)));var u=fs();i=qr(i,o),i!==null&&(to(i,o,u),Es(i,u))}function SS(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),Dx(i,u)}function ES(i,o){var u=0;switch(i.tag){case 13:var g=i.stateNode,_=i.memoizedState;_!==null&&(u=_.retryLane);break;case 19:g=i.stateNode;break;default:throw Error(r(314))}g!==null&&g.delete(o),Dx(i,u)}var $x;$x=function(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps||_s.current)Ns=!0;else{if((i.lanes&u)===0&&(o.flags&128)===0)return Ns=!1,mS(i,o,u);Ns=(i.flags&131072)!==0}else Ns=!1,Pt&&(o.flags&1048576)!==0&&pg(o,Ql,o.index);switch(o.lanes=0,o.tag){case 2:var g=o.type;hc(i,o),i=o.pendingProps;var _=Yi(o,as.current);ea(o,u),_=Ju(null,o,g,i,_,u);var N=Zu();return o.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,bs(g)?(N=!0,Yl(o)):N=!1,o.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Hu(o),_.updater=dc,o.stateNode=_,_._reactInternals=o,ih(o,g,i,u),o=ch(null,o,g,!0,N,u)):(o.tag=0,Pt&&N&&Du(o),ms(null,o,_,u),o=o.child),o;case 16:g=o.elementType;e:{switch(hc(i,o),i=o.pendingProps,_=g._init,g=_(g._payload),o.type=g,_=o.tag=TS(g),i=Zs(g,i),_){case 0:o=lh(null,o,g,i,u);break e;case 1:o=lx(null,o,g,i,u);break e;case 11:o=rx(null,o,g,i,u);break e;case 14:o=nx(null,o,g,Zs(g.type,i),u);break e}throw Error(r(306,g,""))}return o;case 0:return g=o.type,_=o.pendingProps,_=o.elementType===g?_:Zs(g,_),lh(i,o,g,_,u);case 1:return g=o.type,_=o.pendingProps,_=o.elementType===g?_:Zs(g,_),lx(i,o,g,_,u);case 3:e:{if(cx(o),i===null)throw Error(r(387));g=o.pendingProps,N=o.memoizedState,_=N.element,Ng(i,o),rc(o,g,null,u);var T=o.memoizedState;if(g=T.element,N.isDehydrated)if(N={element:g,isDehydrated:!1,cache:T.cache,pendingSuspenseBoundaries:T.pendingSuspenseBoundaries,transitions:T.transitions},o.updateQueue.baseState=N,o.memoizedState=N,o.flags&256){_=sa(Error(r(423)),o),o=dx(i,o,g,u,_);break e}else if(g!==_){_=sa(Error(r(424)),o),o=dx(i,o,g,u,_);break e}else for(Ps=vn(o.stateNode.containerInfo.firstChild),Rs=o,Pt=!0,Js=null,u=_g(o,null,g,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Qi(),g===_){o=Vr(i,o,u);break e}ms(i,o,g,u)}o=o.child}return o;case 5:return Cg(o),i===null&&Mu(o),g=o.type,_=o.pendingProps,N=i!==null?i.memoizedProps:null,T=_.children,ku(g,_)?T=null:N!==null&&ku(g,N)&&(o.flags|=32),ox(i,o),ms(i,o,T,u),o.child;case 6:return i===null&&Mu(o),null;case 13:return ux(i,o,u);case 4:return Vu(o,o.stateNode.containerInfo),g=o.pendingProps,i===null?o.child=Ji(o,null,g,u):ms(i,o,g,u),o.child;case 11:return g=o.type,_=o.pendingProps,_=o.elementType===g?_:Zs(g,_),rx(i,o,g,_,u);case 7:return ms(i,o,o.pendingProps,u),o.child;case 8:return ms(i,o,o.pendingProps.children,u),o.child;case 12:return ms(i,o,o.pendingProps.children,u),o.child;case 10:e:{if(g=o.type._context,_=o.pendingProps,N=o.memoizedProps,T=_.value,Et(ec,g._currentValue),g._currentValue=T,N!==null)if(Qs(N.value,T)){if(N.children===_.children&&!_s.current){o=Vr(i,o,u);break e}}else for(N=o.child,N!==null&&(N.return=o);N!==null;){var A=N.dependencies;if(A!==null){T=N.child;for(var U=A.firstContext;U!==null;){if(U.context===g){if(N.tag===1){U=Hr(-1,u&-u),U.tag=2;var Z=N.updateQueue;if(Z!==null){Z=Z.shared;var he=Z.pending;he===null?U.next=U:(U.next=he.next,he.next=U),Z.pending=U}}N.lanes|=u,U=N.alternate,U!==null&&(U.lanes|=u),Bu(N.return,u,o),A.lanes|=u;break}U=U.next}}else if(N.tag===10)T=N.type===o.type?null:N.child;else if(N.tag===18){if(T=N.return,T===null)throw Error(r(341));T.lanes|=u,A=T.alternate,A!==null&&(A.lanes|=u),Bu(T,u,o),T=N.sibling}else T=N.child;if(T!==null)T.return=N;else for(T=N;T!==null;){if(T===o){T=null;break}if(N=T.sibling,N!==null){N.return=T.return,T=N;break}T=T.return}N=T}ms(i,o,_.children,u),o=o.child}return o;case 9:return _=o.type,g=o.pendingProps.children,ea(o,u),_=zs(_),g=g(_),o.flags|=1,ms(i,o,g,u),o.child;case 14:return g=o.type,_=Zs(g,o.pendingProps),_=Zs(g.type,_),nx(i,o,g,_,u);case 15:return ix(i,o,o.type,o.pendingProps,u);case 17:return g=o.type,_=o.pendingProps,_=o.elementType===g?_:Zs(g,_),hc(i,o),o.tag=1,bs(g)?(i=!0,Yl(o)):i=!1,ea(o,u),Xg(o,g,_),ih(o,g,_,u),ch(null,o,g,!0,i,u);case 19:return mx(i,o,u);case 22:return ax(i,o,u)}throw Error(r(156,o.tag))};function Lx(i,o){return gp(i,o)}function CS(i,o,u,g){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qs(i,o,u,g){return new CS(i,o,u,g)}function kh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function TS(i){if(typeof i=="function")return kh(i)?1:0;if(i!=null){if(i=i.$$typeof,i===re)return 11;if(i===ge)return 14}return 2}function kn(i,o){var u=i.alternate;return u===null?(u=qs(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&14680064,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u}function bc(i,o,u,g,_,N){var T=2;if(g=i,typeof i=="function")kh(i)&&(T=1);else if(typeof i=="string")T=5;else e:switch(i){case P:return mi(u.children,_,N,o);case F:T=8,_|=8;break;case ee:return i=qs(12,u,o,_|2),i.elementType=ee,i.lanes=N,i;case H:return i=qs(13,u,o,_),i.elementType=H,i.lanes=N,i;case G:return i=qs(19,u,o,_),i.elementType=G,i.lanes=N,i;case xe:return Nc(u,_,N,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case ne:T=10;break e;case pe:T=9;break e;case re:T=11;break e;case ge:T=14;break e;case ie:T=16,g=null;break e}throw Error(r(130,i==null?i:typeof i,""))}return o=qs(T,u,o,_),o.elementType=i,o.type=g,o.lanes=N,o}function mi(i,o,u,g){return i=qs(7,i,g,o),i.lanes=u,i}function Nc(i,o,u,g){return i=qs(22,i,g,o),i.elementType=xe,i.lanes=u,i.stateNode={isHidden:!1},i}function Oh(i,o,u){return i=qs(6,i,null,o),i.lanes=u,i}function Rh(i,o,u){return o=qs(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function kS(i,o,u,g,_){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nu(0),this.expirationTimes=nu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nu(0),this.identifierPrefix=g,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Ph(i,o,u,g,_,N,T,A,U){return i=new kS(i,o,u,A,U),o===1?(o=1,N===!0&&(o|=8)):o=0,N=qs(3,null,null,o),i.current=N,N.stateNode=i,N.memoizedState={element:g,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hu(N),i}function OS(i,o,u){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:k,key:g==null?null:""+g,children:i,containerInfo:o,implementation:u}}function Mx(i){if(!i)return jn;i=i._reactInternals;e:{if(ti(i)!==i||i.tag!==1)throw Error(r(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(bs(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(r(171))}if(i.tag===1){var u=i.type;if(bs(u))return hg(i,u,o)}return o}function Fx(i,o,u,g,_,N,T,A,U){return i=Ph(u,g,!0,i,_,N,T,A,U),i.context=Mx(null),u=i.current,g=fs(),_=Cn(u),N=Hr(g,_),N.callback=o??null,bn(u,N,_),i.current.lanes=_,to(i,_,g),Es(i,g),i}function Sc(i,o,u,g){var _=o.current,N=fs(),T=Cn(_);return u=Mx(u),o.context===null?o.context=u:o.pendingContext=u,o=Hr(N,T),o.payload={element:i},g=g===void 0?null:g,g!==null&&(o.callback=g),i=bn(_,o,T),i!==null&&(sr(i,_,T,N),sc(i,_,T)),T}function Ec(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Ux(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function Ih(i,o){Ux(i,o),(i=i.alternate)&&Ux(i,o)}function RS(){return null}var zx=typeof reportError=="function"?reportError:function(i){console.error(i)};function Ah(i){this._internalRoot=i}Cc.prototype.render=Ah.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(r(409));Sc(i,o,null,null)},Cc.prototype.unmount=Ah.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;di(function(){Sc(null,i,null,null)}),o[Ur]=null}};function Cc(i){this._internalRoot=i}Cc.prototype.unstable_scheduleHydration=function(i){if(i){var o=Np();i={blockedOn:null,target:i,priority:o};for(var u=0;u<pn.length&&o!==0&&o<pn[u].priority;u++);pn.splice(u,0,i),u===0&&Cp(i)}};function Dh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Tc(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Wx(){}function PS(i,o,u,g,_){if(_){if(typeof g=="function"){var N=g;g=function(){var Z=Ec(T);N.call(Z)}}var T=Fx(o,g,i,0,null,!1,!1,"",Wx);return i._reactRootContainer=T,i[Ur]=T.current,go(i.nodeType===8?i.parentNode:i),di(),T}for(;_=i.lastChild;)i.removeChild(_);if(typeof g=="function"){var A=g;g=function(){var Z=Ec(U);A.call(Z)}}var U=Ph(i,0,!1,null,null,!1,!1,"",Wx);return i._reactRootContainer=U,i[Ur]=U.current,go(i.nodeType===8?i.parentNode:i),di(function(){Sc(o,U,u,g)}),U}function kc(i,o,u,g,_){var N=u._reactRootContainer;if(N){var T=N;if(typeof _=="function"){var A=_;_=function(){var U=Ec(T);A.call(U)}}Sc(o,T,i,_)}else T=PS(u,o,i,_,g);return Ec(T)}_p=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var u=eo(o.pendingLanes);u!==0&&(iu(o,u|1),Es(o,zt()),(vt&6)===0&&(ia=zt()+500,wn()))}break;case 13:di(function(){var g=qr(i,1);if(g!==null){var _=fs();sr(g,i,1,_)}}),Ih(i,1)}},au=function(i){if(i.tag===13){var o=qr(i,134217728);if(o!==null){var u=fs();sr(o,i,134217728,u)}Ih(i,134217728)}},bp=function(i){if(i.tag===13){var o=Cn(i),u=qr(i,o);if(u!==null){var g=fs();sr(u,i,o,g)}Ih(i,o)}},Np=function(){return wt},Sp=function(i,o){var u=wt;try{return wt=i,o()}finally{wt=u}},Mi=function(i,o,u){switch(o){case"input":if(Ce(i,u),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<u.length;o++){var g=u[o];if(g!==i&&g.form===i.form){var _=Vl(g);if(!_)throw Error(r(90));ut(g),Ce(g,_)}}}break;case"textarea":Re(i,u);break;case"select":o=u.value,o!=null&&z(i,!!u.multiple,o,!1)}},jt=Eh,bt=di;var IS={usingClientEntryPoint:!1,Events:[yo,Vi,Vl,bl,Qe,Eh]},Io={findFiberByHostInstance:si,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},AS={bundleType:Io.bundleType,version:Io.version,rendererPackageName:Io.rendererPackageName,rendererConfig:Io.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:O.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=fp(i),i===null?null:i.stateNode},findFiberByHostInstance:Io.findFiberByHostInstance||RS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oc.isDisabled&&Oc.supportsFiber)try{Cl=Oc.inject(AS),gr=Oc}catch{}}return Cs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IS,Cs.createPortal=function(i,o){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dh(o))throw Error(r(200));return OS(i,o,null,u)},Cs.createRoot=function(i,o){if(!Dh(i))throw Error(r(299));var u=!1,g="",_=zx;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onRecoverableError!==void 0&&(_=o.onRecoverableError)),o=Ph(i,1,!1,null,null,u,!1,g,_),i[Ur]=o.current,go(i.nodeType===8?i.parentNode:i),new Ah(o)},Cs.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=fp(o),i=i===null?null:i.stateNode,i},Cs.flushSync=function(i){return di(i)},Cs.hydrate=function(i,o,u){if(!Tc(o))throw Error(r(200));return kc(null,i,o,!0,u)},Cs.hydrateRoot=function(i,o,u){if(!Dh(i))throw Error(r(405));var g=u!=null&&u.hydratedSources||null,_=!1,N="",T=zx;if(u!=null&&(u.unstable_strictMode===!0&&(_=!0),u.identifierPrefix!==void 0&&(N=u.identifierPrefix),u.onRecoverableError!==void 0&&(T=u.onRecoverableError)),o=Fx(o,null,i,1,u??null,_,!1,N,T),i[Ur]=o.current,go(i),g)for(i=0;i<g.length;i++)u=g[i],_=u._getVersion,_=_(u._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[u,_]:o.mutableSourceEagerHydrationData.push(u,_);return new Cc(o)},Cs.render=function(i,o,u){if(!Tc(o))throw Error(r(200));return kc(null,i,o,!1,u)},Cs.unmountComponentAtNode=function(i){if(!Tc(i))throw Error(r(40));return i._reactRootContainer?(di(function(){kc(null,null,i,!1,function(){i._reactRootContainer=null,i[Ur]=null})}),!0):!1},Cs.unstable_batchedUpdates=Eh,Cs.unstable_renderSubtreeIntoContainer=function(i,o,u,g){if(!Tc(u))throw Error(r(200));if(i==null||i._reactInternals===void 0)throw Error(r(38));return kc(i,o,u,!1,g)},Cs.version="18.3.1-next-f1338f8080-20240426",Cs}var Xx;function By(){if(Xx)return Mh.exports;Xx=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),Mh.exports=BS(),Mh.exports}var Qx;function qS(){if(Qx)return Rc;Qx=1;var s=By();return Rc.createRoot=s.createRoot,Rc.hydrateRoot=s.hydrateRoot,Rc}var HS=qS(),x=nf();const ye=rf(x),af=$S({__proto__:null,default:ye},[x]),VS=1,GS=1e6;let zh=0;function YS(){return zh=(zh+1)%Number.MAX_SAFE_INTEGER,zh.toString()}const Wh=new Map,Jx=s=>{if(Wh.has(s))return;const t=setTimeout(()=>{Wh.delete(s),zo({type:"REMOVE_TOAST",toastId:s})},GS);Wh.set(s,t)},KS=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,VS)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?Jx(r):s.toasts.forEach(n=>{Jx(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(r=>r.id!==t.toastId)}}},Kc=[];let Xc={toasts:[]};function zo(s){Xc=KS(Xc,s),Kc.forEach(t=>{t(Xc)})}function XS({...s}){const t=YS(),r=a=>zo({type:"UPDATE_TOAST",toast:{...a,id:t}}),n=()=>zo({type:"DISMISS_TOAST",toastId:t});return zo({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:a=>{a||n()}}}),{id:t,dismiss:n,update:r}}function Xe(){const[s,t]=x.useState(Xc);return x.useEffect(()=>(Kc.push(t),()=>{const r=Kc.indexOf(t);r>-1&&Kc.splice(r,1)}),[s]),{...s,toast:XS,dismiss:r=>zo({type:"DISMISS_TOAST",toastId:r})}}var Ua=By();const qy=rf(Ua);function Pe(s,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(s?.(a),r===!1||!a.defaultPrevented)return t?.(a)}}function Zx(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function Hy(...s){return t=>{let r=!1;const n=s.map(a=>{const l=Zx(a,t);return!r&&typeof l=="function"&&(r=!0),l});if(r)return()=>{for(let a=0;a<n.length;a++){const l=n[a];typeof l=="function"?l():Zx(s[a],null)}}}}function pt(...s){return x.useCallback(Hy(...s),s)}function QS(s,t){const r=x.createContext(t),n=l=>{const{children:c,...d}=l,m=x.useMemo(()=>d,Object.values(d));return e.jsx(r.Provider,{value:m,children:c})};n.displayName=s+"Provider";function a(l){const c=x.useContext(r);if(c)return c;if(t!==void 0)return t;throw new Error(`\`${l}\` must be used within \`${s}\``)}return[n,a]}function Vs(s,t=[]){let r=[];function n(l,c){const d=x.createContext(c),m=r.length;r=[...r,c];const h=p=>{const{scope:w,children:v,...j}=p,y=w?.[s]?.[m]||d,b=x.useMemo(()=>j,Object.values(j));return e.jsx(y.Provider,{value:b,children:v})};h.displayName=l+"Provider";function f(p,w){const v=w?.[s]?.[m]||d,j=x.useContext(v);if(j)return j;if(c!==void 0)return c;throw new Error(`\`${p}\` must be used within \`${l}\``)}return[h,f]}const a=()=>{const l=r.map(c=>x.createContext(c));return function(d){const m=d?.[s]||l;return x.useMemo(()=>({[`__scope${s}`]:{...d,[s]:m}}),[d,m])}};return a.scopeName=s,[n,JS(a,...t)]}function JS(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const n=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const c=n.reduce((d,{useScope:m,scopeName:h})=>{const p=m(l)[`__scope${h}`];return{...d,...p}},{});return x.useMemo(()=>({[`__scope${t.scopeName}`]:c}),[c])}};return r.scopeName=t.scopeName,r}function Si(s){const t=e1(s),r=x.forwardRef((n,a)=>{const{children:l,...c}=n,d=x.Children.toArray(l),m=d.find(s1);if(m){const h=m.props.children,f=d.map(p=>p===m?x.Children.count(h)>1?x.Children.only(null):x.isValidElement(h)?h.props.children:null:p);return e.jsx(t,{...c,ref:a,children:x.isValidElement(h)?x.cloneElement(h,void 0,f):null})}return e.jsx(t,{...c,ref:a,children:l})});return r.displayName=`${s}.Slot`,r}var ZS=Si("Slot");function e1(s){const t=x.forwardRef((r,n)=>{const{children:a,...l}=r;if(x.isValidElement(a)){const c=n1(a),d=r1(l,a.props);return a.type!==x.Fragment&&(d.ref=n?Hy(n,c):c),x.cloneElement(a,d)}return x.Children.count(a)>1?x.Children.only(null):null});return t.displayName=`${s}.SlotClone`,t}var Vy=Symbol("radix.slottable");function t1(s){const t=({children:r})=>e.jsx(e.Fragment,{children:r});return t.displayName=`${s}.Slottable`,t.__radixId=Vy,t}function s1(s){return x.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===Vy}function r1(s,t){const r={...t};for(const n in t){const a=s[n],l=t[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...d)=>{const m=l(...d);return a(...d),m}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...s,...r}}function n1(s){let t=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=Object.getOwnPropertyDescriptor(s,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}function of(s){const t=s+"CollectionProvider",[r,n]=Vs(t),[a,l]=r(t,{collectionRef:{current:null},itemMap:new Map}),c=y=>{const{scope:b,children:C}=y,E=ye.useRef(null),S=ye.useRef(new Map).current;return e.jsx(a,{scope:b,itemMap:S,collectionRef:E,children:C})};c.displayName=t;const d=s+"CollectionSlot",m=Si(d),h=ye.forwardRef((y,b)=>{const{scope:C,children:E}=y,S=l(d,C),O=pt(b,S.collectionRef);return e.jsx(m,{ref:O,children:E})});h.displayName=d;const f=s+"CollectionItemSlot",p="data-radix-collection-item",w=Si(f),v=ye.forwardRef((y,b)=>{const{scope:C,children:E,...S}=y,O=ye.useRef(null),R=pt(b,O),k=l(f,C);return ye.useEffect(()=>(k.itemMap.set(O,{ref:O,...S}),()=>void k.itemMap.delete(O))),e.jsx(w,{[p]:"",ref:R,children:E})});v.displayName=f;function j(y){const b=l(s+"CollectionConsumer",y);return ye.useCallback(()=>{const E=b.collectionRef.current;if(!E)return[];const S=Array.from(E.querySelectorAll(`[${p}]`));return Array.from(b.itemMap.values()).sort((k,P)=>S.indexOf(k.ref.current)-S.indexOf(P.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:c,Slot:h,ItemSlot:v},j,n]}var i1=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ze=i1.reduce((s,t)=>{const r=Si(`Primitive.${t}`),n=x.forwardRef((a,l)=>{const{asChild:c,...d}=a,m=c?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(m,{...d,ref:l})});return n.displayName=`Primitive.${t}`,{...s,[t]:n}},{});function Gy(s,t){s&&Ua.flushSync(()=>s.dispatchEvent(t))}function Xt(s){const t=x.useRef(s);return x.useEffect(()=>{t.current=s}),x.useMemo(()=>(...r)=>t.current?.(...r),[])}function a1(s,t=globalThis?.document){const r=Xt(s);x.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var o1="DismissableLayer",hm="dismissableLayer.update",l1="dismissableLayer.pointerDownOutside",c1="dismissableLayer.focusOutside",ev,Yy=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),za=x.forwardRef((s,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:l,onInteractOutside:c,onDismiss:d,...m}=s,h=x.useContext(Yy),[f,p]=x.useState(null),w=f?.ownerDocument??globalThis?.document,[,v]=x.useState({}),j=pt(t,P=>p(P)),y=Array.from(h.layers),[b]=[...h.layersWithOutsidePointerEventsDisabled].slice(-1),C=y.indexOf(b),E=f?y.indexOf(f):-1,S=h.layersWithOutsidePointerEventsDisabled.size>0,O=E>=C,R=u1(P=>{const F=P.target,ee=[...h.branches].some(ne=>ne.contains(F));!O||ee||(a?.(P),c?.(P),P.defaultPrevented||d?.())},w),k=h1(P=>{const F=P.target;[...h.branches].some(ne=>ne.contains(F))||(l?.(P),c?.(P),P.defaultPrevented||d?.())},w);return a1(P=>{E===h.layers.size-1&&(n?.(P),!P.defaultPrevented&&d&&(P.preventDefault(),d()))},w),x.useEffect(()=>{if(f)return r&&(h.layersWithOutsidePointerEventsDisabled.size===0&&(ev=w.body.style.pointerEvents,w.body.style.pointerEvents="none"),h.layersWithOutsidePointerEventsDisabled.add(f)),h.layers.add(f),tv(),()=>{r&&h.layersWithOutsidePointerEventsDisabled.size===1&&(w.body.style.pointerEvents=ev)}},[f,w,r,h]),x.useEffect(()=>()=>{f&&(h.layers.delete(f),h.layersWithOutsidePointerEventsDisabled.delete(f),tv())},[f,h]),x.useEffect(()=>{const P=()=>v({});return document.addEventListener(hm,P),()=>document.removeEventListener(hm,P)},[]),e.jsx(ze.div,{...m,ref:j,style:{pointerEvents:S?O?"auto":"none":void 0,...s.style},onFocusCapture:Pe(s.onFocusCapture,k.onFocusCapture),onBlurCapture:Pe(s.onBlurCapture,k.onBlurCapture),onPointerDownCapture:Pe(s.onPointerDownCapture,R.onPointerDownCapture)})});za.displayName=o1;var d1="DismissableLayerBranch",Ky=x.forwardRef((s,t)=>{const r=x.useContext(Yy),n=x.useRef(null),a=pt(t,n);return x.useEffect(()=>{const l=n.current;if(l)return r.branches.add(l),()=>{r.branches.delete(l)}},[r.branches]),e.jsx(ze.div,{...s,ref:a})});Ky.displayName=d1;function u1(s,t=globalThis?.document){const r=Xt(s),n=x.useRef(!1),a=x.useRef(()=>{});return x.useEffect(()=>{const l=d=>{if(d.target&&!n.current){let m=function(){Xy(l1,r,h,{discrete:!0})};const h={originalEvent:d};d.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=m,t.addEventListener("click",a.current,{once:!0})):m()}else t.removeEventListener("click",a.current);n.current=!1},c=window.setTimeout(()=>{t.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(c),t.removeEventListener("pointerdown",l),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function h1(s,t=globalThis?.document){const r=Xt(s),n=x.useRef(!1);return x.useEffect(()=>{const a=l=>{l.target&&!n.current&&Xy(c1,r,{originalEvent:l},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function tv(){const s=new CustomEvent(hm);document.dispatchEvent(s)}function Xy(s,t,r,{discrete:n}){const a=r.originalEvent.target,l=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(s,t,{once:!0}),n?Gy(a,l):a.dispatchEvent(l)}var m1=za,f1=Ky,Qt=globalThis?.document?x.useLayoutEffect:()=>{},p1="Portal",il=x.forwardRef((s,t)=>{const{container:r,...n}=s,[a,l]=x.useState(!1);Qt(()=>l(!0),[]);const c=r||a&&globalThis?.document?.body;return c?qy.createPortal(e.jsx(ze.div,{...n,ref:t}),c):null});il.displayName=p1;function g1(s,t){return x.useReducer((r,n)=>t[r][n]??r,s)}var ks=s=>{const{present:t,children:r}=s,n=x1(t),a=typeof r=="function"?r({present:n.isPresent}):x.Children.only(r),l=pt(n.ref,v1(a));return typeof r=="function"||n.isPresent?x.cloneElement(a,{ref:l}):null};ks.displayName="Presence";function x1(s){const[t,r]=x.useState(),n=x.useRef(null),a=x.useRef(s),l=x.useRef("none"),c=s?"mounted":"unmounted",[d,m]=g1(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const h=Pc(n.current);l.current=d==="mounted"?h:"none"},[d]),Qt(()=>{const h=n.current,f=a.current;if(f!==s){const w=l.current,v=Pc(h);s?m("MOUNT"):v==="none"||h?.display==="none"?m("UNMOUNT"):m(f&&w!==v?"ANIMATION_OUT":"UNMOUNT"),a.current=s}},[s,m]),Qt(()=>{if(t){let h;const f=t.ownerDocument.defaultView??window,p=v=>{const y=Pc(n.current).includes(CSS.escape(v.animationName));if(v.target===t&&y&&(m("ANIMATION_END"),!a.current)){const b=t.style.animationFillMode;t.style.animationFillMode="forwards",h=f.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=b)})}},w=v=>{v.target===t&&(l.current=Pc(n.current))};return t.addEventListener("animationstart",w),t.addEventListener("animationcancel",p),t.addEventListener("animationend",p),()=>{f.clearTimeout(h),t.removeEventListener("animationstart",w),t.removeEventListener("animationcancel",p),t.removeEventListener("animationend",p)}}else m("ANIMATION_END")},[t,m]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:x.useCallback(h=>{n.current=h?getComputedStyle(h):null,r(h)},[])}}function Pc(s){return s?.animationName||"none"}function v1(s){let t=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=Object.getOwnPropertyDescriptor(s,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var y1=af[" useInsertionEffect ".trim().toString()]||Qt;function en({prop:s,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,l,c]=j1({defaultProp:t,onChange:r}),d=s!==void 0,m=d?s:a;{const f=x.useRef(s!==void 0);x.useEffect(()=>{const p=f.current;p!==d&&console.warn(`${n} is changing from ${p?"controlled":"uncontrolled"} to ${d?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=d},[d,n])}const h=x.useCallback(f=>{if(d){const p=w1(f)?f(s):f;p!==s&&c.current?.(p)}else l(f)},[d,s,l,c]);return[m,h]}function j1({defaultProp:s,onChange:t}){const[r,n]=x.useState(s),a=x.useRef(r),l=x.useRef(t);return y1(()=>{l.current=t},[t]),x.useEffect(()=>{a.current!==r&&(l.current?.(r),a.current=r)},[r,a]),[r,n,l]}function w1(s){return typeof s=="function"}var Qy=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),_1="VisuallyHidden",wd=x.forwardRef((s,t)=>e.jsx(ze.span,{...s,ref:t,style:{...Qy,...s.style}}));wd.displayName=_1;var b1=wd,lf="ToastProvider",[cf,N1,S1]=of("Toast"),[Jy,$L]=Vs("Toast",[S1]),[E1,_d]=Jy(lf),Zy=s=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:l=50,children:c}=s,[d,m]=x.useState(null),[h,f]=x.useState(0),p=x.useRef(!1),w=x.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${lf}\`. Expected non-empty \`string\`.`),e.jsx(cf.Provider,{scope:t,children:e.jsx(E1,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:l,toastCount:h,viewport:d,onViewportChange:m,onToastAdd:x.useCallback(()=>f(v=>v+1),[]),onToastRemove:x.useCallback(()=>f(v=>v-1),[]),isFocusedToastEscapeKeyDownRef:p,isClosePausedRef:w,children:c})})};Zy.displayName=lf;var e0="ToastViewport",C1=["F8"],mm="toast.viewportPause",fm="toast.viewportResume",t0=x.forwardRef((s,t)=>{const{__scopeToast:r,hotkey:n=C1,label:a="Notifications ({hotkey})",...l}=s,c=_d(e0,r),d=N1(r),m=x.useRef(null),h=x.useRef(null),f=x.useRef(null),p=x.useRef(null),w=pt(t,p,c.onViewportChange),v=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),j=c.toastCount>0;x.useEffect(()=>{const b=C=>{n.length!==0&&n.every(S=>C[S]||C.code===S)&&p.current?.focus()};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[n]),x.useEffect(()=>{const b=m.current,C=p.current;if(j&&b&&C){const E=()=>{if(!c.isClosePausedRef.current){const k=new CustomEvent(mm);C.dispatchEvent(k),c.isClosePausedRef.current=!0}},S=()=>{if(c.isClosePausedRef.current){const k=new CustomEvent(fm);C.dispatchEvent(k),c.isClosePausedRef.current=!1}},O=k=>{!b.contains(k.relatedTarget)&&S()},R=()=>{b.contains(document.activeElement)||S()};return b.addEventListener("focusin",E),b.addEventListener("focusout",O),b.addEventListener("pointermove",E),b.addEventListener("pointerleave",R),window.addEventListener("blur",E),window.addEventListener("focus",S),()=>{b.removeEventListener("focusin",E),b.removeEventListener("focusout",O),b.removeEventListener("pointermove",E),b.removeEventListener("pointerleave",R),window.removeEventListener("blur",E),window.removeEventListener("focus",S)}}},[j,c.isClosePausedRef]);const y=x.useCallback(({tabbingDirection:b})=>{const E=d().map(S=>{const O=S.ref.current,R=[O,...U1(O)];return b==="forwards"?R:R.reverse()});return(b==="forwards"?E.reverse():E).flat()},[d]);return x.useEffect(()=>{const b=p.current;if(b){const C=E=>{const S=E.altKey||E.ctrlKey||E.metaKey;if(E.key==="Tab"&&!S){const R=document.activeElement,k=E.shiftKey;if(E.target===b&&k){h.current?.focus();return}const ee=y({tabbingDirection:k?"backwards":"forwards"}),ne=ee.findIndex(pe=>pe===R);Bh(ee.slice(ne+1))?E.preventDefault():k?h.current?.focus():f.current?.focus()}};return b.addEventListener("keydown",C),()=>b.removeEventListener("keydown",C)}},[d,y]),e.jsxs(f1,{ref:m,role:"region","aria-label":a.replace("{hotkey}",v),tabIndex:-1,style:{pointerEvents:j?void 0:"none"},children:[j&&e.jsx(pm,{ref:h,onFocusFromOutsideViewport:()=>{const b=y({tabbingDirection:"forwards"});Bh(b)}}),e.jsx(cf.Slot,{scope:r,children:e.jsx(ze.ol,{tabIndex:-1,...l,ref:w})}),j&&e.jsx(pm,{ref:f,onFocusFromOutsideViewport:()=>{const b=y({tabbingDirection:"backwards"});Bh(b)}})]})});t0.displayName=e0;var s0="ToastFocusProxy",pm=x.forwardRef((s,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=s,l=_d(s0,r);return e.jsx(wd,{tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:c=>{const d=c.relatedTarget;!l.viewport?.contains(d)&&n()}})});pm.displayName=s0;var al="Toast",T1="toast.swipeStart",k1="toast.swipeMove",O1="toast.swipeCancel",R1="toast.swipeEnd",r0=x.forwardRef((s,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:l,...c}=s,[d,m]=en({prop:n,defaultProp:a??!0,onChange:l,caller:al});return e.jsx(ks,{present:r||d,children:e.jsx(A1,{open:d,...c,ref:t,onClose:()=>m(!1),onPause:Xt(s.onPause),onResume:Xt(s.onResume),onSwipeStart:Pe(s.onSwipeStart,h=>{h.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Pe(s.onSwipeMove,h=>{const{x:f,y:p}=h.detail.delta;h.currentTarget.setAttribute("data-swipe","move"),h.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),h.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${p}px`)}),onSwipeCancel:Pe(s.onSwipeCancel,h=>{h.currentTarget.setAttribute("data-swipe","cancel"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),h.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Pe(s.onSwipeEnd,h=>{const{x:f,y:p}=h.detail.delta;h.currentTarget.setAttribute("data-swipe","end"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),h.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),h.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${p}px`),m(!1)})})})});r0.displayName=al;var[P1,I1]=Jy(al,{onClose(){}}),A1=x.forwardRef((s,t)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:l,onClose:c,onEscapeKeyDown:d,onPause:m,onResume:h,onSwipeStart:f,onSwipeMove:p,onSwipeCancel:w,onSwipeEnd:v,...j}=s,y=_d(al,r),[b,C]=x.useState(null),E=pt(t,G=>C(G)),S=x.useRef(null),O=x.useRef(null),R=a||y.duration,k=x.useRef(0),P=x.useRef(R),F=x.useRef(0),{onToastAdd:ee,onToastRemove:ne}=y,pe=Xt(()=>{b?.contains(document.activeElement)&&y.viewport?.focus(),c()}),re=x.useCallback(G=>{!G||G===1/0||(window.clearTimeout(F.current),k.current=new Date().getTime(),F.current=window.setTimeout(pe,G))},[pe]);x.useEffect(()=>{const G=y.viewport;if(G){const ge=()=>{re(P.current),h?.()},ie=()=>{const xe=new Date().getTime()-k.current;P.current=P.current-xe,window.clearTimeout(F.current),m?.()};return G.addEventListener(mm,ie),G.addEventListener(fm,ge),()=>{G.removeEventListener(mm,ie),G.removeEventListener(fm,ge)}}},[y.viewport,R,m,h,re]),x.useEffect(()=>{l&&!y.isClosePausedRef.current&&re(R)},[l,R,y.isClosePausedRef,re]),x.useEffect(()=>(ee(),()=>ne()),[ee,ne]);const H=x.useMemo(()=>b?d0(b):null,[b]);return y.viewport?e.jsxs(e.Fragment,{children:[H&&e.jsx(D1,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:H}),e.jsx(P1,{scope:r,onClose:pe,children:Ua.createPortal(e.jsx(cf.ItemSlot,{scope:r,children:e.jsx(m1,{asChild:!0,onEscapeKeyDown:Pe(d,()=>{y.isFocusedToastEscapeKeyDownRef.current||pe(),y.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(ze.li,{tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":y.swipeDirection,...j,ref:E,style:{userSelect:"none",touchAction:"none",...s.style},onKeyDown:Pe(s.onKeyDown,G=>{G.key==="Escape"&&(d?.(G.nativeEvent),G.nativeEvent.defaultPrevented||(y.isFocusedToastEscapeKeyDownRef.current=!0,pe()))}),onPointerDown:Pe(s.onPointerDown,G=>{G.button===0&&(S.current={x:G.clientX,y:G.clientY})}),onPointerMove:Pe(s.onPointerMove,G=>{if(!S.current)return;const ge=G.clientX-S.current.x,ie=G.clientY-S.current.y,xe=!!O.current,X=["left","right"].includes(y.swipeDirection),te=["left","up"].includes(y.swipeDirection)?Math.min:Math.max,oe=X?te(0,ge):0,W=X?0:te(0,ie),se=G.pointerType==="touch"?10:2,we={x:oe,y:W},_e={originalEvent:G,delta:we};xe?(O.current=we,Ic(k1,p,_e,{discrete:!1})):sv(we,y.swipeDirection,se)?(O.current=we,Ic(T1,f,_e,{discrete:!1}),G.target.setPointerCapture(G.pointerId)):(Math.abs(ge)>se||Math.abs(ie)>se)&&(S.current=null)}),onPointerUp:Pe(s.onPointerUp,G=>{const ge=O.current,ie=G.target;if(ie.hasPointerCapture(G.pointerId)&&ie.releasePointerCapture(G.pointerId),O.current=null,S.current=null,ge){const xe=G.currentTarget,X={originalEvent:G,delta:ge};sv(ge,y.swipeDirection,y.swipeThreshold)?Ic(R1,v,X,{discrete:!0}):Ic(O1,w,X,{discrete:!0}),xe.addEventListener("click",te=>te.preventDefault(),{once:!0})}})})})}),y.viewport)})]}):null}),D1=s=>{const{__scopeToast:t,children:r,...n}=s,a=_d(al,t),[l,c]=x.useState(!1),[d,m]=x.useState(!1);return M1(()=>c(!0)),x.useEffect(()=>{const h=window.setTimeout(()=>m(!0),1e3);return()=>window.clearTimeout(h)},[]),d?null:e.jsx(il,{asChild:!0,children:e.jsx(wd,{...n,children:l&&e.jsxs(e.Fragment,{children:[a.label," ",r]})})})},$1="ToastTitle",n0=x.forwardRef((s,t)=>{const{__scopeToast:r,...n}=s;return e.jsx(ze.div,{...n,ref:t})});n0.displayName=$1;var L1="ToastDescription",i0=x.forwardRef((s,t)=>{const{__scopeToast:r,...n}=s;return e.jsx(ze.div,{...n,ref:t})});i0.displayName=L1;var a0="ToastAction",o0=x.forwardRef((s,t)=>{const{altText:r,...n}=s;return r.trim()?e.jsx(c0,{altText:r,asChild:!0,children:e.jsx(df,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${a0}\`. Expected non-empty \`string\`.`),null)});o0.displayName=a0;var l0="ToastClose",df=x.forwardRef((s,t)=>{const{__scopeToast:r,...n}=s,a=I1(l0,r);return e.jsx(c0,{asChild:!0,children:e.jsx(ze.button,{type:"button",...n,ref:t,onClick:Pe(s.onClick,a.onClose)})})});df.displayName=l0;var c0=x.forwardRef((s,t)=>{const{__scopeToast:r,altText:n,...a}=s;return e.jsx(ze.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:t})});function d0(s){const t=[];return Array.from(s.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),F1(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",l=n.dataset.radixToastAnnounceExclude==="";if(!a)if(l){const c=n.dataset.radixToastAnnounceAlt;c&&t.push(c)}else t.push(...d0(n))}}),t}function Ic(s,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,l=new CustomEvent(s,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(s,t,{once:!0}),n?Gy(a,l):a.dispatchEvent(l)}var sv=(s,t,r=0)=>{const n=Math.abs(s.x),a=Math.abs(s.y),l=n>a;return t==="left"||t==="right"?l&&n>r:!l&&a>r};function M1(s=()=>{}){const t=Xt(s);Qt(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function F1(s){return s.nodeType===s.ELEMENT_NODE}function U1(s){const t=[],r=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Bh(s){const t=document.activeElement;return s.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var z1=Zy,u0=t0,h0=r0,m0=n0,f0=i0,p0=o0,g0=df;function x0(s){var t,r,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s)){var a=s.length;for(t=0;t<a;t++)s[t]&&(r=x0(s[t]))&&(n&&(n+=" "),n+=r)}else for(r in s)s[r]&&(n&&(n+=" "),n+=r);return n}function v0(){for(var s,t,r=0,n="",a=arguments.length;r<a;r++)(s=arguments[r])&&(t=x0(s))&&(n&&(n+=" "),n+=t);return n}const rv=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,nv=v0,ol=(s,t)=>r=>{var n;if(t?.variants==null)return nv(s,r?.class,r?.className);const{variants:a,defaultVariants:l}=t,c=Object.keys(a).map(h=>{const f=r?.[h],p=l?.[h];if(f===null)return null;const w=rv(f)||rv(p);return a[h][w]}),d=r&&Object.entries(r).reduce((h,f)=>{let[p,w]=f;return w===void 0||(h[p]=w),h},{}),m=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((h,f)=>{let{class:p,className:w,...v}=f;return Object.entries(v).every(j=>{let[y,b]=j;return Array.isArray(b)?b.includes({...l,...d}[y]):{...l,...d}[y]===b})?[...h,p,w]:h},[]);return nv(s,c,m,r?.class,r?.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W1=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),y0=(...s)=>s.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var B1={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q1=x.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:l,iconNode:c,...d},m)=>x.createElement("svg",{ref:m,...B1,width:t,height:t,stroke:s,strokeWidth:n?Number(r)*24/Number(t):r,className:y0("lucide",a),...d},[...c.map(([h,f])=>x.createElement(h,f)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=(s,t)=>{const r=x.forwardRef(({className:n,...a},l)=>x.createElement(q1,{ref:l,iconNode:t,className:y0(`lucide-${W1(s)}`,n),...a}));return r.displayName=`${s}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H1=Ie("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=Ie("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gm=Ie("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=Ie("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=Ie("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=Ie("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=Ie("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hf=Ie("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V1=Ie("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G1=Ie("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=Ie("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=Ie("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=Ie("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=Ie("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iv=Ie("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=Ie("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=Ie("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ji=Ie("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=Ie("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const av=Ie("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y1=Ie("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ov=Ie("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K1=Ie("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=Ie("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=Ie("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w0=Ie("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X1=Ie("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=Ie("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=Ie("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q1=Ie("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=Ie("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=Ie("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=Ie("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _0=Ie("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J1=Ie("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=Ie("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lv=Ie("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=Ie("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=Ie("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cv=Ie("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xm=Ie("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=Ie("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=Ie("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rd=Ie("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z1=Ie("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=Ie("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=Ie("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=Ie("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sE=Ie("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=Ie("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rE=Ie("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=Ie("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=Ie("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=Ie("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=Ie("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=Ie("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=Ie("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=Ie("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ll=Ie("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=Ie("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aE=Ie("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=Ie("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=Ie("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),mf="-",oE=s=>{const t=cE(s),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=s;return{getClassGroupId:c=>{const d=c.split(mf);return d[0]===""&&d.length!==1&&d.shift(),b0(d,t)||lE(c)},getConflictingClassGroupIds:(c,d)=>{const m=r[c]||[];return d&&n[c]?[...m,...n[c]]:m}}},b0=(s,t)=>{if(s.length===0)return t.classGroupId;const r=s[0],n=t.nextPart.get(r),a=n?b0(s.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const l=s.join(mf);return t.validators.find(({validator:c})=>c(l))?.classGroupId},dv=/^\[(.+)\]$/,lE=s=>{if(dv.test(s)){const t=dv.exec(s)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},cE=s=>{const{theme:t,prefix:r}=s,n={nextPart:new Map,validators:[]};return uE(Object.entries(s.classGroups),r).forEach(([l,c])=>{vm(c,n,l,t)}),n},vm=(s,t,r,n)=>{s.forEach(a=>{if(typeof a=="string"){const l=a===""?t:uv(t,a);l.classGroupId=r;return}if(typeof a=="function"){if(dE(a)){vm(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([l,c])=>{vm(c,uv(t,l),r,n)})})},uv=(s,t)=>{let r=s;return t.split(mf).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},dE=s=>s.isThemeGetter,uE=(s,t)=>t?s.map(([r,n])=>{const a=n.map(l=>typeof l=="string"?t+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(([c,d])=>[t+c,d])):l);return[r,a]}):s,hE=s=>{if(s<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(l,c)=>{r.set(l,c),t++,t>s&&(t=0,n=r,r=new Map)};return{get(l){let c=r.get(l);if(c!==void 0)return c;if((c=n.get(l))!==void 0)return a(l,c),c},set(l,c){r.has(l)?r.set(l,c):a(l,c)}}},N0="!",mE=s=>{const{separator:t,experimentalParseClassName:r}=s,n=t.length===1,a=t[0],l=t.length,c=d=>{const m=[];let h=0,f=0,p;for(let b=0;b<d.length;b++){let C=d[b];if(h===0){if(C===a&&(n||d.slice(b,b+l)===t)){m.push(d.slice(f,b)),f=b+l;continue}if(C==="/"){p=b;continue}}C==="["?h++:C==="]"&&h--}const w=m.length===0?d:d.substring(f),v=w.startsWith(N0),j=v?w.substring(1):w,y=p&&p>f?p-f:void 0;return{modifiers:m,hasImportantModifier:v,baseClassName:j,maybePostfixModifierPosition:y}};return r?d=>r({className:d,parseClassName:c}):c},fE=s=>{if(s.length<=1)return s;const t=[];let r=[];return s.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},pE=s=>({cache:hE(s.cacheSize),parseClassName:mE(s),...oE(s)}),gE=/\s+/,xE=(s,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,l=[],c=s.trim().split(gE);let d="";for(let m=c.length-1;m>=0;m-=1){const h=c[m],{modifiers:f,hasImportantModifier:p,baseClassName:w,maybePostfixModifierPosition:v}=r(h);let j=!!v,y=n(j?w.substring(0,v):w);if(!y){if(!j){d=h+(d.length>0?" "+d:d);continue}if(y=n(w),!y){d=h+(d.length>0?" "+d:d);continue}j=!1}const b=fE(f).join(":"),C=p?b+N0:b,E=C+y;if(l.includes(E))continue;l.push(E);const S=a(y,j);for(let O=0;O<S.length;++O){const R=S[O];l.push(C+R)}d=h+(d.length>0?" "+d:d)}return d};function vE(){let s=0,t,r,n="";for(;s<arguments.length;)(t=arguments[s++])&&(r=S0(t))&&(n&&(n+=" "),n+=r);return n}const S0=s=>{if(typeof s=="string")return s;let t,r="";for(let n=0;n<s.length;n++)s[n]&&(t=S0(s[n]))&&(r&&(r+=" "),r+=t);return r};function yE(s,...t){let r,n,a,l=c;function c(m){const h=t.reduce((f,p)=>p(f),s());return r=pE(h),n=r.cache.get,a=r.cache.set,l=d,d(m)}function d(m){const h=n(m);if(h)return h;const f=xE(m,r);return a(m,f),f}return function(){return l(vE.apply(null,arguments))}}const Ot=s=>{const t=r=>r[s]||[];return t.isThemeGetter=!0,t},E0=/^\[(?:([a-z-]+):)?(.+)\]$/i,jE=/^\d+\/\d+$/,wE=new Set(["px","full","screen"]),_E=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,bE=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,NE=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,SE=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,EE=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Yr=s=>Ta(s)||wE.has(s)||jE.test(s),Rn=s=>Ba(s,"length",AE),Ta=s=>!!s&&!Number.isNaN(Number(s)),Hh=s=>Ba(s,"number",Ta),Do=s=>!!s&&Number.isInteger(Number(s)),CE=s=>s.endsWith("%")&&Ta(s.slice(0,-1)),rt=s=>E0.test(s),Pn=s=>_E.test(s),TE=new Set(["length","size","percentage"]),kE=s=>Ba(s,TE,C0),OE=s=>Ba(s,"position",C0),RE=new Set(["image","url"]),PE=s=>Ba(s,RE,$E),IE=s=>Ba(s,"",DE),$o=()=>!0,Ba=(s,t,r)=>{const n=E0.exec(s);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},AE=s=>bE.test(s)&&!NE.test(s),C0=()=>!1,DE=s=>SE.test(s),$E=s=>EE.test(s),LE=()=>{const s=Ot("colors"),t=Ot("spacing"),r=Ot("blur"),n=Ot("brightness"),a=Ot("borderColor"),l=Ot("borderRadius"),c=Ot("borderSpacing"),d=Ot("borderWidth"),m=Ot("contrast"),h=Ot("grayscale"),f=Ot("hueRotate"),p=Ot("invert"),w=Ot("gap"),v=Ot("gradientColorStops"),j=Ot("gradientColorStopPositions"),y=Ot("inset"),b=Ot("margin"),C=Ot("opacity"),E=Ot("padding"),S=Ot("saturate"),O=Ot("scale"),R=Ot("sepia"),k=Ot("skew"),P=Ot("space"),F=Ot("translate"),ee=()=>["auto","contain","none"],ne=()=>["auto","hidden","clip","visible","scroll"],pe=()=>["auto",rt,t],re=()=>[rt,t],H=()=>["",Yr,Rn],G=()=>["auto",Ta,rt],ge=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ie=()=>["solid","dashed","dotted","double","none"],xe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],X=()=>["start","end","center","between","around","evenly","stretch"],te=()=>["","0",rt],oe=()=>["auto","avoid","all","avoid-page","page","left","right","column"],W=()=>[Ta,rt];return{cacheSize:500,separator:":",theme:{colors:[$o],spacing:[Yr,Rn],blur:["none","",Pn,rt],brightness:W(),borderColor:[s],borderRadius:["none","","full",Pn,rt],borderSpacing:re(),borderWidth:H(),contrast:W(),grayscale:te(),hueRotate:W(),invert:te(),gap:re(),gradientColorStops:[s],gradientColorStopPositions:[CE,Rn],inset:pe(),margin:pe(),opacity:W(),padding:re(),saturate:W(),scale:W(),sepia:te(),skew:W(),space:re(),translate:re()},classGroups:{aspect:[{aspect:["auto","square","video",rt]}],container:["container"],columns:[{columns:[Pn]}],"break-after":[{"break-after":oe()}],"break-before":[{"break-before":oe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ge(),rt]}],overflow:[{overflow:ne()}],"overflow-x":[{"overflow-x":ne()}],"overflow-y":[{"overflow-y":ne()}],overscroll:[{overscroll:ee()}],"overscroll-x":[{"overscroll-x":ee()}],"overscroll-y":[{"overscroll-y":ee()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Do,rt]}],basis:[{basis:pe()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",rt]}],grow:[{grow:te()}],shrink:[{shrink:te()}],order:[{order:["first","last","none",Do,rt]}],"grid-cols":[{"grid-cols":[$o]}],"col-start-end":[{col:["auto",{span:["full",Do,rt]},rt]}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":[$o]}],"row-start-end":[{row:["auto",{span:[Do,rt]},rt]}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",rt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",rt]}],gap:[{gap:[w]}],"gap-x":[{"gap-x":[w]}],"gap-y":[{"gap-y":[w]}],"justify-content":[{justify:["normal",...X()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...X(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...X(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[E]}],px:[{px:[E]}],py:[{py:[E]}],ps:[{ps:[E]}],pe:[{pe:[E]}],pt:[{pt:[E]}],pr:[{pr:[E]}],pb:[{pb:[E]}],pl:[{pl:[E]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",rt,t]}],"min-w":[{"min-w":[rt,t,"min","max","fit"]}],"max-w":[{"max-w":[rt,t,"none","full","min","max","fit","prose",{screen:[Pn]},Pn]}],h:[{h:[rt,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[rt,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[rt,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[rt,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Pn,Rn]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Hh]}],"font-family":[{font:[$o]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",rt]}],"line-clamp":[{"line-clamp":["none",Ta,Hh]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Yr,rt]}],"list-image":[{"list-image":["none",rt]}],"list-style-type":[{list:["none","disc","decimal",rt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[s]}],"placeholder-opacity":[{"placeholder-opacity":[C]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[s]}],"text-opacity":[{"text-opacity":[C]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ie(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Yr,Rn]}],"underline-offset":[{"underline-offset":["auto",Yr,rt]}],"text-decoration-color":[{decoration:[s]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:re()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",rt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",rt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[C]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ge(),OE]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",kE]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},PE]}],"bg-color":[{bg:[s]}],"gradient-from-pos":[{from:[j]}],"gradient-via-pos":[{via:[j]}],"gradient-to-pos":[{to:[j]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[l]}],"rounded-s":[{"rounded-s":[l]}],"rounded-e":[{"rounded-e":[l]}],"rounded-t":[{"rounded-t":[l]}],"rounded-r":[{"rounded-r":[l]}],"rounded-b":[{"rounded-b":[l]}],"rounded-l":[{"rounded-l":[l]}],"rounded-ss":[{"rounded-ss":[l]}],"rounded-se":[{"rounded-se":[l]}],"rounded-ee":[{"rounded-ee":[l]}],"rounded-es":[{"rounded-es":[l]}],"rounded-tl":[{"rounded-tl":[l]}],"rounded-tr":[{"rounded-tr":[l]}],"rounded-br":[{"rounded-br":[l]}],"rounded-bl":[{"rounded-bl":[l]}],"border-w":[{border:[d]}],"border-w-x":[{"border-x":[d]}],"border-w-y":[{"border-y":[d]}],"border-w-s":[{"border-s":[d]}],"border-w-e":[{"border-e":[d]}],"border-w-t":[{"border-t":[d]}],"border-w-r":[{"border-r":[d]}],"border-w-b":[{"border-b":[d]}],"border-w-l":[{"border-l":[d]}],"border-opacity":[{"border-opacity":[C]}],"border-style":[{border:[...ie(),"hidden"]}],"divide-x":[{"divide-x":[d]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[d]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[C]}],"divide-style":[{divide:ie()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...ie()]}],"outline-offset":[{"outline-offset":[Yr,rt]}],"outline-w":[{outline:[Yr,Rn]}],"outline-color":[{outline:[s]}],"ring-w":[{ring:H()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[s]}],"ring-opacity":[{"ring-opacity":[C]}],"ring-offset-w":[{"ring-offset":[Yr,Rn]}],"ring-offset-color":[{"ring-offset":[s]}],shadow:[{shadow:["","inner","none",Pn,IE]}],"shadow-color":[{shadow:[$o]}],opacity:[{opacity:[C]}],"mix-blend":[{"mix-blend":[...xe(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":xe()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[m]}],"drop-shadow":[{"drop-shadow":["","none",Pn,rt]}],grayscale:[{grayscale:[h]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[p]}],saturate:[{saturate:[S]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[m]}],"backdrop-grayscale":[{"backdrop-grayscale":[h]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[C]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",rt]}],duration:[{duration:W()}],ease:[{ease:["linear","in","out","in-out",rt]}],delay:[{delay:W()}],animate:[{animate:["none","spin","ping","pulse","bounce",rt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[O]}],"scale-x":[{"scale-x":[O]}],"scale-y":[{"scale-y":[O]}],rotate:[{rotate:[Do,rt]}],"translate-x":[{"translate-x":[F]}],"translate-y":[{"translate-y":[F]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",rt]}],accent:[{accent:["auto",s]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",rt]}],"caret-color":[{caret:[s]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":re()}],"scroll-mx":[{"scroll-mx":re()}],"scroll-my":[{"scroll-my":re()}],"scroll-ms":[{"scroll-ms":re()}],"scroll-me":[{"scroll-me":re()}],"scroll-mt":[{"scroll-mt":re()}],"scroll-mr":[{"scroll-mr":re()}],"scroll-mb":[{"scroll-mb":re()}],"scroll-ml":[{"scroll-ml":re()}],"scroll-p":[{"scroll-p":re()}],"scroll-px":[{"scroll-px":re()}],"scroll-py":[{"scroll-py":re()}],"scroll-ps":[{"scroll-ps":re()}],"scroll-pe":[{"scroll-pe":re()}],"scroll-pt":[{"scroll-pt":re()}],"scroll-pr":[{"scroll-pr":re()}],"scroll-pb":[{"scroll-pb":re()}],"scroll-pl":[{"scroll-pl":re()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",rt]}],fill:[{fill:[s,"none"]}],"stroke-w":[{stroke:[Yr,Rn,Hh]}],stroke:[{stroke:[s,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},ME=yE(LE);function Ue(...s){return ME(v0(s))}const T0=z1,ff=x.forwardRef(({className:s,...t},r)=>e.jsx(u0,{ref:r,className:Ue("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));ff.displayName=u0.displayName;const FE=ol("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),pf=x.forwardRef(({className:s,variant:t,...r},n)=>e.jsx(h0,{ref:n,className:Ue(FE({variant:t}),s),...r}));pf.displayName=h0.displayName;const UE=x.forwardRef(({className:s,...t},r)=>e.jsx(p0,{ref:r,className:Ue("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));UE.displayName=p0.displayName;const gf=x.forwardRef(({className:s,...t},r)=>e.jsx(g0,{ref:r,className:Ue("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(Vn,{className:"h-4 w-4"})}));gf.displayName=g0.displayName;const xf=x.forwardRef(({className:s,...t},r)=>e.jsx(m0,{ref:r,className:Ue("text-sm font-semibold",s),...t}));xf.displayName=m0.displayName;const vf=x.forwardRef(({className:s,...t},r)=>e.jsx(f0,{ref:r,className:Ue("text-sm opacity-90",s),...t}));vf.displayName=f0.displayName;function zE(){const{toasts:s}=Xe();return e.jsxs(T0,{children:[s.map(function({id:t,title:r,description:n,action:a,...l}){return e.jsxs(pf,{...l,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(xf,{children:r}),n&&e.jsx(vf,{children:n})]}),a,e.jsx(gf,{})]},t)}),e.jsx(ff,{})]})}var hv=["light","dark"],WE="(prefers-color-scheme: dark)",BE=x.createContext(void 0),qE={setTheme:s=>{},themes:[]},HE=()=>{var s;return(s=x.useContext(BE))!=null?s:qE};x.memo(({forcedTheme:s,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:l,value:c,attrs:d,nonce:m})=>{let h=l==="system",f=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${d.map(j=>`'${j}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,p=a?hv.includes(l)&&l?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${l}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",w=(j,y=!1,b=!0)=>{let C=c?c[j]:j,E=y?j+"|| ''":`'${C}'`,S="";return a&&b&&!y&&hv.includes(j)&&(S+=`d.style.colorScheme = '${j}';`),r==="class"?y||C?S+=`c.add(${E})`:S+="null":C&&(S+=`d[s](n,${E})`),S},v=s?`!function(){${f}${w(s)}}()`:n?`!function(){try{${f}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${h})){var t='${WE}',m=window.matchMedia(t);if(m.media!==t||m.matches){${w("dark")}}else{${w("light")}}}else if(e){${c?`var x=${JSON.stringify(c)};`:""}${w(c?"x[e]":"e",!0)}}${h?"":"else{"+w(l,!1,!1)+"}"}${p}}catch(e){}}()`:`!function(){try{${f}var e=localStorage.getItem('${t}');if(e){${c?`var x=${JSON.stringify(c)};`:""}${w(c?"x[e]":"e",!0)}}else{${w(l,!1,!1)};}${p}}catch(t){}}();`;return x.createElement("script",{nonce:m,dangerouslySetInnerHTML:{__html:v}})});var VE=s=>{switch(s){case"success":return KE;case"info":return QE;case"warning":return XE;case"error":return JE;default:return null}},GE=Array(12).fill(0),YE=({visible:s,className:t})=>ye.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":s},ye.createElement("div",{className:"sonner-spinner"},GE.map((r,n)=>ye.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),KE=ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ye.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),XE=ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ye.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),QE=ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ye.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),JE=ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ye.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),ZE=ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ye.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ye.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),eC=()=>{let[s,t]=ye.useState(document.hidden);return ye.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),s},ym=1,tC=class{constructor(){this.subscribe=s=>(this.subscribers.push(s),()=>{let t=this.subscribers.indexOf(s);this.subscribers.splice(t,1)}),this.publish=s=>{this.subscribers.forEach(t=>t(s))},this.addToast=s=>{this.publish(s),this.toasts=[...this.toasts,s]},this.create=s=>{var t;let{message:r,...n}=s,a=typeof s?.id=="number"||((t=s.id)==null?void 0:t.length)>0?s.id:ym++,l=this.toasts.find(d=>d.id===a),c=s.dismissible===void 0?!0:s.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),l?this.toasts=this.toasts.map(d=>d.id===a?(this.publish({...d,...s,id:a,title:r}),{...d,...s,id:a,dismissible:c,title:r}):d):this.addToast({title:r,...n,dismissible:c,id:a}),a},this.dismiss=s=>(this.dismissedToasts.add(s),s||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:s,dismiss:!0})),s),this.message=(s,t)=>this.create({...t,message:s}),this.error=(s,t)=>this.create({...t,message:s,type:"error"}),this.success=(s,t)=>this.create({...t,type:"success",message:s}),this.info=(s,t)=>this.create({...t,type:"info",message:s}),this.warning=(s,t)=>this.create({...t,type:"warning",message:s}),this.loading=(s,t)=>this.create({...t,type:"loading",message:s}),this.promise=(s,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:s,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let n=s instanceof Promise?s:s(),a=r!==void 0,l,c=n.then(async m=>{if(l=["resolve",m],ye.isValidElement(m))a=!1,this.create({id:r,type:"default",message:m});else if(rC(m)&&!m.ok){a=!1;let h=typeof t.error=="function"?await t.error(`HTTP error! status: ${m.status}`):t.error,f=typeof t.description=="function"?await t.description(`HTTP error! status: ${m.status}`):t.description;this.create({id:r,type:"error",message:h,description:f})}else if(t.success!==void 0){a=!1;let h=typeof t.success=="function"?await t.success(m):t.success,f=typeof t.description=="function"?await t.description(m):t.description;this.create({id:r,type:"success",message:h,description:f})}}).catch(async m=>{if(l=["reject",m],t.error!==void 0){a=!1;let h=typeof t.error=="function"?await t.error(m):t.error,f=typeof t.description=="function"?await t.description(m):t.description;this.create({id:r,type:"error",message:h,description:f})}}).finally(()=>{var m;a&&(this.dismiss(r),r=void 0),(m=t.finally)==null||m.call(t)}),d=()=>new Promise((m,h)=>c.then(()=>l[0]==="reject"?h(l[1]):m(l[1])).catch(h));return typeof r!="string"&&typeof r!="number"?{unwrap:d}:Object.assign(r,{unwrap:d})},this.custom=(s,t)=>{let r=t?.id||ym++;return this.create({jsx:s(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(s=>!this.dismissedToasts.has(s.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Ts=new tC,sC=(s,t)=>{let r=t?.id||ym++;return Ts.addToast({title:s,...t,id:r}),r},rC=s=>s&&typeof s=="object"&&"ok"in s&&typeof s.ok=="boolean"&&"status"in s&&typeof s.status=="number",nC=sC,iC=()=>Ts.toasts,aC=()=>Ts.getActiveToasts();Object.assign(nC,{success:Ts.success,info:Ts.info,warning:Ts.warning,error:Ts.error,custom:Ts.custom,message:Ts.message,promise:Ts.promise,dismiss:Ts.dismiss,loading:Ts.loading},{getHistory:iC,getToasts:aC});function oC(s,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=s:n.appendChild(document.createTextNode(s))}oC(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Ac(s){return s.label!==void 0}var lC=3,cC="32px",dC="16px",mv=4e3,uC=356,hC=14,mC=20,fC=200;function rr(...s){return s.filter(Boolean).join(" ")}function pC(s){let[t,r]=s.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var gC=s=>{var t,r,n,a,l,c,d,m,h,f,p;let{invert:w,toast:v,unstyled:j,interacting:y,setHeights:b,visibleToasts:C,heights:E,index:S,toasts:O,expanded:R,removeToast:k,defaultRichColors:P,closeButton:F,style:ee,cancelButtonStyle:ne,actionButtonStyle:pe,className:re="",descriptionClassName:H="",duration:G,position:ge,gap:ie,loadingIcon:xe,expandByDefault:X,classNames:te,icons:oe,closeButtonAriaLabel:W="Close toast",pauseWhenPageIsHidden:se}=s,[we,_e]=ye.useState(null),[Le,He]=ye.useState(null),[de,Ne]=ye.useState(!1),[Ve,Ye]=ye.useState(!1),[tt,ut]=ye.useState(!1),[gt,J]=ye.useState(!1),[ue,be]=ye.useState(!1),[Ce,je]=ye.useState(0),[ke,Je]=ye.useState(0),z=ye.useRef(v.duration||G||mv),me=ye.useRef(null),$e=ye.useRef(null),Re=S===0,Ge=S+1<=C,ae=v.type,le=v.dismissible!==!1,at=v.className||"",xt=v.descriptionClassName||"",We=ye.useMemo(()=>E.findIndex(Qe=>Qe.toastId===v.id)||0,[E,v.id]),Mr=ye.useMemo(()=>{var Qe;return(Qe=v.closeButton)!=null?Qe:F},[v.closeButton,F]),wl=ye.useMemo(()=>v.duration||G||mv,[v.duration,G]),$i=ye.useRef(0),Fr=ye.useRef(0),_l=ye.useRef(0),mr=ye.useRef(null),[Qa,Ja]=ge.split("-"),Li=ye.useMemo(()=>E.reduce((Qe,jt,bt)=>bt>=We?Qe:Qe+jt.height,0),[E,We]),Mi=eC(),un=v.invert||w,fr=ae==="loading";Fr.current=ye.useMemo(()=>We*ie+Li,[We,Li]),ye.useEffect(()=>{z.current=wl},[wl]),ye.useEffect(()=>{Ne(!0)},[]),ye.useEffect(()=>{let Qe=$e.current;if(Qe){let jt=Qe.getBoundingClientRect().height;return Je(jt),b(bt=>[{toastId:v.id,height:jt,position:v.position},...bt]),()=>b(bt=>bt.filter(hs=>hs.toastId!==v.id))}},[b,v.id]),ye.useLayoutEffect(()=>{if(!de)return;let Qe=$e.current,jt=Qe.style.height;Qe.style.height="auto";let bt=Qe.getBoundingClientRect().height;Qe.style.height=jt,Je(bt),b(hs=>hs.find(js=>js.toastId===v.id)?hs.map(js=>js.toastId===v.id?{...js,height:bt}:js):[{toastId:v.id,height:bt,position:v.position},...hs])},[de,v.title,v.description,b,v.id]);let Ys=ye.useCallback(()=>{Ye(!0),je(Fr.current),b(Qe=>Qe.filter(jt=>jt.toastId!==v.id)),setTimeout(()=>{k(v)},fC)},[v,k,b,Fr]);ye.useEffect(()=>{if(v.promise&&ae==="loading"||v.duration===1/0||v.type==="loading")return;let Qe;return R||y||se&&Mi?(()=>{if(_l.current<$i.current){let jt=new Date().getTime()-$i.current;z.current=z.current-jt}_l.current=new Date().getTime()})():z.current!==1/0&&($i.current=new Date().getTime(),Qe=setTimeout(()=>{var jt;(jt=v.onAutoClose)==null||jt.call(v,v),Ys()},z.current)),()=>clearTimeout(Qe)},[R,y,v,ae,se,Mi,Ys]),ye.useEffect(()=>{v.delete&&Ys()},[Ys,v.delete]);function bl(){var Qe,jt,bt;return oe!=null&&oe.loading?ye.createElement("div",{className:rr(te?.loader,(Qe=v?.classNames)==null?void 0:Qe.loader,"sonner-loader"),"data-visible":ae==="loading"},oe.loading):xe?ye.createElement("div",{className:rr(te?.loader,(jt=v?.classNames)==null?void 0:jt.loader,"sonner-loader"),"data-visible":ae==="loading"},xe):ye.createElement(YE,{className:rr(te?.loader,(bt=v?.classNames)==null?void 0:bt.loader),visible:ae==="loading"})}return ye.createElement("li",{tabIndex:0,ref:$e,className:rr(re,at,te?.toast,(t=v?.classNames)==null?void 0:t.toast,te?.default,te?.[ae],(r=v?.classNames)==null?void 0:r[ae]),"data-sonner-toast":"","data-rich-colors":(n=v.richColors)!=null?n:P,"data-styled":!(v.jsx||v.unstyled||j),"data-mounted":de,"data-promise":!!v.promise,"data-swiped":ue,"data-removed":Ve,"data-visible":Ge,"data-y-position":Qa,"data-x-position":Ja,"data-index":S,"data-front":Re,"data-swiping":tt,"data-dismissible":le,"data-type":ae,"data-invert":un,"data-swipe-out":gt,"data-swipe-direction":Le,"data-expanded":!!(R||X&&de),style:{"--index":S,"--toasts-before":S,"--z-index":O.length-S,"--offset":`${Ve?Ce:Fr.current}px`,"--initial-height":X?"auto":`${ke}px`,...ee,...v.style},onDragEnd:()=>{ut(!1),_e(null),mr.current=null},onPointerDown:Qe=>{fr||!le||(me.current=new Date,je(Fr.current),Qe.target.setPointerCapture(Qe.pointerId),Qe.target.tagName!=="BUTTON"&&(ut(!0),mr.current={x:Qe.clientX,y:Qe.clientY}))},onPointerUp:()=>{var Qe,jt,bt,hs;if(gt||!le)return;mr.current=null;let js=Number(((Qe=$e.current)==null?void 0:Qe.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),ws=Number(((jt=$e.current)==null?void 0:jt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Ks=new Date().getTime()-((bt=me.current)==null?void 0:bt.getTime()),ss=we==="x"?js:ws,pr=Math.abs(ss)/Ks;if(Math.abs(ss)>=mC||pr>.11){je(Fr.current),(hs=v.onDismiss)==null||hs.call(v,v),He(we==="x"?js>0?"right":"left":ws>0?"down":"up"),Ys(),J(!0),be(!1);return}ut(!1),_e(null)},onPointerMove:Qe=>{var jt,bt,hs,js;if(!mr.current||!le||((jt=window.getSelection())==null?void 0:jt.toString().length)>0)return;let ws=Qe.clientY-mr.current.y,Ks=Qe.clientX-mr.current.x,ss=(bt=s.swipeDirections)!=null?bt:pC(ge);!we&&(Math.abs(Ks)>1||Math.abs(ws)>1)&&_e(Math.abs(Ks)>Math.abs(ws)?"x":"y");let pr={x:0,y:0};we==="y"?(ss.includes("top")||ss.includes("bottom"))&&(ss.includes("top")&&ws<0||ss.includes("bottom")&&ws>0)&&(pr.y=ws):we==="x"&&(ss.includes("left")||ss.includes("right"))&&(ss.includes("left")&&Ks<0||ss.includes("right")&&Ks>0)&&(pr.x=Ks),(Math.abs(pr.x)>0||Math.abs(pr.y)>0)&&be(!0),(hs=$e.current)==null||hs.style.setProperty("--swipe-amount-x",`${pr.x}px`),(js=$e.current)==null||js.style.setProperty("--swipe-amount-y",`${pr.y}px`)}},Mr&&!v.jsx?ye.createElement("button",{"aria-label":W,"data-disabled":fr,"data-close-button":!0,onClick:fr||!le?()=>{}:()=>{var Qe;Ys(),(Qe=v.onDismiss)==null||Qe.call(v,v)},className:rr(te?.closeButton,(a=v?.classNames)==null?void 0:a.closeButton)},(l=oe?.close)!=null?l:ZE):null,v.jsx||x.isValidElement(v.title)?v.jsx?v.jsx:typeof v.title=="function"?v.title():v.title:ye.createElement(ye.Fragment,null,ae||v.icon||v.promise?ye.createElement("div",{"data-icon":"",className:rr(te?.icon,(c=v?.classNames)==null?void 0:c.icon)},v.promise||v.type==="loading"&&!v.icon?v.icon||bl():null,v.type!=="loading"?v.icon||oe?.[ae]||VE(ae):null):null,ye.createElement("div",{"data-content":"",className:rr(te?.content,(d=v?.classNames)==null?void 0:d.content)},ye.createElement("div",{"data-title":"",className:rr(te?.title,(m=v?.classNames)==null?void 0:m.title)},typeof v.title=="function"?v.title():v.title),v.description?ye.createElement("div",{"data-description":"",className:rr(H,xt,te?.description,(h=v?.classNames)==null?void 0:h.description)},typeof v.description=="function"?v.description():v.description):null),x.isValidElement(v.cancel)?v.cancel:v.cancel&&Ac(v.cancel)?ye.createElement("button",{"data-button":!0,"data-cancel":!0,style:v.cancelButtonStyle||ne,onClick:Qe=>{var jt,bt;Ac(v.cancel)&&le&&((bt=(jt=v.cancel).onClick)==null||bt.call(jt,Qe),Ys())},className:rr(te?.cancelButton,(f=v?.classNames)==null?void 0:f.cancelButton)},v.cancel.label):null,x.isValidElement(v.action)?v.action:v.action&&Ac(v.action)?ye.createElement("button",{"data-button":!0,"data-action":!0,style:v.actionButtonStyle||pe,onClick:Qe=>{var jt,bt;Ac(v.action)&&((bt=(jt=v.action).onClick)==null||bt.call(jt,Qe),!Qe.defaultPrevented&&Ys())},className:rr(te?.actionButton,(p=v?.classNames)==null?void 0:p.actionButton)},v.action.label):null))};function fv(){if(typeof window>"u"||typeof document>"u")return"ltr";let s=document.documentElement.getAttribute("dir");return s==="auto"||!s?window.getComputedStyle(document.documentElement).direction:s}function xC(s,t){let r={};return[s,t].forEach((n,a)=>{let l=a===1,c=l?"--mobile-offset":"--offset",d=l?dC:cC;function m(h){["top","right","bottom","left"].forEach(f=>{r[`${c}-${f}`]=typeof h=="number"?`${h}px`:h})}typeof n=="number"||typeof n=="string"?m(n):typeof n=="object"?["top","right","bottom","left"].forEach(h=>{n[h]===void 0?r[`${c}-${h}`]=d:r[`${c}-${h}`]=typeof n[h]=="number"?`${n[h]}px`:n[h]}):m(d)}),r}var vC=x.forwardRef(function(s,t){let{invert:r,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:l,closeButton:c,className:d,offset:m,mobileOffset:h,theme:f="light",richColors:p,duration:w,style:v,visibleToasts:j=lC,toastOptions:y,dir:b=fv(),gap:C=hC,loadingIcon:E,icons:S,containerAriaLabel:O="Notifications",pauseWhenPageIsHidden:R}=s,[k,P]=ye.useState([]),F=ye.useMemo(()=>Array.from(new Set([n].concat(k.filter(se=>se.position).map(se=>se.position)))),[k,n]),[ee,ne]=ye.useState([]),[pe,re]=ye.useState(!1),[H,G]=ye.useState(!1),[ge,ie]=ye.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),xe=ye.useRef(null),X=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),te=ye.useRef(null),oe=ye.useRef(!1),W=ye.useCallback(se=>{P(we=>{var _e;return(_e=we.find(Le=>Le.id===se.id))!=null&&_e.delete||Ts.dismiss(se.id),we.filter(({id:Le})=>Le!==se.id)})},[]);return ye.useEffect(()=>Ts.subscribe(se=>{if(se.dismiss){P(we=>we.map(_e=>_e.id===se.id?{..._e,delete:!0}:_e));return}setTimeout(()=>{qy.flushSync(()=>{P(we=>{let _e=we.findIndex(Le=>Le.id===se.id);return _e!==-1?[...we.slice(0,_e),{...we[_e],...se},...we.slice(_e+1)]:[se,...we]})})})}),[]),ye.useEffect(()=>{if(f!=="system"){ie(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ie("dark"):ie("light")),typeof window>"u")return;let se=window.matchMedia("(prefers-color-scheme: dark)");try{se.addEventListener("change",({matches:we})=>{ie(we?"dark":"light")})}catch{se.addListener(({matches:_e})=>{try{ie(_e?"dark":"light")}catch(Le){console.error(Le)}})}},[f]),ye.useEffect(()=>{k.length<=1&&re(!1)},[k]),ye.useEffect(()=>{let se=we=>{var _e,Le;a.every(He=>we[He]||we.code===He)&&(re(!0),(_e=xe.current)==null||_e.focus()),we.code==="Escape"&&(document.activeElement===xe.current||(Le=xe.current)!=null&&Le.contains(document.activeElement))&&re(!1)};return document.addEventListener("keydown",se),()=>document.removeEventListener("keydown",se)},[a]),ye.useEffect(()=>{if(xe.current)return()=>{te.current&&(te.current.focus({preventScroll:!0}),te.current=null,oe.current=!1)}},[xe.current]),ye.createElement("section",{ref:t,"aria-label":`${O} ${X}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},F.map((se,we)=>{var _e;let[Le,He]=se.split("-");return k.length?ye.createElement("ol",{key:se,dir:b==="auto"?fv():b,tabIndex:-1,ref:xe,className:d,"data-sonner-toaster":!0,"data-theme":ge,"data-y-position":Le,"data-lifted":pe&&k.length>1&&!l,"data-x-position":He,style:{"--front-toast-height":`${((_e=ee[0])==null?void 0:_e.height)||0}px`,"--width":`${uC}px`,"--gap":`${C}px`,...v,...xC(m,h)},onBlur:de=>{oe.current&&!de.currentTarget.contains(de.relatedTarget)&&(oe.current=!1,te.current&&(te.current.focus({preventScroll:!0}),te.current=null))},onFocus:de=>{de.target instanceof HTMLElement&&de.target.dataset.dismissible==="false"||oe.current||(oe.current=!0,te.current=de.relatedTarget)},onMouseEnter:()=>re(!0),onMouseMove:()=>re(!0),onMouseLeave:()=>{H||re(!1)},onDragEnd:()=>re(!1),onPointerDown:de=>{de.target instanceof HTMLElement&&de.target.dataset.dismissible==="false"||G(!0)},onPointerUp:()=>G(!1)},k.filter(de=>!de.position&&we===0||de.position===se).map((de,Ne)=>{var Ve,Ye;return ye.createElement(gC,{key:de.id,icons:S,index:Ne,toast:de,defaultRichColors:p,duration:(Ve=y?.duration)!=null?Ve:w,className:y?.className,descriptionClassName:y?.descriptionClassName,invert:r,visibleToasts:j,closeButton:(Ye=y?.closeButton)!=null?Ye:c,interacting:H,position:se,style:y?.style,unstyled:y?.unstyled,classNames:y?.classNames,cancelButtonStyle:y?.cancelButtonStyle,actionButtonStyle:y?.actionButtonStyle,removeToast:W,toasts:k.filter(tt=>tt.position==de.position),heights:ee.filter(tt=>tt.position==de.position),setHeights:ne,expandByDefault:l,gap:C,loadingIcon:E,expanded:pe,pauseWhenPageIsHidden:R,swipeDirections:s.swipeDirections})})):null}))});const yC=({...s})=>{const{theme:t="system"}=HE();return e.jsx(vC,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})};var jC=af[" useId ".trim().toString()]||(()=>{}),wC=0;function lr(s){const[t,r]=x.useState(jC());return Qt(()=>{r(n=>n??String(wC++))},[s]),t?`radix-${t}`:""}const _C=["top","right","bottom","left"],Gn=Math.min,Ds=Math.max,nd=Math.round,Dc=Math.floor,Cr=s=>({x:s,y:s}),bC={left:"right",right:"left",bottom:"top",top:"bottom"},NC={start:"end",end:"start"};function jm(s,t,r){return Ds(s,Gn(t,r))}function nn(s,t){return typeof s=="function"?s(t):s}function an(s){return s.split("-")[0]}function qa(s){return s.split("-")[1]}function yf(s){return s==="x"?"y":"x"}function jf(s){return s==="y"?"height":"width"}const SC=new Set(["top","bottom"]);function Nr(s){return SC.has(an(s))?"y":"x"}function wf(s){return yf(Nr(s))}function EC(s,t,r){r===void 0&&(r=!1);const n=qa(s),a=wf(s),l=jf(a);let c=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[l]>t.floating[l]&&(c=id(c)),[c,id(c)]}function CC(s){const t=id(s);return[wm(s),t,wm(t)]}function wm(s){return s.replace(/start|end/g,t=>NC[t])}const pv=["left","right"],gv=["right","left"],TC=["top","bottom"],kC=["bottom","top"];function OC(s,t,r){switch(s){case"top":case"bottom":return r?t?gv:pv:t?pv:gv;case"left":case"right":return t?TC:kC;default:return[]}}function RC(s,t,r,n){const a=qa(s);let l=OC(an(s),r==="start",n);return a&&(l=l.map(c=>c+"-"+a),t&&(l=l.concat(l.map(wm)))),l}function id(s){return s.replace(/left|right|bottom|top/g,t=>bC[t])}function PC(s){return{top:0,right:0,bottom:0,left:0,...s}}function k0(s){return typeof s!="number"?PC(s):{top:s,right:s,bottom:s,left:s}}function ad(s){const{x:t,y:r,width:n,height:a}=s;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function xv(s,t,r){let{reference:n,floating:a}=s;const l=Nr(t),c=wf(t),d=jf(c),m=an(t),h=l==="y",f=n.x+n.width/2-a.width/2,p=n.y+n.height/2-a.height/2,w=n[d]/2-a[d]/2;let v;switch(m){case"top":v={x:f,y:n.y-a.height};break;case"bottom":v={x:f,y:n.y+n.height};break;case"right":v={x:n.x+n.width,y:p};break;case"left":v={x:n.x-a.width,y:p};break;default:v={x:n.x,y:n.y}}switch(qa(t)){case"start":v[c]-=w*(r&&h?-1:1);break;case"end":v[c]+=w*(r&&h?-1:1);break}return v}const IC=async(s,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:l=[],platform:c}=r,d=l.filter(Boolean),m=await(c.isRTL==null?void 0:c.isRTL(t));let h=await c.getElementRects({reference:s,floating:t,strategy:a}),{x:f,y:p}=xv(h,n,m),w=n,v={},j=0;for(let y=0;y<d.length;y++){const{name:b,fn:C}=d[y],{x:E,y:S,data:O,reset:R}=await C({x:f,y:p,initialPlacement:n,placement:w,strategy:a,middlewareData:v,rects:h,platform:c,elements:{reference:s,floating:t}});f=E??f,p=S??p,v={...v,[b]:{...v[b],...O}},R&&j<=50&&(j++,typeof R=="object"&&(R.placement&&(w=R.placement),R.rects&&(h=R.rects===!0?await c.getElementRects({reference:s,floating:t,strategy:a}):R.rects),{x:f,y:p}=xv(h,w,m)),y=-1)}return{x:f,y:p,placement:w,strategy:a,middlewareData:v}};async function Yo(s,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:l,rects:c,elements:d,strategy:m}=s,{boundary:h="clippingAncestors",rootBoundary:f="viewport",elementContext:p="floating",altBoundary:w=!1,padding:v=0}=nn(t,s),j=k0(v),b=d[w?p==="floating"?"reference":"floating":p],C=ad(await l.getClippingRect({element:(r=await(l.isElement==null?void 0:l.isElement(b)))==null||r?b:b.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(d.floating)),boundary:h,rootBoundary:f,strategy:m})),E=p==="floating"?{x:n,y:a,width:c.floating.width,height:c.floating.height}:c.reference,S=await(l.getOffsetParent==null?void 0:l.getOffsetParent(d.floating)),O=await(l.isElement==null?void 0:l.isElement(S))?await(l.getScale==null?void 0:l.getScale(S))||{x:1,y:1}:{x:1,y:1},R=ad(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:d,rect:E,offsetParent:S,strategy:m}):E);return{top:(C.top-R.top+j.top)/O.y,bottom:(R.bottom-C.bottom+j.bottom)/O.y,left:(C.left-R.left+j.left)/O.x,right:(R.right-C.right+j.right)/O.x}}const AC=s=>({name:"arrow",options:s,async fn(t){const{x:r,y:n,placement:a,rects:l,platform:c,elements:d,middlewareData:m}=t,{element:h,padding:f=0}=nn(s,t)||{};if(h==null)return{};const p=k0(f),w={x:r,y:n},v=wf(a),j=jf(v),y=await c.getDimensions(h),b=v==="y",C=b?"top":"left",E=b?"bottom":"right",S=b?"clientHeight":"clientWidth",O=l.reference[j]+l.reference[v]-w[v]-l.floating[j],R=w[v]-l.reference[v],k=await(c.getOffsetParent==null?void 0:c.getOffsetParent(h));let P=k?k[S]:0;(!P||!await(c.isElement==null?void 0:c.isElement(k)))&&(P=d.floating[S]||l.floating[j]);const F=O/2-R/2,ee=P/2-y[j]/2-1,ne=Gn(p[C],ee),pe=Gn(p[E],ee),re=ne,H=P-y[j]-pe,G=P/2-y[j]/2+F,ge=jm(re,G,H),ie=!m.arrow&&qa(a)!=null&&G!==ge&&l.reference[j]/2-(G<re?ne:pe)-y[j]/2<0,xe=ie?G<re?G-re:G-H:0;return{[v]:w[v]+xe,data:{[v]:ge,centerOffset:G-ge-xe,...ie&&{alignmentOffset:xe}},reset:ie}}}),DC=function(s){return s===void 0&&(s={}),{name:"flip",options:s,async fn(t){var r,n;const{placement:a,middlewareData:l,rects:c,initialPlacement:d,platform:m,elements:h}=t,{mainAxis:f=!0,crossAxis:p=!0,fallbackPlacements:w,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:j="none",flipAlignment:y=!0,...b}=nn(s,t);if((r=l.arrow)!=null&&r.alignmentOffset)return{};const C=an(a),E=Nr(d),S=an(d)===d,O=await(m.isRTL==null?void 0:m.isRTL(h.floating)),R=w||(S||!y?[id(d)]:CC(d)),k=j!=="none";!w&&k&&R.push(...RC(d,y,j,O));const P=[d,...R],F=await Yo(t,b),ee=[];let ne=((n=l.flip)==null?void 0:n.overflows)||[];if(f&&ee.push(F[C]),p){const G=EC(a,c,O);ee.push(F[G[0]],F[G[1]])}if(ne=[...ne,{placement:a,overflows:ee}],!ee.every(G=>G<=0)){var pe,re;const G=(((pe=l.flip)==null?void 0:pe.index)||0)+1,ge=P[G];if(ge&&(!(p==="alignment"?E!==Nr(ge):!1)||ne.every(X=>Nr(X.placement)===E?X.overflows[0]>0:!0)))return{data:{index:G,overflows:ne},reset:{placement:ge}};let ie=(re=ne.filter(xe=>xe.overflows[0]<=0).sort((xe,X)=>xe.overflows[1]-X.overflows[1])[0])==null?void 0:re.placement;if(!ie)switch(v){case"bestFit":{var H;const xe=(H=ne.filter(X=>{if(k){const te=Nr(X.placement);return te===E||te==="y"}return!0}).map(X=>[X.placement,X.overflows.filter(te=>te>0).reduce((te,oe)=>te+oe,0)]).sort((X,te)=>X[1]-te[1])[0])==null?void 0:H[0];xe&&(ie=xe);break}case"initialPlacement":ie=d;break}if(a!==ie)return{reset:{placement:ie}}}return{}}}};function vv(s,t){return{top:s.top-t.height,right:s.right-t.width,bottom:s.bottom-t.height,left:s.left-t.width}}function yv(s){return _C.some(t=>s[t]>=0)}const $C=function(s){return s===void 0&&(s={}),{name:"hide",options:s,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=nn(s,t);switch(n){case"referenceHidden":{const l=await Yo(t,{...a,elementContext:"reference"}),c=vv(l,r.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:yv(c)}}}case"escaped":{const l=await Yo(t,{...a,altBoundary:!0}),c=vv(l,r.floating);return{data:{escapedOffsets:c,escaped:yv(c)}}}default:return{}}}}},O0=new Set(["left","top"]);async function LC(s,t){const{placement:r,platform:n,elements:a}=s,l=await(n.isRTL==null?void 0:n.isRTL(a.floating)),c=an(r),d=qa(r),m=Nr(r)==="y",h=O0.has(c)?-1:1,f=l&&m?-1:1,p=nn(t,s);let{mainAxis:w,crossAxis:v,alignmentAxis:j}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return d&&typeof j=="number"&&(v=d==="end"?j*-1:j),m?{x:v*f,y:w*h}:{x:w*h,y:v*f}}const MC=function(s){return s===void 0&&(s=0),{name:"offset",options:s,async fn(t){var r,n;const{x:a,y:l,placement:c,middlewareData:d}=t,m=await LC(t,s);return c===((r=d.offset)==null?void 0:r.placement)&&(n=d.arrow)!=null&&n.alignmentOffset?{}:{x:a+m.x,y:l+m.y,data:{...m,placement:c}}}}},FC=function(s){return s===void 0&&(s={}),{name:"shift",options:s,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:l=!0,crossAxis:c=!1,limiter:d={fn:b=>{let{x:C,y:E}=b;return{x:C,y:E}}},...m}=nn(s,t),h={x:r,y:n},f=await Yo(t,m),p=Nr(an(a)),w=yf(p);let v=h[w],j=h[p];if(l){const b=w==="y"?"top":"left",C=w==="y"?"bottom":"right",E=v+f[b],S=v-f[C];v=jm(E,v,S)}if(c){const b=p==="y"?"top":"left",C=p==="y"?"bottom":"right",E=j+f[b],S=j-f[C];j=jm(E,j,S)}const y=d.fn({...t,[w]:v,[p]:j});return{...y,data:{x:y.x-r,y:y.y-n,enabled:{[w]:l,[p]:c}}}}}},UC=function(s){return s===void 0&&(s={}),{options:s,fn(t){const{x:r,y:n,placement:a,rects:l,middlewareData:c}=t,{offset:d=0,mainAxis:m=!0,crossAxis:h=!0}=nn(s,t),f={x:r,y:n},p=Nr(a),w=yf(p);let v=f[w],j=f[p];const y=nn(d,t),b=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(m){const S=w==="y"?"height":"width",O=l.reference[w]-l.floating[S]+b.mainAxis,R=l.reference[w]+l.reference[S]-b.mainAxis;v<O?v=O:v>R&&(v=R)}if(h){var C,E;const S=w==="y"?"width":"height",O=O0.has(an(a)),R=l.reference[p]-l.floating[S]+(O&&((C=c.offset)==null?void 0:C[p])||0)+(O?0:b.crossAxis),k=l.reference[p]+l.reference[S]+(O?0:((E=c.offset)==null?void 0:E[p])||0)-(O?b.crossAxis:0);j<R?j=R:j>k&&(j=k)}return{[w]:v,[p]:j}}}},zC=function(s){return s===void 0&&(s={}),{name:"size",options:s,async fn(t){var r,n;const{placement:a,rects:l,platform:c,elements:d}=t,{apply:m=()=>{},...h}=nn(s,t),f=await Yo(t,h),p=an(a),w=qa(a),v=Nr(a)==="y",{width:j,height:y}=l.floating;let b,C;p==="top"||p==="bottom"?(b=p,C=w===(await(c.isRTL==null?void 0:c.isRTL(d.floating))?"start":"end")?"left":"right"):(C=p,b=w==="end"?"top":"bottom");const E=y-f.top-f.bottom,S=j-f.left-f.right,O=Gn(y-f[b],E),R=Gn(j-f[C],S),k=!t.middlewareData.shift;let P=O,F=R;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(F=S),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(P=E),k&&!w){const ne=Ds(f.left,0),pe=Ds(f.right,0),re=Ds(f.top,0),H=Ds(f.bottom,0);v?F=j-2*(ne!==0||pe!==0?ne+pe:Ds(f.left,f.right)):P=y-2*(re!==0||H!==0?re+H:Ds(f.top,f.bottom))}await m({...t,availableWidth:F,availableHeight:P});const ee=await c.getDimensions(d.floating);return j!==ee.width||y!==ee.height?{reset:{rects:!0}}:{}}}};function Td(){return typeof window<"u"}function Ha(s){return R0(s)?(s.nodeName||"").toLowerCase():"#document"}function Ms(s){var t;return(s==null||(t=s.ownerDocument)==null?void 0:t.defaultView)||window}function Dr(s){var t;return(t=(R0(s)?s.ownerDocument:s.document)||window.document)==null?void 0:t.documentElement}function R0(s){return Td()?s instanceof Node||s instanceof Ms(s).Node:!1}function cr(s){return Td()?s instanceof Element||s instanceof Ms(s).Element:!1}function Tr(s){return Td()?s instanceof HTMLElement||s instanceof Ms(s).HTMLElement:!1}function jv(s){return!Td()||typeof ShadowRoot>"u"?!1:s instanceof ShadowRoot||s instanceof Ms(s).ShadowRoot}const WC=new Set(["inline","contents"]);function cl(s){const{overflow:t,overflowX:r,overflowY:n,display:a}=dr(s);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!WC.has(a)}const BC=new Set(["table","td","th"]);function qC(s){return BC.has(Ha(s))}const HC=[":popover-open",":modal"];function kd(s){return HC.some(t=>{try{return s.matches(t)}catch{return!1}})}const VC=["transform","translate","scale","rotate","perspective"],GC=["transform","translate","scale","rotate","perspective","filter"],YC=["paint","layout","strict","content"];function _f(s){const t=bf(),r=cr(s)?dr(s):s;return VC.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||GC.some(n=>(r.willChange||"").includes(n))||YC.some(n=>(r.contain||"").includes(n))}function KC(s){let t=Yn(s);for(;Tr(t)&&!Ia(t);){if(_f(t))return t;if(kd(t))return null;t=Yn(t)}return null}function bf(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const XC=new Set(["html","body","#document"]);function Ia(s){return XC.has(Ha(s))}function dr(s){return Ms(s).getComputedStyle(s)}function Od(s){return cr(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:{scrollLeft:s.scrollX,scrollTop:s.scrollY}}function Yn(s){if(Ha(s)==="html")return s;const t=s.assignedSlot||s.parentNode||jv(s)&&s.host||Dr(s);return jv(t)?t.host:t}function P0(s){const t=Yn(s);return Ia(t)?s.ownerDocument?s.ownerDocument.body:s.body:Tr(t)&&cl(t)?t:P0(t)}function Ko(s,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=P0(s),l=a===((n=s.ownerDocument)==null?void 0:n.body),c=Ms(a);if(l){const d=_m(c);return t.concat(c,c.visualViewport||[],cl(a)?a:[],d&&r?Ko(d):[])}return t.concat(a,Ko(a,[],r))}function _m(s){return s.parent&&Object.getPrototypeOf(s.parent)?s.frameElement:null}function I0(s){const t=dr(s);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Tr(s),l=a?s.offsetWidth:r,c=a?s.offsetHeight:n,d=nd(r)!==l||nd(n)!==c;return d&&(r=l,n=c),{width:r,height:n,$:d}}function Nf(s){return cr(s)?s:s.contextElement}function ka(s){const t=Nf(s);if(!Tr(t))return Cr(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:l}=I0(t);let c=(l?nd(r.width):r.width)/n,d=(l?nd(r.height):r.height)/a;return(!c||!Number.isFinite(c))&&(c=1),(!d||!Number.isFinite(d))&&(d=1),{x:c,y:d}}const QC=Cr(0);function A0(s){const t=Ms(s);return!bf()||!t.visualViewport?QC:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function JC(s,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ms(s)?!1:t}function Ci(s,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=s.getBoundingClientRect(),l=Nf(s);let c=Cr(1);t&&(n?cr(n)&&(c=ka(n)):c=ka(s));const d=JC(l,r,n)?A0(l):Cr(0);let m=(a.left+d.x)/c.x,h=(a.top+d.y)/c.y,f=a.width/c.x,p=a.height/c.y;if(l){const w=Ms(l),v=n&&cr(n)?Ms(n):n;let j=w,y=_m(j);for(;y&&n&&v!==j;){const b=ka(y),C=y.getBoundingClientRect(),E=dr(y),S=C.left+(y.clientLeft+parseFloat(E.paddingLeft))*b.x,O=C.top+(y.clientTop+parseFloat(E.paddingTop))*b.y;m*=b.x,h*=b.y,f*=b.x,p*=b.y,m+=S,h+=O,j=Ms(y),y=_m(j)}}return ad({width:f,height:p,x:m,y:h})}function Rd(s,t){const r=Od(s).scrollLeft;return t?t.left+r:Ci(Dr(s)).left+r}function D0(s,t){const r=s.getBoundingClientRect(),n=r.left+t.scrollLeft-Rd(s,r),a=r.top+t.scrollTop;return{x:n,y:a}}function ZC(s){let{elements:t,rect:r,offsetParent:n,strategy:a}=s;const l=a==="fixed",c=Dr(n),d=t?kd(t.floating):!1;if(n===c||d&&l)return r;let m={scrollLeft:0,scrollTop:0},h=Cr(1);const f=Cr(0),p=Tr(n);if((p||!p&&!l)&&((Ha(n)!=="body"||cl(c))&&(m=Od(n)),Tr(n))){const v=Ci(n);h=ka(n),f.x=v.x+n.clientLeft,f.y=v.y+n.clientTop}const w=c&&!p&&!l?D0(c,m):Cr(0);return{width:r.width*h.x,height:r.height*h.y,x:r.x*h.x-m.scrollLeft*h.x+f.x+w.x,y:r.y*h.y-m.scrollTop*h.y+f.y+w.y}}function e2(s){return Array.from(s.getClientRects())}function t2(s){const t=Dr(s),r=Od(s),n=s.ownerDocument.body,a=Ds(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),l=Ds(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let c=-r.scrollLeft+Rd(s);const d=-r.scrollTop;return dr(n).direction==="rtl"&&(c+=Ds(t.clientWidth,n.clientWidth)-a),{width:a,height:l,x:c,y:d}}const wv=25;function s2(s,t){const r=Ms(s),n=Dr(s),a=r.visualViewport;let l=n.clientWidth,c=n.clientHeight,d=0,m=0;if(a){l=a.width,c=a.height;const f=bf();(!f||f&&t==="fixed")&&(d=a.offsetLeft,m=a.offsetTop)}const h=Rd(n);if(h<=0){const f=n.ownerDocument,p=f.body,w=getComputedStyle(p),v=f.compatMode==="CSS1Compat"&&parseFloat(w.marginLeft)+parseFloat(w.marginRight)||0,j=Math.abs(n.clientWidth-p.clientWidth-v);j<=wv&&(l-=j)}else h<=wv&&(l+=h);return{width:l,height:c,x:d,y:m}}const r2=new Set(["absolute","fixed"]);function n2(s,t){const r=Ci(s,!0,t==="fixed"),n=r.top+s.clientTop,a=r.left+s.clientLeft,l=Tr(s)?ka(s):Cr(1),c=s.clientWidth*l.x,d=s.clientHeight*l.y,m=a*l.x,h=n*l.y;return{width:c,height:d,x:m,y:h}}function _v(s,t,r){let n;if(t==="viewport")n=s2(s,r);else if(t==="document")n=t2(Dr(s));else if(cr(t))n=n2(t,r);else{const a=A0(s);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return ad(n)}function $0(s,t){const r=Yn(s);return r===t||!cr(r)||Ia(r)?!1:dr(r).position==="fixed"||$0(r,t)}function i2(s,t){const r=t.get(s);if(r)return r;let n=Ko(s,[],!1).filter(d=>cr(d)&&Ha(d)!=="body"),a=null;const l=dr(s).position==="fixed";let c=l?Yn(s):s;for(;cr(c)&&!Ia(c);){const d=dr(c),m=_f(c);!m&&d.position==="fixed"&&(a=null),(l?!m&&!a:!m&&d.position==="static"&&!!a&&r2.has(a.position)||cl(c)&&!m&&$0(s,c))?n=n.filter(f=>f!==c):a=d,c=Yn(c)}return t.set(s,n),n}function a2(s){let{element:t,boundary:r,rootBoundary:n,strategy:a}=s;const c=[...r==="clippingAncestors"?kd(t)?[]:i2(t,this._c):[].concat(r),n],d=c[0],m=c.reduce((h,f)=>{const p=_v(t,f,a);return h.top=Ds(p.top,h.top),h.right=Gn(p.right,h.right),h.bottom=Gn(p.bottom,h.bottom),h.left=Ds(p.left,h.left),h},_v(t,d,a));return{width:m.right-m.left,height:m.bottom-m.top,x:m.left,y:m.top}}function o2(s){const{width:t,height:r}=I0(s);return{width:t,height:r}}function l2(s,t,r){const n=Tr(t),a=Dr(t),l=r==="fixed",c=Ci(s,!0,l,t);let d={scrollLeft:0,scrollTop:0};const m=Cr(0);function h(){m.x=Rd(a)}if(n||!n&&!l)if((Ha(t)!=="body"||cl(a))&&(d=Od(t)),n){const v=Ci(t,!0,l,t);m.x=v.x+t.clientLeft,m.y=v.y+t.clientTop}else a&&h();l&&!n&&a&&h();const f=a&&!n&&!l?D0(a,d):Cr(0),p=c.left+d.scrollLeft-m.x-f.x,w=c.top+d.scrollTop-m.y-f.y;return{x:p,y:w,width:c.width,height:c.height}}function Vh(s){return dr(s).position==="static"}function bv(s,t){if(!Tr(s)||dr(s).position==="fixed")return null;if(t)return t(s);let r=s.offsetParent;return Dr(s)===r&&(r=r.ownerDocument.body),r}function L0(s,t){const r=Ms(s);if(kd(s))return r;if(!Tr(s)){let a=Yn(s);for(;a&&!Ia(a);){if(cr(a)&&!Vh(a))return a;a=Yn(a)}return r}let n=bv(s,t);for(;n&&qC(n)&&Vh(n);)n=bv(n,t);return n&&Ia(n)&&Vh(n)&&!_f(n)?r:n||KC(s)||r}const c2=async function(s){const t=this.getOffsetParent||L0,r=this.getDimensions,n=await r(s.floating);return{reference:l2(s.reference,await t(s.floating),s.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function d2(s){return dr(s).direction==="rtl"}const u2={convertOffsetParentRelativeRectToViewportRelativeRect:ZC,getDocumentElement:Dr,getClippingRect:a2,getOffsetParent:L0,getElementRects:c2,getClientRects:e2,getDimensions:o2,getScale:ka,isElement:cr,isRTL:d2};function M0(s,t){return s.x===t.x&&s.y===t.y&&s.width===t.width&&s.height===t.height}function h2(s,t){let r=null,n;const a=Dr(s);function l(){var d;clearTimeout(n),(d=r)==null||d.disconnect(),r=null}function c(d,m){d===void 0&&(d=!1),m===void 0&&(m=1),l();const h=s.getBoundingClientRect(),{left:f,top:p,width:w,height:v}=h;if(d||t(),!w||!v)return;const j=Dc(p),y=Dc(a.clientWidth-(f+w)),b=Dc(a.clientHeight-(p+v)),C=Dc(f),S={rootMargin:-j+"px "+-y+"px "+-b+"px "+-C+"px",threshold:Ds(0,Gn(1,m))||1};let O=!0;function R(k){const P=k[0].intersectionRatio;if(P!==m){if(!O)return c();P?c(!1,P):n=setTimeout(()=>{c(!1,1e-7)},1e3)}P===1&&!M0(h,s.getBoundingClientRect())&&c(),O=!1}try{r=new IntersectionObserver(R,{...S,root:a.ownerDocument})}catch{r=new IntersectionObserver(R,S)}r.observe(s)}return c(!0),l}function m2(s,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:m=!1}=n,h=Nf(s),f=a||l?[...h?Ko(h):[],...Ko(t)]:[];f.forEach(C=>{a&&C.addEventListener("scroll",r,{passive:!0}),l&&C.addEventListener("resize",r)});const p=h&&d?h2(h,r):null;let w=-1,v=null;c&&(v=new ResizeObserver(C=>{let[E]=C;E&&E.target===h&&v&&(v.unobserve(t),cancelAnimationFrame(w),w=requestAnimationFrame(()=>{var S;(S=v)==null||S.observe(t)})),r()}),h&&!m&&v.observe(h),v.observe(t));let j,y=m?Ci(s):null;m&&b();function b(){const C=Ci(s);y&&!M0(y,C)&&r(),y=C,j=requestAnimationFrame(b)}return r(),()=>{var C;f.forEach(E=>{a&&E.removeEventListener("scroll",r),l&&E.removeEventListener("resize",r)}),p?.(),(C=v)==null||C.disconnect(),v=null,m&&cancelAnimationFrame(j)}}const f2=MC,p2=FC,g2=DC,x2=zC,v2=$C,Nv=AC,y2=UC,j2=(s,t,r)=>{const n=new Map,a={platform:u2,...r},l={...a.platform,_c:n};return IC(s,t,{...a,platform:l})};var w2=typeof document<"u",_2=function(){},Qc=w2?x.useLayoutEffect:_2;function od(s,t){if(s===t)return!0;if(typeof s!=typeof t)return!1;if(typeof s=="function"&&s.toString()===t.toString())return!0;let r,n,a;if(s&&t&&typeof s=="object"){if(Array.isArray(s)){if(r=s.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!od(s[n],t[n]))return!1;return!0}if(a=Object.keys(s),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const l=a[n];if(!(l==="_owner"&&s.$$typeof)&&!od(s[l],t[l]))return!1}return!0}return s!==s&&t!==t}function F0(s){return typeof window>"u"?1:(s.ownerDocument.defaultView||window).devicePixelRatio||1}function Sv(s,t){const r=F0(s);return Math.round(t*r)/r}function Gh(s){const t=x.useRef(s);return Qc(()=>{t.current=s}),t}function b2(s){s===void 0&&(s={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:l,floating:c}={},transform:d=!0,whileElementsMounted:m,open:h}=s,[f,p]=x.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[w,v]=x.useState(n);od(w,n)||v(n);const[j,y]=x.useState(null),[b,C]=x.useState(null),E=x.useCallback(X=>{X!==k.current&&(k.current=X,y(X))},[]),S=x.useCallback(X=>{X!==P.current&&(P.current=X,C(X))},[]),O=l||j,R=c||b,k=x.useRef(null),P=x.useRef(null),F=x.useRef(f),ee=m!=null,ne=Gh(m),pe=Gh(a),re=Gh(h),H=x.useCallback(()=>{if(!k.current||!P.current)return;const X={placement:t,strategy:r,middleware:w};pe.current&&(X.platform=pe.current),j2(k.current,P.current,X).then(te=>{const oe={...te,isPositioned:re.current!==!1};G.current&&!od(F.current,oe)&&(F.current=oe,Ua.flushSync(()=>{p(oe)}))})},[w,t,r,pe,re]);Qc(()=>{h===!1&&F.current.isPositioned&&(F.current.isPositioned=!1,p(X=>({...X,isPositioned:!1})))},[h]);const G=x.useRef(!1);Qc(()=>(G.current=!0,()=>{G.current=!1}),[]),Qc(()=>{if(O&&(k.current=O),R&&(P.current=R),O&&R){if(ne.current)return ne.current(O,R,H);H()}},[O,R,H,ne,ee]);const ge=x.useMemo(()=>({reference:k,floating:P,setReference:E,setFloating:S}),[E,S]),ie=x.useMemo(()=>({reference:O,floating:R}),[O,R]),xe=x.useMemo(()=>{const X={position:r,left:0,top:0};if(!ie.floating)return X;const te=Sv(ie.floating,f.x),oe=Sv(ie.floating,f.y);return d?{...X,transform:"translate("+te+"px, "+oe+"px)",...F0(ie.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:te,top:oe}},[r,d,ie.floating,f.x,f.y]);return x.useMemo(()=>({...f,update:H,refs:ge,elements:ie,floatingStyles:xe}),[f,H,ge,ie,xe])}const N2=s=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:s,fn(r){const{element:n,padding:a}=typeof s=="function"?s(r):s;return n&&t(n)?n.current!=null?Nv({element:n.current,padding:a}).fn(r):{}:n?Nv({element:n,padding:a}).fn(r):{}}}},S2=(s,t)=>({...f2(s),options:[s,t]}),E2=(s,t)=>({...p2(s),options:[s,t]}),C2=(s,t)=>({...y2(s),options:[s,t]}),T2=(s,t)=>({...g2(s),options:[s,t]}),k2=(s,t)=>({...x2(s),options:[s,t]}),O2=(s,t)=>({...v2(s),options:[s,t]}),R2=(s,t)=>({...N2(s),options:[s,t]});var P2="Arrow",U0=x.forwardRef((s,t)=>{const{children:r,width:n=10,height:a=5,...l}=s;return e.jsx(ze.svg,{...l,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:s.asChild?r:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});U0.displayName=P2;var I2=U0;function A2(s){const[t,r]=x.useState(void 0);return Qt(()=>{if(s){r({width:s.offsetWidth,height:s.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const l=a[0];let c,d;if("borderBoxSize"in l){const m=l.borderBoxSize,h=Array.isArray(m)?m[0]:m;c=h.inlineSize,d=h.blockSize}else c=s.offsetWidth,d=s.offsetHeight;r({width:c,height:d})});return n.observe(s,{box:"border-box"}),()=>n.unobserve(s)}else r(void 0)},[s]),t}var Sf="Popper",[z0,Va]=Vs(Sf),[D2,W0]=z0(Sf),B0=s=>{const{__scopePopper:t,children:r}=s,[n,a]=x.useState(null);return e.jsx(D2,{scope:t,anchor:n,onAnchorChange:a,children:r})};B0.displayName=Sf;var q0="PopperAnchor",H0=x.forwardRef((s,t)=>{const{__scopePopper:r,virtualRef:n,...a}=s,l=W0(q0,r),c=x.useRef(null),d=pt(t,c),m=x.useRef(null);return x.useEffect(()=>{const h=m.current;m.current=n?.current||c.current,h!==m.current&&l.onAnchorChange(m.current)}),n?null:e.jsx(ze.div,{...a,ref:d})});H0.displayName=q0;var Ef="PopperContent",[$2,L2]=z0(Ef),V0=x.forwardRef((s,t)=>{const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:l="center",alignOffset:c=0,arrowPadding:d=0,avoidCollisions:m=!0,collisionBoundary:h=[],collisionPadding:f=0,sticky:p="partial",hideWhenDetached:w=!1,updatePositionStrategy:v="optimized",onPlaced:j,...y}=s,b=W0(Ef,r),[C,E]=x.useState(null),S=pt(t,de=>E(de)),[O,R]=x.useState(null),k=A2(O),P=k?.width??0,F=k?.height??0,ee=n+(l!=="center"?"-"+l:""),ne=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},pe=Array.isArray(h)?h:[h],re=pe.length>0,H={padding:ne,boundary:pe.filter(F2),altBoundary:re},{refs:G,floatingStyles:ge,placement:ie,isPositioned:xe,middlewareData:X}=b2({strategy:"fixed",placement:ee,whileElementsMounted:(...de)=>m2(...de,{animationFrame:v==="always"}),elements:{reference:b.anchor},middleware:[S2({mainAxis:a+F,alignmentAxis:c}),m&&E2({mainAxis:!0,crossAxis:!1,limiter:p==="partial"?C2():void 0,...H}),m&&T2({...H}),k2({...H,apply:({elements:de,rects:Ne,availableWidth:Ve,availableHeight:Ye})=>{const{width:tt,height:ut}=Ne.reference,gt=de.floating.style;gt.setProperty("--radix-popper-available-width",`${Ve}px`),gt.setProperty("--radix-popper-available-height",`${Ye}px`),gt.setProperty("--radix-popper-anchor-width",`${tt}px`),gt.setProperty("--radix-popper-anchor-height",`${ut}px`)}}),O&&R2({element:O,padding:d}),U2({arrowWidth:P,arrowHeight:F}),w&&O2({strategy:"referenceHidden",...H})]}),[te,oe]=K0(ie),W=Xt(j);Qt(()=>{xe&&W?.()},[xe,W]);const se=X.arrow?.x,we=X.arrow?.y,_e=X.arrow?.centerOffset!==0,[Le,He]=x.useState();return Qt(()=>{C&&He(window.getComputedStyle(C).zIndex)},[C]),e.jsx("div",{ref:G.setFloating,"data-radix-popper-content-wrapper":"",style:{...ge,transform:xe?ge.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Le,"--radix-popper-transform-origin":[X.transformOrigin?.x,X.transformOrigin?.y].join(" "),...X.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:s.dir,children:e.jsx($2,{scope:r,placedSide:te,onArrowChange:R,arrowX:se,arrowY:we,shouldHideArrow:_e,children:e.jsx(ze.div,{"data-side":te,"data-align":oe,...y,ref:S,style:{...y.style,animation:xe?void 0:"none"}})})})});V0.displayName=Ef;var G0="PopperArrow",M2={top:"bottom",right:"left",bottom:"top",left:"right"},Y0=x.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,l=L2(G0,n),c=M2[l.placedSide];return e.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:e.jsx(I2,{...a,ref:r,style:{...a.style,display:"block"}})})});Y0.displayName=G0;function F2(s){return s!==null}var U2=s=>({name:"transformOrigin",options:s,fn(t){const{placement:r,rects:n,middlewareData:a}=t,c=a.arrow?.centerOffset!==0,d=c?0:s.arrowWidth,m=c?0:s.arrowHeight,[h,f]=K0(r),p={start:"0%",center:"50%",end:"100%"}[f],w=(a.arrow?.x??0)+d/2,v=(a.arrow?.y??0)+m/2;let j="",y="";return h==="bottom"?(j=c?p:`${w}px`,y=`${-m}px`):h==="top"?(j=c?p:`${w}px`,y=`${n.floating.height+m}px`):h==="right"?(j=`${-m}px`,y=c?p:`${v}px`):h==="left"&&(j=`${n.floating.width+m}px`,y=c?p:`${v}px`),{data:{x:j,y}}}});function K0(s){const[t,r="center"]=s.split("-");return[t,r]}var Cf=B0,Pd=H0,Tf=V0,kf=Y0,[Id,LL]=Vs("Tooltip",[Va]),Ad=Va(),X0="TooltipProvider",z2=700,bm="tooltip.open",[W2,Of]=Id(X0),Q0=s=>{const{__scopeTooltip:t,delayDuration:r=z2,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:l}=s,c=x.useRef(!0),d=x.useRef(!1),m=x.useRef(0);return x.useEffect(()=>{const h=m.current;return()=>window.clearTimeout(h)},[]),e.jsx(W2,{scope:t,isOpenDelayedRef:c,delayDuration:r,onOpen:x.useCallback(()=>{window.clearTimeout(m.current),c.current=!1},[]),onClose:x.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>c.current=!0,n)},[n]),isPointerInTransitRef:d,onPointerInTransitChange:x.useCallback(h=>{d.current=h},[]),disableHoverableContent:a,children:l})};Q0.displayName=X0;var Xo="Tooltip",[B2,Dd]=Id(Xo),J0=s=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a,onOpenChange:l,disableHoverableContent:c,delayDuration:d}=s,m=Of(Xo,s.__scopeTooltip),h=Ad(t),[f,p]=x.useState(null),w=lr(),v=x.useRef(0),j=c??m.disableHoverableContent,y=d??m.delayDuration,b=x.useRef(!1),[C,E]=en({prop:n,defaultProp:a??!1,onChange:P=>{P?(m.onOpen(),document.dispatchEvent(new CustomEvent(bm))):m.onClose(),l?.(P)},caller:Xo}),S=x.useMemo(()=>C?b.current?"delayed-open":"instant-open":"closed",[C]),O=x.useCallback(()=>{window.clearTimeout(v.current),v.current=0,b.current=!1,E(!0)},[E]),R=x.useCallback(()=>{window.clearTimeout(v.current),v.current=0,E(!1)},[E]),k=x.useCallback(()=>{window.clearTimeout(v.current),v.current=window.setTimeout(()=>{b.current=!0,E(!0),v.current=0},y)},[y,E]);return x.useEffect(()=>()=>{v.current&&(window.clearTimeout(v.current),v.current=0)},[]),e.jsx(Cf,{...h,children:e.jsx(B2,{scope:t,contentId:w,open:C,stateAttribute:S,trigger:f,onTriggerChange:p,onTriggerEnter:x.useCallback(()=>{m.isOpenDelayedRef.current?k():O()},[m.isOpenDelayedRef,k,O]),onTriggerLeave:x.useCallback(()=>{j?R():(window.clearTimeout(v.current),v.current=0)},[R,j]),onOpen:O,onClose:R,disableHoverableContent:j,children:r})})};J0.displayName=Xo;var Nm="TooltipTrigger",Z0=x.forwardRef((s,t)=>{const{__scopeTooltip:r,...n}=s,a=Dd(Nm,r),l=Of(Nm,r),c=Ad(r),d=x.useRef(null),m=pt(t,d,a.onTriggerChange),h=x.useRef(!1),f=x.useRef(!1),p=x.useCallback(()=>h.current=!1,[]);return x.useEffect(()=>()=>document.removeEventListener("pointerup",p),[p]),e.jsx(Pd,{asChild:!0,...c,children:e.jsx(ze.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:m,onPointerMove:Pe(s.onPointerMove,w=>{w.pointerType!=="touch"&&!f.current&&!l.isPointerInTransitRef.current&&(a.onTriggerEnter(),f.current=!0)}),onPointerLeave:Pe(s.onPointerLeave,()=>{a.onTriggerLeave(),f.current=!1}),onPointerDown:Pe(s.onPointerDown,()=>{a.open&&a.onClose(),h.current=!0,document.addEventListener("pointerup",p,{once:!0})}),onFocus:Pe(s.onFocus,()=>{h.current||a.onOpen()}),onBlur:Pe(s.onBlur,a.onClose),onClick:Pe(s.onClick,a.onClose)})})});Z0.displayName=Nm;var q2="TooltipPortal",[ML,H2]=Id(q2,{forceMount:void 0}),Aa="TooltipContent",ej=x.forwardRef((s,t)=>{const r=H2(Aa,s.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...l}=s,c=Dd(Aa,s.__scopeTooltip);return e.jsx(ks,{present:n||c.open,children:c.disableHoverableContent?e.jsx(tj,{side:a,...l,ref:t}):e.jsx(V2,{side:a,...l,ref:t})})}),V2=x.forwardRef((s,t)=>{const r=Dd(Aa,s.__scopeTooltip),n=Of(Aa,s.__scopeTooltip),a=x.useRef(null),l=pt(t,a),[c,d]=x.useState(null),{trigger:m,onClose:h}=r,f=a.current,{onPointerInTransitChange:p}=n,w=x.useCallback(()=>{d(null),p(!1)},[p]),v=x.useCallback((j,y)=>{const b=j.currentTarget,C={x:j.clientX,y:j.clientY},E=Q2(C,b.getBoundingClientRect()),S=J2(C,E),O=Z2(y.getBoundingClientRect()),R=tT([...S,...O]);d(R),p(!0)},[p]);return x.useEffect(()=>()=>w(),[w]),x.useEffect(()=>{if(m&&f){const j=b=>v(b,f),y=b=>v(b,m);return m.addEventListener("pointerleave",j),f.addEventListener("pointerleave",y),()=>{m.removeEventListener("pointerleave",j),f.removeEventListener("pointerleave",y)}}},[m,f,v,w]),x.useEffect(()=>{if(c){const j=y=>{const b=y.target,C={x:y.clientX,y:y.clientY},E=m?.contains(b)||f?.contains(b),S=!eT(C,c);E?w():S&&(w(),h())};return document.addEventListener("pointermove",j),()=>document.removeEventListener("pointermove",j)}},[m,f,c,h,w]),e.jsx(tj,{...s,ref:l})}),[G2,Y2]=Id(Xo,{isInside:!1}),K2=t1("TooltipContent"),tj=x.forwardRef((s,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:l,onPointerDownOutside:c,...d}=s,m=Dd(Aa,r),h=Ad(r),{onClose:f}=m;return x.useEffect(()=>(document.addEventListener(bm,f),()=>document.removeEventListener(bm,f)),[f]),x.useEffect(()=>{if(m.trigger){const p=w=>{w.target?.contains(m.trigger)&&f()};return window.addEventListener("scroll",p,{capture:!0}),()=>window.removeEventListener("scroll",p,{capture:!0})}},[m.trigger,f]),e.jsx(za,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:p=>p.preventDefault(),onDismiss:f,children:e.jsxs(Tf,{"data-state":m.stateAttribute,...h,...d,ref:t,style:{...d.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(K2,{children:n}),e.jsx(G2,{scope:r,isInside:!0,children:e.jsx(b1,{id:m.contentId,role:"tooltip",children:a||n})})]})})});ej.displayName=Aa;var sj="TooltipArrow",X2=x.forwardRef((s,t)=>{const{__scopeTooltip:r,...n}=s,a=Ad(r);return Y2(sj,r).isInside?null:e.jsx(kf,{...a,...n,ref:t})});X2.displayName=sj;function Q2(s,t){const r=Math.abs(t.top-s.y),n=Math.abs(t.bottom-s.y),a=Math.abs(t.right-s.x),l=Math.abs(t.left-s.x);switch(Math.min(r,n,a,l)){case l:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function J2(s,t,r=5){const n=[];switch(t){case"top":n.push({x:s.x-r,y:s.y+r},{x:s.x+r,y:s.y+r});break;case"bottom":n.push({x:s.x-r,y:s.y-r},{x:s.x+r,y:s.y-r});break;case"left":n.push({x:s.x+r,y:s.y-r},{x:s.x+r,y:s.y+r});break;case"right":n.push({x:s.x-r,y:s.y-r},{x:s.x-r,y:s.y+r});break}return n}function Z2(s){const{top:t,right:r,bottom:n,left:a}=s;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function eT(s,t){const{x:r,y:n}=s;let a=!1;for(let l=0,c=t.length-1;l<t.length;c=l++){const d=t[l],m=t[c],h=d.x,f=d.y,p=m.x,w=m.y;f>n!=w>n&&r<(p-h)*(n-f)/(w-f)+h&&(a=!a)}return a}function tT(s){const t=s.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),sT(t)}function sT(s){if(s.length<=1)return s.slice();const t=[];for(let n=0;n<s.length;n++){const a=s[n];for(;t.length>=2;){const l=t[t.length-1],c=t[t.length-2];if((l.x-c.x)*(a.y-c.y)>=(l.y-c.y)*(a.x-c.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=s.length-1;n>=0;n--){const a=s[n];for(;r.length>=2;){const l=r[r.length-1],c=r[r.length-2];if((l.x-c.x)*(a.y-c.y)>=(l.y-c.y)*(a.x-c.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var rT=Q0,nT=J0,iT=Z0,rj=ej;const Rf=rT,nj=nT,ij=iT,Pf=x.forwardRef(({className:s,sideOffset:t=4,...r},n)=>e.jsx(rj,{ref:n,sideOffset:t,className:Ue("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r}));Pf.displayName=rj.displayName;var $d=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Ld=typeof window>"u"||"Deno"in globalThis;function ar(){}function aT(s,t){return typeof s=="function"?s(t):s}function oT(s){return typeof s=="number"&&s>=0&&s!==1/0}function lT(s,t){return Math.max(s+(t||0)-Date.now(),0)}function Sm(s,t){return typeof s=="function"?s(t):s}function cT(s,t){return typeof s=="function"?s(t):s}function Ev(s,t){const{type:r="all",exact:n,fetchStatus:a,predicate:l,queryKey:c,stale:d}=s;if(c){if(n){if(t.queryHash!==If(c,t.options))return!1}else if(!Jo(t.queryKey,c))return!1}if(r!=="all"){const m=t.isActive();if(r==="active"&&!m||r==="inactive"&&m)return!1}return!(typeof d=="boolean"&&t.isStale()!==d||a&&a!==t.state.fetchStatus||l&&!l(t))}function Cv(s,t){const{exact:r,status:n,predicate:a,mutationKey:l}=s;if(l){if(!t.options.mutationKey)return!1;if(r){if(Qo(t.options.mutationKey)!==Qo(l))return!1}else if(!Jo(t.options.mutationKey,l))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function If(s,t){return(t?.queryKeyHashFn||Qo)(s)}function Qo(s){return JSON.stringify(s,(t,r)=>Em(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function Jo(s,t){return s===t?!0:typeof s!=typeof t?!1:s&&t&&typeof s=="object"&&typeof t=="object"?Object.keys(t).every(r=>Jo(s[r],t[r])):!1}function aj(s,t){if(s===t)return s;const r=Tv(s)&&Tv(t);if(r||Em(s)&&Em(t)){const n=r?s:Object.keys(s),a=n.length,l=r?t:Object.keys(t),c=l.length,d=r?[]:{},m=new Set(n);let h=0;for(let f=0;f<c;f++){const p=r?f:l[f];(!r&&m.has(p)||r)&&s[p]===void 0&&t[p]===void 0?(d[p]=void 0,h++):(d[p]=aj(s[p],t[p]),d[p]===s[p]&&s[p]!==void 0&&h++)}return a===c&&h===a?s:d}return t}function Tv(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function Em(s){if(!kv(s))return!1;const t=s.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!kv(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function kv(s){return Object.prototype.toString.call(s)==="[object Object]"}function dT(s){return new Promise(t=>{setTimeout(t,s)})}function uT(s,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(s,t):r.structuralSharing!==!1?aj(s,t):t}function hT(s,t,r=0){const n=[...s,t];return r&&n.length>r?n.slice(1):n}function mT(s,t,r=0){const n=[t,...s];return r&&n.length>r?n.slice(0,-1):n}var Af=Symbol();function oj(s,t){return!s.queryFn&&t?.initialPromise?()=>t.initialPromise:!s.queryFn||s.queryFn===Af?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}var fT=class extends $d{#e;#t;#s;constructor(){super(),this.#s=s=>{if(!Ld&&window.addEventListener){const t=()=>s();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(s){this.#s=s,this.#t?.(),this.#t=s(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(s){this.#e!==s&&(this.#e=s,this.onFocus())}onFocus(){const s=this.isFocused();this.listeners.forEach(t=>{t(s)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},lj=new fT,pT=class extends $d{#e=!0;#t;#s;constructor(){super(),this.#s=s=>{if(!Ld&&window.addEventListener){const t=()=>s(!0),r=()=>s(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(s){this.#s=s,this.#t?.(),this.#t=s(this.setOnline.bind(this))}setOnline(s){this.#e!==s&&(this.#e=s,this.listeners.forEach(r=>{r(s)}))}isOnline(){return this.#e}},ld=new pT;function gT(){let s,t;const r=new Promise((a,l)=>{s=a,t=l});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),s(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}function xT(s){return Math.min(1e3*2**s,3e4)}function cj(s){return(s??"online")==="online"?ld.isOnline():!0}var dj=class extends Error{constructor(s){super("CancelledError"),this.revert=s?.revert,this.silent=s?.silent}};function uj(s){let t=!1,r=0,n;const a=gT(),l=()=>a.status!=="pending",c=y=>{l()||(w(new dj(y)),s.abort?.())},d=()=>{t=!0},m=()=>{t=!1},h=()=>lj.isFocused()&&(s.networkMode==="always"||ld.isOnline())&&s.canRun(),f=()=>cj(s.networkMode)&&s.canRun(),p=y=>{l()||(n?.(),a.resolve(y))},w=y=>{l()||(n?.(),a.reject(y))},v=()=>new Promise(y=>{n=b=>{(l()||h())&&y(b)},s.onPause?.()}).then(()=>{n=void 0,l()||s.onContinue?.()}),j=()=>{if(l())return;let y;const b=r===0?s.initialPromise:void 0;try{y=b??s.fn()}catch(C){y=Promise.reject(C)}Promise.resolve(y).then(p).catch(C=>{if(l())return;const E=s.retry??(Ld?0:3),S=s.retryDelay??xT,O=typeof S=="function"?S(r,C):S,R=E===!0||typeof E=="number"&&r<E||typeof E=="function"&&E(r,C);if(t||!R){w(C);return}r++,s.onFail?.(r,C),dT(O).then(()=>h()?void 0:v()).then(()=>{t?w(C):j()})})};return{promise:a,status:()=>a.status,cancel:c,continue:()=>(n?.(),a),cancelRetry:d,continueRetry:m,canStart:f,start:()=>(f()?j():v().then(j),a)}}var vT=s=>setTimeout(s,0);function yT(){let s=[],t=0,r=d=>{d()},n=d=>{d()},a=vT;const l=d=>{t?s.push(d):a(()=>{r(d)})},c=()=>{const d=s;s=[],d.length&&a(()=>{n(()=>{d.forEach(m=>{r(m)})})})};return{batch:d=>{let m;t++;try{m=d()}finally{t--,t||c()}return m},batchCalls:d=>(...m)=>{l(()=>{d(...m)})},schedule:l,setNotifyFunction:d=>{r=d},setBatchNotifyFunction:d=>{n=d},setScheduler:d=>{a=d}}}var gs=yT(),hj=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),oT(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(Ld?1/0:300*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},jT=class extends hj{#e;#t;#s;#n;#r;#a;#o;constructor(s){super(),this.#o=!1,this.#a=s.defaultOptions,this.setOptions(s.options),this.observers=[],this.#n=s.client,this.#s=this.#n.getQueryCache(),this.queryKey=s.queryKey,this.queryHash=s.queryHash,this.#e=_T(this.options),this.state=s.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(s){this.options={...this.#a,...s},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#s.remove(this)}setData(s,t){const r=uT(this.state.data,s,this.options);return this.#i({data:r,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),r}setState(s,t){this.#i({type:"setState",state:s,setStateOptions:t})}cancel(s){const t=this.#r?.promise;return this.#r?.cancel(s),t?t.then(ar).catch(ar):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(s=>cT(s.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Af||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(s=>Sm(s.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(s=>s.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(s=0){return this.state.data===void 0?!0:s==="static"?!1:this.state.isInvalidated?!0:!lT(this.state.dataUpdatedAt,s)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(s){this.observers.includes(s)||(this.observers.push(s),this.clearGcTimeout(),this.#s.notify({type:"observerAdded",query:this,observer:s}))}removeObserver(s){this.observers.includes(s)&&(this.observers=this.observers.filter(t=>t!==s),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#s.notify({type:"observerRemoved",query:this,observer:s}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}async fetch(s,t){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(s&&this.setOptions(s),!this.options.queryFn){const d=this.observers.find(m=>m.options.queryFn);d&&this.setOptions(d.options)}const r=new AbortController,n=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(this.#o=!0,r.signal)})},a=()=>{const d=oj(this.options,t),h=(()=>{const f={client:this.#n,queryKey:this.queryKey,meta:this.meta};return n(f),f})();return this.#o=!1,this.options.persister?this.options.persister(d,h,this):d(h)},c=(()=>{const d={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#n,state:this.state,fetchFn:a};return n(d),d})();this.options.behavior?.onFetch(c,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==c.fetchOptions?.meta)&&this.#i({type:"fetch",meta:c.fetchOptions?.meta}),this.#r=uj({initialPromise:t?.initialPromise,fn:c.fetchFn,abort:r.abort.bind(r),onFail:(d,m)=>{this.#i({type:"failed",failureCount:d,error:m})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0});try{const d=await this.#r.start();if(d===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(d),this.#s.config.onSuccess?.(d,this),this.#s.config.onSettled?.(d,this.state.error,this),d}catch(d){if(d instanceof dj){if(d.silent)return this.#r.promise;if(d.revert){if(this.setState({...this.#t,fetchStatus:"idle"}),this.state.data===void 0)throw d;return this.state.data}}throw this.#i({type:"error",error:d}),this.#s.config.onError?.(d,this),this.#s.config.onSettled?.(this.state.data,d,this),d}finally{this.scheduleGc()}}#i(s){const t=r=>{switch(s.type){case"failed":return{...r,fetchFailureCount:s.failureCount,fetchFailureReason:s.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...wT(r.data,this.options),fetchMeta:s.meta??null};case"success":const n={...r,data:s.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:s.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!s.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=s.manual?n:void 0,n;case"error":const a=s.error;return{...r,error:a,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...s.state}}};this.state=t(this.state),gs.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#s.notify({query:this,type:"updated",action:s})})}};function wT(s,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:cj(t.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function _T(s){const t=typeof s.initialData=="function"?s.initialData():s.initialData,r=t!==void 0,n=r?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var bT=class extends $d{constructor(s={}){super(),this.config=s,this.#e=new Map}#e;build(s,t,r){const n=t.queryKey,a=t.queryHash??If(n,t);let l=this.get(a);return l||(l=new jT({client:s,queryKey:n,queryHash:a,options:s.defaultQueryOptions(t),state:r,defaultOptions:s.getQueryDefaults(n)}),this.add(l)),l}add(s){this.#e.has(s.queryHash)||(this.#e.set(s.queryHash,s),this.notify({type:"added",query:s}))}remove(s){const t=this.#e.get(s.queryHash);t&&(s.destroy(),t===s&&this.#e.delete(s.queryHash),this.notify({type:"removed",query:s}))}clear(){gs.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}get(s){return this.#e.get(s)}getAll(){return[...this.#e.values()]}find(s){const t={exact:!0,...s};return this.getAll().find(r=>Ev(t,r))}findAll(s={}){const t=this.getAll();return Object.keys(s).length>0?t.filter(r=>Ev(s,r)):t}notify(s){gs.batch(()=>{this.listeners.forEach(t=>{t(s)})})}onFocus(){gs.batch(()=>{this.getAll().forEach(s=>{s.onFocus()})})}onOnline(){gs.batch(()=>{this.getAll().forEach(s=>{s.onOnline()})})}},NT=class extends hj{#e;#t;#s;constructor(s){super(),this.mutationId=s.mutationId,this.#t=s.mutationCache,this.#e=[],this.state=s.state||ST(),this.setOptions(s.options),this.scheduleGc()}setOptions(s){this.options=s,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(s){this.#e.includes(s)||(this.#e.push(s),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:s}))}removeObserver(s){this.#e=this.#e.filter(t=>t!==s),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:s})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(s){const t=()=>{this.#n({type:"continue"})};this.#s=uj({fn:()=>this.options.mutationFn?this.options.mutationFn(s):Promise.reject(new Error("No mutationFn found")),onFail:(a,l)=>{this.#n({type:"failed",failureCount:a,error:l})},onPause:()=>{this.#n({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const r=this.state.status==="pending",n=!this.#s.canStart();try{if(r)t();else{this.#n({type:"pending",variables:s,isPaused:n}),await this.#t.config.onMutate?.(s,this);const l=await this.options.onMutate?.(s);l!==this.state.context&&this.#n({type:"pending",context:l,variables:s,isPaused:n})}const a=await this.#s.start();return await this.#t.config.onSuccess?.(a,s,this.state.context,this),await this.options.onSuccess?.(a,s,this.state.context),await this.#t.config.onSettled?.(a,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(a,null,s,this.state.context),this.#n({type:"success",data:a}),a}catch(a){try{throw await this.#t.config.onError?.(a,s,this.state.context,this),await this.options.onError?.(a,s,this.state.context),await this.#t.config.onSettled?.(void 0,a,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,a,s,this.state.context),a}finally{this.#n({type:"error",error:a})}}finally{this.#t.runNext(this)}}#n(s){const t=r=>{switch(s.type){case"failed":return{...r,failureCount:s.failureCount,failureReason:s.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:s.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:s.isPaused,status:"pending",variables:s.variables,submittedAt:Date.now()};case"success":return{...r,data:s.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:s.error,failureCount:r.failureCount+1,failureReason:s.error,isPaused:!1,status:"error"}}};this.state=t(this.state),gs.batch(()=>{this.#e.forEach(r=>{r.onMutationUpdate(s)}),this.#t.notify({mutation:this,type:"updated",action:s})})}};function ST(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ET=class extends $d{constructor(s={}){super(),this.config=s,this.#e=new Set,this.#t=new Map,this.#s=0}#e;#t;#s;build(s,t,r){const n=new NT({mutationCache:this,mutationId:++this.#s,options:s.defaultMutationOptions(t),state:r});return this.add(n),n}add(s){this.#e.add(s);const t=$c(s);if(typeof t=="string"){const r=this.#t.get(t);r?r.push(s):this.#t.set(t,[s])}this.notify({type:"added",mutation:s})}remove(s){if(this.#e.delete(s)){const t=$c(s);if(typeof t=="string"){const r=this.#t.get(t);if(r)if(r.length>1){const n=r.indexOf(s);n!==-1&&r.splice(n,1)}else r[0]===s&&this.#t.delete(t)}}this.notify({type:"removed",mutation:s})}canRun(s){const t=$c(s);if(typeof t=="string"){const n=this.#t.get(t)?.find(a=>a.state.status==="pending");return!n||n===s}else return!0}runNext(s){const t=$c(s);return typeof t=="string"?this.#t.get(t)?.find(n=>n!==s&&n.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){gs.batch(()=>{this.#e.forEach(s=>{this.notify({type:"removed",mutation:s})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(s){const t={exact:!0,...s};return this.getAll().find(r=>Cv(t,r))}findAll(s={}){return this.getAll().filter(t=>Cv(s,t))}notify(s){gs.batch(()=>{this.listeners.forEach(t=>{t(s)})})}resumePausedMutations(){const s=this.getAll().filter(t=>t.state.isPaused);return gs.batch(()=>Promise.all(s.map(t=>t.continue().catch(ar))))}};function $c(s){return s.options.scope?.id}function Ov(s){return{onFetch:(t,r)=>{const n=t.options,a=t.fetchOptions?.meta?.fetchMore?.direction,l=t.state.data?.pages||[],c=t.state.data?.pageParams||[];let d={pages:[],pageParams:[]},m=0;const h=async()=>{let f=!1;const p=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(t.signal.aborted?f=!0:t.signal.addEventListener("abort",()=>{f=!0}),t.signal)})},w=oj(t.options,t.fetchOptions),v=async(j,y,b)=>{if(f)return Promise.reject();if(y==null&&j.pages.length)return Promise.resolve(j);const E=(()=>{const k={client:t.client,queryKey:t.queryKey,pageParam:y,direction:b?"backward":"forward",meta:t.options.meta};return p(k),k})(),S=await w(E),{maxPages:O}=t.options,R=b?mT:hT;return{pages:R(j.pages,S,O),pageParams:R(j.pageParams,y,O)}};if(a&&l.length){const j=a==="backward",y=j?CT:Rv,b={pages:l,pageParams:c},C=y(n,b);d=await v(b,C,j)}else{const j=s??l.length;do{const y=m===0?c[0]??n.initialPageParam:Rv(n,d);if(m>0&&y==null)break;d=await v(d,y),m++}while(m<j)}return d};t.options.persister?t.fetchFn=()=>t.options.persister?.(h,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r):t.fetchFn=h}}}function Rv(s,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?s.getNextPageParam(t[n],t,r[n],r):void 0}function CT(s,{pages:t,pageParams:r}){return t.length>0?s.getPreviousPageParam?.(t[0],t,r[0],r):void 0}var TT=class{#e;#t;#s;#n;#r;#a;#o;#i;constructor(s={}){this.#e=s.queryCache||new bT,this.#t=s.mutationCache||new ET,this.#s=s.defaultOptions||{},this.#n=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=lj.subscribe(async s=>{s&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#i=ld.subscribe(async s=>{s&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#i?.(),this.#i=void 0)}isFetching(s){return this.#e.findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return this.#t.findAll({...s,status:"pending"}).length}getQueryData(s){const t=this.defaultQueryOptions({queryKey:s});return this.#e.get(t.queryHash)?.state.data}ensureQueryData(s){const t=this.defaultQueryOptions(s),r=this.#e.build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(s):(s.revalidateIfStale&&r.isStaleByTime(Sm(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(s){return this.#e.findAll(s).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(s,t,r){const n=this.defaultQueryOptions({queryKey:s}),l=this.#e.get(n.queryHash)?.state.data,c=aT(t,l);if(c!==void 0)return this.#e.build(this,n).setData(c,{...r,manual:!0})}setQueriesData(s,t,r){return gs.batch(()=>this.#e.findAll(s).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(s){const t=this.defaultQueryOptions({queryKey:s});return this.#e.get(t.queryHash)?.state}removeQueries(s){const t=this.#e;gs.batch(()=>{t.findAll(s).forEach(r=>{t.remove(r)})})}resetQueries(s,t){const r=this.#e;return gs.batch(()=>(r.findAll(s).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...s},t)))}cancelQueries(s,t={}){const r={revert:!0,...t},n=gs.batch(()=>this.#e.findAll(s).map(a=>a.cancel(r)));return Promise.all(n).then(ar).catch(ar)}invalidateQueries(s,t={}){return gs.batch(()=>(this.#e.findAll(s).forEach(r=>{r.invalidate()}),s?.refetchType==="none"?Promise.resolve():this.refetchQueries({...s,type:s?.refetchType??s?.type??"active"},t)))}refetchQueries(s,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=gs.batch(()=>this.#e.findAll(s).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,r);return r.throwOnError||(l=l.catch(ar)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(n).then(ar)}fetchQuery(s){const t=this.defaultQueryOptions(s);t.retry===void 0&&(t.retry=!1);const r=this.#e.build(this,t);return r.isStaleByTime(Sm(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(ar).catch(ar)}fetchInfiniteQuery(s){return s.behavior=Ov(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(ar).catch(ar)}ensureInfiniteQueryData(s){return s.behavior=Ov(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return ld.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#s}setDefaultOptions(s){this.#s=s}setQueryDefaults(s,t){this.#n.set(Qo(s),{queryKey:s,defaultOptions:t})}getQueryDefaults(s){const t=[...this.#n.values()],r={};return t.forEach(n=>{Jo(s,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(s,t){this.#r.set(Qo(s),{mutationKey:s,defaultOptions:t})}getMutationDefaults(s){const t=[...this.#r.values()],r={};return t.forEach(n=>{Jo(s,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(s){if(s._defaulted)return s;const t={...this.#s.queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return t.queryHash||(t.queryHash=If(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Af&&(t.enabled=!1),t}defaultMutationOptions(s){return s?._defaulted?s:{...this.#s.mutations,...s?.mutationKey&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},kT=x.createContext(void 0),OT=({client:s,children:t})=>(x.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),e.jsx(kT.Provider,{value:s,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zo(){return Zo=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Zo.apply(this,arguments)}var zn;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(zn||(zn={}));const Pv="popstate";function RT(s){s===void 0&&(s={});function t(n,a){let{pathname:l,search:c,hash:d}=n.location;return Cm("",{pathname:l,search:c,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:cd(a)}return IT(t,r,null,s)}function Ht(s,t){if(s===!1||s===null||typeof s>"u")throw new Error(t)}function mj(s,t){if(!s){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function PT(){return Math.random().toString(36).substr(2,8)}function Iv(s,t){return{usr:s.state,key:s.key,idx:t}}function Cm(s,t,r,n){return r===void 0&&(r=null),Zo({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof t=="string"?Ga(t):t,{state:r,key:t&&t.key||n||PT()})}function cd(s){let{pathname:t="/",search:r="",hash:n=""}=s;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ga(s){let t={};if(s){let r=s.indexOf("#");r>=0&&(t.hash=s.substr(r),s=s.substr(0,r));let n=s.indexOf("?");n>=0&&(t.search=s.substr(n),s=s.substr(0,n)),s&&(t.pathname=s)}return t}function IT(s,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:l=!1}=n,c=a.history,d=zn.Pop,m=null,h=f();h==null&&(h=0,c.replaceState(Zo({},c.state,{idx:h}),""));function f(){return(c.state||{idx:null}).idx}function p(){d=zn.Pop;let b=f(),C=b==null?null:b-h;h=b,m&&m({action:d,location:y.location,delta:C})}function w(b,C){d=zn.Push;let E=Cm(y.location,b,C);h=f()+1;let S=Iv(E,h),O=y.createHref(E);try{c.pushState(S,"",O)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;a.location.assign(O)}l&&m&&m({action:d,location:y.location,delta:1})}function v(b,C){d=zn.Replace;let E=Cm(y.location,b,C);h=f();let S=Iv(E,h),O=y.createHref(E);c.replaceState(S,"",O),l&&m&&m({action:d,location:y.location,delta:0})}function j(b){let C=a.location.origin!=="null"?a.location.origin:a.location.href,E=typeof b=="string"?b:cd(b);return E=E.replace(/ $/,"%20"),Ht(C,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,C)}let y={get action(){return d},get location(){return s(a,c)},listen(b){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(Pv,p),m=b,()=>{a.removeEventListener(Pv,p),m=null}},createHref(b){return t(a,b)},createURL:j,encodeLocation(b){let C=j(b);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:w,replace:v,go(b){return c.go(b)}};return y}var Av;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(Av||(Av={}));function AT(s,t,r){return r===void 0&&(r="/"),DT(s,t,r)}function DT(s,t,r,n){let a=typeof t=="string"?Ga(t):t,l=Df(a.pathname||"/",r);if(l==null)return null;let c=fj(s);$T(c);let d=null;for(let m=0;d==null&&m<c.length;++m){let h=YT(l);d=HT(c[m],h)}return d}function fj(s,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(l,c,d)=>{let m={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};m.relativePath.startsWith("/")&&(Ht(m.relativePath.startsWith(n),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(n.length));let h=Wn([n,m.relativePath]),f=r.concat(m);l.children&&l.children.length>0&&(Ht(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),fj(l.children,t,f,h)),!(l.path==null&&!l.index)&&t.push({path:h,score:BT(h,l.index),routesMeta:f})};return s.forEach((l,c)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))a(l,c);else for(let m of pj(l.path))a(l,c,m)}),t}function pj(s){let t=s.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return a?[l,""]:[l];let c=pj(n.join("/")),d=[];return d.push(...c.map(m=>m===""?l:[l,m].join("/"))),a&&d.push(...c),d.map(m=>s.startsWith("/")&&m===""?"/":m)}function $T(s){s.sort((t,r)=>t.score!==r.score?r.score-t.score:qT(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const LT=/^:[\w-]+$/,MT=3,FT=2,UT=1,zT=10,WT=-2,Dv=s=>s==="*";function BT(s,t){let r=s.split("/"),n=r.length;return r.some(Dv)&&(n+=WT),t&&(n+=FT),r.filter(a=>!Dv(a)).reduce((a,l)=>a+(LT.test(l)?MT:l===""?UT:zT),n)}function qT(s,t){return s.length===t.length&&s.slice(0,-1).every((n,a)=>n===t[a])?s[s.length-1]-t[t.length-1]:0}function HT(s,t,r){let{routesMeta:n}=s,a={},l="/",c=[];for(let d=0;d<n.length;++d){let m=n[d],h=d===n.length-1,f=l==="/"?t:t.slice(l.length)||"/",p=VT({path:m.relativePath,caseSensitive:m.caseSensitive,end:h},f),w=m.route;if(!p)return null;Object.assign(a,p.params),c.push({params:a,pathname:Wn([l,p.pathname]),pathnameBase:JT(Wn([l,p.pathnameBase])),route:w}),p.pathnameBase!=="/"&&(l=Wn([l,p.pathnameBase]))}return c}function VT(s,t){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[r,n]=GT(s.path,s.caseSensitive,s.end),a=t.match(r);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:n.reduce((h,f,p)=>{let{paramName:w,isOptional:v}=f;if(w==="*"){let y=d[p]||"";c=l.slice(0,l.length-y.length).replace(/(.)\/+$/,"$1")}const j=d[p];return v&&!j?h[w]=void 0:h[w]=(j||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:c,pattern:s}}function GT(s,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),mj(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let n=[],a="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,m)=>(n.push({paramName:d,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(n.push({paramName:"*"}),a+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":s!==""&&s!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function YT(s){try{return s.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return mj(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),s}}function Df(s,t){if(t==="/")return s;if(!s.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=s.charAt(r);return n&&n!=="/"?null:s.slice(r)||"/"}function KT(s,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof s=="string"?Ga(s):s;return{pathname:r?r.startsWith("/")?r:XT(r,t):t,search:ZT(n),hash:ek(a)}}function XT(s,t){let r=t.replace(/\/+$/,"").split("/");return s.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Yh(s,t,r,n){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function QT(s){return s.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function gj(s,t){let r=QT(s);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function xj(s,t,r,n){n===void 0&&(n=!1);let a;typeof s=="string"?a=Ga(s):(a=Zo({},s),Ht(!a.pathname||!a.pathname.includes("?"),Yh("?","pathname","search",a)),Ht(!a.pathname||!a.pathname.includes("#"),Yh("#","pathname","hash",a)),Ht(!a.search||!a.search.includes("#"),Yh("#","search","hash",a)));let l=s===""||a.pathname==="",c=l?"/":a.pathname,d;if(c==null)d=r;else{let p=t.length-1;if(!n&&c.startsWith("..")){let w=c.split("/");for(;w[0]==="..";)w.shift(),p-=1;a.pathname=w.join("/")}d=p>=0?t[p]:"/"}let m=KT(a,d),h=c&&c!=="/"&&c.endsWith("/"),f=(l||c===".")&&r.endsWith("/");return!m.pathname.endsWith("/")&&(h||f)&&(m.pathname+="/"),m}const Wn=s=>s.join("/").replace(/\/\/+/g,"/"),JT=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),ZT=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,ek=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function tk(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const vj=["post","put","patch","delete"];new Set(vj);const sk=["get",...vj];new Set(sk);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function el(){return el=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},el.apply(this,arguments)}const $f=x.createContext(null),rk=x.createContext(null),Ri=x.createContext(null),Md=x.createContext(null),Pi=x.createContext({outlet:null,matches:[],isDataRoute:!1}),yj=x.createContext(null);function nk(s,t){let{relative:r}=t===void 0?{}:t;dl()||Ht(!1);let{basename:n,navigator:a}=x.useContext(Ri),{hash:l,pathname:c,search:d}=wj(s,{relative:r}),m=c;return n!=="/"&&(m=c==="/"?n:Wn([n,c])),a.createHref({pathname:m,search:d,hash:l})}function dl(){return x.useContext(Md)!=null}function ul(){return dl()||Ht(!1),x.useContext(Md).location}function jj(s){x.useContext(Ri).static||x.useLayoutEffect(s)}function ur(){let{isDataRoute:s}=x.useContext(Pi);return s?xk():ik()}function ik(){dl()||Ht(!1);let s=x.useContext($f),{basename:t,future:r,navigator:n}=x.useContext(Ri),{matches:a}=x.useContext(Pi),{pathname:l}=ul(),c=JSON.stringify(gj(a,r.v7_relativeSplatPath)),d=x.useRef(!1);return jj(()=>{d.current=!0}),x.useCallback(function(h,f){if(f===void 0&&(f={}),!d.current)return;if(typeof h=="number"){n.go(h);return}let p=xj(h,JSON.parse(c),l,f.relative==="path");s==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:Wn([t,p.pathname])),(f.replace?n.replace:n.push)(p,f.state,f)},[t,n,c,l,s])}function wj(s,t){let{relative:r}=t===void 0?{}:t,{future:n}=x.useContext(Ri),{matches:a}=x.useContext(Pi),{pathname:l}=ul(),c=JSON.stringify(gj(a,n.v7_relativeSplatPath));return x.useMemo(()=>xj(s,JSON.parse(c),l,r==="path"),[s,c,l,r])}function ak(s,t){return ok(s,t)}function ok(s,t,r,n){dl()||Ht(!1);let{navigator:a}=x.useContext(Ri),{matches:l}=x.useContext(Pi),c=l[l.length-1],d=c?c.params:{};c&&c.pathname;let m=c?c.pathnameBase:"/";c&&c.route;let h=ul(),f;if(t){var p;let b=typeof t=="string"?Ga(t):t;m==="/"||(p=b.pathname)!=null&&p.startsWith(m)||Ht(!1),f=b}else f=h;let w=f.pathname||"/",v=w;if(m!=="/"){let b=m.replace(/^\//,"").split("/");v="/"+w.replace(/^\//,"").split("/").slice(b.length).join("/")}let j=AT(s,{pathname:v}),y=hk(j&&j.map(b=>Object.assign({},b,{params:Object.assign({},d,b.params),pathname:Wn([m,a.encodeLocation?a.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?m:Wn([m,a.encodeLocation?a.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),l,r,n);return t&&y?x.createElement(Md.Provider,{value:{location:el({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:zn.Pop}},y):y}function lk(){let s=gk(),t=tk(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),r=s instanceof Error?s.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),r?x.createElement("pre",{style:a},r):null,null)}const ck=x.createElement(lk,null);class dk extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?x.createElement(Pi.Provider,{value:this.props.routeContext},x.createElement(yj.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uk(s){let{routeContext:t,match:r,children:n}=s,a=x.useContext($f);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),x.createElement(Pi.Provider,{value:t},n)}function hk(s,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),s==null){var l;if(!r)return null;if(r.errors)s=r.matches;else if((l=n)!=null&&l.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)s=r.matches;else return null}let c=s,d=(a=r)==null?void 0:a.errors;if(d!=null){let f=c.findIndex(p=>p.route.id&&d?.[p.route.id]!==void 0);f>=0||Ht(!1),c=c.slice(0,Math.min(c.length,f+1))}let m=!1,h=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<c.length;f++){let p=c[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=f),p.route.id){let{loaderData:w,errors:v}=r,j=p.route.loader&&w[p.route.id]===void 0&&(!v||v[p.route.id]===void 0);if(p.route.lazy||j){m=!0,h>=0?c=c.slice(0,h+1):c=[c[0]];break}}}return c.reduceRight((f,p,w)=>{let v,j=!1,y=null,b=null;r&&(v=d&&p.route.id?d[p.route.id]:void 0,y=p.route.errorElement||ck,m&&(h<0&&w===0?(vk("route-fallback"),j=!0,b=null):h===w&&(j=!0,b=p.route.hydrateFallbackElement||null)));let C=t.concat(c.slice(0,w+1)),E=()=>{let S;return v?S=y:j?S=b:p.route.Component?S=x.createElement(p.route.Component,null):p.route.element?S=p.route.element:S=f,x.createElement(uk,{match:p,routeContext:{outlet:f,matches:C,isDataRoute:r!=null},children:S})};return r&&(p.route.ErrorBoundary||p.route.errorElement||w===0)?x.createElement(dk,{location:r.location,revalidation:r.revalidation,component:y,error:v,children:E(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):E()},null)}var _j=(function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s})(_j||{}),bj=(function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s})(bj||{});function mk(s){let t=x.useContext($f);return t||Ht(!1),t}function fk(s){let t=x.useContext(rk);return t||Ht(!1),t}function pk(s){let t=x.useContext(Pi);return t||Ht(!1),t}function Nj(s){let t=pk(),r=t.matches[t.matches.length-1];return r.route.id||Ht(!1),r.route.id}function gk(){var s;let t=x.useContext(yj),r=fk(),n=Nj();return t!==void 0?t:(s=r.errors)==null?void 0:s[n]}function xk(){let{router:s}=mk(_j.UseNavigateStable),t=Nj(bj.UseNavigateStable),r=x.useRef(!1);return jj(()=>{r.current=!0}),x.useCallback(function(a,l){l===void 0&&(l={}),r.current&&(typeof a=="number"?s.navigate(a):s.navigate(a,el({fromRouteId:t},l)))},[s,t])}const $v={};function vk(s,t,r){$v[s]||($v[s]=!0)}function yk(s,t){s?.v7_startTransition,s?.v7_relativeSplatPath}function Fe(s){Ht(!1)}function jk(s){let{basename:t="/",children:r=null,location:n,navigationType:a=zn.Pop,navigator:l,static:c=!1,future:d}=s;dl()&&Ht(!1);let m=t.replace(/^\/*/,"/"),h=x.useMemo(()=>({basename:m,navigator:l,static:c,future:el({v7_relativeSplatPath:!1},d)}),[m,d,l,c]);typeof n=="string"&&(n=Ga(n));let{pathname:f="/",search:p="",hash:w="",state:v=null,key:j="default"}=n,y=x.useMemo(()=>{let b=Df(f,m);return b==null?null:{location:{pathname:b,search:p,hash:w,state:v,key:j},navigationType:a}},[m,f,p,w,v,j,a]);return y==null?null:x.createElement(Ri.Provider,{value:h},x.createElement(Md.Provider,{children:r,value:y}))}function wk(s){let{children:t,location:r}=s;return ak(Tm(t),r)}new Promise(()=>{});function Tm(s,t){t===void 0&&(t=[]);let r=[];return x.Children.forEach(s,(n,a)=>{if(!x.isValidElement(n))return;let l=[...t,a];if(n.type===x.Fragment){r.push.apply(r,Tm(n.props.children,l));return}n.type!==Fe&&Ht(!1),!n.props.index||!n.props.children||Ht(!1);let c={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=Tm(n.props.children,l)),r.push(c)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function km(){return km=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},km.apply(this,arguments)}function _k(s,t){if(s==null)return{};var r={},n=Object.keys(s),a,l;for(l=0;l<n.length;l++)a=n[l],!(t.indexOf(a)>=0)&&(r[a]=s[a]);return r}function bk(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function Nk(s,t){return s.button===0&&(!t||t==="_self")&&!bk(s)}const Sk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ek="6";try{window.__reactRouterVersion=Ek}catch{}const Ck="startTransition",Lv=af[Ck];function Tk(s){let{basename:t,children:r,future:n,window:a}=s,l=x.useRef();l.current==null&&(l.current=RT({window:a,v5Compat:!0}));let c=l.current,[d,m]=x.useState({action:c.action,location:c.location}),{v7_startTransition:h}=n||{},f=x.useCallback(p=>{h&&Lv?Lv(()=>m(p)):m(p)},[m,h]);return x.useLayoutEffect(()=>c.listen(f),[c,f]),x.useEffect(()=>yk(n),[n]),x.createElement(jk,{basename:t,children:r,location:d.location,navigationType:d.action,navigator:c,future:n})}const kk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ok=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Qr=x.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:l,replace:c,state:d,target:m,to:h,preventScrollReset:f,viewTransition:p}=t,w=_k(t,Sk),{basename:v}=x.useContext(Ri),j,y=!1;if(typeof h=="string"&&Ok.test(h)&&(j=h,kk))try{let S=new URL(window.location.href),O=h.startsWith("//")?new URL(S.protocol+h):new URL(h),R=Df(O.pathname,v);O.origin===S.origin&&R!=null?h=R+O.search+O.hash:y=!0}catch{}let b=nk(h,{relative:a}),C=Rk(h,{replace:c,state:d,target:m,preventScrollReset:f,relative:a,viewTransition:p});function E(S){n&&n(S),S.defaultPrevented||C(S)}return x.createElement("a",km({},w,{href:j||b,onClick:y||l?n:E,ref:r,target:m}))});var Mv;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(Mv||(Mv={}));var Fv;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(Fv||(Fv={}));function Rk(s,t){let{target:r,replace:n,state:a,preventScrollReset:l,relative:c,viewTransition:d}=t===void 0?{}:t,m=ur(),h=ul(),f=wj(s,{relative:c});return x.useCallback(p=>{if(Nk(p,r)){p.preventDefault();let w=n!==void 0?n:cd(h)===cd(f);m(s,{replace:w,state:a,preventScrollReset:l,relative:c,viewTransition:d})}},[h,m,f,n,a,r,s,l,c,d])}const Sj=x.createContext(void 0),Uv={ar:{"admin.dashboard":"  ","admin.logout":" ","admin.orders":"","admin.stores":"","admin.users":"","admin.settings":"","admin.orders.list":" ","admin.orders.total":" ","admin.orders.pending":" ","admin.orders.processing":"  ","admin.orders.completed":" ","admin.orders.cancelled":" ","admin.order.details":" ","admin.order.code":" ","admin.order.customer":"","admin.order.product":"","admin.order.amount":"","admin.order.status":" ","admin.order.date":" ","admin.refresh":"","admin.add.store":" ","admin.stores.management":" ","admin.orders.all.description":"       ","store.dashboard":"  ","store.orders":"","store.orders.description":"    ","store.order.accept":"","store.order.reject":"","store.order.customer.details":" ","store.name":" ","store.status":" ","store.orders.assigned":" ","store.orders.delivered":" ","store.orders.returned":" ","store.tab.assigned":"","store.tab.accepted":"","store.tab.rejected":"","store.dialog.inventory.status":" ","store.dialog.available.customer":"  -  ","store.dialog.customer.delivery":"  ","store.orders.total":" ","store.refresh":"","store.logout":" ","language.toggle":" ",loading:" ...",error:"",success:"",cancel:"",save:"",delete:"",edit:"",view:"",close:"",search:"",filter:"",all:"",yes:"",no:"",refreshing:" ...","no.orders":"  ",customer:"",product:"",price:"",amount:"",total:"",date:"",status:"",details:"",quantity:"","quantity.label":":","customer.label":":","customer.notes":" ",pending:"",processing:" ",assigned:"",delivered:"",returned:"",cancelled:"",accepted:"",rejected:"",available:"",unavailable:" ","no.orders.pending":"   ","no.orders.assigned":"   ","no.orders.delivered":"   ","no.orders.returned":"   ","waiting.for.store.response":"   ","store.assigned":" ","not.assigned":" ","product.details":" ","product.name":" ","product.price":" ","product.total":" ","product.quantity":"","grand.total":" ","availability.confirmed":"  ","availability.checking":"   ","inventory.status":" ","order.items":" ","order.summary":" ","customer.info":" ","delivery.details":" ","order.note":" ","store.response":" ","assign.to.store":" ","store.selection":" ","confirm.order":" ","order.confirmation":" ",order:"",orders:"",card:"",information:"",notes:"","about.availability.selection":"    ","availability.notes":" ","selection.notes":" ","order.card":" ","product.card":" ","information.notes":" ","total.assigned.orders":"  ","availability.status":" ","in.stock":" ","out.of.stock":"   ","availability.rejected":"  ","reject.order":" ","order.number":" ","choose.rejection.reason":"  ","rejection.reason.out.of.stock":"    ","rejection.reason.damaged":"   ","rejection.reason.price.incorrect":"  ","rejection.reason.info.inaccurate":"   ","rejection.reason.supply.issue":"  ","rejection.reason.discontinued":"   ","rejection.reason.insufficient.quantity":"  ","rejection.reason.other":" ( )","explain.reason":" ","write.custom.reason":"   ","write.rejection.reason.placeholder":"    ...","rejection.warning":":               .","confirm.rejection":" ",rejecting:" ...","order.total.without.delivery":"  ( )","customer.details":" ","customer.details.delivery":" ","order.details.returned":"  ","return.reason":" ",products:"","products.required":" ","name.label":":","phone.label":":","address.label":":","total.amount.label":" :","delivery.date.label":" :","return.date.label":" :","order.date.label":" :","cannot.change":"  ","customer.rejected":" ","customer.rejection":" ","returned.field":" ","ready.for.delivery":" ","no.rejected.orders.customer":"     ","product.details.label":" :","amount.label":":","unavailable.reason":" :      ","order.rejected.by.customer":"     ","cannot.deliver.rejected":"            ","no.returned.orders":"   ","customer.details.title":" ","name.field":"","phone.field":"","address.field":"","amount.field":"","products.field":"","inventory.check.title":"   ","responded.at":"  ","store.confirmed.availability":"      ","products.count":" ({count} )","store.field":"","assigned.store":" ","total.amount.no.delivery":"  ( )","order.word":"","customer.notes.label":" :","return.reason.label":" :","availability.status.label":" :","in.stock.full":"  ","not.in.stock.full":"   ","store.order.details":" ","order.available":"","realtime.connected":" ","periodic.update":" ",disconnected:" "},en:{"admin.dashboard":"Admin Dashboard","admin.logout":"Logout","admin.orders":"Orders","admin.stores":"Stores","admin.users":"Users","admin.settings":"Settings","admin.orders.list":"Orders List","admin.orders.total":"Total Orders","admin.orders.pending":"Pending Orders","admin.orders.processing":"Processing Orders","admin.orders.completed":"Completed Orders","admin.orders.cancelled":"Cancelled Orders","admin.order.details":"Order Details","admin.order.code":"Order Code","admin.order.customer":"Customer","admin.order.product":"Product","admin.order.amount":"Amount","admin.order.status":"Order Status","admin.order.date":"Order Date","admin.refresh":"Refresh","admin.add.store":"Add Store","admin.stores.management":"Store Management","admin.orders.all.description":"All customer orders grouped by status","store.dashboard":"Store Dashboard","store.orders":"Your Orders","store.orders.description":"View and manage orders assigned to your store","store.order.accept":"Accept","store.order.reject":"Reject","store.order.customer.details":"Customer Details","store.name":"Store Name","store.status":"Store Status","store.orders.assigned":"Assigned Orders","store.orders.delivered":"Delivered Orders","store.orders.returned":"Returned Orders","store.tab.assigned":"Assigned","store.tab.accepted":"Accepted","store.tab.rejected":"Rejected","store.dialog.inventory.status":"Inventory Status","store.dialog.available.customer":"Available Order - Customer Details","store.dialog.customer.delivery":"Customer Delivery Details","store.orders.total":"Total Orders","store.refresh":"Refresh","store.logout":"Logout","language.toggle":"Toggle Language",loading:"Loading...",error:"Error",success:"Success",cancel:"Cancel",save:"Save",delete:"Delete",edit:"Edit",view:"View",close:"Close",search:"Search",filter:"Filter",all:"All",yes:"Yes",no:"No",refreshing:"Refreshing...","no.orders":"No orders",customer:"Customer",product:"Product",price:"Price",amount:"Amount",total:"Total",date:"Date",status:"Status",details:"Details",quantity:"Quantity","quantity.label":"Quantity:","customer.label":"Customer:","customer.notes":"Customer Notes",pending:"Pending",processing:"Processing",assigned:"Assigned",delivered:"Delivered",returned:"Returned",cancelled:"Cancelled",accepted:"Accepted",rejected:"Rejected",available:"Available",unavailable:"Unavailable","no.orders.pending":"No pending orders","no.orders.assigned":"No assigned orders","no.orders.delivered":"No delivered orders","no.orders.returned":"No returned orders","waiting.for.store.response":"Waiting for store response","store.assigned":"Assigned Store","not.assigned":"Not assigned","product.details":"Product Details","product.name":"Product Name","product.price":"Product Price","product.total":"Total","product.quantity":"Quantity","grand.total":"Grand Total","availability.confirmed":"Availability Confirmed","availability.checking":"Checking Availability","inventory.status":"Inventory Status","order.items":"Order Items","order.summary":"Order Summary","customer.info":"Customer Information","delivery.details":"Delivery Details","order.note":"Order Note","store.response":"Store Response","assign.to.store":"Assign to Store","store.selection":"Store Selection","confirm.order":"Confirm Order","order.confirmation":"Order Confirmation",order:"Order",orders:"Orders",card:"Card",information:"Information",notes:"Notes","about.availability.selection":"About Availability Selection","availability.notes":"Availability Notes","selection.notes":"Selection Notes","order.card":"Order Card","product.card":"Product Card","information.notes":"Information & Notes","total.assigned.orders":"Total Assigned Orders","availability.status":"Availability Status","in.stock":"In Stock","out.of.stock":"Out of Stock","availability.rejected":"Availability Rejected","reject.order":"Reject Order","order.number":"Order Number","choose.rejection.reason":"Choose rejection reason","rejection.reason.out.of.stock":"Product not available in stock","rejection.reason.damaged":"Product is damaged or defective","rejection.reason.price.incorrect":"Price is incorrect","rejection.reason.info.inaccurate":"Product information is inaccurate","rejection.reason.supply.issue":"Supply chain issue","rejection.reason.discontinued":"Product discontinued","rejection.reason.insufficient.quantity":"Insufficient quantity","rejection.reason.other":"Other (please specify)","explain.reason":"Explain reason","write.custom.reason":"Or write a custom reason","write.rejection.reason.placeholder":"Please write the reason for rejecting the order...","rejection.warning":"Warning: Rejecting the order will remove it from your store list and return it to pending orders to be assigned to another store.","confirm.rejection":"Confirm Rejection",rejecting:"Rejecting...","order.total.without.delivery":"Order Total (without delivery)","customer.details":"Customer Details","customer.details.delivery":"Customer Details","order.details.returned":"Returned Order Details","return.reason":"Return Reason",products:"Products","products.required":"Required Products","name.label":"Name:","phone.label":"Phone:","address.label":"Address:","total.amount.label":"Total Amount:","delivery.date.label":"Delivery Date:","return.date.label":"Return Date:","order.date.label":"Order Date:","cannot.change":"Cannot change","customer.rejected":"Customer Rejected","customer.rejection":"Customer Rejection","returned.field":"Returned Field","ready.for.delivery":"Ready for Delivery","no.rejected.orders.customer":"No customer rejected orders","product.details.label":"Product Details:","amount.label":"Amount:","unavailable.reason":"Unavailable: Enter reason for unavailability and return to admin","order.rejected.by.customer":"Order rejected by customer","cannot.deliver.rejected":"Cannot deliver or return this order as it was rejected by customer","no.returned.orders":"No returned orders","customer.details.title":"Customer Details","name.field":"Name","phone.field":"Phone","address.field":"Address","amount.field":"Amount","products.field":"Products","inventory.check.title":"Store Inventory Check","responded.at":"Responded at","store.confirmed.availability":"Store confirmed this product is available in their inventory","products.count":"Products ({count} product)","store.field":"Store","assigned.store":"Assigned Store","total.amount.no.delivery":"Total Amount (without delivery)","order.word":"Order","customer.notes.label":"Customer Notes:","return.reason.label":"Return Reason:","availability.status.label":"Availability Status:","in.stock.full":"Available in stock","not.in.stock.full":"Unavailable in stock","store.order.details":"Order Details","order.available":"Available","realtime.connected":"Live Connected","periodic.update":"Periodic Update",disconnected:"Disconnected"}},Pk=({children:s})=>{const[t,r]=x.useState(()=>localStorage.getItem("language")||"ar");x.useEffect(()=>{localStorage.setItem("language",t),document.documentElement.dir=t==="ar"?"rtl":"ltr",document.documentElement.lang=t,document.body.style.transition="all 0.3s ease-in-out"},[t]);const n=()=>{r(c=>c==="ar"?"en":"ar")},a=c=>{const d=Uv[t][c];return d||Uv[t==="ar"?"en":"ar"][c]||c},l=t==="ar"?"rtl":"ltr";return e.jsx(Sj.Provider,{value:{language:t,toggleLanguage:n,t:a,dir:l},children:s})},us=()=>{const s=x.useContext(Sj);if(s===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return s},Ej=x.createContext(void 0),Ik=({children:s})=>{const[t,r]=x.useState(()=>{const l=localStorage.getItem("theme");return l==="light"||l==="dark"?l:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"});x.useEffect(()=>{localStorage.setItem("theme",t),t==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),document.body.style.transition="background-color 0.3s ease-in-out, color 0.3s ease-in-out"},[t]);const n=()=>{r(l=>l==="light"?"dark":"light")},a=t==="dark";return e.jsx(Ej.Provider,{value:{theme:t,toggleTheme:n,isDark:a},children:s})},Ak=()=>{const s=x.useContext(Ej);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},Dk=ol("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),L=x.forwardRef(({className:s,variant:t,size:r,asChild:n=!1,...a},l)=>{const c=n?ZS:"button";return e.jsx(c,{className:Ue(Dk({variant:t,size:r,className:s})),ref:l,...a})});L.displayName="Button";const $=x.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:Ue("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));$.displayName="Card";const q=x.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:Ue("flex flex-col space-y-1.5 p-6",s),...t}));q.displayName="CardHeader";const V=x.forwardRef(({className:s,...t},r)=>e.jsx("h3",{ref:r,className:Ue("text-2xl font-semibold leading-none tracking-tight",s),...t}));V.displayName="CardTitle";const Ze=x.forwardRef(({className:s,...t},r)=>e.jsx("p",{ref:r,className:Ue("text-sm text-muted-foreground",s),...t}));Ze.displayName="CardDescription";const M=x.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:Ue("p-6 pt-0",s),...t}));M.displayName="CardContent";const $k=x.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:Ue("flex items-center p-6 pt-0",s),...t}));$k.displayName="CardFooter";const hl=()=>{const{theme:s,toggleTheme:t,isDark:r}=Ak(),{t:n}=us(),a={ar:{light:" ",dark:" ",toggle:" "},en:{light:"Light Mode",dark:"Dark Mode",toggle:"Toggle Theme"}},l=n("language.toggle").includes("")?"ar":"en",c=r?`${a[l].toggle} (${a[l].light})`:`${a[l].toggle} (${a[l].dark})`;return e.jsx(Rf,{children:e.jsxs(nj,{children:[e.jsx(ij,{asChild:!0,children:e.jsxs(L,{variant:"outline",size:"sm",onClick:t,className:"flex items-center gap-2 transition-all duration-300 hover:scale-105 shadow-sm hover:shadow-md",children:[r?e.jsx(eE,{className:"h-4 w-4 text-yellow-500 dark:text-yellow-400"}):e.jsx(Q1,{className:"h-4 w-4 text-slate-700 dark:text-slate-300"}),e.jsx("span",{className:"text-sm font-medium",children:r?l==="ar"?"":"Light":l==="ar"?"":"Dark"})]})}),e.jsx(Pf,{children:e.jsx("p",{children:c})})]})})},ml=()=>{const{language:s,toggleLanguage:t,t:r}=us();return e.jsx(Rf,{children:e.jsxs(nj,{children:[e.jsx(ij,{asChild:!0,children:e.jsxs(L,{variant:"outline",size:"sm",onClick:t,className:"flex items-center gap-2 transition-all duration-200 hover:scale-105",children:[e.jsx(K1,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:s==="ar"?"EN":""})]})}),e.jsx(Pf,{children:e.jsxs("p",{children:[r("language.toggle")," (",s==="ar"?"English":"",")"]})})]})})},zv=()=>{const s=ur();return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/10 to-secondary/10 p-6",dir:"rtl",children:[e.jsxs("div",{className:"fixed top-4 left-4 z-50 flex gap-2",children:[e.jsx(hl,{}),e.jsx(ml,{})]}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-primary mb-4",children:"  "}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"   "})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 mb-12 justify-center max-w-4xl mx-auto",children:[e.jsxs($,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>s("/admin-aa-smn-justme9003"),children:[e.jsxs(q,{className:"text-center",children:[e.jsx(cv,{className:"w-16 h-16 text-primary mx-auto mb-4"}),e.jsx(V,{className:"text-2xl",children:" "}),e.jsx(Ze,{children:"    "})]}),e.jsx(M,{children:e.jsx(L,{className:"w-full",size:"lg",children:" "})})]}),e.jsxs($,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>s("/store-login-space9003"),children:[e.jsxs(q,{className:"text-center",children:[e.jsx(is,{className:"w-16 h-16 text-primary mx-auto mb-4"}),e.jsx(V,{className:"text-2xl",children:" "}),e.jsx(Ze,{children:"    "})]}),e.jsx(M,{children:e.jsx(L,{className:"w-full",variant:"outline",size:"lg",children:" "})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx($,{children:e.jsxs(M,{className:"p-6 text-center",children:[e.jsx(Me,{className:"w-12 h-12 text-primary mx-auto mb-4"}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:" "}),e.jsx("p",{className:"text-muted-foreground",children:"       "})]})}),e.jsx($,{children:e.jsxs(M,{className:"p-6 text-center",children:[e.jsx(cv,{className:"w-12 h-12 text-primary mx-auto mb-4"}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:" "}),e.jsx("p",{className:"text-muted-foreground",children:"      "})]})}),e.jsx($,{children:e.jsxs(M,{className:"p-6 text-center",children:[e.jsx(is,{className:"w-12 h-12 text-primary mx-auto mb-4"}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:" "}),e.jsx("p",{className:"text-muted-foreground",children:"     "})]})})]}),e.jsxs("div",{className:"text-center mt-12 pt-8 border-t",children:[e.jsx("p",{className:"text-muted-foreground",children:e.jsx("strong",{children:'"              ."'})}),e.jsx("p",{})]})]})]})},Lk=()=>{const s=ul(),t=ur();x.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",s.pathname)},[s.pathname]);const r=()=>{t("/")},n=()=>{t(-1)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/5 p-4",children:e.jsx($,{className:"w-full max-w-md mx-auto shadow-lg",children:e.jsxs(M,{className:"p-8 text-center space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-6xl font-bold text-primary",children:"404"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"  "}),e.jsx("h3",{className:"text-lg text-gray-600",children:"Page Not Found"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-gray-700",children:"         ."}),e.jsx("p",{className:"text-sm text-gray-600",children:"Sorry, the page you are looking for could not be found or has been moved."})]}),s.pathname&&s.pathname!=="/"&&e.jsx("div",{className:"bg-gray-100 p-3 rounded-lg",children:e.jsxs("p",{className:"text-xs text-gray-600 break-all",children:[" : ",e.jsx("code",{className:"font-mono",children:s.pathname})]})}),e.jsxs("div",{className:"space-y-3 pt-4",children:[e.jsxs(L,{onClick:r,className:"w-full gap-2",size:"lg",children:[e.jsx(Y1,{className:"w-4 h-4"}),"  "]}),e.jsxs(L,{onClick:n,variant:"outline",className:"w-full gap-2",size:"lg",children:[e.jsx(bd,{className:"w-4 h-4"}),"  "]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx("p",{className:"text-xs text-gray-500",children:"            ."})})]})})})},it=x.forwardRef(({className:s,type:t,...r},n)=>e.jsx("input",{type:t,className:Ue("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...r}));it.displayName="Input";var Mk="Label",Cj=x.forwardRef((s,t)=>e.jsx(ze.label,{...s,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(s.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Cj.displayName=Mk;var Tj=Cj;const Fk=ol("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),et=x.forwardRef(({className:s,...t},r)=>e.jsx(Tj,{ref:r,className:Ue(Fk(),s),...t}));et.displayName=Tj.displayName;const Uk="modulepreload",zk=function(s){return"/"+s},Wv={},Ii=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let m=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=c?.nonce||c?.getAttribute("nonce");a=m(r.map(h=>{if(h=zk(h),h in Wv)return;Wv[h]=!0;const f=h.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const w=document.createElement("link");if(w.rel=f?"stylesheet":Uk,f||(w.as="script"),w.crossOrigin="",w.href=h,d&&w.setAttribute("nonce",d),document.head.appendChild(w),f)return new Promise((v,j)=>{w.addEventListener("load",v),w.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return a.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return t().catch(l)})},Wk=s=>{let t;return s?t=s:typeof fetch>"u"?t=(...r)=>Ii(async()=>{const{default:n}=await Promise.resolve().then(()=>Ya);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Lf extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Bk extends Lf{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Bv extends Lf{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class qv extends Lf{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Om;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(Om||(Om={}));var qk=function(s,t,r,n){function a(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(f){try{h(n.next(f))}catch(p){c(p)}}function m(f){try{h(n.throw(f))}catch(p){c(p)}}function h(f){f.done?l(f.value):a(f.value).then(d,m)}h((n=n.apply(s,t||[])).next())})};class Hk{constructor(t,{headers:r={},customFetch:n,region:a=Om.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Wk(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return qk(this,void 0,void 0,function*(){try{const{headers:a,method:l,body:c}=r;let d={},{region:m}=r;m||(m=this.region);const h=new URL(`${this.url}/${t}`);m&&m!=="any"&&(d["x-region"]=m,h.searchParams.set("forceFunctionRegion",m));let f;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",f=c):typeof c=="string"?(d["Content-Type"]="text/plain",f=c):typeof FormData<"u"&&c instanceof FormData?f=c:(d["Content-Type"]="application/json",f=JSON.stringify(c)));const p=yield this.fetch(h.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),a),body:f}).catch(y=>{throw new Bk(y)}),w=p.headers.get("x-relay-error");if(w&&w==="true")throw new Bv(p);if(!p.ok)throw new qv(p);let v=((n=p.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),j;return v==="application/json"?j=yield p.json():v==="application/octet-stream"?j=yield p.blob():v==="text/event-stream"?j=p:v==="multipart/form-data"?j=yield p.formData():j=yield p.text(),{data:j,error:null,response:p}}catch(a){return{data:null,error:a,response:a instanceof qv||a instanceof Bv?a.context:void 0}}})}}var ts={},oa={},la={},ca={},da={},ua={},Vk=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Da=Vk();const Gk=Da.fetch,kj=Da.fetch.bind(Da),Oj=Da.Headers,Yk=Da.Request,Kk=Da.Response,Ya=Object.freeze(Object.defineProperty({__proto__:null,Headers:Oj,Request:Yk,Response:Kk,default:kj,fetch:Gk},Symbol.toStringTag,{value:"Module"})),Xk=LS(Ya);var Lc={},Hv;function Rj(){if(Hv)return Lc;Hv=1,Object.defineProperty(Lc,"__esModule",{value:!0});class s extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Lc.default=s,Lc}var Vv;function Pj(){if(Vv)return ua;Vv=1;var s=ua&&ua.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ua,"__esModule",{value:!0});const t=s(Xk),r=s(Rj());class n{constructor(l){var c,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let m=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var f,p,w,v;let j=null,y=null,b=null,C=h.status,E=h.statusText;if(h.ok){if(this.method!=="HEAD"){const k=await h.text();k===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((f=this.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?y=k:y=JSON.parse(k))}const O=(p=this.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),R=(w=h.headers.get("content-range"))===null||w===void 0?void 0:w.split("/");O&&R&&R.length>1&&(b=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(j={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,b=null,C=406,E="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const O=await h.text();try{j=JSON.parse(O),Array.isArray(j)&&h.status===404&&(y=[],j=null,C=200,E="OK")}catch{h.status===404&&O===""?(C=204,E="No Content"):j={message:O}}if(j&&this.isMaybeSingle&&(!((v=j?.details)===null||v===void 0)&&v.includes("0 rows"))&&(j=null,C=200,E="OK"),j&&this.shouldThrowOnError)throw new r.default(j)}return{error:j,data:y,count:b,status:C,statusText:E}});return this.shouldThrowOnError||(m=m.catch(h=>{var f,p,w;return{error:{message:`${(f=h?.name)!==null&&f!==void 0?f:"FetchError"}: ${h?.message}`,details:`${(p=h?.stack)!==null&&p!==void 0?p:""}`,hint:"",code:`${(w=h?.code)!==null&&w!==void 0?w:""}`},data:null,count:null,status:0,statusText:""}})),m.then(l,c)}returns(){return this}overrideTypes(){return this}}return ua.default=n,ua}var Gv;function Ij(){if(Gv)return da;Gv=1;var s=da&&da.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(da,"__esModule",{value:!0});const t=s(Pj());class r extends t.default{select(a){let l=!1;const c=(a??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:m=d}={}){const h=m?`${m}.order`:"order",f=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${f?`${f},`:""}${a}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,l,{foreignTable:c,referencedTable:d=c}={}){const m=typeof d>"u"?"offset":`${d}.offset`,h=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(m,`${a}`),this.url.searchParams.set(h,`${l-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:m=!1,format:h="text"}={}){var f;const p=[a?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,m?"wal":null].filter(Boolean).join("|"),w=(f=this.headers.get("Accept"))!==null&&f!==void 0?f:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${w}"; options=${p};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return da.default=r,da}var Yv;function Mf(){if(Yv)return ca;Yv=1;var s=ca&&ca.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ca,"__esModule",{value:!0});const t=s(Ij());class r extends t.default{eq(a,l){return this.url.searchParams.append(a,`eq.${l}`),this}neq(a,l){return this.url.searchParams.append(a,`neq.${l}`),this}gt(a,l){return this.url.searchParams.append(a,`gt.${l}`),this}gte(a,l){return this.url.searchParams.append(a,`gte.${l}`),this}lt(a,l){return this.url.searchParams.append(a,`lt.${l}`),this}lte(a,l){return this.url.searchParams.append(a,`lte.${l}`),this}like(a,l){return this.url.searchParams.append(a,`like.${l}`),this}likeAllOf(a,l){return this.url.searchParams.append(a,`like(all).{${l.join(",")}}`),this}likeAnyOf(a,l){return this.url.searchParams.append(a,`like(any).{${l.join(",")}}`),this}ilike(a,l){return this.url.searchParams.append(a,`ilike.${l}`),this}ilikeAllOf(a,l){return this.url.searchParams.append(a,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(a,l){return this.url.searchParams.append(a,`ilike(any).{${l.join(",")}}`),this}is(a,l){return this.url.searchParams.append(a,`is.${l}`),this}in(a,l){const c=Array.from(new Set(l)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(a,`in.(${c})`),this}contains(a,l){return typeof l=="string"?this.url.searchParams.append(a,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(a,`cs.{${l.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(l)}`),this}containedBy(a,l){return typeof l=="string"?this.url.searchParams.append(a,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(a,`cd.{${l.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(l)}`),this}rangeGt(a,l){return this.url.searchParams.append(a,`sr.${l}`),this}rangeGte(a,l){return this.url.searchParams.append(a,`nxl.${l}`),this}rangeLt(a,l){return this.url.searchParams.append(a,`sl.${l}`),this}rangeLte(a,l){return this.url.searchParams.append(a,`nxr.${l}`),this}rangeAdjacent(a,l){return this.url.searchParams.append(a,`adj.${l}`),this}overlaps(a,l){return typeof l=="string"?this.url.searchParams.append(a,`ov.${l}`):this.url.searchParams.append(a,`ov.{${l.join(",")}}`),this}textSearch(a,l,{config:c,type:d}={}){let m="";d==="plain"?m="pl":d==="phrase"?m="ph":d==="websearch"&&(m="w");const h=c===void 0?"":`(${c})`;return this.url.searchParams.append(a,`${m}fts${h}.${l}`),this}match(a){return Object.entries(a).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(a,l,c){return this.url.searchParams.append(a,`not.${l}.${c}`),this}or(a,{foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,l,c){return this.url.searchParams.append(a,`${l}.${c}`),this}}return ca.default=r,ca}var Kv;function Aj(){if(Kv)return la;Kv=1;var s=la&&la.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(la,"__esModule",{value:!0});const t=s(Mf());class r{constructor(a,{headers:l={},schema:c,fetch:d}){this.url=a,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(a,{head:l=!1,count:c}={}){const d=l?"HEAD":"GET";let m=!1;const h=(a??"*").split("").map(f=>/\s/.test(f)&&!m?"":(f==='"'&&(m=!m),f)).join("");return this.url.searchParams.set("select",h),c&&this.headers.append("Prefer",`count=${c}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:l,defaultToNull:c=!0}={}){var d;const m="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const h=a.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new t.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(a,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:m=!0}={}){var h;const f="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),m||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const p=a.reduce((w,v)=>w.concat(Object.keys(v)),[]);if(p.length>0){const w=[...new Set(p)].map(v=>`"${v}"`);this.url.searchParams.set("columns",w.join(","))}}return new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}update(a,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:a}={}){var l;const c="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return la.default=r,la}var Xv;function Qk(){if(Xv)return oa;Xv=1;var s=oa&&oa.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(oa,"__esModule",{value:!0});const t=s(Aj()),r=s(Mf());class n{constructor(l,{headers:c={},schema:d,fetch:m}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=m}from(l){const c=new URL(`${this.url}/${l}`);return new t.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new n(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:m=!1,count:h}={}){var f;let p;const w=new URL(`${this.url}/rpc/${l}`);let v;d||m?(p=d?"HEAD":"GET",Object.entries(c).filter(([y,b])=>b!==void 0).map(([y,b])=>[y,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([y,b])=>{w.searchParams.append(y,b)})):(p="POST",v=c);const j=new Headers(this.headers);return h&&j.set("Prefer",`count=${h}`),new r.default({method:p,url:w,headers:j,schema:this.schemaName,body:v,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}}return oa.default=n,oa}var Qv;function Jk(){if(Qv)return ts;Qv=1;var s=ts&&ts.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(ts,"__esModule",{value:!0}),ts.PostgrestError=ts.PostgrestBuilder=ts.PostgrestTransformBuilder=ts.PostgrestFilterBuilder=ts.PostgrestQueryBuilder=ts.PostgrestClient=void 0;const t=s(Qk());ts.PostgrestClient=t.default;const r=s(Aj());ts.PostgrestQueryBuilder=r.default;const n=s(Mf());ts.PostgrestFilterBuilder=n.default;const a=s(Ij());ts.PostgrestTransformBuilder=a.default;const l=s(Pj());ts.PostgrestBuilder=l.default;const c=s(Rj());return ts.PostgrestError=c.default,ts.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default},ts}var Zk=Jk();const eO=rf(Zk),{PostgrestClient:tO,PostgrestQueryBuilder:FL,PostgrestFilterBuilder:UL,PostgrestTransformBuilder:zL,PostgrestBuilder:WL,PostgrestError:BL}=eO;class sO{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const rO="2.15.1",nO=`realtime-js/${rO}`,iO="1.0.0",Rm=1e4,aO=1e3,oO=100;var Wo;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Wo||(Wo={}));var Yt;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(Yt||(Yt={}));var or;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(or||(or={}));var Pm;(function(s){s.websocket="websocket"})(Pm||(Pm={}));var yi;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(yi||(yi={}));class lO{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),l=r.getUint8(2);let c=this.HEADER_LENGTH+2;const d=n.decode(t.slice(c,c+a));c=c+a;const m=n.decode(t.slice(c,c+l));c=c+l;const h=JSON.parse(n.decode(t.slice(c,t.byteLength)));return{ref:null,topic:d,event:m,payload:h}}}class Dj{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ct;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(Ct||(Ct={}));const Jv=(s,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((l,c)=>(l[c]=cO(c,s,t,a),l),{})},cO=(s,t,r,n)=>{const a=t.find(d=>d.name===s),l=a?.type,c=r[s];return l&&!n.includes(l)?$j(l,c):Im(c)},$j=(s,t)=>{if(s.charAt(0)==="_"){const r=s.slice(1,s.length);return mO(t,r)}switch(s){case Ct.bool:return dO(t);case Ct.float4:case Ct.float8:case Ct.int2:case Ct.int4:case Ct.int8:case Ct.numeric:case Ct.oid:return uO(t);case Ct.json:case Ct.jsonb:return hO(t);case Ct.timestamp:return fO(t);case Ct.abstime:case Ct.date:case Ct.daterange:case Ct.int4range:case Ct.int8range:case Ct.money:case Ct.reltime:case Ct.text:case Ct.time:case Ct.timestamptz:case Ct.timetz:case Ct.tsrange:case Ct.tstzrange:return Im(t);default:return Im(t)}},Im=s=>s,dO=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},uO=s=>{if(typeof s=="string"){const t=parseFloat(s);if(!Number.isNaN(t))return t}return s},hO=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(t){return console.log(`JSON parse error: ${t}`),s}return s},mO=(s,t)=>{if(typeof s!="string")return s;const r=s.length-1,n=s[r];if(s[0]==="{"&&n==="}"){let l;const c=s.slice(1,r);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>$j(t,d))}return s},fO=s=>typeof s=="string"?s.replace(" ","T"):s,Lj=s=>{let t=s;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Kh{constructor(t,r,n={},a=Rm){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Zv;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(Zv||(Zv={}));class Bo{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Bo.syncState(this.state,a,l,c),this.pendingDiffs.forEach(m=>{this.state=Bo.syncDiff(this.state,m,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(n.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Bo.syncDiff(this.state,a,l,c),d())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const l=this.cloneDeep(t),c=this.transformState(r),d={},m={};return this.map(l,(h,f)=>{c[h]||(m[h]=f)}),this.map(c,(h,f)=>{const p=l[h];if(p){const w=f.map(b=>b.presence_ref),v=p.map(b=>b.presence_ref),j=f.filter(b=>v.indexOf(b.presence_ref)<0),y=p.filter(b=>w.indexOf(b.presence_ref)<0);j.length>0&&(d[h]=j),y.length>0&&(m[h]=y)}else d[h]=f}),this.syncDiff(l,{joins:d,leaves:m},n,a)}static syncDiff(t,r,n,a){const{joins:l,leaves:c}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(l,(d,m)=>{var h;const f=(h=t[d])!==null&&h!==void 0?h:[];if(t[d]=this.cloneDeep(m),f.length>0){const p=t[d].map(v=>v.presence_ref),w=f.filter(v=>p.indexOf(v.presence_ref)<0);t[d].unshift(...w)}n(d,f,m)}),this.map(c,(d,m)=>{let h=t[d];if(!h)return;const f=m.map(p=>p.presence_ref);h=h.filter(p=>f.indexOf(p.presence_ref)<0),t[d]=h,a(d,h,m),h.length===0&&delete t[d]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ey;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(ey||(ey={}));var qo;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(qo||(qo={}));var Xr;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Xr||(Xr={}));class Ff{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Yt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Kh(this,or.join,this.params,this.timeout),this.rejoinTimer=new Dj(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Yt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Yt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Yt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Yt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Yt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(or.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new Bo(this),this.broadcastEndpointURL=Lj(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Yt.closed){const{config:{broadcast:l,presence:c,private:d}}=this.params,m=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(w=>w.filter))!==null&&a!==void 0?a:[],h=!!this.bindings[qo.PRESENCE]&&this.bindings[qo.PRESENCE].length>0,f={},p={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:h}),postgres_changes:m,private:d};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(w=>t?.(Xr.CHANNEL_ERROR,w)),this._onClose(()=>t?.(Xr.CLOSED)),this.updateJoinPayload(Object.assign({config:p},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:w})=>{var v;if(this.socket.setAuth(),w===void 0){t?.(Xr.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,y=(v=j?.length)!==null&&v!==void 0?v:0,b=[];for(let C=0;C<y;C++){const E=j[C],{filter:{event:S,schema:O,table:R,filter:k}}=E,P=w&&w[C];if(P&&P.event===S&&P.schema===O&&P.table===R&&P.filter===k)b.push(Object.assign(Object.assign({},E),{id:P.id}));else{this.unsubscribe(),this.state=Yt.errored,t?.(Xr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,t&&t(Xr.SUBSCRIBED);return}}).receive("error",w=>{this.state=Yt.errored,t?.(Xr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(w).join(", ")||"error")))}).receive("timeout",()=>{t?.(Xr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Yt.joined&&t===qo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:l,payload:c}=t,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=h.body)===null||a===void 0?void 0:a.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,m;const h=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((m=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||m===void 0)&&m.ack)&&l("ok"),h.receive("ok",()=>l("ok")),h.receive("error",()=>l("error")),h.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Yt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(or.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Kh(this,or.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Yt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,l=setTimeout(()=>a.abort(),n),c=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(l),c}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Kh(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>oO){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,l;const c=t.toLocaleLowerCase(),{close:d,error:m,leave:h,join:f}=or;if(n&&[d,m,h,f].indexOf(c)>=0&&n!==this._joinRef())return;let w=this._onMessage(c,r,n);if(r&&!w)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(v=>{var j,y,b;return((j=v.filter)===null||j===void 0?void 0:j.event)==="*"||((b=(y=v.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===c}).map(v=>v.callback(w,n)):(l=this.bindings[c])===null||l===void 0||l.filter(v=>{var j,y,b,C,E,S;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in v){const O=v.id,R=(j=v.filter)===null||j===void 0?void 0:j.event;return O&&((y=r.ids)===null||y===void 0?void 0:y.includes(O))&&(R==="*"||R?.toLocaleLowerCase()===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const O=(E=(C=v?.filter)===null||C===void 0?void 0:C.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return O==="*"||O===((S=r?.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===c}).map(v=>{if(typeof w=="object"&&"ids"in w){const j=w.data,{schema:y,table:b,commit_timestamp:C,type:E,errors:S}=j;w=Object.assign(Object.assign({},{schema:y,table:b,commit_timestamp:C,eventType:E,new:{},old:{},errors:S}),this._getPayloadRecords(j))}v.callback(w,n)})}_isClosed(){return this.state===Yt.closed}_isJoined(){return this.state===Yt.joined}_isJoining(){return this.state===Yt.joining}_isLeaving(){return this.state===Yt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),l={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&Ff.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(or.close,{},t)}_onError(t){this._on(or.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Yt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Jv(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Jv(t.columns,t.old_record)),r}}const ty=()=>{},Mc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},pO=[1e3,2e3,5e3,1e4],gO=1e4,xO=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class vO{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Rm,this.transport=null,this.heartbeatIntervalMs=Mc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ty,this.ref=0,this.reconnectTimer=null,this.logger=ty,this.conn=null,this.sendBuffer=[],this.serializer=new lO,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let l;return a?l=a:typeof fetch>"u"?l=(...c)=>Ii(async()=>{const{default:d}=await Promise.resolve().then(()=>Ya);return{default:d}},void 0).then(({default:d})=>d(...c)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Pm.websocket}`,this.httpEndpoint=Lj(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=sO.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:iO}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Wo.connecting:return yi.Connecting;case Wo.open:return yi.Open;case Wo.closing:return yi.Closing;default:return yi.Closed}}isConnected(){return this.connectionState()===yi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(l=>l.topic===n);if(a)return a;{const l=new Ff(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:n,payload:a,ref:l}=t,c=()=>{this.encode(t,d=>{var m;(m=this.conn)===null||m===void 0||m.send(d)})};this.log("push",`${r} ${n} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(aO,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Mc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{r.topic==="phoenix"&&r.event==="phx_reply"&&this.heartbeatCallback(r.payload.status==="ok"?"ok":"error"),r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:l,ref:c}=r,d=c?`(${c})`:"",m=l.status||"";this.log("receive",`${m} ${n} ${a} ${d}`.trim(),l),this.channels.filter(h=>h._isMember(n)).forEach(h=>h._trigger(a,l,c)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(or.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([xO],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:nO};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(or.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Dj(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Mc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,l,c,d,m,h;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Rm,this.heartbeatIntervalMs=(a=t?.heartbeatIntervalMs)!==null&&a!==void 0?a:Mc.HEARTBEAT_INTERVAL,this.worker=(l=t?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=t?.accessToken)!==null&&c!==void 0?c:null,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t?.reconnectAfterMs)!==null&&d!==void 0?d:(f=>pO[f-1]||gO),this.encode=(m=t?.encode)!==null&&m!==void 0?m:((f,p)=>p(JSON.stringify(f))),this.decode=(h=t?.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class Uf extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Kt(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class yO extends Uf{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Am extends Uf{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var jO=function(s,t,r,n){function a(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(f){try{h(n.next(f))}catch(p){c(p)}}function m(f){try{h(n.throw(f))}catch(p){c(p)}}function h(f){f.done?l(f.value):a(f.value).then(d,m)}h((n=n.apply(s,t||[])).next())})};const Mj=s=>{let t;return s?t=s:typeof fetch>"u"?t=(...r)=>Ii(async()=>{const{default:n}=await Promise.resolve().then(()=>Ya);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},wO=()=>jO(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ii(()=>Promise.resolve().then(()=>Ya),void 0)).Response:Response}),Dm=s=>{if(Array.isArray(s))return s.map(r=>Dm(r));if(typeof s=="function"||s!==Object(s))return s;const t={};return Object.entries(s).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[a]=Dm(n)}),t},_O=s=>{if(typeof s!="object"||s===null)return!1;const t=Object.getPrototypeOf(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)};var Ai=function(s,t,r,n){function a(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(f){try{h(n.next(f))}catch(p){c(p)}}function m(f){try{h(n.throw(f))}catch(p){c(p)}}function h(f){f.done?l(f.value):a(f.value).then(d,m)}h((n=n.apply(s,t||[])).next())})};const Xh=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),bO=(s,t,r)=>Ai(void 0,void 0,void 0,function*(){const n=yield wO();s instanceof n&&!r?.noResolveJson?s.json().then(a=>{const l=s.status||500,c=a?.statusCode||l+"";t(new yO(Xh(a),l,c))}).catch(a=>{t(new Am(Xh(a),a))}):t(new Am(Xh(s),s))}),NO=(s,t,r,n)=>{const a={method:s,headers:t?.headers||{}};return s==="GET"||!n?a:(_O(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(n)):a.body=n,t?.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function fl(s,t,r,n,a,l){return Ai(this,void 0,void 0,function*(){return new Promise((c,d)=>{s(r,NO(t,n,a,l)).then(m=>{if(!m.ok)throw m;return n?.noResolveJson?m:m.json()}).then(m=>c(m)).catch(m=>bO(m,d,n))})})}function dd(s,t,r,n){return Ai(this,void 0,void 0,function*(){return fl(s,"GET",t,r,n)})}function _r(s,t,r,n,a){return Ai(this,void 0,void 0,function*(){return fl(s,"POST",t,n,a,r)})}function $m(s,t,r,n,a){return Ai(this,void 0,void 0,function*(){return fl(s,"PUT",t,n,a,r)})}function SO(s,t,r,n){return Ai(this,void 0,void 0,function*(){return fl(s,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Fj(s,t,r,n,a){return Ai(this,void 0,void 0,function*(){return fl(s,"DELETE",t,n,a,r)})}var ps=function(s,t,r,n){function a(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(f){try{h(n.next(f))}catch(p){c(p)}}function m(f){try{h(n.throw(f))}catch(p){c(p)}}function h(f){f.done?l(f.value):a(f.value).then(d,m)}h((n=n.apply(s,t||[])).next())})};const EO={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},sy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class CO{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Mj(a)}uploadOrUpdate(t,r,n,a){return ps(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},sy),a);let d=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(c.upsert)});const m=c.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),m&&l.append("metadata",this.encodeMetadata(m)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl),m&&l.append("metadata",this.encodeMetadata(m))):(l=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,m&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),a?.headers&&(d=Object.assign(Object.assign({},d),a.headers));const h=this._removeEmptyFolders(r),f=this._getFinalPath(h),p=yield(t=="PUT"?$m:_r)(this.fetch,`${this.url}/object/${f}`,l,Object.assign({headers:d},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:h,id:p.Id,fullPath:p.Key},error:null}}catch(l){if(Kt(l))return{data:null,error:l};throw l}})}upload(t,r,n){return ps(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return ps(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",r);try{let m;const h=Object.assign({upsert:sy.upsert},a),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&n instanceof Blob?(m=new FormData,m.append("cacheControl",h.cacheControl),m.append("",n)):typeof FormData<"u"&&n instanceof FormData?(m=n,m.append("cacheControl",h.cacheControl)):(m=n,f["cache-control"]=`max-age=${h.cacheControl}`,f["content-type"]=h.contentType);const p=yield $m(this.fetch,d.toString(),m,{headers:f});return{data:{path:l,fullPath:p.Key},error:null}}catch(m){if(Kt(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(t,r){return ps(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r?.upsert&&(a["x-upsert"]="true");const l=yield _r(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new Uf("No token returned by API");return{data:{signedUrl:c.toString(),path:t,token:d},error:null}}catch(n){if(Kt(n))return{data:null,error:n};throw n}})}update(t,r,n){return ps(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return ps(this,void 0,void 0,function*(){try{return{data:yield _r(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Kt(a))return{data:null,error:a};throw a}})}copy(t,r,n){return ps(this,void 0,void 0,function*(){try{return{data:{path:(yield _r(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Kt(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return ps(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),l=yield _r(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n?.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(Kt(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return ps(this,void 0,void 0,function*(){try{const a=yield _r(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(Kt(a))return{data:null,error:a};throw a}})}download(t,r){return ps(this,void 0,void 0,function*(){const a=typeof r?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(r?.transform||{}),c=l?`?${l}`:"";try{const d=this._getFinalPath(t);return{data:yield(yield dd(this.fetch,`${this.url}/${a}/${d}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(d){if(Kt(d))return{data:null,error:d};throw d}})}info(t){return ps(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield dd(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Dm(n),error:null}}catch(n){if(Kt(n))return{data:null,error:n};throw n}})}exists(t){return ps(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield SO(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Kt(n)&&n instanceof Am){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],l=r?.download?`download=${r.download===!0?"":r.download}`:"";l!==""&&a.push(l);const d=typeof r?.transform<"u"?"render/image":"object",m=this.transformOptsToQueryString(r?.transform||{});m!==""&&a.push(m);let h=a.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${n}${h}`)}}}remove(t){return ps(this,void 0,void 0,function*(){try{return{data:yield Fj(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Kt(r))return{data:null,error:r};throw r}})}list(t,r,n){return ps(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},EO),r),{prefix:t||""});return{data:yield _r(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Kt(a))return{data:null,error:a};throw a}})}listV2(t,r){return ps(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield _r(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Kt(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const TO="2.11.0",kO={"X-Client-Info":`storage-js/${TO}`};var ha=function(s,t,r,n){function a(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(f){try{h(n.next(f))}catch(p){c(p)}}function m(f){try{h(n.throw(f))}catch(p){c(p)}}function h(f){f.done?l(f.value):a(f.value).then(d,m)}h((n=n.apply(s,t||[])).next())})};class OO{constructor(t,r={},n,a){const l=new URL(t);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},kO),r),this.fetch=Mj(n)}listBuckets(){return ha(this,void 0,void 0,function*(){try{return{data:yield dd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Kt(t))return{data:null,error:t};throw t}})}getBucket(t){return ha(this,void 0,void 0,function*(){try{return{data:yield dd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Kt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return ha(this,void 0,void 0,function*(){try{return{data:yield _r(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Kt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return ha(this,void 0,void 0,function*(){try{return{data:yield $m(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Kt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ha(this,void 0,void 0,function*(){try{return{data:yield _r(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Kt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ha(this,void 0,void 0,function*(){try{return{data:yield Fj(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Kt(r))return{data:null,error:r};throw r}})}}class RO extends OO{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new CO(this.url,this.headers,t,this.fetch)}}const PO="2.56.0";let Lo="";typeof Deno<"u"?Lo="deno":typeof document<"u"?Lo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Lo="react-native":Lo="node";const IO={"X-Client-Info":`supabase-js-${Lo}/${PO}`},AO={headers:IO},DO={schema:"public"},$O={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},LO={};var MO=function(s,t,r,n){function a(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(f){try{h(n.next(f))}catch(p){c(p)}}function m(f){try{h(n.throw(f))}catch(p){c(p)}}function h(f){f.done?l(f.value):a(f.value).then(d,m)}h((n=n.apply(s,t||[])).next())})};const FO=s=>{let t;return s?t=s:typeof fetch>"u"?t=kj:t=fetch,(...r)=>t(...r)},UO=()=>typeof Headers>"u"?Oj:Headers,zO=(s,t,r)=>{const n=FO(r),a=UO();return(l,c)=>MO(void 0,void 0,void 0,function*(){var d;const m=(d=yield t())!==null&&d!==void 0?d:s;let h=new a(c?.headers);return h.has("apikey")||h.set("apikey",s),h.has("Authorization")||h.set("Authorization",`Bearer ${m}`),n(l,Object.assign(Object.assign({},c),{headers:h}))})};var WO=function(s,t,r,n){function a(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(f){try{h(n.next(f))}catch(p){c(p)}}function m(f){try{h(n.throw(f))}catch(p){c(p)}}function h(f){f.done?l(f.value):a(f.value).then(d,m)}h((n=n.apply(s,t||[])).next())})};function BO(s){return s.endsWith("/")?s:s+"/"}function qO(s,t){var r,n;const{db:a,auth:l,realtime:c,global:d}=s,{db:m,auth:h,realtime:f,global:p}=t,w={db:Object.assign(Object.assign({},m),a),auth:Object.assign(Object.assign({},h),l),realtime:Object.assign(Object.assign({},f),c),storage:{},global:Object.assign(Object.assign(Object.assign({},p),d),{headers:Object.assign(Object.assign({},(r=p?.headers)!==null&&r!==void 0?r:{}),(n=d?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>WO(this,void 0,void 0,function*(){return""})};return s.accessToken?w.accessToken=s.accessToken:delete w.accessToken,w}const Uj="2.71.1",_a=30*1e3,Lm=3,Qh=Lm*_a,HO="http://localhost:9999",VO="supabase.auth.token",GO={"X-Client-Info":`gotrue-js/${Uj}`},Mm="X-Supabase-Api-Version",zj={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},YO=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,KO=600*1e3;class zf extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function st(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class XO extends zf{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function QO(s){return st(s)&&s.name==="AuthApiError"}class Wj extends zf{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Xn extends zf{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Ln extends Xn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function JO(s){return st(s)&&s.name==="AuthSessionMissingError"}class Fc extends Xn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Uc extends Xn{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class zc extends Xn{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ZO(s){return st(s)&&s.name==="AuthImplicitGrantRedirectError"}class ry extends Xn{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Fm extends Xn{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Jh(s){return st(s)&&s.name==="AuthRetryableFetchError"}class ny extends Xn{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Um extends Xn{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const ud="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),iy=` 	
\r=`.split(""),eR=(()=>{const s=new Array(128);for(let t=0;t<s.length;t+=1)s[t]=-1;for(let t=0;t<iy.length;t+=1)s[iy[t].charCodeAt(0)]=-2;for(let t=0;t<ud.length;t+=1)s[ud[t].charCodeAt(0)]=t;return s})();function ay(s,t,r){if(s!==null)for(t.queue=t.queue<<8|s,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ud[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ud[n]),t.queuedBits-=6}}function Bj(s,t,r){const n=eR[s];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function oy(s){const t=[],r=c=>{t.push(String.fromCodePoint(c))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{rR(c,n,r)};for(let c=0;c<s.length;c+=1)Bj(s.charCodeAt(c),a,l);return t.join("")}function tR(s,t){if(s<=127){t(s);return}else if(s<=2047){t(192|s>>6),t(128|s&63);return}else if(s<=65535){t(224|s>>12),t(128|s>>6&63),t(128|s&63);return}else if(s<=1114111){t(240|s>>18),t(128|s>>12&63),t(128|s>>6&63),t(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function sR(s,t){for(let r=0;r<s.length;r+=1){let n=s.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(s.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}tR(n,t)}}function rR(s,t,r){if(t.utf8seq===0){if(s<=127){r(s);return}for(let n=1;n<6;n+=1)if((s>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=s&31;else if(t.utf8seq===3)t.codepoint=s&15;else if(t.utf8seq===4)t.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|s&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function nR(s){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<s.length;a+=1)Bj(s.charCodeAt(a),r,n);return new Uint8Array(t)}function iR(s){const t=[];return sR(s,r=>t.push(r)),new Uint8Array(t)}function aR(s){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return s.forEach(a=>ay(a,r,n)),ay(null,r,n),t.join("")}function oR(s){return Math.round(Date.now()/1e3)+s}function lR(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const t=Math.random()*16|0;return(s=="x"?t:t&3|8).toString(16)})}const nr=()=>typeof window<"u"&&typeof document<"u",fi={tested:!1,writable:!1},qj=()=>{if(!nr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(fi.tested)return fi.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),fi.tested=!0,fi.writable=!0}catch{fi.tested=!0,fi.writable=!1}return fi.writable};function cR(s){const t={},r=new URL(s);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,l)=>{t[l]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const Hj=s=>{let t;return s?t=s:typeof fetch>"u"?t=(...r)=>Ii(async()=>{const{default:n}=await Promise.resolve().then(()=>Ya);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},dR=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",ba=async(s,t,r)=>{await s.setItem(t,JSON.stringify(r))},pi=async(s,t)=>{const r=await s.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},In=async(s,t)=>{await s.removeItem(t)};class Fd{constructor(){this.promise=new Fd.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Fd.promiseConstructor=Promise;function Zh(s){const t=s.split(".");if(t.length!==3)throw new Um("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!YO.test(t[n]))throw new Um("JWT not in base64url format");return{header:JSON.parse(oy(t[0])),payload:JSON.parse(oy(t[1])),signature:nR(t[2]),raw:{header:t[0],payload:t[1]}}}async function uR(s){return await new Promise(t=>{setTimeout(()=>t(null),s)})}function hR(s,t){return new Promise((n,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await s(l);if(!t(l,null,c)){n(c);return}}catch(c){if(!t(l,c)){a(c);return}}})()})}function mR(s){return("0"+s.toString(16)).substr(-2)}function fR(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let l=0;l<56;l++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,mR).join("")}async function pR(s){const r=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function gR(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const r=await pR(s);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ma(s,t,r=!1){const n=fR();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await ba(s,`${t}-code-verifier`,a);const l=await gR(n);return[l,n===l?"plain":"s256"]}const xR=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function vR(s){const t=s.headers.get(Mm);if(!t||!t.match(xR))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function yR(s){if(!s)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(s<=t)throw new Error("JWT has expired")}function jR(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const wR=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function fa(s){if(!wR.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function em(){const s={};return new Proxy(s,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ly(s){return JSON.parse(JSON.stringify(s))}var _R=function(s,t){var r={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&t.indexOf(n)<0&&(r[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(r[n[a]]=s[n[a]]);return r};const gi=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),bR=[502,503,504];async function cy(s){var t;if(!dR(s))throw new Fm(gi(s),0);if(bR.includes(s.status))throw new Fm(gi(s),s.status);let r;try{r=await s.json()}catch(l){throw new Wj(gi(l),l)}let n;const a=vR(s);if(a&&a.getTime()>=zj["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new ny(gi(r),s.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ln}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new ny(gi(r),s.status,r.weak_password.reasons);throw new XO(gi(r),s.status||500,n)}const NR=(s,t,r,n)=>{const a={method:s,headers:t?.headers||{}};return s==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function ct(s,t,r,n){var a;const l=Object.assign({},n?.headers);l[Mm]||(l[Mm]=zj["2024-01-01"].name),n?.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const c=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(c.redirect_to=n.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",m=await SR(s,t,r+d,{headers:l,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(m):{data:Object.assign({},m),error:null}}async function SR(s,t,r,n,a,l){const c=NR(t,n,a,l);let d;try{d=await s(r,Object.assign({},c))}catch(m){throw console.error(m),new Fm(gi(m),0)}if(d.ok||await cy(d),n?.noResolveJson)return d;try{return await d.json()}catch(m){await cy(m)}}function Kr(s){var t;let r=null;kR(s)&&(r=Object.assign({},s),s.expires_at||(r.expires_at=oR(s.expires_in)));const n=(t=s.user)!==null&&t!==void 0?t:s;return{data:{session:r,user:n},error:null}}function dy(s){const t=Kr(s);return!t.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=s.weak_password),t}function Fn(s){var t;return{data:{user:(t=s.user)!==null&&t!==void 0?t:s},error:null}}function ER(s){return{data:s,error:null}}function CR(s){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:l}=s,c=_R(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:l},m=Object.assign({},c);return{data:{properties:d,user:m},error:null}}function TR(s){return s}function kR(s){return s.access_token&&s.refresh_token&&s.expires_in}const tm=["global","local","others"];var OR=function(s,t){var r={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&t.indexOf(n)<0&&(r[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(r[n[a]]=s[n[a]]);return r};class RR{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Hj(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=tm[0]){if(tm.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${tm.join(", ")}`);try{return await ct(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(st(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await ct(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Fn})}catch(n){if(st(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=OR(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await ct(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:CR,redirectTo:r?.redirectTo})}catch(r){if(st(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ct(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Fn})}catch(r){if(st(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,l,c,d,m;try{const h={nextPage:null,lastPage:0,total:0},f=await ct(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:TR});if(f.error)throw f.error;const p=await f.json(),w=(c=f.headers.get("x-total-count"))!==null&&c!==void 0?c:0,v=(m=(d=f.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&m!==void 0?m:[];return v.length>0&&(v.forEach(j=>{const y=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(j.split(";")[1].split("=")[1]);h[`${b}Page`]=y}),h.total=parseInt(w)),{data:Object.assign(Object.assign({},p),h),error:null}}catch(h){if(st(h))return{data:{users:[]},error:h};throw h}}async getUserById(t){fa(t);try{return await ct(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Fn})}catch(r){if(st(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){fa(t);try{return await ct(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Fn})}catch(n){if(st(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){fa(t);try{return await ct(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Fn})}catch(n){if(st(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){fa(t.userId);try{const{data:r,error:n}=await ct(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(st(r))return{data:null,error:r};throw r}}async _deleteFactor(t){fa(t.userId),fa(t.id);try{return{data:await ct(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(st(r))return{data:null,error:r};throw r}}}function uy(s={}){return{getItem:t=>s[t]||null,setItem:(t,r)=>{s[t]=r},removeItem:t=>{delete s[t]}}}function PR(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const pa={debug:!!(globalThis&&qj()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Vj extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class IR extends Vj{}async function AR(s,t,r){pa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),pa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){pa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,a.name);try{return await r()}finally{pa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,a.name)}}else{if(t===0)throw pa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new IR(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(pa.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}PR();const DR={url:HO,storageKey:VO,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:GO,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function hy(s,t,r){return await r()}const ga={};class tl{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=tl.nextInstanceID,tl.nextInstanceID+=1,this.instanceID>0&&nr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},DR),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new RR({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Hj(a.fetch),this.lock=a.lock||hy,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:nr()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=AR:this.lock=hy,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:qj()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=uy(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=uy(this.memoryStorage)),nr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=ga[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){ga[this.storageKey]=Object.assign(Object.assign({},ga[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=ga[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ga[this.storageKey]=Object.assign(Object.assign({},ga[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Uj}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=cR(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),nr()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:l}=await this._getSessionFromURL(r,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),ZO(l)){const m=(t=l.details)===null||t===void 0?void 0:t.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return st(r)?{error:r}:{error:new Wj("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Kr}),{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const m=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:h,session:m},error:null}}catch(l){if(st(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var r,n,a;try{let l;if("email"in t){const{email:f,password:p,options:w}=t;let v=null,j=null;this.flowType==="pkce"&&([v,j]=await ma(this.storage,this.storageKey)),l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:w?.emailRedirectTo,body:{email:f,password:p,data:(r=w?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:w?.captchaToken},code_challenge:v,code_challenge_method:j},xform:Kr})}else if("phone"in t){const{phone:f,password:p,options:w}=t;l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:p,data:(n=w?.data)!==null&&n!==void 0?n:{},channel:(a=w?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:w?.captchaToken}},xform:Kr})}else throw new Uc("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const m=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:h,session:m},error:null}}catch(l){if(st(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:c,options:d}=t;r=await ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:dy})}else if("phone"in t){const{phone:l,password:c,options:d}=t;r=await ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:dy})}else throw new Uc("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Fc}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(st(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,l,c,d,m,h,f,p,w,v;let j,y;if("message"in t)j=t.message,y=t.signature;else{const{chain:b,wallet:C,statement:E,options:S}=t;let O;if(nr())if(typeof C=="object")O=C;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))O=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!S?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=C}const R=new URL((r=S?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in O&&O.signIn){const k=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S?.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),E?{statement:E}:null));let P;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")P=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)P=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)j=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),y=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");j=[`${R.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),...E?["",E,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(a=(n=S?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=S?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((c=S?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((d=S?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((m=S?.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((h=S?.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((p=(f=S?.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||p===void 0)&&p.length?["Resources",...S.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const k=await O.signMessage(new TextEncoder().encode(j),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=k}}try{const{data:b,error:C}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:j,signature:aR(y)},!((w=t.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Kr});if(C)throw C;return!b||!b.session||!b.user?{data:{user:null,session:null},error:new Fc}:(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign({},b),error:C})}catch(b){if(st(b))return{data:{user:null,session:null},error:b};throw b}}async _exchangeCodeForSession(t){const r=await pi(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:l,error:c}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Kr});if(await In(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Fc}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(st(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:l,nonce:c}=t,d=await ct(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Kr}),{data:m,error:h}=d;return h?{data:{user:null,session:null},error:h}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Fc}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:h})}catch(r){if(st(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,l,c;try{if("email"in t){const{email:d,options:m}=t;let h=null,f=null;this.flowType==="pkce"&&([h,f]=await ma(this.storage,this.storageKey));const{error:p}=await ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(r=m?.data)!==null&&r!==void 0?r:{},create_user:(n=m?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:h,code_challenge_method:f},redirectTo:m?.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in t){const{phone:d,options:m}=t,{data:h,error:f}=await ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=m?.data)!==null&&a!==void 0?a:{},create_user:(l=m?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},channel:(c=m?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:h?.message_id},error:f}}throw new Uc("You must provide either an email or phone number.")}catch(d){if(st(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(t){var r,n;try{let a,l;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:d}=await ct(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:Kr});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const m=c.session,h=c.user;return m?.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:h,session:m},error:null}}catch(a){if(st(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await ma(this.storage,this.storageKey)),await ct(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:ER})}catch(l){if(st(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ln;const{error:a}=await ct(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(st(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:l}=t,{error:c}=await ct(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in t){const{phone:n,type:a,options:l}=t,{data:c,error:d}=await ct(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:d}}throw new Uc("You must provide either an email or phone number and a type")}catch(r){if(st(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await pi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Qh:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const c=await pi(this.userStorage,this.storageKey+"-user");c?.user?t.user=c.user:t.user=em()}if(this.storage.isServer&&t.user){let c=this.suppressGetSessionWarning;t=new Proxy(t,{get:(m,h,f)=>(!c&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,h,f))})}return{data:{session:t},error:null}}const{session:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Fn}):await this._useSession(async r=>{var n,a,l;const{data:c,error:d}=r;if(d)throw d;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ln}:await ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:Fn})})}catch(r){if(st(r))return JO(r)&&(await this._removeSession(),await In(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:l}=n;if(l)throw l;if(!a.session)throw new Ln;const c=a.session;let d=null,m=null;this.flowType==="pkce"&&t.email!=null&&([d,m]=await ma(this.storage,this.storageKey));const{data:h,error:f}=await ct(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:d,code_challenge_method:m}),jwt:c.access_token,xform:Fn});if(f)throw f;return c.user=h.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(n){if(st(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ln;const r=Date.now()/1e3;let n=r,a=!0,l=null;const{payload:c}=Zh(t.access_token);if(c.exp&&(n=c.exp,a=n<=r),a){const{session:d,error:m}=await this._callRefreshToken(t.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:m}=await this._getUser(t.access_token);if(m)throw m;l={access_token:t.access_token,refresh_token:t.refresh_token,user:d.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(r){if(st(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:c,error:d}=r;if(d)throw d;t=(n=c.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Ln;const{session:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(st(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!nr())throw new zc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new zc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ry("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new zc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new ry("No code detected.");const{data:E,error:S}=await this._exchangeCodeForSession(t.code);if(S)throw S;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:E.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:d,expires_at:m,token_type:h}=t;if(!l||!d||!c||!h)throw new zc("No session defined in URL");const f=Math.round(Date.now()/1e3),p=parseInt(d);let w=f+p;m&&(w=parseInt(m));const v=w-f;v*1e3<=_a&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${p}s`);const j=w-p;f-j>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",j,w,f):f-j<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",j,w,f);const{data:y,error:b}=await this._getUser(l);if(b)throw b;const C={provider_token:n,provider_refresh_token:a,access_token:l,expires_in:p,expires_at:w,refresh_token:c,token_type:h,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:C,redirectType:t.type},error:null}}catch(n){if(st(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await pi(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:l}=r;if(l)return{error:l};const c=(n=a.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:d}=await this.admin.signOut(c,t);if(d&&!(QO(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return t!=="others"&&(await this._removeSession(),await In(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=lR(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:l},error:c}=r;if(c)throw c;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await ma(this.storage,this.storageKey,!0));try{return await ct(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(st(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(st(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async l=>{var c,d,m,h,f;const{data:p,error:w}=l;if(w)throw w;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=t.options)===null||d===void 0?void 0:d.scopes,queryParams:(m=t.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await ct(this.fetch,"GET",v,{headers:this.headers,jwt:(f=(h=p.session)===null||h===void 0?void 0:h.access_token)!==null&&f!==void 0?f:void 0})});if(a)throw a;return nr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(st(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:l,error:c}=r;if(c)throw c;return await ct(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(st(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await hR(async a=>(a>0&&await uR(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await ct(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Kr})),(a,l)=>{const c=200*Math.pow(2,a);return l&&Jh(l)&&Date.now()+c-n<_a})}catch(n){if(this._debug(r,"error",n),st(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),nr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await pi(this.storage,this.storageKey);if(a&&this.userStorage){let c=await pi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await ba(this.userStorage,this.storageKey+"-user",c)),a.user=(t=c?.user)!==null&&t!==void 0?t:em()}else if(a&&!a.user&&!a.user){const c=await pi(this.storage,this.storageKey+"-user");c&&c?.user?(a.user=c.user,await In(this.storage,this.storageKey+"-user"),await ba(this.storage,this.storageKey,a)):a.user=em()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const l=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Qh;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${Qh}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),Jh(c)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(a.access_token);!d&&c?.user?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(n,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ln;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Fd;const{data:l,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!l.session)throw new Ln;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={session:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(a,"error",l),st(l)){const c={session:null,error:l};return Jh(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(t,r)}catch(m){l.push(m)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await ba(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const l=ly(a);await ba(this.storage,this.storageKey,l)}else{const a=ly(r);await ba(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await In(this.storage,this.storageKey),await In(this.storage,this.storageKey+"-code-verifier"),await In(this.storage,this.storageKey+"-user"),this.userStorage&&await In(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&nr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),_a);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/_a);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${_a}ms, refresh threshold is ${Lm} ticks`),a<=Lm&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Vj)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!nr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,c]=await ma(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(d.toString())}if(n?.queryParams){const l=new URLSearchParams(n.queryParams);a.push(l.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;return l?{data:null,error:l}:await ct(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(st(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:l,error:c}=r;if(c)return{data:null,error:c};const d=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:m,error:h}=await ct(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(n=l?.session)===null||n===void 0?void 0:n.access_token});return h?{data:null,error:h}:(t.factorType==="totp"&&(!((a=m?.totp)===null||a===void 0)&&a.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(r){if(st(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;if(l)return{data:null,error:l};const{data:c,error:d}=await ct(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:d})})}catch(r){if(st(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;return l?{data:null,error:l}:await ct(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(st(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=t?.factors||[],a=n.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=n.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:n,totp:a,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:l}=t;if(l)return{data:null,error:l};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=Zh(a.access_token);let d=null;c.aal&&(d=c.aal);let m=d;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(p=>p.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const f=c.amr||[];return{data:{currentLevel:d,nextLevel:m,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(d=>d.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(d=>d.kid===t),n&&this.jwks_cached_at+KO>a)return n;const{data:l,error:c}=await ct(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,n=l.keys.find(d=>d.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:v,error:j}=await this.getSession();if(j||!v.session)return{data:null,error:j};n=v.session.access_token}const{header:a,payload:l,signature:c,raw:{header:d,payload:m}}=Zh(n);r?.allowExpired||yR(l.exp);const h=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!h){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:l,header:a,signature:c},error:null}}const f=jR(a.alg),p=await crypto.subtle.importKey("jwk",h,f,!0,["verify"]);if(!await crypto.subtle.verify(f,p,c,iR(`${d}.${m}`)))throw new Um("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(n){if(st(n))return{data:null,error:n};throw n}}}tl.nextInstanceID=0;const $R=tl;class LR extends $R{constructor(t){super(t)}}var MR=function(s,t,r,n){function a(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(f){try{h(n.next(f))}catch(p){c(p)}}function m(f){try{h(n.throw(f))}catch(p){c(p)}}function h(f){f.done?l(f.value):a(f.value).then(d,m)}h((n=n.apply(s,t||[])).next())})};class FR{constructor(t,r,n){var a,l,c;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const d=BO(t),m=new URL(d);this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const h=`sb-${m.hostname.split(".")[0]}-auth-token`,f={db:DO,realtime:LO,auth:Object.assign(Object.assign({},$O),{storageKey:h}),global:AO},p=qO(n??{},f);this.storageKey=(a=p.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=p.global.headers)!==null&&l!==void 0?l:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(w,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=p.auth)!==null&&c!==void 0?c:{},this.headers,p.global.fetch),this.fetch=zO(r,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new tO(new URL("rest/v1",m).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new RO(this.storageUrl.href,this.headers,this.fetch,n?.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new Hk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return MR(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:l,flowType:c,lock:d,debug:m},h,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new LR({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),h),storageKey:l,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:c,lock:d,debug:m,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new vO(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Gj=(s,t,r)=>new FR(s,t,r);function UR(){if(typeof window<"u"||typeof process>"u")return!1;const s=process.version;if(s==null)return!1;const t=s.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}UR()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Yj="https://wkzjovhlljeaqzoytpeb.supabase.co",Kj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndrempvdmhsbGplYXF6b3l0cGViIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkwNDY2MjIsImV4cCI6MjA2NDYyMjYyMn0.mx8PnQJaMochaPbjYUmwzlVNIULM05LUDBIM7OFFjZ8";console.log(" Supabase client initialized with:",{url:Yj,key:Kj.substring(0,20)+"...",source:"environment"});const I=Gj(Yj,Kj,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}}),zR=()=>{const[s,t]=x.useState(""),[r,n]=x.useState(""),[a,l]=x.useState(!1),c=ur(),{toast:d}=Xe(),m=async h=>{h.preventDefault(),l(!0),console.log(" Attempting login with:",{email:s,password:"***hidden***"}),console.log(" Using Supabase URL:",I.supabaseUrl);try{console.log(" Calling admin-login-v2 function...");const{data:f,error:p}=await I.functions.invoke("admin-login-v2",{body:{email:s,password:r}});if(console.log(" Login response data:",f),console.log(" Login response error:",p),p)throw console.error(" Supabase function error:",p),p;f?.success?(console.log(" Login successful, setting localStorage and navigating"),localStorage.setItem("adminAuth","true"),d({title:"  ",description:"    "}),c("/admin-aa-smn-justme9003")):(console.log(" Login failed, data.success =",f?.success),console.log(" Error message:",f?.error),d({title:"   ",description:f?.error||"   ",variant:"destructive"}))}catch(f){console.error(" Login error caught:",f),console.error(" Error details:",{message:f instanceof Error?f.message:"Unknown error",stack:f instanceof Error?f.stack:void 0,fullError:f}),d({title:"",description:"    ",variant:"destructive"})}finally{console.log(" Login process ended, disabling loading."),l(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/10 to-secondary/10 p-4",dir:"rtl",children:[e.jsxs("div",{className:"fixed top-4 left-4 z-50 flex gap-2",children:[e.jsx(hl,{}),e.jsx(ml,{})]}),e.jsxs($,{className:"w-full max-w-md",children:[e.jsxs(q,{className:"text-center",children:[e.jsx(V,{className:"text-2xl font-bold text-primary",children:"  "}),e.jsx(Ze,{children:"      "})]}),e.jsxs(M,{children:[e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(et,{htmlFor:"email",className:"flex items-center gap-2",children:[e.jsx(X1,{className:"w-4 h-4"})," "]}),e.jsx(it,{id:"email",type:"email",value:s,onChange:h=>t(h.target.value),placeholder:"admin@example.com",required:!0,className:"text-right"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(et,{htmlFor:"password",className:"flex items-center gap-2",children:[e.jsx(j0,{className:"w-4 h-4"})," "]}),e.jsx(it,{id:"password",type:"password",value:r,onChange:h=>n(h.target.value),placeholder:"",required:!0,className:"text-right"})]}),e.jsx(L,{type:"submit",className:"w-full",disabled:a,children:a?"  ...":" "})]}),e.jsx("div",{className:"mt-4 text-center flex gap-2 justify-center"})]})]})]})};var sm="focusScope.autoFocusOnMount",rm="focusScope.autoFocusOnUnmount",my={bubbles:!1,cancelable:!0},WR="FocusScope",Ud=x.forwardRef((s,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:l,...c}=s,[d,m]=x.useState(null),h=Xt(a),f=Xt(l),p=x.useRef(null),w=pt(t,y=>m(y)),v=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(n){let y=function(S){if(v.paused||!d)return;const O=S.target;d.contains(O)?p.current=O:Mn(p.current,{select:!0})},b=function(S){if(v.paused||!d)return;const O=S.relatedTarget;O!==null&&(d.contains(O)||Mn(p.current,{select:!0}))},C=function(S){if(document.activeElement===document.body)for(const R of S)R.removedNodes.length>0&&Mn(d)};document.addEventListener("focusin",y),document.addEventListener("focusout",b);const E=new MutationObserver(C);return d&&E.observe(d,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",b),E.disconnect()}}},[n,d,v.paused]),x.useEffect(()=>{if(d){py.add(v);const y=document.activeElement;if(!d.contains(y)){const C=new CustomEvent(sm,my);d.addEventListener(sm,h),d.dispatchEvent(C),C.defaultPrevented||(BR(YR(Xj(d)),{select:!0}),document.activeElement===y&&Mn(d))}return()=>{d.removeEventListener(sm,h),setTimeout(()=>{const C=new CustomEvent(rm,my);d.addEventListener(rm,f),d.dispatchEvent(C),C.defaultPrevented||Mn(y??document.body,{select:!0}),d.removeEventListener(rm,f),py.remove(v)},0)}}},[d,h,f,v]);const j=x.useCallback(y=>{if(!r&&!n||v.paused)return;const b=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,C=document.activeElement;if(b&&C){const E=y.currentTarget,[S,O]=qR(E);S&&O?!y.shiftKey&&C===O?(y.preventDefault(),r&&Mn(S,{select:!0})):y.shiftKey&&C===S&&(y.preventDefault(),r&&Mn(O,{select:!0})):C===E&&y.preventDefault()}},[r,n,v.paused]);return e.jsx(ze.div,{tabIndex:-1,...c,ref:w,onKeyDown:j})});Ud.displayName=WR;function BR(s,{select:t=!1}={}){const r=document.activeElement;for(const n of s)if(Mn(n,{select:t}),document.activeElement!==r)return}function qR(s){const t=Xj(s),r=fy(t,s),n=fy(t.reverse(),s);return[r,n]}function Xj(s){const t=[],r=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function fy(s,t){for(const r of s)if(!HR(r,{upTo:t}))return r}function HR(s,{upTo:t}){if(getComputedStyle(s).visibility==="hidden")return!0;for(;s;){if(t!==void 0&&s===t)return!1;if(getComputedStyle(s).display==="none")return!0;s=s.parentElement}return!1}function VR(s){return s instanceof HTMLInputElement&&"select"in s}function Mn(s,{select:t=!1}={}){if(s&&s.focus){const r=document.activeElement;s.focus({preventScroll:!0}),s!==r&&VR(s)&&t&&s.select()}}var py=GR();function GR(){let s=[];return{add(t){const r=s[0];t!==r&&r?.pause(),s=gy(s,t),s.unshift(t)},remove(t){s=gy(s,t),s[0]?.resume()}}}function gy(s,t){const r=[...s],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function YR(s){return s.filter(t=>t.tagName!=="A")}var nm=0;function Wf(){x.useEffect(()=>{const s=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",s[0]??xy()),document.body.insertAdjacentElement("beforeend",s[1]??xy()),nm++,()=>{nm===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),nm--}},[])}function xy(){const s=document.createElement("span");return s.setAttribute("data-radix-focus-guard",""),s.tabIndex=0,s.style.outline="none",s.style.opacity="0",s.style.position="fixed",s.style.pointerEvents="none",s}var br=function(){return br=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},br.apply(this,arguments)};function Qj(s,t){var r={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&t.indexOf(n)<0&&(r[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(r[n[a]]=s[n[a]]);return r}function KR(s,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return s.concat(l||Array.prototype.slice.call(t))}var Jc="right-scroll-bar-position",Zc="width-before-scroll-bar",XR="with-scroll-bars-hidden",QR="--removed-body-scroll-bar-size";function im(s,t){return typeof s=="function"?s(t):s&&(s.current=t),s}function JR(s,t){var r=x.useState(function(){return{value:s,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var ZR=typeof window<"u"?x.useLayoutEffect:x.useEffect,vy=new WeakMap;function eP(s,t){var r=JR(null,function(n){return s.forEach(function(a){return im(a,n)})});return ZR(function(){var n=vy.get(r);if(n){var a=new Set(n),l=new Set(s),c=r.current;a.forEach(function(d){l.has(d)||im(d,null)}),l.forEach(function(d){a.has(d)||im(d,c)})}vy.set(r,s)},[s]),r}function tP(s){return s}function sP(s,t){t===void 0&&(t=tP);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:s},useMedium:function(l){var c=t(l,n);return r.push(c),function(){r=r.filter(function(d){return d!==c})}},assignSyncMedium:function(l){for(n=!0;r.length;){var c=r;r=[],c.forEach(l)}r={push:function(d){return l(d)},filter:function(){return r}}},assignMedium:function(l){n=!0;var c=[];if(r.length){var d=r;r=[],d.forEach(l),c=r}var m=function(){var f=c;c=[],f.forEach(l)},h=function(){return Promise.resolve().then(m)};h(),r={push:function(f){c.push(f),h()},filter:function(f){return c=c.filter(f),r}}}};return a}function rP(s){s===void 0&&(s={});var t=sP(null);return t.options=br({async:!0,ssr:!1},s),t}var Jj=function(s){var t=s.sideCar,r=Qj(s,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return x.createElement(n,br({},r))};Jj.isSideCarExport=!0;function nP(s,t){return s.useMedium(t),Jj}var Zj=rP(),am=function(){},zd=x.forwardRef(function(s,t){var r=x.useRef(null),n=x.useState({onScrollCapture:am,onWheelCapture:am,onTouchMoveCapture:am}),a=n[0],l=n[1],c=s.forwardProps,d=s.children,m=s.className,h=s.removeScrollBar,f=s.enabled,p=s.shards,w=s.sideCar,v=s.noRelative,j=s.noIsolation,y=s.inert,b=s.allowPinchZoom,C=s.as,E=C===void 0?"div":C,S=s.gapMode,O=Qj(s,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),R=w,k=eP([r,t]),P=br(br({},O),a);return x.createElement(x.Fragment,null,f&&x.createElement(R,{sideCar:Zj,removeScrollBar:h,shards:p,noRelative:v,noIsolation:j,inert:y,setCallbacks:l,allowPinchZoom:!!b,lockRef:r,gapMode:S}),c?x.cloneElement(x.Children.only(d),br(br({},P),{ref:k})):x.createElement(E,br({},P,{className:m,ref:k}),d))});zd.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};zd.classNames={fullWidth:Zc,zeroRight:Jc};var iP=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function aP(){if(!document)return null;var s=document.createElement("style");s.type="text/css";var t=iP();return t&&s.setAttribute("nonce",t),s}function oP(s,t){s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}function lP(s){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(s)}var cP=function(){var s=0,t=null;return{add:function(r){s==0&&(t=aP())&&(oP(t,r),lP(t)),s++},remove:function(){s--,!s&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},dP=function(){var s=cP();return function(t,r){x.useEffect(function(){return s.add(t),function(){s.remove()}},[t&&r])}},ew=function(){var s=dP(),t=function(r){var n=r.styles,a=r.dynamic;return s(n,a),null};return t},uP={left:0,top:0,right:0,gap:0},om=function(s){return parseInt(s||"",10)||0},hP=function(s){var t=window.getComputedStyle(document.body),r=t[s==="padding"?"paddingLeft":"marginLeft"],n=t[s==="padding"?"paddingTop":"marginTop"],a=t[s==="padding"?"paddingRight":"marginRight"];return[om(r),om(n),om(a)]},mP=function(s){if(s===void 0&&(s="margin"),typeof window>"u")return uP;var t=hP(s),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},fP=ew(),Oa="data-scroll-locked",pP=function(s,t,r,n){var a=s.left,l=s.top,c=s.right,d=s.gap;return r===void 0&&(r="margin"),`
  .`.concat(XR,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(d,"px ").concat(n,`;
  }
  body[`).concat(Oa,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(d,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(d,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Jc,` {
    right: `).concat(d,"px ").concat(n,`;
  }
  
  .`).concat(Zc,` {
    margin-right: `).concat(d,"px ").concat(n,`;
  }
  
  .`).concat(Jc," .").concat(Jc,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Zc," .").concat(Zc,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Oa,`] {
    `).concat(QR,": ").concat(d,`px;
  }
`)},yy=function(){var s=parseInt(document.body.getAttribute(Oa)||"0",10);return isFinite(s)?s:0},gP=function(){x.useEffect(function(){return document.body.setAttribute(Oa,(yy()+1).toString()),function(){var s=yy()-1;s<=0?document.body.removeAttribute(Oa):document.body.setAttribute(Oa,s.toString())}},[])},xP=function(s){var t=s.noRelative,r=s.noImportant,n=s.gapMode,a=n===void 0?"margin":n;gP();var l=x.useMemo(function(){return mP(a)},[a]);return x.createElement(fP,{styles:pP(l,!t,a,r?"":"!important")})},zm=!1;if(typeof window<"u")try{var Wc=Object.defineProperty({},"passive",{get:function(){return zm=!0,!0}});window.addEventListener("test",Wc,Wc),window.removeEventListener("test",Wc,Wc)}catch{zm=!1}var xa=zm?{passive:!1}:!1,vP=function(s){return s.tagName==="TEXTAREA"},tw=function(s,t){if(!(s instanceof Element))return!1;var r=window.getComputedStyle(s);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!vP(s)&&r[t]==="visible")},yP=function(s){return tw(s,"overflowY")},jP=function(s){return tw(s,"overflowX")},jy=function(s,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=sw(s,n);if(a){var l=rw(s,n),c=l[1],d=l[2];if(c>d)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},wP=function(s){var t=s.scrollTop,r=s.scrollHeight,n=s.clientHeight;return[t,r,n]},_P=function(s){var t=s.scrollLeft,r=s.scrollWidth,n=s.clientWidth;return[t,r,n]},sw=function(s,t){return s==="v"?yP(t):jP(t)},rw=function(s,t){return s==="v"?wP(t):_P(t)},bP=function(s,t){return s==="h"&&t==="rtl"?-1:1},NP=function(s,t,r,n,a){var l=bP(s,window.getComputedStyle(t).direction),c=l*n,d=r.target,m=t.contains(d),h=!1,f=c>0,p=0,w=0;do{if(!d)break;var v=rw(s,d),j=v[0],y=v[1],b=v[2],C=y-b-l*j;(j||C)&&sw(s,d)&&(p+=C,w+=j);var E=d.parentNode;d=E&&E.nodeType===Node.DOCUMENT_FRAGMENT_NODE?E.host:E}while(!m&&d!==document.body||m&&(t.contains(d)||t===d));return(f&&Math.abs(p)<1||!f&&Math.abs(w)<1)&&(h=!0),h},Bc=function(s){return"changedTouches"in s?[s.changedTouches[0].clientX,s.changedTouches[0].clientY]:[0,0]},wy=function(s){return[s.deltaX,s.deltaY]},_y=function(s){return s&&"current"in s?s.current:s},SP=function(s,t){return s[0]===t[0]&&s[1]===t[1]},EP=function(s){return`
  .block-interactivity-`.concat(s,` {pointer-events: none;}
  .allow-interactivity-`).concat(s,` {pointer-events: all;}
`)},CP=0,va=[];function TP(s){var t=x.useRef([]),r=x.useRef([0,0]),n=x.useRef(),a=x.useState(CP++)[0],l=x.useState(ew)[0],c=x.useRef(s);x.useEffect(function(){c.current=s},[s]),x.useEffect(function(){if(s.inert){document.body.classList.add("block-interactivity-".concat(a));var y=KR([s.lockRef.current],(s.shards||[]).map(_y),!0).filter(Boolean);return y.forEach(function(b){return b.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),y.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(a))})}}},[s.inert,s.lockRef.current,s.shards]);var d=x.useCallback(function(y,b){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!c.current.allowPinchZoom;var C=Bc(y),E=r.current,S="deltaX"in y?y.deltaX:E[0]-C[0],O="deltaY"in y?y.deltaY:E[1]-C[1],R,k=y.target,P=Math.abs(S)>Math.abs(O)?"h":"v";if("touches"in y&&P==="h"&&k.type==="range")return!1;var F=jy(P,k);if(!F)return!0;if(F?R=P:(R=P==="v"?"h":"v",F=jy(P,k)),!F)return!1;if(!n.current&&"changedTouches"in y&&(S||O)&&(n.current=R),!R)return!0;var ee=n.current||R;return NP(ee,b,y,ee==="h"?S:O)},[]),m=x.useCallback(function(y){var b=y;if(!(!va.length||va[va.length-1]!==l)){var C="deltaY"in b?wy(b):Bc(b),E=t.current.filter(function(R){return R.name===b.type&&(R.target===b.target||b.target===R.shadowParent)&&SP(R.delta,C)})[0];if(E&&E.should){b.cancelable&&b.preventDefault();return}if(!E){var S=(c.current.shards||[]).map(_y).filter(Boolean).filter(function(R){return R.contains(b.target)}),O=S.length>0?d(b,S[0]):!c.current.noIsolation;O&&b.cancelable&&b.preventDefault()}}},[]),h=x.useCallback(function(y,b,C,E){var S={name:y,delta:b,target:C,should:E,shadowParent:kP(C)};t.current.push(S),setTimeout(function(){t.current=t.current.filter(function(O){return O!==S})},1)},[]),f=x.useCallback(function(y){r.current=Bc(y),n.current=void 0},[]),p=x.useCallback(function(y){h(y.type,wy(y),y.target,d(y,s.lockRef.current))},[]),w=x.useCallback(function(y){h(y.type,Bc(y),y.target,d(y,s.lockRef.current))},[]);x.useEffect(function(){return va.push(l),s.setCallbacks({onScrollCapture:p,onWheelCapture:p,onTouchMoveCapture:w}),document.addEventListener("wheel",m,xa),document.addEventListener("touchmove",m,xa),document.addEventListener("touchstart",f,xa),function(){va=va.filter(function(y){return y!==l}),document.removeEventListener("wheel",m,xa),document.removeEventListener("touchmove",m,xa),document.removeEventListener("touchstart",f,xa)}},[]);var v=s.removeScrollBar,j=s.inert;return x.createElement(x.Fragment,null,j?x.createElement(l,{styles:EP(a)}):null,v?x.createElement(xP,{noRelative:s.noRelative,gapMode:s.gapMode}):null)}function kP(s){for(var t=null;s!==null;)s instanceof ShadowRoot&&(t=s.host,s=s.host),s=s.parentNode;return t}const OP=nP(Zj,TP);var Wd=x.forwardRef(function(s,t){return x.createElement(zd,br({},s,{ref:t,sideCar:OP}))});Wd.classNames=zd.classNames;var RP=function(s){if(typeof document>"u")return null;var t=Array.isArray(s)?s[0]:s;return t.ownerDocument.body},ya=new WeakMap,qc=new WeakMap,Hc={},lm=0,nw=function(s){return s&&(s.host||nw(s.parentNode))},PP=function(s,t){return t.map(function(r){if(s.contains(r))return r;var n=nw(r);return n&&s.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",s,". Doing nothing"),null)}).filter(function(r){return!!r})},IP=function(s,t,r,n){var a=PP(t,Array.isArray(s)?s:[s]);Hc[r]||(Hc[r]=new WeakMap);var l=Hc[r],c=[],d=new Set,m=new Set(a),h=function(p){!p||d.has(p)||(d.add(p),h(p.parentNode))};a.forEach(h);var f=function(p){!p||m.has(p)||Array.prototype.forEach.call(p.children,function(w){if(d.has(w))f(w);else try{var v=w.getAttribute(n),j=v!==null&&v!=="false",y=(ya.get(w)||0)+1,b=(l.get(w)||0)+1;ya.set(w,y),l.set(w,b),c.push(w),y===1&&j&&qc.set(w,!0),b===1&&w.setAttribute(r,"true"),j||w.setAttribute(n,"true")}catch(C){console.error("aria-hidden: cannot operate on ",w,C)}})};return f(t),d.clear(),lm++,function(){c.forEach(function(p){var w=ya.get(p)-1,v=l.get(p)-1;ya.set(p,w),l.set(p,v),w||(qc.has(p)||p.removeAttribute(n),qc.delete(p)),v||p.removeAttribute(r)}),lm--,lm||(ya=new WeakMap,ya=new WeakMap,qc=new WeakMap,Hc={})}},Bf=function(s,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(s)?s:[s]),a=RP(s);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),IP(n,a,r,"aria-hidden")):function(){return null}},Bd="Dialog",[iw,qL]=Vs(Bd),[AP,hr]=iw(Bd),aw=s=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:c=!0}=s,d=x.useRef(null),m=x.useRef(null),[h,f]=en({prop:n,defaultProp:a??!1,onChange:l,caller:Bd});return e.jsx(AP,{scope:t,triggerRef:d,contentRef:m,contentId:lr(),titleId:lr(),descriptionId:lr(),open:h,onOpenChange:f,onOpenToggle:x.useCallback(()=>f(p=>!p),[f]),modal:c,children:r})};aw.displayName=Bd;var ow="DialogTrigger",lw=x.forwardRef((s,t)=>{const{__scopeDialog:r,...n}=s,a=hr(ow,r),l=pt(t,a.triggerRef);return e.jsx(ze.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Vf(a.open),...n,ref:l,onClick:Pe(s.onClick,a.onOpenToggle)})});lw.displayName=ow;var qf="DialogPortal",[DP,cw]=iw(qf,{forceMount:void 0}),dw=s=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=s,l=hr(qf,t);return e.jsx(DP,{scope:t,forceMount:r,children:x.Children.map(n,c=>e.jsx(ks,{present:r||l.open,children:e.jsx(il,{asChild:!0,container:a,children:c})}))})};dw.displayName=qf;var hd="DialogOverlay",uw=x.forwardRef((s,t)=>{const r=cw(hd,s.__scopeDialog),{forceMount:n=r.forceMount,...a}=s,l=hr(hd,s.__scopeDialog);return l.modal?e.jsx(ks,{present:n||l.open,children:e.jsx(LP,{...a,ref:t})}):null});uw.displayName=hd;var $P=Si("DialogOverlay.RemoveScroll"),LP=x.forwardRef((s,t)=>{const{__scopeDialog:r,...n}=s,a=hr(hd,r);return e.jsx(Wd,{as:$P,allowPinchZoom:!0,shards:[a.contentRef],children:e.jsx(ze.div,{"data-state":Vf(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Ti="DialogContent",hw=x.forwardRef((s,t)=>{const r=cw(Ti,s.__scopeDialog),{forceMount:n=r.forceMount,...a}=s,l=hr(Ti,s.__scopeDialog);return e.jsx(ks,{present:n||l.open,children:l.modal?e.jsx(MP,{...a,ref:t}):e.jsx(FP,{...a,ref:t})})});hw.displayName=Ti;var MP=x.forwardRef((s,t)=>{const r=hr(Ti,s.__scopeDialog),n=x.useRef(null),a=pt(t,r.contentRef,n);return x.useEffect(()=>{const l=n.current;if(l)return Bf(l)},[]),e.jsx(mw,{...s,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Pe(s.onCloseAutoFocus,l=>{l.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Pe(s.onPointerDownOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0;(c.button===2||d)&&l.preventDefault()}),onFocusOutside:Pe(s.onFocusOutside,l=>l.preventDefault())})}),FP=x.forwardRef((s,t)=>{const r=hr(Ti,s.__scopeDialog),n=x.useRef(!1),a=x.useRef(!1);return e.jsx(mw,{...s,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{s.onCloseAutoFocus?.(l),l.defaultPrevented||(n.current||r.triggerRef.current?.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{s.onInteractOutside?.(l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=l.target;r.triggerRef.current?.contains(c)&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),mw=x.forwardRef((s,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,...c}=s,d=hr(Ti,r),m=x.useRef(null),h=pt(t,m);return Wf(),e.jsxs(e.Fragment,{children:[e.jsx(Ud,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:e.jsx(za,{role:"dialog",id:d.contentId,"aria-describedby":d.descriptionId,"aria-labelledby":d.titleId,"data-state":Vf(d.open),...c,ref:h,onDismiss:()=>d.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(UP,{titleId:d.titleId}),e.jsx(WP,{contentRef:m,descriptionId:d.descriptionId})]})]})}),Hf="DialogTitle",fw=x.forwardRef((s,t)=>{const{__scopeDialog:r,...n}=s,a=hr(Hf,r);return e.jsx(ze.h2,{id:a.titleId,...n,ref:t})});fw.displayName=Hf;var pw="DialogDescription",gw=x.forwardRef((s,t)=>{const{__scopeDialog:r,...n}=s,a=hr(pw,r);return e.jsx(ze.p,{id:a.descriptionId,...n,ref:t})});gw.displayName=pw;var xw="DialogClose",vw=x.forwardRef((s,t)=>{const{__scopeDialog:r,...n}=s,a=hr(xw,r);return e.jsx(ze.button,{type:"button",...n,ref:t,onClick:Pe(s.onClick,()=>a.onOpenChange(!1))})});vw.displayName=xw;function Vf(s){return s?"open":"closed"}var yw="DialogTitleWarning",[HL,jw]=QS(yw,{contentName:Ti,titleName:Hf,docsSlug:"dialog"}),UP=({titleId:s})=>{const t=jw(yw),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return x.useEffect(()=>{s&&(document.getElementById(s)||console.error(r))},[r,s]),null},zP="DialogDescriptionWarning",WP=({contentRef:s,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${jw(zP).contentName}}.`;return x.useEffect(()=>{const a=s.current?.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,s,t]),null},BP=aw,qP=lw,HP=dw,ww=uw,_w=hw,bw=fw,Nw=gw,VP=vw;const on=BP,GP=qP,YP=HP,Sw=x.forwardRef(({className:s,...t},r)=>e.jsx(ww,{ref:r,className:Ue("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));Sw.displayName=ww.displayName;const kr=x.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(YP,{children:[e.jsx(Sw,{}),e.jsxs(_w,{ref:n,className:Ue("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...r,children:[t,e.jsxs(VP,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Vn,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));kr.displayName=_w.displayName;const Or=({className:s,...t})=>e.jsx("div",{className:Ue("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});Or.displayName="DialogHeader";const Di=({className:s,...t})=>e.jsx("div",{className:Ue("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Di.displayName="DialogFooter";const Rr=x.forwardRef(({className:s,...t},r)=>e.jsx(bw,{ref:r,className:Ue("text-lg font-semibold leading-none tracking-tight",s),...t}));Rr.displayName=bw.displayName;const Ka=x.forwardRef(({className:s,...t},r)=>e.jsx(Nw,{ref:r,className:Ue("text-sm text-muted-foreground",s),...t}));Ka.displayName=Nw.displayName;function Wm(s,[t,r]){return Math.min(r,Math.max(t,s))}var KP=x.createContext(void 0);function qd(s){const t=x.useContext(KP);return s||t||"ltr"}function XP(s){const t=x.useRef({value:s,previous:s});return x.useMemo(()=>(t.current.value!==s&&(t.current.previous=t.current.value,t.current.value=s),t.current.previous),[s])}var QP=[" ","Enter","ArrowUp","ArrowDown"],JP=[" ","Enter"],ki="Select",[Hd,Vd,ZP]=of(ki),[Xa,VL]=Vs(ki,[ZP,Va]),Gd=Va(),[e4,Qn]=Xa(ki),[t4,s4]=Xa(ki),Ew=s=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:l,value:c,defaultValue:d,onValueChange:m,dir:h,name:f,autoComplete:p,disabled:w,required:v,form:j}=s,y=Gd(t),[b,C]=x.useState(null),[E,S]=x.useState(null),[O,R]=x.useState(!1),k=qd(h),[P,F]=en({prop:n,defaultProp:a??!1,onChange:l,caller:ki}),[ee,ne]=en({prop:c,defaultProp:d,onChange:m,caller:ki}),pe=x.useRef(null),re=b?j||!!b.closest("form"):!0,[H,G]=x.useState(new Set),ge=Array.from(H).map(ie=>ie.props.value).join(";");return e.jsx(Cf,{...y,children:e.jsxs(e4,{required:v,scope:t,trigger:b,onTriggerChange:C,valueNode:E,onValueNodeChange:S,valueNodeHasChildren:O,onValueNodeHasChildrenChange:R,contentId:lr(),value:ee,onValueChange:ne,open:P,onOpenChange:F,dir:k,triggerPointerDownPosRef:pe,disabled:w,children:[e.jsx(Hd.Provider,{scope:t,children:e.jsx(t4,{scope:s.__scopeSelect,onNativeOptionAdd:x.useCallback(ie=>{G(xe=>new Set(xe).add(ie))},[]),onNativeOptionRemove:x.useCallback(ie=>{G(xe=>{const X=new Set(xe);return X.delete(ie),X})},[]),children:r})}),re?e.jsxs(Xw,{"aria-hidden":!0,required:v,tabIndex:-1,name:f,autoComplete:p,value:ee,onChange:ie=>ne(ie.target.value),disabled:w,form:j,children:[ee===void 0?e.jsx("option",{value:""}):null,Array.from(H)]},ge):null]})})};Ew.displayName=ki;var Cw="SelectTrigger",Tw=x.forwardRef((s,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=s,l=Gd(r),c=Qn(Cw,r),d=c.disabled||n,m=pt(t,c.onTriggerChange),h=Vd(r),f=x.useRef("touch"),[p,w,v]=Jw(y=>{const b=h().filter(S=>!S.disabled),C=b.find(S=>S.value===c.value),E=Zw(b,y,C);E!==void 0&&c.onValueChange(E.value)}),j=y=>{d||(c.onOpenChange(!0),v()),y&&(c.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return e.jsx(Pd,{asChild:!0,...l,children:e.jsx(ze.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:d,"data-disabled":d?"":void 0,"data-placeholder":Qw(c.value)?"":void 0,...a,ref:m,onClick:Pe(a.onClick,y=>{y.currentTarget.focus(),f.current!=="mouse"&&j(y)}),onPointerDown:Pe(a.onPointerDown,y=>{f.current=y.pointerType;const b=y.target;b.hasPointerCapture(y.pointerId)&&b.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(j(y),y.preventDefault())}),onKeyDown:Pe(a.onKeyDown,y=>{const b=p.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&w(y.key),!(b&&y.key===" ")&&QP.includes(y.key)&&(j(),y.preventDefault())})})})});Tw.displayName=Cw;var kw="SelectValue",Ow=x.forwardRef((s,t)=>{const{__scopeSelect:r,className:n,style:a,children:l,placeholder:c="",...d}=s,m=Qn(kw,r),{onValueNodeHasChildrenChange:h}=m,f=l!==void 0,p=pt(t,m.onValueNodeChange);return Qt(()=>{h(f)},[h,f]),e.jsx(ze.span,{...d,ref:p,style:{pointerEvents:"none"},children:Qw(m.value)?e.jsx(e.Fragment,{children:c}):l})});Ow.displayName=kw;var r4="SelectIcon",Rw=x.forwardRef((s,t)=>{const{__scopeSelect:r,children:n,...a}=s;return e.jsx(ze.span,{"aria-hidden":!0,...a,ref:t,children:n||""})});Rw.displayName=r4;var n4="SelectPortal",Pw=s=>e.jsx(il,{asChild:!0,...s});Pw.displayName=n4;var Oi="SelectContent",Iw=x.forwardRef((s,t)=>{const r=Qn(Oi,s.__scopeSelect),[n,a]=x.useState();if(Qt(()=>{a(new DocumentFragment)},[]),!r.open){const l=n;return l?Ua.createPortal(e.jsx(Aw,{scope:s.__scopeSelect,children:e.jsx(Hd.Slot,{scope:s.__scopeSelect,children:e.jsx("div",{children:s.children})})}),l):null}return e.jsx(Dw,{...s,ref:t})});Iw.displayName=Oi;var ir=10,[Aw,Jn]=Xa(Oi),i4="SelectContentImpl",a4=Si("SelectContent.RemoveScroll"),Dw=x.forwardRef((s,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:l,onPointerDownOutside:c,side:d,sideOffset:m,align:h,alignOffset:f,arrowPadding:p,collisionBoundary:w,collisionPadding:v,sticky:j,hideWhenDetached:y,avoidCollisions:b,...C}=s,E=Qn(Oi,r),[S,O]=x.useState(null),[R,k]=x.useState(null),P=pt(t,de=>O(de)),[F,ee]=x.useState(null),[ne,pe]=x.useState(null),re=Vd(r),[H,G]=x.useState(!1),ge=x.useRef(!1);x.useEffect(()=>{if(S)return Bf(S)},[S]),Wf();const ie=x.useCallback(de=>{const[Ne,...Ve]=re().map(ut=>ut.ref.current),[Ye]=Ve.slice(-1),tt=document.activeElement;for(const ut of de)if(ut===tt||(ut?.scrollIntoView({block:"nearest"}),ut===Ne&&R&&(R.scrollTop=0),ut===Ye&&R&&(R.scrollTop=R.scrollHeight),ut?.focus(),document.activeElement!==tt))return},[re,R]),xe=x.useCallback(()=>ie([F,S]),[ie,F,S]);x.useEffect(()=>{H&&xe()},[H,xe]);const{onOpenChange:X,triggerPointerDownPosRef:te}=E;x.useEffect(()=>{if(S){let de={x:0,y:0};const Ne=Ye=>{de={x:Math.abs(Math.round(Ye.pageX)-(te.current?.x??0)),y:Math.abs(Math.round(Ye.pageY)-(te.current?.y??0))}},Ve=Ye=>{de.x<=10&&de.y<=10?Ye.preventDefault():S.contains(Ye.target)||X(!1),document.removeEventListener("pointermove",Ne),te.current=null};return te.current!==null&&(document.addEventListener("pointermove",Ne),document.addEventListener("pointerup",Ve,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Ne),document.removeEventListener("pointerup",Ve,{capture:!0})}}},[S,X,te]),x.useEffect(()=>{const de=()=>X(!1);return window.addEventListener("blur",de),window.addEventListener("resize",de),()=>{window.removeEventListener("blur",de),window.removeEventListener("resize",de)}},[X]);const[oe,W]=Jw(de=>{const Ne=re().filter(tt=>!tt.disabled),Ve=Ne.find(tt=>tt.ref.current===document.activeElement),Ye=Zw(Ne,de,Ve);Ye&&setTimeout(()=>Ye.ref.current.focus())}),se=x.useCallback((de,Ne,Ve)=>{const Ye=!ge.current&&!Ve;(E.value!==void 0&&E.value===Ne||Ye)&&(ee(de),Ye&&(ge.current=!0))},[E.value]),we=x.useCallback(()=>S?.focus(),[S]),_e=x.useCallback((de,Ne,Ve)=>{const Ye=!ge.current&&!Ve;(E.value!==void 0&&E.value===Ne||Ye)&&pe(de)},[E.value]),Le=n==="popper"?Bm:$w,He=Le===Bm?{side:d,sideOffset:m,align:h,alignOffset:f,arrowPadding:p,collisionBoundary:w,collisionPadding:v,sticky:j,hideWhenDetached:y,avoidCollisions:b}:{};return e.jsx(Aw,{scope:r,content:S,viewport:R,onViewportChange:k,itemRefCallback:se,selectedItem:F,onItemLeave:we,itemTextRefCallback:_e,focusSelectedItem:xe,selectedItemText:ne,position:n,isPositioned:H,searchRef:oe,children:e.jsx(Wd,{as:a4,allowPinchZoom:!0,children:e.jsx(Ud,{asChild:!0,trapped:E.open,onMountAutoFocus:de=>{de.preventDefault()},onUnmountAutoFocus:Pe(a,de=>{E.trigger?.focus({preventScroll:!0}),de.preventDefault()}),children:e.jsx(za,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:de=>de.preventDefault(),onDismiss:()=>E.onOpenChange(!1),children:e.jsx(Le,{role:"listbox",id:E.contentId,"data-state":E.open?"open":"closed",dir:E.dir,onContextMenu:de=>de.preventDefault(),...C,...He,onPlaced:()=>G(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...C.style},onKeyDown:Pe(C.onKeyDown,de=>{const Ne=de.ctrlKey||de.altKey||de.metaKey;if(de.key==="Tab"&&de.preventDefault(),!Ne&&de.key.length===1&&W(de.key),["ArrowUp","ArrowDown","Home","End"].includes(de.key)){let Ye=re().filter(tt=>!tt.disabled).map(tt=>tt.ref.current);if(["ArrowUp","End"].includes(de.key)&&(Ye=Ye.slice().reverse()),["ArrowUp","ArrowDown"].includes(de.key)){const tt=de.target,ut=Ye.indexOf(tt);Ye=Ye.slice(ut+1)}setTimeout(()=>ie(Ye)),de.preventDefault()}})})})})})})});Dw.displayName=i4;var o4="SelectItemAlignedPosition",$w=x.forwardRef((s,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=s,l=Qn(Oi,r),c=Jn(Oi,r),[d,m]=x.useState(null),[h,f]=x.useState(null),p=pt(t,P=>f(P)),w=Vd(r),v=x.useRef(!1),j=x.useRef(!0),{viewport:y,selectedItem:b,selectedItemText:C,focusSelectedItem:E}=c,S=x.useCallback(()=>{if(l.trigger&&l.valueNode&&d&&h&&y&&b&&C){const P=l.trigger.getBoundingClientRect(),F=h.getBoundingClientRect(),ee=l.valueNode.getBoundingClientRect(),ne=C.getBoundingClientRect();if(l.dir!=="rtl"){const tt=ne.left-F.left,ut=ee.left-tt,gt=P.left-ut,J=P.width+gt,ue=Math.max(J,F.width),be=window.innerWidth-ir,Ce=Wm(ut,[ir,Math.max(ir,be-ue)]);d.style.minWidth=J+"px",d.style.left=Ce+"px"}else{const tt=F.right-ne.right,ut=window.innerWidth-ee.right-tt,gt=window.innerWidth-P.right-ut,J=P.width+gt,ue=Math.max(J,F.width),be=window.innerWidth-ir,Ce=Wm(ut,[ir,Math.max(ir,be-ue)]);d.style.minWidth=J+"px",d.style.right=Ce+"px"}const pe=w(),re=window.innerHeight-ir*2,H=y.scrollHeight,G=window.getComputedStyle(h),ge=parseInt(G.borderTopWidth,10),ie=parseInt(G.paddingTop,10),xe=parseInt(G.borderBottomWidth,10),X=parseInt(G.paddingBottom,10),te=ge+ie+H+X+xe,oe=Math.min(b.offsetHeight*5,te),W=window.getComputedStyle(y),se=parseInt(W.paddingTop,10),we=parseInt(W.paddingBottom,10),_e=P.top+P.height/2-ir,Le=re-_e,He=b.offsetHeight/2,de=b.offsetTop+He,Ne=ge+ie+de,Ve=te-Ne;if(Ne<=_e){const tt=pe.length>0&&b===pe[pe.length-1].ref.current;d.style.bottom="0px";const ut=h.clientHeight-y.offsetTop-y.offsetHeight,gt=Math.max(Le,He+(tt?we:0)+ut+xe),J=Ne+gt;d.style.height=J+"px"}else{const tt=pe.length>0&&b===pe[0].ref.current;d.style.top="0px";const gt=Math.max(_e,ge+y.offsetTop+(tt?se:0)+He)+Ve;d.style.height=gt+"px",y.scrollTop=Ne-_e+y.offsetTop}d.style.margin=`${ir}px 0`,d.style.minHeight=oe+"px",d.style.maxHeight=re+"px",n?.(),requestAnimationFrame(()=>v.current=!0)}},[w,l.trigger,l.valueNode,d,h,y,b,C,l.dir,n]);Qt(()=>S(),[S]);const[O,R]=x.useState();Qt(()=>{h&&R(window.getComputedStyle(h).zIndex)},[h]);const k=x.useCallback(P=>{P&&j.current===!0&&(S(),E?.(),j.current=!1)},[S,E]);return e.jsx(c4,{scope:r,contentWrapper:d,shouldExpandOnScrollRef:v,onScrollButtonChange:k,children:e.jsx("div",{ref:m,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:O},children:e.jsx(ze.div,{...a,ref:p,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});$w.displayName=o4;var l4="SelectPopperPosition",Bm=x.forwardRef((s,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=ir,...l}=s,c=Gd(r);return e.jsx(Tf,{...c,...l,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Bm.displayName=l4;var[c4,Gf]=Xa(Oi,{}),qm="SelectViewport",Lw=x.forwardRef((s,t)=>{const{__scopeSelect:r,nonce:n,...a}=s,l=Jn(qm,r),c=Gf(qm,r),d=pt(t,l.onViewportChange),m=x.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(Hd.Slot,{scope:r,children:e.jsx(ze.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:d,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Pe(a.onScroll,h=>{const f=h.currentTarget,{contentWrapper:p,shouldExpandOnScrollRef:w}=c;if(w?.current&&p){const v=Math.abs(m.current-f.scrollTop);if(v>0){const j=window.innerHeight-ir*2,y=parseFloat(p.style.minHeight),b=parseFloat(p.style.height),C=Math.max(y,b);if(C<j){const E=C+v,S=Math.min(j,E),O=E-S;p.style.height=S+"px",p.style.bottom==="0px"&&(f.scrollTop=O>0?O:0,p.style.justifyContent="flex-end")}}}m.current=f.scrollTop})})})]})});Lw.displayName=qm;var Mw="SelectGroup",[d4,u4]=Xa(Mw),h4=x.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s,a=lr();return e.jsx(d4,{scope:r,id:a,children:e.jsx(ze.div,{role:"group","aria-labelledby":a,...n,ref:t})})});h4.displayName=Mw;var Fw="SelectLabel",Uw=x.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s,a=u4(Fw,r);return e.jsx(ze.div,{id:a.id,...n,ref:t})});Uw.displayName=Fw;var md="SelectItem",[m4,zw]=Xa(md),Ww=x.forwardRef((s,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:l,...c}=s,d=Qn(md,r),m=Jn(md,r),h=d.value===n,[f,p]=x.useState(l??""),[w,v]=x.useState(!1),j=pt(t,E=>m.itemRefCallback?.(E,n,a)),y=lr(),b=x.useRef("touch"),C=()=>{a||(d.onValueChange(n),d.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(m4,{scope:r,value:n,disabled:a,textId:y,isSelected:h,onItemTextChange:x.useCallback(E=>{p(S=>S||(E?.textContent??"").trim())},[]),children:e.jsx(Hd.ItemSlot,{scope:r,value:n,disabled:a,textValue:f,children:e.jsx(ze.div,{role:"option","aria-labelledby":y,"data-highlighted":w?"":void 0,"aria-selected":h&&w,"data-state":h?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...c,ref:j,onFocus:Pe(c.onFocus,()=>v(!0)),onBlur:Pe(c.onBlur,()=>v(!1)),onClick:Pe(c.onClick,()=>{b.current!=="mouse"&&C()}),onPointerUp:Pe(c.onPointerUp,()=>{b.current==="mouse"&&C()}),onPointerDown:Pe(c.onPointerDown,E=>{b.current=E.pointerType}),onPointerMove:Pe(c.onPointerMove,E=>{b.current=E.pointerType,a?m.onItemLeave?.():b.current==="mouse"&&E.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Pe(c.onPointerLeave,E=>{E.currentTarget===document.activeElement&&m.onItemLeave?.()}),onKeyDown:Pe(c.onKeyDown,E=>{m.searchRef?.current!==""&&E.key===" "||(JP.includes(E.key)&&C(),E.key===" "&&E.preventDefault())})})})})});Ww.displayName=md;var Mo="SelectItemText",Bw=x.forwardRef((s,t)=>{const{__scopeSelect:r,className:n,style:a,...l}=s,c=Qn(Mo,r),d=Jn(Mo,r),m=zw(Mo,r),h=s4(Mo,r),[f,p]=x.useState(null),w=pt(t,C=>p(C),m.onItemTextChange,C=>d.itemTextRefCallback?.(C,m.value,m.disabled)),v=f?.textContent,j=x.useMemo(()=>e.jsx("option",{value:m.value,disabled:m.disabled,children:v},m.value),[m.disabled,m.value,v]),{onNativeOptionAdd:y,onNativeOptionRemove:b}=h;return Qt(()=>(y(j),()=>b(j)),[y,b,j]),e.jsxs(e.Fragment,{children:[e.jsx(ze.span,{id:m.textId,...l,ref:w}),m.isSelected&&c.valueNode&&!c.valueNodeHasChildren?Ua.createPortal(l.children,c.valueNode):null]})});Bw.displayName=Mo;var qw="SelectItemIndicator",Hw=x.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s;return zw(qw,r).isSelected?e.jsx(ze.span,{"aria-hidden":!0,...n,ref:t}):null});Hw.displayName=qw;var Hm="SelectScrollUpButton",Vw=x.forwardRef((s,t)=>{const r=Jn(Hm,s.__scopeSelect),n=Gf(Hm,s.__scopeSelect),[a,l]=x.useState(!1),c=pt(t,n.onScrollButtonChange);return Qt(()=>{if(r.viewport&&r.isPositioned){let d=function(){const h=m.scrollTop>0;l(h)};const m=r.viewport;return d(),m.addEventListener("scroll",d),()=>m.removeEventListener("scroll",d)}},[r.viewport,r.isPositioned]),a?e.jsx(Yw,{...s,ref:c,onAutoScroll:()=>{const{viewport:d,selectedItem:m}=r;d&&m&&(d.scrollTop=d.scrollTop-m.offsetHeight)}}):null});Vw.displayName=Hm;var Vm="SelectScrollDownButton",Gw=x.forwardRef((s,t)=>{const r=Jn(Vm,s.__scopeSelect),n=Gf(Vm,s.__scopeSelect),[a,l]=x.useState(!1),c=pt(t,n.onScrollButtonChange);return Qt(()=>{if(r.viewport&&r.isPositioned){let d=function(){const h=m.scrollHeight-m.clientHeight,f=Math.ceil(m.scrollTop)<h;l(f)};const m=r.viewport;return d(),m.addEventListener("scroll",d),()=>m.removeEventListener("scroll",d)}},[r.viewport,r.isPositioned]),a?e.jsx(Yw,{...s,ref:c,onAutoScroll:()=>{const{viewport:d,selectedItem:m}=r;d&&m&&(d.scrollTop=d.scrollTop+m.offsetHeight)}}):null});Gw.displayName=Vm;var Yw=x.forwardRef((s,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=s,l=Jn("SelectScrollButton",r),c=x.useRef(null),d=Vd(r),m=x.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return x.useEffect(()=>()=>m(),[m]),Qt(()=>{d().find(f=>f.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[d]),e.jsx(ze.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Pe(a.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(n,50))}),onPointerMove:Pe(a.onPointerMove,()=>{l.onItemLeave?.(),c.current===null&&(c.current=window.setInterval(n,50))}),onPointerLeave:Pe(a.onPointerLeave,()=>{m()})})}),f4="SelectSeparator",Kw=x.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s;return e.jsx(ze.div,{"aria-hidden":!0,...n,ref:t})});Kw.displayName=f4;var Gm="SelectArrow",p4=x.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s,a=Gd(r),l=Qn(Gm,r),c=Jn(Gm,r);return l.open&&c.position==="popper"?e.jsx(kf,{...a,...n,ref:t}):null});p4.displayName=Gm;var g4="SelectBubbleInput",Xw=x.forwardRef(({__scopeSelect:s,value:t,...r},n)=>{const a=x.useRef(null),l=pt(n,a),c=XP(t);return x.useEffect(()=>{const d=a.current;if(!d)return;const m=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(m,"value").set;if(c!==t&&f){const p=new Event("change",{bubbles:!0});f.call(d,t),d.dispatchEvent(p)}},[c,t]),e.jsx(ze.select,{...r,style:{...Qy,...r.style},ref:l,defaultValue:t})});Xw.displayName=g4;function Qw(s){return s===""||s===void 0}function Jw(s){const t=Xt(s),r=x.useRef(""),n=x.useRef(0),a=x.useCallback(c=>{const d=r.current+c;t(d),(function m(h){r.current=h,window.clearTimeout(n.current),h!==""&&(n.current=window.setTimeout(()=>m(""),1e3))})(d)},[t]),l=x.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return x.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,l]}function Zw(s,t,r){const a=t.length>1&&Array.from(t).every(h=>h===t[0])?t[0]:t,l=r?s.indexOf(r):-1;let c=x4(s,Math.max(l,0));a.length===1&&(c=c.filter(h=>h!==r));const m=c.find(h=>h.textValue.toLowerCase().startsWith(a.toLowerCase()));return m!==r?m:void 0}function x4(s,t){return s.map((r,n)=>s[(t+n)%s.length])}var v4=Ew,e_=Tw,y4=Ow,j4=Rw,w4=Pw,t_=Iw,_4=Lw,s_=Uw,r_=Ww,b4=Bw,N4=Hw,n_=Vw,i_=Gw,a_=Kw;const ln=v4,cn=y4,Pr=x.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(e_,{ref:n,className:Ue("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...r,children:[t,e.jsx(j4,{asChild:!0,children:e.jsx(hf,{className:"h-4 w-4 opacity-50"})})]}));Pr.displayName=e_.displayName;const o_=x.forwardRef(({className:s,...t},r)=>e.jsx(n_,{ref:r,className:Ue("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(G1,{className:"h-4 w-4"})}));o_.displayName=n_.displayName;const l_=x.forwardRef(({className:s,...t},r)=>e.jsx(i_,{ref:r,className:Ue("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(hf,{className:"h-4 w-4"})}));l_.displayName=i_.displayName;const Ir=x.forwardRef(({className:s,children:t,position:r="popper",...n},a)=>e.jsx(w4,{children:e.jsxs(t_,{ref:a,className:Ue("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...n,children:[e.jsx(o_,{}),e.jsx(_4,{className:Ue("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(l_,{})]})}));Ir.displayName=t_.displayName;const S4=x.forwardRef(({className:s,...t},r)=>e.jsx(s_,{ref:r,className:Ue("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));S4.displayName=s_.displayName;const Nt=x.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(r_,{ref:n,className:Ue("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(N4,{children:e.jsx(Sd,{className:"h-4 w-4"})})}),e.jsx(b4,{children:t})]}));Nt.displayName=r_.displayName;const E4=x.forwardRef(({className:s,...t},r)=>e.jsx(a_,{ref:r,className:Ue("-mx-1 my-1 h-px bg-muted",s),...t}));E4.displayName=a_.displayName;const C4=ol("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Q({className:s,variant:t,...r}){return e.jsx("div",{className:Ue(C4({variant:t}),s),...r})}var cm="rovingFocusGroup.onEntryFocus",T4={bubbles:!1,cancelable:!0},pl="RovingFocusGroup",[Ym,c_,k4]=of(pl),[O4,d_]=Vs(pl,[k4]),[R4,P4]=O4(pl),u_=x.forwardRef((s,t)=>e.jsx(Ym.Provider,{scope:s.__scopeRovingFocusGroup,children:e.jsx(Ym.Slot,{scope:s.__scopeRovingFocusGroup,children:e.jsx(I4,{...s,ref:t})})}));u_.displayName=pl;var I4=x.forwardRef((s,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:l,currentTabStopId:c,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:m,onEntryFocus:h,preventScrollOnEntryFocus:f=!1,...p}=s,w=x.useRef(null),v=pt(t,w),j=qd(l),[y,b]=en({prop:c,defaultProp:d??null,onChange:m,caller:pl}),[C,E]=x.useState(!1),S=Xt(h),O=c_(r),R=x.useRef(!1),[k,P]=x.useState(0);return x.useEffect(()=>{const F=w.current;if(F)return F.addEventListener(cm,S),()=>F.removeEventListener(cm,S)},[S]),e.jsx(R4,{scope:r,orientation:n,dir:j,loop:a,currentTabStopId:y,onItemFocus:x.useCallback(F=>b(F),[b]),onItemShiftTab:x.useCallback(()=>E(!0),[]),onFocusableItemAdd:x.useCallback(()=>P(F=>F+1),[]),onFocusableItemRemove:x.useCallback(()=>P(F=>F-1),[]),children:e.jsx(ze.div,{tabIndex:C||k===0?-1:0,"data-orientation":n,...p,ref:v,style:{outline:"none",...s.style},onMouseDown:Pe(s.onMouseDown,()=>{R.current=!0}),onFocus:Pe(s.onFocus,F=>{const ee=!R.current;if(F.target===F.currentTarget&&ee&&!C){const ne=new CustomEvent(cm,T4);if(F.currentTarget.dispatchEvent(ne),!ne.defaultPrevented){const pe=O().filter(ie=>ie.focusable),re=pe.find(ie=>ie.active),H=pe.find(ie=>ie.id===y),ge=[re,H,...pe].filter(Boolean).map(ie=>ie.ref.current);f_(ge,f)}}R.current=!1}),onBlur:Pe(s.onBlur,()=>E(!1))})})}),h_="RovingFocusGroupItem",m_=x.forwardRef((s,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:l,children:c,...d}=s,m=lr(),h=l||m,f=P4(h_,r),p=f.currentTabStopId===h,w=c_(r),{onFocusableItemAdd:v,onFocusableItemRemove:j,currentTabStopId:y}=f;return x.useEffect(()=>{if(n)return v(),()=>j()},[n,v,j]),e.jsx(Ym.ItemSlot,{scope:r,id:h,focusable:n,active:a,children:e.jsx(ze.span,{tabIndex:p?0:-1,"data-orientation":f.orientation,...d,ref:t,onMouseDown:Pe(s.onMouseDown,b=>{n?f.onItemFocus(h):b.preventDefault()}),onFocus:Pe(s.onFocus,()=>f.onItemFocus(h)),onKeyDown:Pe(s.onKeyDown,b=>{if(b.key==="Tab"&&b.shiftKey){f.onItemShiftTab();return}if(b.target!==b.currentTarget)return;const C=$4(b,f.orientation,f.dir);if(C!==void 0){if(b.metaKey||b.ctrlKey||b.altKey||b.shiftKey)return;b.preventDefault();let S=w().filter(O=>O.focusable).map(O=>O.ref.current);if(C==="last")S.reverse();else if(C==="prev"||C==="next"){C==="prev"&&S.reverse();const O=S.indexOf(b.currentTarget);S=f.loop?L4(S,O+1):S.slice(O+1)}setTimeout(()=>f_(S))}}),children:typeof c=="function"?c({isCurrentTabStop:p,hasTabStop:y!=null}):c})})});m_.displayName=h_;var A4={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function D4(s,t){return t!=="rtl"?s:s==="ArrowLeft"?"ArrowRight":s==="ArrowRight"?"ArrowLeft":s}function $4(s,t,r){const n=D4(s.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return A4[n]}function f_(s,t=!1){const r=document.activeElement;for(const n of s)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function L4(s,t){return s.map((r,n)=>s[(t+n)%s.length])}var M4=u_,F4=m_,Yd="Tabs",[U4,GL]=Vs(Yd,[d_]),p_=d_(),[z4,Yf]=U4(Yd),g_=x.forwardRef((s,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:l,orientation:c="horizontal",dir:d,activationMode:m="automatic",...h}=s,f=qd(d),[p,w]=en({prop:n,onChange:a,defaultProp:l??"",caller:Yd});return e.jsx(z4,{scope:r,baseId:lr(),value:p,onValueChange:w,orientation:c,dir:f,activationMode:m,children:e.jsx(ze.div,{dir:f,"data-orientation":c,...h,ref:t})})});g_.displayName=Yd;var x_="TabsList",v_=x.forwardRef((s,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=s,l=Yf(x_,r),c=p_(r);return e.jsx(M4,{asChild:!0,...c,orientation:l.orientation,dir:l.dir,loop:n,children:e.jsx(ze.div,{role:"tablist","aria-orientation":l.orientation,...a,ref:t})})});v_.displayName=x_;var y_="TabsTrigger",j_=x.forwardRef((s,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...l}=s,c=Yf(y_,r),d=p_(r),m=b_(c.baseId,n),h=N_(c.baseId,n),f=n===c.value;return e.jsx(F4,{asChild:!0,...d,focusable:!a,active:f,children:e.jsx(ze.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":h,"data-state":f?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:m,...l,ref:t,onMouseDown:Pe(s.onMouseDown,p=>{!a&&p.button===0&&p.ctrlKey===!1?c.onValueChange(n):p.preventDefault()}),onKeyDown:Pe(s.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&c.onValueChange(n)}),onFocus:Pe(s.onFocus,()=>{const p=c.activationMode!=="manual";!f&&!a&&p&&c.onValueChange(n)})})})});j_.displayName=y_;var w_="TabsContent",__=x.forwardRef((s,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:l,...c}=s,d=Yf(w_,r),m=b_(d.baseId,n),h=N_(d.baseId,n),f=n===d.value,p=x.useRef(f);return x.useEffect(()=>{const w=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(w)},[]),e.jsx(ks,{present:a||f,children:({present:w})=>e.jsx(ze.div,{"data-state":f?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":m,hidden:!w,id:h,tabIndex:0,...c,ref:t,style:{...s.style,animationDuration:p.current?"0s":void 0},children:w&&l})})});__.displayName=w_;function b_(s,t){return`${s}-trigger-${t}`}function N_(s,t){return`${s}-content-${t}`}var W4=g_,S_=v_,E_=j_,C_=__;const dn=W4,$r=x.forwardRef(({className:s,...t},r)=>e.jsx(S_,{ref:r,className:Ue("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t}));$r.displayName=S_.displayName;const ht=x.forwardRef(({className:s,...t},r)=>e.jsx(E_,{ref:r,className:Ue("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t}));ht.displayName=E_.displayName;const mt=x.forwardRef(({className:s,...t},r)=>e.jsx(C_,{ref:r,className:Ue("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));mt.displayName=C_.displayName;const An="https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1";class Vc{static async callEdgeFunction(t,r={},n){const a=new AbortController,l=setTimeout(()=>a.abort(),n?.timeout||3e4);try{const c={"Content-Type":"application/json"};n?.storeId&&n.storeId.trim()!==""?(c["x-store-id"]=n.storeId,console.log(` Adding x-store-id header: ${n.storeId}`)):console.log(` No storeId provided for function: ${t} (admin mode)`),console.log(` Calling Edge Function: ${t}`,{body:r,headers:c,url:`${An}/${t}`});const d=await fetch(`${An}/${t}`,{method:"POST",headers:c,body:JSON.stringify(r),signal:a.signal});if(clearTimeout(l),console.log(` ${t} response status:`,d.status),!d.ok){let h;try{const f=await d.json();h=f.error||f.message||"Unknown error",h.includes("x-store-id")&&(h+=` (Headers sent: ${JSON.stringify(c)})`)}catch{h=`HTTP ${d.status}: ${d.statusText}`}throw console.error(` Edge Function ${t} failed:`,{status:d.status,statusText:d.statusText,errorMessage:h,headers:c,body:r}),new Error(h)}const m=await d.json();return console.log(` ${t} success:`,m),m}catch(c){if(clearTimeout(l),c instanceof Error&&c.name==="AbortError"){const h=`    ${t} (${n?.timeout||3e4}ms) -    `;throw console.error(" Timeout error:",h),new Error(h)}const d=this.getDetailedErrorMessage(c,`callEdgeFunction(${t})`);console.error(" Enhanced error details:",d);const m=new Error(d);throw m.name="EdgeFunctionError",m.originalError=c,m.functionName=t,m.baseUrl=An,m}}static async getOrderDetails(t,r){if(!t)throw new Error("  ");try{const n=new URL(`${An}/get-order`);n.searchParams.append("orderId",t),n.searchParams.append("adminMode",r?"false":"true");const a={};r&&r.trim()!==""&&(a["x-store-id"]=r,console.log(` Adding x-store-id header for GET: ${r}`)),console.log(" GET order details:",{orderId:t,storeId:r,adminMode:r?"false":"true",url:n.toString()});const l=await fetch(n.toString(),{method:"GET",headers:a});if(console.log(" get-order response status:",l.status),!l.ok){const d=await l.json().catch(()=>({}));throw new Error(d.error||`HTTP ${l.status}: ${l.statusText}`)}const c=await l.json();if(!c.success)throw new Error(c.error||"    ");return c}catch(n){console.error(" Error getting order details:",n);try{console.log(" Attempting database fallback for order:",t);const{data:a,error:l}=await I.from("orders").select(`
            *,
            stores:assigned_store_id(
              id,
              name
            )
          `).eq("id",t).single();if(l)throw console.error("    :",l),l;if(a){console.log("    :",{orderId:a.id,order_code:a.order_code});let c=[];try{console.log("   order_items :",t);const{data:d,error:m}=await I.from("order_items").select(`
                id,
                product_name,
                quantity,
                price,
                discounted_price,
                product_id,
                availability_status,
                products:product_id(
                  id,
                  name,
                  price,
                  discounted_price,
                  main_store_name
                )
              `).eq("order_id",t);m?(console.error("    order_items:",m),console.error("  :",{code:m.code,details:m.details,hint:m.hint,message:m.message})):d&&d.length>0?(console.log("   order_items :",d.length,""),c=d):console.log("     order_items  items  ")}catch(d){console.error("     order_items:",d);let m="    order_items";if(d instanceof Error)m=d.message;else if(d&&typeof d=="object"){const h=d;if(h.message)m=h.message;else if(h.details)m=h.details;else try{m=JSON.stringify(d)}catch{m="     order_items"}}else typeof d=="string"&&(m=d);console.error("   :",m)}return c.length===0&&a.items&&(console.log("  items JSON "),c=Array.isArray(a.items)?a.items:[]),console.log(" Database fallback successful"),{success:!0,message:"      (Edge Function  )",order:{id:a.id,order_code:a.order_code,customer_name:a.customer_name,customer_phone:a.customer_phone,customer_address:a.customer_address,customer_city:a.customer_city,customer_notes:a.customer_notes,order_status:a.order_status||a.status,total_amount:a.total_amount,subtotal:a.subtotal,created_at:a.created_at,updated_at:a.updated_at,main_store_name:a.main_store_name,assigned_store_id:a.assigned_store_id,assigned_store_name:a.stores?.name||a.assigned_store_name},order_items:c,assigned_store:a.assigned_store_id?{id:a.assigned_store_id,name:a.stores?.name||a.assigned_store_name||"  "}:void 0}}}catch(a){console.error(" Database fallback failed - :",typeof a),console.error(" Database fallback failed - :",a);let l="   fallback  ";if(a instanceof Error)l=a.message;else if(a&&typeof a=="object"){const c=a;if(c.message)l=c.message;else if(c.details)l=c.details;else try{l=JSON.stringify(a)}catch{l="    fallback"}}else typeof a=="string"&&(l=a);console.error("   fallback :",l)}throw n}}static async assignOrder(t,r){if(!t||!r)throw new Error("    ");try{const n=await this.callEdgeFunction("assign-order",{orderId:t,storeId:r},{storeId:r});if(!n.success)throw new Error(n.error||"   ");return n}catch(n){throw console.error(" Error assigning order:",n),n}}static async autoAssignOrders(){try{const t=await this.callEdgeFunction("auto-assign-orders",{},{timeout:6e4});if(!t.success)throw new Error(t.error||"    ");return t}catch(t){throw console.error(" Error auto-assigning orders:",t),t}}static async checkConnectivity(){try{console.log(" Checking Edge Functions connectivity..."),console.log(" Base URL:",An),console.log(" Has Environment Variable:",!0);const r=await fetch(`${An}/get-order`,{method:"POST",headers:{"Content-Type":"application/json","x-store-id":"connectivity-test"},body:JSON.stringify({orderId:"connectivity-test"})}),n=r.status<500;return console.log(n?" Edge Functions accessible":" Edge Functions not accessible"),console.log(" Response status:",r.status),{isConnected:n,status:r.status,baseUrl:An,hasEnvVar:!0}}catch(r){const n=r instanceof Error?r.message:"Unknown network error";return console.error(" Edge Functions connectivity check failed:",n),{isConnected:!1,error:n,baseUrl:An,hasEnvVar:!0}}}static getDetailedErrorMessage(t,r){if(!t)return"Unknown error occurred";let n=`Error in ${r}: `;return t.message?n+=t.message:typeof t=="string"?n+=t:n+="Unknown error",t.message?.includes("fetch")?n+=" (Network connectivity issue - check if Edge Functions are deployed)":t.message?.includes("404")?n+=" (Edge Function not found - check function name and deployment)":t.message?.includes("401")||t.message?.includes("403")?n+=" (Authentication issue - check API keys and permissions)":t.message?.includes("500")&&(n+=" (Server error - check Edge Function logs)"),n}}const Kf=()=>{const[s,t]=x.useState({getOrder:!1,assignOrder:!1,autoAssignOrders:!1}),[r,n]=x.useState({getOrder:null,assignOrder:null,autoAssignOrders:null}),[a,l]=x.useState(null),[c,d]=x.useState(null),[m,h]=x.useState(null),{toast:f}=Xe(),p=x.useCallback(C=>{n(E=>({...E,[C]:null}))},[]),w=x.useCallback(()=>{n({getOrder:null,assignOrder:null,autoAssignOrders:null})},[]),v=x.useCallback(async(C,E)=>{t(S=>({...S,getOrder:!0})),p("getOrder");try{const S=await Vc.getOrderDetails(C,E);return l(S),S.message&&f({title:"   ",description:S.message}),S}catch(S){console.error("   useEnhancedEdgeFunctions.getOrderDetails - :",typeof S),console.error("   useEnhancedEdgeFunctions.getOrderDetails - :",S);let O="    ";if(S instanceof Error)O=S.message;else if(S&&typeof S=="object"){const P=S;if(P.message)O=P.message;else if(P.details)O=P.details;else try{O=JSON.stringify(S)}catch{O="      "}}else typeof S=="string"&&(O=S);console.error("   :",O);const R={operation:"get-order",orderId:C,timestamp:new Date().toISOString()};n(P=>({...P,getOrder:O})),h(R);let k=O;return O.includes("404")?k=`  ${C.slice(0,8)}    `:O.includes("500")?k="   -     Edge Functions":(O.includes("network")||O.includes("fetch"))&&(k="   -      "),f({title:"    ",description:k,variant:"destructive"}),null}finally{t(S=>({...S,getOrder:!1}))}},[f,p]),j=x.useCallback(async(C,E,S)=>{t(O=>({...O,assignOrder:!0})),p("assignOrder");try{const O=await Vc.assignOrder(C,E);return S?.showSuccessToast!==!1&&f({title:"   ",description:O.message||`    ${O.store_name||" "}`}),S?.onSuccess?.(O),!0}catch(O){const R=O instanceof Error?O.message:"   ",k={operation:"auto-assign-orders (manual mode)",orderId:C,storeId:E,timestamp:new Date().toISOString()};n(F=>({...F,assignOrder:R})),h(k);let P=R;return R.includes("already assigned")?P="     ":R.includes("not found")?P="       ":R.includes("environment")&&(P="    -    "),f({title:"   ",description:P,variant:"destructive"}),!1}finally{t(O=>({...O,assignOrder:!1}))}},[f,p]),y=x.useCallback(async C=>{t(E=>({...E,autoAssignOrders:!0})),p("autoAssignOrders");try{const E=await Vc.autoAssignOrders();d(E),C?.onProgress?.(E);let S=`  ${E.assigned_count}  `;if(E.unmatched_count>0&&(S+=`
${E.unmatched_count}       `),E.error_count>0&&(S+=`
${E.error_count}    `),C?.showDetailedResults&&E.results){const O=E.results.filter(P=>P.status==="assigned"),R=E.results.filter(P=>P.status==="unmatched"),k=E.results.filter(P=>P.status==="error");O.length>0&&console.log("   :",O),R.length>0&&console.log("       :",R),k.length>0&&console.log("    :",k)}return f({title:"  ",description:E.message||S}),E}catch(E){const S=E instanceof Error?E.message:"   ";return n(O=>({...O,autoAssignOrders:S})),f({title:"   ",description:S,variant:"destructive"}),null}finally{t(E=>({...E,autoAssignOrders:!1}))}},[f,p]),b=x.useCallback(async()=>{try{const C=await Vc.checkConnectivity();return C||f({title:"",description:"    Edge Functions -      ",variant:"destructive"}),C}catch(C){return console.error(" Connectivity check failed:",C),!1}},[f]);return{loading:s,isLoading:Object.values(s).some(Boolean),isGettingOrder:s.getOrder,isAssigningOrder:s.assignOrder,isAutoAssigning:s.autoAssignOrders,errors:r,hasErrors:Object.values(r).some(Boolean),orderDetails:a,autoAssignResults:c,getOrderDetails:v,assignOrder:j,autoAssignOrders:y,checkConnectivity:b,clearError:p,clearAllErrors:w,clearOrderDetails:()=>l(null),clearAutoAssignResults:()=>d(null),setAutoAssignResults:d,errorContext:m,clearErrorContext:()=>h(null)}},T_=s=>typeof s!="number"||isNaN(s)?"0 .":`${s.toLocaleString("ar-IQ",{minimumFractionDigits:0,maximumFractionDigits:0})} .`,Gc=(s,t)=>{const r=t||0,n=r>0;return{finalPrice:Math.max(0,s-r),hasDiscount:n,discountAmount:r,savings:n?r:0}},Ut=T_,$a=s=>Ut(s),Km=["Asus ROG Zephyrus G16","Lenovo IdeaPad Slim 3","Microsoft Surface Pro 10 (8GB/256GB)"],B4=[/^ \d+$/,/^ \d+ - /,/^ /,/^ /,/  /,/^Intel Core i5-14400F/];function wi(s){return!s||s.trim()===""?!0:B4.some(t=>t.test(s))}function Fo(s=0,t){const r=s%Km.length,n=Km[r];return t?`${n} -  ${t}`:n}function by(s,t=0,r){return s.product_name&&!wi(s.product_name)?s.product_name:s.name&&!wi(s.name)?s.name:Fo(t,r)}function q4(s,t){return s.map((r,n)=>({...r,product_name:by(r,n,t),name:r.name&&!wi(r.name)?r.name:by(r,n,t)}))}function H4(s){if(console.log(" getProductNameWithPriority - input item:",{product_name:s.product_name,name:s.name,products:s.products}),s.product_name&&s.product_name.trim()!==""&&s.product_name!=="  ")return console.log(" Using product_name:",s.product_name),s.product_name;if(s.name&&s.name.trim()!==""&&s.name!=="  ")return console.log(" Using name:",s.name),s.name;if(s.products?.name&&s.products.name.trim()!==""&&s.products.name!=="  ")return console.log(" Using products.name:",s.products.name),s.products.name;const t=Km[0];return console.log(" Using fallback name:",t),t}function V4({order:s,showTitle:t=!0,compact:r=!1}){const{t:n}=us();if(s.order_status==="customer_rejected"||s.store_response_status==="customer_rejected"||!s.assigned_store_id)return null;if(!s.store_response_status)return e.jsxs("div",{className:`flex items-start gap-2 p-3 rounded-lg border ${r?"bg-blue-50 border-blue-200":"bg-blue-50"}`,children:[e.jsx(Rt,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"  :"}),e.jsx("span",{className:"font-bold text-blue-600",children:"    "})]}),e.jsx("div",{className:"text-sm text-blue-600 mt-1",children:"         "}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"              "})]})]});const a=s.store_response_status==="available"||s.store_response_status==="accepted",l=s.store_response_status==="unavailable"||s.store_response_status==="rejected",c=a?{icon:Se,iconColor:"text-green-600",textColor:"text-green-600",bgColor:r?"bg-green-50 border-green-200":"bg-green-50",label:` ${n("in.stock.full")}`,description:n("store.confirmed.availability")}:{icon:lt,iconColor:"text-red-600",textColor:"text-red-600",bgColor:r?"bg-red-50 border-red-200":"bg-red-50",label:` ${n("not.in.stock.full")}`,description:"       "},d=c.icon;return e.jsxs("div",{className:`flex items-start gap-2 p-3 rounded-lg border ${c.bgColor}`,children:[e.jsx(d,{className:`w-5 h-5 ${c.iconColor} mt-0.5`}),e.jsxs("div",{className:"flex-1",children:[t&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(is,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-semibold text-blue-800",children:n("inventory.check.title")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:n("availability.status.label")}),e.jsx("span",{className:`font-bold ${c.textColor}`,children:c.label})]}),s.store_response_at&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[n("responded.at"),": ",new Date(s.store_response_at).toLocaleString("ar-IQ",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]}),l&&s.rejection_reason&&e.jsxs("div",{className:`text-sm ${c.textColor} mt-2 p-2 rounded ${l?"bg-red-100":""}`,children:[e.jsx("span",{className:"font-medium",children:"  :"}),e.jsx("div",{className:"mt-1",children:s.rejection_reason})]}),!r&&e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:c.description})]})]})}function k_(s){const t=new Set,r=s.order_items&&s.order_items.length>0?s.order_items:s.items||[];r.length===0?s.main_store_name&&t.add(s.main_store_name):(r.forEach(d=>{const m=d.main_store_name||d.main_store||d.store_name||"  ";m.trim()!==""&&m!=="  "&&t.add(m)}),t.size===0&&s.main_store_name&&t.add(s.main_store_name));const n=Array.from(t).filter(d=>d!=="  "),a=n.length,l=a>1;let c;return s.assigned_store_name?c=s.assigned_store_name:l?c=" ":n.length===1?c=n[0]:r.length>1&&r.some(m=>{const h=m.main_store_name||m.main_store||m.store_name;return h&&h!==s.main_store_name&&h.trim()!==""})?c=" ":c=s.main_store_name||"  ",{storesCount:a,stores:n,isMultiStore:l,displayName:c}}function Xf(s){const t=k_(s);return s.assigned_store_name?" : ":t.isMultiStore||t.displayName===" "?": ":" : "}function Qf(s){return k_(s).displayName}const O_=({orderId:s,stores:t=[],onOrderUpdated:r,storeId:n})=>{const{t:a}=us(),[l,c]=x.useState(null),[d,m]=x.useState(""),{getOrderDetails:h,isGettingOrder:f}=Kf(),p=async()=>{if(!s){console.warn(" loadOrderData called without orderId");return}try{console.log(" loadOrderData: Starting to load order data for:",s,"with storeId:",n||"undefined (admin mode)");const S=await h(s,n);console.log(" getOrderDetails successful:",S),S?(c(S),console.log(" Order data loaded and set:",S)):console.warn(" No data received from order loading")}catch(S){console.error(" Failed to fetch order details - :",typeof S),console.error(" Failed to fetch order details - :",S);let O="     ";if(S instanceof Error)O=S.message;else if(S&&typeof S=="object"){const R=S;if(R.message)O=R.message;else if(R.details)O=R.details;else try{O=JSON.stringify(S)}catch{O="      "}}else typeof S=="string"&&(O=S);console.error("   :",O)}};x.useEffect(()=>{s&&(console.log(" OrderDetails: Loading data for orderId:",s,"with storeId:",n||"undefined (admin mode)"),p())},[s,n]),x.useEffect(()=>{if(!s)return;const S=I.channel(`order-${s}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders",filter:`id=eq.${s}`},O=>{console.log(" OrderDetails: Real-time update received:",O),p()}).subscribe();return()=>{S.unsubscribe()}},[s]);const w=S=>({pending:{label:a("pending"),variant:"secondary",icon:Rt},assigned:{label:a("assigned"),variant:"default",icon:Me},delivered:{label:a("delivered"),variant:"default",icon:Se},completed:{label:a("delivered"),variant:"default",icon:Se},returned:{label:a("returned"),variant:"destructive",icon:ft}})[S]||{label:S,variant:"secondary",icon:Me};if(f)return e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),e.jsx("span",{children:"   ..."})]})})});if(!l)return e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsx("div",{className:"text-center text-gray-500",children:"     "})})});const v=l.order||l,j=l.order_items||v.items||[];l.assigned_store;const y=()=>!j||j.length===0?0:j.reduce((S,O)=>{const R=O.product?.price||O.price||0,k=O.product?.discounted_price||O.discounted_price||0,P=k>0&&k<R?R-k:0,F=Gc(R,P),ee=O.quantity||1;return S+F.finalPrice*ee},0),b=()=>!j||j.length===0?0:j.reduce((S,O)=>{const R=O.product?.price||O.price||0,k=O.product?.discounted_price||O.discounted_price||0,P=k>0&&k<R?R-k:0,F=Gc(R,P);if(F.hasDiscount){const ee=O.quantity||1;return S+F.savings*ee}return S},0),C=w(v.order_status||v.status),E=C.icon;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),""]}),e.jsxs(Q,{variant:C.variant,className:"flex items-center gap-1",children:[e.jsx(E,{className:"w-4 h-4"}),C.label]})]})}),e.jsx(M,{children:e.jsx("div",{className:"flex flex-col gap-6",children:e.jsxs("div",{className:"space-y-4 flex flex-col mx-auto",children:[e.jsx("h3",{className:"font-semibold text-lg border-b pb-2 mx-auto",children:" "}),e.jsxs("div",{className:"space-y-3 flex flex-col mt-4 mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nd,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"font-medium",children:a("order.date.label")}),e.jsx("span",{children:new Date(v.created_at).toLocaleString("ar-IQ",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bn,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{className:"font-medium",children:[a("total.amount.no.delivery"),":"]}),e.jsx("span",{className:"font-bold text-green-700",children:Ut(y())})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"font-medium",children:Xf(v)}),e.jsx("span",{className:"text-blue-600 font-medium",children:Qf(v)})]}),(v.order_status==="customer_rejected"||v.store_response_status==="customer_rejected")&&e.jsxs("div",{className:"flex items-start gap-2 p-4 rounded-lg border-2 border-purple-300 bg-purple-50 mt-3 mx-auto",children:[e.jsx(Se,{className:"w-5 h-5 text-purple-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-purple-800",children:" :"}),e.jsx("span",{className:"font-bold text-purple-600",children:"    "})]}),v.store_response_at&&e.jsxs("div",{className:"text-sm text-purple-600 mt-1",children:["  : ",new Date(v.store_response_at).toLocaleString("ar-IQ",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]}),v.store_response_status&&v.store_response_status!=="customer_rejected"&&v.order_status!=="customer_rejected"&&e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg border bg-gray-50 mt-3 mx-auto",children:[v.store_response_status==="available"||v.store_response_status==="accepted"?e.jsx(Se,{className:"w-5 h-5 text-green-600 mt-0.5"}):e.jsx(Rt,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:[a("store.status"),":"]}),e.jsx("span",{className:`font-bold ${v.store_response_status==="available"||v.store_response_status==="accepted"?"text-green-600":"text-red-600"}`,children:v.store_response_status==="available"||v.store_response_status==="accepted"?` ${a("available.status")}`:` ${a("unavailable")}`})]}),v.store_response_at&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[a("responded.at"),": ",new Date(v.store_response_at).toLocaleString("ar-IQ",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]}),v.store_response_status==="unavailable"&&v.rejection_reason&&e.jsxs("div",{className:"text-sm text-red-600 mt-1",children:["  : ",v.rejection_reason]})]})]})]})]})})})]}),!n&&v.order_status!=="customer_rejected"&&v.store_response_status!=="customer_rejected"&&e.jsx(V4,{order:v}),j&&j.length>0&&e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),a("products.count",{count:j.length}).replace("{count}",j.length.toString())]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4",children:[j.map((S,O)=>e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-lg text-blue-800 mb-2",children:H4(S)}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-foreground",children:a("quantity.label")}),e.jsx("div",{className:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-1 py-0 rounded text-xs border dark:border-blue-700 w-6 h-5 flex items-center justify-center font-medium",children:S.quantity||1})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4 text-purple-600"}),e.jsxs("span",{className:"font-semibold text-gray-700",children:[a("store.field"),":"]}),e.jsx("span",{className:"text-purple-600 font-medium",children:S.product?.main_store_name||S.main_store_name||S.main_store||v.main_store_name||""})]})]})]}),e.jsxs("div",{className:"text-right",children:[(()=>{const R=S.product?.price||S.price||0,k=S.product?.discounted_price||S.discounted_price||0,P=k>0&&k<R?R-k:0,F=Gc(R,P);return e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:`inline-block rounded-lg px-3 py-2 ${F.hasDiscount?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:e.jsx("div",{className:`text-xl font-bold ${F.hasDiscount?"text-red-600":"text-green-600"}`,children:Ut(F.finalPrice)})}),F.hasDiscount&&e.jsx("div",{className:"text-gray-500 line-through text-sm",children:Ut(R)}),F.hasDiscount&&F.savings>0&&e.jsx("div",{className:"inline-block bg-green-50 border border-green-200 rounded px-2 py-1",children:e.jsxs("span",{className:"text-xs font-medium text-green-700",children:[": ",Ut(F.savings)]})})]})})(),S.quantity>1&&e.jsxs("div",{className:"text-xs text-gray-600 mt-2 bg-gray-50 px-2 py-1 rounded",children:[e.jsx("span",{className:"font-medium",children:": "}),Ut((()=>{const R=S.product?.price||S.price||0,k=S.product?.discounted_price||S.discounted_price||0,P=k>0&&k<R?R-k:0;return Gc(R,P).finalPrice*(S.quantity||1)})())]})]})]})},S.id||O)),e.jsxs("div",{className:"border-t pt-4 mt-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bn,{className:"w-5 h-5 text-green-600"}),e.jsxs("span",{className:"font-bold text-lg text-green-800",children:[a("order.total.without.delivery"),":"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-2xl font-bold text-green-700",children:Ut(y())})})]}),b()>0&&e.jsxs("div",{className:"flex justify-between items-center bg-gradient-to-r from-orange-50 to-yellow-50 border border-orange-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),e.jsx("span",{className:"font-semibold text-orange-800",children:"     :"})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-xl font-bold text-orange-700 bg-white px-3 py-1 rounded-lg border border-orange-300",children:Ut(b())})})]})]})]})})]}),!1]})},G4=s=>{if(!s)return"";try{if(s.includes("")||s.includes("")||s.includes("")){const t=new TextEncoder().encode(s);return new TextDecoder("utf-8",{fatal:!1}).decode(t)||s}return s}catch(t){return console.warn("Error processing Arabic text:",t),s}},Y4=s=>/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/.test(s),K4=s=>Y4(s)?"rtl":"ltr",D=({children:s,className:t,as:r="span"})=>{const n=G4(s),a=K4(n);return e.jsx(r,{className:Ue("font-cairo",t),dir:a,style:{textRendering:"optimizeLegibility",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:n})};class X4 extends ye.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Error Boundary caught an error:",t,r)}handleReset=()=>{this.setState({hasError:!1,error:void 0})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx($,{className:"w-full max-w-md mx-auto",children:e.jsx(M,{className:"p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(Bt,{className:"w-12 h-12 text-red-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:e.jsx(D,{children:"    "})}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:e.jsx(D,{children:"    .    ."})}),!1]}),e.jsxs(L,{onClick:this.handleReset,className:"flex items-center gap-2",children:[e.jsx(ft,{className:"w-4 h-4"}),e.jsx(D,{children:" "})]})]})})}):this.props.children}}const Q4={order_created_customer:{type:"order_created",recipient_type:"customer",title_ar:"  ",message_ar:"    {{order_code}}    ",url_pattern:"/my-orders/{{order_id}}"},order_confirmed_customer:{type:"order_confirmed",recipient_type:"customer",title_ar:"  ",message_ar:"    {{order_code}}     ",url_pattern:"/my-orders/{{order_id}}"},order_rejected_customer:{type:"order_rejected",recipient_type:"customer",title_ar:"   ",message_ar:"    {{order_code}}  .    ",url_pattern:"/my-orders/{{order_id}}"},order_completed_customer:{type:"order_completed",recipient_type:"customer",title_ar:"  ",message_ar:"    {{order_code}} .  ",url_pattern:"/my-orders/{{order_id}}"},order_assigned_store:{type:"order_assigned",recipient_type:"store",title_ar:" ",message_ar:"    {{order_code}}  {{customer_name}}",url_pattern:"/store/orders/{{order_id}}"},order_created_admin:{type:"order_created",recipient_type:"admin",title_ar:" ",message_ar:"    {{customer_name}}  : {{order_code}}",url_pattern:"/admin/orders/{{order_id}}"},order_confirmed_admin:{type:"order_confirmed",recipient_type:"admin",title_ar:" ",message_ar:"    {{order_code}}  ",url_pattern:"/admin/orders/{{order_id}}"},order_rejected_admin:{type:"order_rejected",recipient_type:"admin",title_ar:" ",message_ar:"    {{order_code}}  ",url_pattern:"/admin/orders/{{order_id}}"}};class J4{channel=null;isConnected=!1;subscribers=[];async initialize(t){try{console.log(" Initializing Realtime notification service...");const{data:{session:r},error:n}=await I.auth.getSession();n&&console.warn(" Session error, but continuing with Realtime setup:",n),r?console.log(" Active session found for Realtime connection"):console.warn(" No active session found, Realtime may not work properly");const a=`notifications_${t||"anonymous"}_${Date.now()}`;this.channel=I.channel(a).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications"},l=>{console.log(" New notification received via Realtime:",l.new);const c=l.new;t&&c.recipient_id===t?this.handleRealtimeNotification(c):t||this.handleRealtimeNotification(c)}).subscribe(l=>{console.log(" Realtime subscription status:",l),l==="SUBSCRIBED"?(this.isConnected=!0,console.log(" Successfully subscribed to notifications channel")):l==="CHANNEL_ERROR"?(console.error(" Realtime channel error - this may be due to authentication or network issues"),this.isConnected=!1,setTimeout(()=>this.reconnect(),5e3)):l==="TIMED_OUT"&&(console.warn(" Realtime connection timed out - retrying..."),this.isConnected=!1,setTimeout(()=>this.reconnect(),3e3))})}catch(r){console.error(" Failed to initialize Realtime notifications:",{error:r,formattedError:JSON.stringify(r,null,2),operation:"initializeRealtimeNotifications",userId:t,stack:r?.stack})}}handleRealtimeNotification(t){console.log(" Processing Realtime notification:",t),this.sendToServiceWorker(t),this.notifySubscribers(t)}sendToServiceWorker(t){navigator.serviceWorker.controller?(console.log(" Sending notification to Service Worker:",t),navigator.serviceWorker.controller.postMessage({type:"NEW_NOTIFICATION",payload:t})):(console.warn(" No Service Worker controller available"),Notification.permission==="granted"&&new Notification(t.title,{body:t.message,icon:"/icons/icon-192x192.svg",tag:t.order_id?`order-${t.order_id}`:t.id}))}notifySubscribers(t){this.subscribers.forEach(r=>{try{r(t)}catch(n){console.error(" Error in notification subscriber:",{error:n,formattedError:JSON.stringify(n,null,2),operation:"notificationSubscriberCallback",notification:t,stack:n?.stack})}})}subscribe(t){return this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);r>-1&&this.subscribers.splice(r,1)}}async sendNotification(t){try{console.log(" Sending notification via Edge Function:",t);const{data:r,error:n}=await I.functions.invoke("send-notification",{body:t});return n?(console.error(" Error sending notification:",{error:n,formattedError:JSON.stringify(n,null,2),operation:"sendNotificationViaEdgeFunction",notificationData:t,stack:n?.stack}),!1):(console.log(" Notification sent successfully:",r),!0)}catch(r){return console.error(" Exception sending notification:",{error:r,formattedError:JSON.stringify(r,null,2),operation:"sendNotification",notificationData:t,stack:r?.stack}),!1}}async sendTestNotification(t){return this.sendNotification({title:"  ",message:`   Realtime - ${new Date().toLocaleTimeString("ar")}`,type:"test",recipient_id:t,recipient_type:"admin",url:"/realtime-test"})}async sendOrderNotification(t){return this.sendNotification({title:"  ",message:`   ${t.customer_name} - : ${t.order_code} - : ${t.total_amount} `,type:"order_received",recipient_id:t.store_id,recipient_type:"store",order_id:t.order_id,url:`/orders/${t.order_id}`})}async sendOrderStatusNotification(t){return this.sendNotification({title:"   ",message:`    ${t.order_code} : ${t.status}`,type:"order_status",recipient_id:t.customer_id,recipient_type:"customer",order_id:t.order_id,url:`/orders/${t.order_id}`})}isConnectionActive(){return this.isConnected}async reconnect(t){console.log(" Reconnecting to Realtime..."),this.channel&&I.removeChannel(this.channel),this.isConnected=!1,await new Promise(r=>setTimeout(r,1e3)),await this.initialize(t)}disconnect(){console.log(" Disconnecting from Realtime notifications..."),this.channel&&(I.removeChannel(this.channel),this.channel=null),this.isConnected=!1,this.subscribers=[]}getStatus(){return{isConnected:this.isConnected,subscribersCount:this.subscribers.length,channelState:this.channel?.state||null,sessionStatus:"unknown"}}async testDatabaseAccess(){try{console.log(" Testing database access for notifications table...");const{data:t,error:r}=await I.from("notifications").select("id").limit(1);return r?(console.error(" Database access test failed:",r),!1):(console.log(" Database access test successful"),!0)}catch(t){return console.error(" Database access test exception:",t),!1}}async ensureSession(){try{const{data:{session:t},error:r}=await I.auth.getSession();return r&&console.warn(" Session check error:",r),t?(console.log(" Valid session exists"),!0):(console.log(" No session found, attempting to create anonymous session..."),!1)}catch(t){return console.error(" Session check failed:",t),!1}}}const As=new J4,Z4="BJKVWqP8D6cD2I7zK8Y5gSQXb_sFJ7y5QS9n2k8Qy1X6rKs4nTdULmO7P8Y9cS3vN4b5M6qKs4nTdULmO7P8Y9cS";class eI{formatError(t,r=""){if(!t)return"Unknown error";const n=[];if(t.message&&n.push(`Message: ${t.message}`),t.code&&n.push(`Code: ${t.code}`),t.details&&n.push(`Details: ${t.details}`),t.hint&&n.push(`Hint: ${t.hint}`),n.length===0)try{return JSON.stringify(t,null,2)}catch{return String(t)}const a=n.join(" | ");return r?`${r}: ${a}`:a}isSupported(){return"serviceWorker"in navigator&&"PushManager"in window}urlBase64ToUint8Array(t){const r="=".repeat((4-t.length%4)%4),n=(t+r).replace(/-/g,"+").replace(/_/g,"/"),a=atob(n);return Uint8Array.from([...a].map(l=>l.charCodeAt(0)))}async registerServiceWorker(){if(!this.isSupported())return console.warn("Push notifications are not supported"),null;try{const t=await navigator.serviceWorker.register("/service-worker.js");return console.log("Service Worker registered successfully:",t),t}catch(t){return console.error("Service Worker registration failed:",this.formatError(t)),null}}async subscribeToPushNotifications(t,r){try{const n=await this.registerServiceWorker();if(!n)throw new Error("Service Worker registration failed");if(await n.pushManager.getSubscription())return console.log("User is already subscribed"),!0;if(await Notification.requestPermission()!=="granted")return console.warn("Notification permission denied"),!1;const c=await n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array(Z4)}),d={user_id:t,user_type:r,subscription:{endpoint:c.endpoint,keys:{p256dh:c.toJSON().keys?.p256dh||"",auth:c.toJSON().keys?.auth||""}},active:!0},{error:m}=await I.from("notification_subscriptions").upsert(d,{onConflict:"user_id"});return m?(console.error("Failed to save subscription:",this.formatError(m)),!1):(console.log("Successfully subscribed to push notifications"),!0)}catch(n){return console.error("Failed to subscribe to push notifications:",this.formatError(n)),!1}}async unsubscribeFromPushNotifications(t){try{const r=await navigator.serviceWorker.getRegistration();if(!r)return!0;const n=await r.pushManager.getSubscription();n&&await n.unsubscribe();const{error:a}=await I.from("notification_subscriptions").update({active:!1}).eq("user_id",t);return a?(console.error("Failed to remove subscription from database:",this.formatError(a)),!1):(console.log("Successfully unsubscribed from push notifications"),!0)}catch(r){return console.error("Failed to unsubscribe from push notifications:",this.formatError(r)),!1}}async sendNotification(t){try{if(await As.sendNotification({title:t.title,message:t.message,type:t.type||"general",recipient_id:t.recipient_id,recipient_type:t.recipient_type,order_id:t.order_id,url:t.url}))return console.log(" Notification sent via new Realtime system"),!0;console.log(" Falling back to legacy Edge Function...");const{error:n}=await I.functions.invoke("send-notification",{body:t});return n?(console.log("Notification service not available:",n.message),!1):(console.log("Notification sent successfully via legacy method"),!0)}catch{return console.log("Notification service not available"),!1}}async createNotification(t){try{const r={recipient_type:t.recipient_type,recipient_id:t.recipient_id,title:t.title,message:t.message,order_id:t.order_id||null,read:!1,sent:!1,created_at:new Date().toISOString()},{error:n}=await I.from("notifications").insert(r);return n?(console.error(" Failed to create notification:",this.formatError(n)),!1):(console.log(" Notification created successfully"),!0)}catch(r){return console.error(" Exception creating notification:",this.formatError(r)),!1}}createNotificationFromTemplate(t,r){const n=Q4[t];if(!n)return console.error(`Template ${t} not found`),null;let a=n.message_ar,l=n.url_pattern;return r.order_code&&(a=a.replace(/\{\{order_code\}\}/g,r.order_code)),r.customer_name&&(a=a.replace(/\{\{customer_name\}\}/g,r.customer_name)),r.order_id&&(l=l.replace(/\{\{order_id\}\}/g,r.order_id)),{title:n.title_ar,message:a,type:n.recipient_type,order_id:r.order_id,customer_name:r.customer_name,order_code:r.order_code,url:l}}async sendOrderNotification(t,r,n){const a=this.createNotificationFromTemplate(t,n);if(!a)return!1;const l={recipient_type:a.type,recipient_id:r,title:a.title,message:a.message,order_id:n.order_id};return await this.createNotification(l)}async getNotificationHistory(t,r=50){try{console.log(" Fetching notification history for userId:",t,"limit:",r);const{data:n,error:a}=await I.from("notifications").select("id, recipient_type, recipient_id, title, message, order_id, created_at, read, sent").eq("recipient_id",t).order("created_at",{ascending:!1}).limit(r);if(console.log(" Supabase response:",{data:n?.length||0,error:a}),a)return a.code==="PGRST116"||a.message?.includes("does not exist")||a.message?.includes("relation")&&a.message?.includes("does not exist")?(console.log(" Notifications table not available. Returning empty array."),[]):(console.log(" Notifications service not available:",a.message),[]);const l=n||[];return console.log(" Returning notifications:",l.length),l}catch(n){return console.error(" Exception in getNotificationHistory:",{error:this.formatError(n),userId:t,limit:r}),[]}}async markNotificationAsRead(t){try{const{error:r}=await I.from("notifications").update({read:!0}).eq("id",t);return r?(console.log("Notification service not available:",r.message),!1):!0}catch(r){return console.error("Failed to mark notification as read:",this.formatError(r)),!1}}async markNotificationAsSent(t){try{const{error:r}=await I.from("notifications").update({sent:!0}).eq("id",t);return r?(console.log("Failed to mark notification as sent:",r.message),!1):!0}catch(r){return console.error("Failed to mark notification as sent:",this.formatError(r)),!1}}async getUnreadNotificationsCount(t){try{console.log(" Fetching unread count for userId:",t);const{count:r,error:n}=await I.from("notifications").select("*",{count:"exact",head:!0}).eq("recipient_id",t).eq("read",!1);if(console.log(" Supabase response:",{count:r,error:n}),n)return n.code==="PGRST116"||n.message?.includes("does not exist")||n.message?.includes("relation")&&n.message?.includes("does not exist")?(console.log(" Notifications table not available. Returning 0."),0):(console.error(" Error fetching unread notifications count:",{error:n,formattedError:JSON.stringify(n,null,2),operation:"getUnreadNotificationsCount",userId:t,stack:n?.stack}),0);const a=r||0;return console.log(" Final unread count:",a),a}catch(r){return console.error(" Exception in getUnreadNotificationsCount:",{error:r,formattedError:JSON.stringify(r,null,2),operation:"getUnreadNotificationsCount",userId:t,stack:r?.stack}),0}}async getUnsentNotificationsCount(t){try{console.log(" Fetching unsent count for userId:",t);const{count:r,error:n}=await I.from("notifications").select("*",{count:"exact",head:!0}).eq("recipient_id",t).eq("sent",!1);if(n)return console.log(" Notifications service not available:",n.message),0;const a=r||0;return console.log(" Final unsent count:",a),a}catch(r){return console.error(" Exception in getUnsentNotificationsCount:",{error:r,formattedError:JSON.stringify(r,null,2),operation:"getUnsentNotificationsCount",userId:t,stack:r?.stack}),0}}async checkNotificationPermission(){return this.isSupported()?Notification.permission:"denied"}async requestNotificationPermission(){return this.isSupported()?await Notification.requestPermission():"denied"}async testDatabaseConnection(){try{console.log(" Testing database connection...");const{data:t,error:r}=await I.from("notifications").select("id").limit(1);return r?(console.error(" Database connection test failed:",this.formatError(r)),{success:!1,error:r.message||this.formatError(r),tableExists:!1}):(console.log(" Database connection test successful"),{success:!0,tableExists:!0})}catch(t){return console.error(" Database connection test exception:",this.formatError(t)),{success:!1,error:t?.message||this.formatError(t),tableExists:!1}}}async createTestNotification(t){try{const r={recipient_type:"admin",recipient_id:t,title:" ",message:"  - "+new Date().toLocaleTimeString("ar"),order_id:"test-"+Date.now()};return await this.createNotification(r)}catch(r){return console.error("Exception creating test notification:",this.formatError(r)),!1}}setupRealtimeSubscription(t,r){const n=I.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`recipient_id=eq.${t}`},a=>{console.log(" New notification received:",a),a.new&&r(a.new)}).subscribe(a=>{console.log(` Notifications channel for user ${t} status:`,a),a==="SUBSCRIBED"?console.log(` Successfully subscribed to notifications for user: ${t}`):a==="CHANNEL_ERROR"?console.error(`   Real-time  ${t}: CHANNEL_ERROR`):a==="TIMED_OUT"&&console.warn(`     Real-time  ${t}`)});return()=>{I.removeChannel(n)}}}const Uo=new eI;class tI{realtimeChannel=null;isListening=!1;notificationPermission="default";adminIds=["admin","admin-user","admin@laraend.com"];constructor(){this.checkNotificationPermission()}async checkNotificationPermission(){if("Notification"in window&&(this.notificationPermission=Notification.permission,this.notificationPermission==="default"))try{this.notificationPermission=await Notification.requestPermission()}catch(t){console.log("Notification permission request failed:",t)}}startListening(){if(this.isListening){console.log(" Order notification service already listening");return}console.log(" Starting order notification service..."),this.realtimeChannel=I.channel("new-orders-notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"orders"},t=>{console.log("    :",t.new),this.handleNewOrder(t.new)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders",filter:"order_status=eq.pending"},t=>{const r=t.old,n=t.new;r.order_status!=="pending"&&n.order_status==="pending"&&(console.log("   :",n),this.handlePendingOrder(n))}).subscribe(t=>{console.log(" Realtime subscription status:",t),t==="SUBSCRIBED"&&(this.isListening=!0,console.log("    "))})}stopListening(){this.realtimeChannel&&(I.removeChannel(this.realtimeChannel),this.realtimeChannel=null,this.isListening=!1,console.log("    "))}async handleNewOrder(t){try{const r=await this.prepareOrderNotificationData(t);await this.sendOrderNotification(r,"new")}catch(r){console.error("     :",r)}}async handlePendingOrder(t){try{const r=await this.prepareOrderNotificationData(t);await this.sendOrderNotification(r,"pending")}catch(r){console.error("     :",r)}}async prepareOrderNotificationData(t){const{data:r,error:n}=await I.from("order_items").select("*").eq("order_id",t.id),a=r?.length||0;return{orderId:t.id,orderCode:t.order_code||t.id.slice(0,8),customerName:t.customer_name,customerPhone:t.customer_phone,totalAmount:t.total_amount||0,itemsCount:a,mainStoreName:t.main_store_name||void 0}}async sendOrderNotification(t,r){const n=r==="new",a=n?"  !":"   ",l=`${t.customerName} - ${t.orderCode}`,c=`${t.itemsCount}   ${t.totalAmount} .`;this.notificationPermission==="granted"&&document.hidden&&this.showBrowserNotification(a,c,t);for(const d of this.adminIds)try{await Uo.sendNotification({recipient_type:"admin",recipient_id:d,title:a,message:`${a}: ${l} (${c})`,order_id:t.orderId})}catch(m){console.log("   :",m)}this.playNotificationSound(),console.log(`    ${n?" ":" "}:`,t)}showBrowserNotification(t,r,n){if("Notification"in window&&this.notificationPermission==="granted"){const a=new Notification(t,{body:r,icon:"/favicon.ico",badge:"/favicon.ico",tag:`order-${n.orderId}`,requireInteraction:!0,data:{orderId:n.orderId,url:`/admin-aa-smn-justme9003?orderId=${n.orderId}`}});a.onclick=()=>{window.focus(),window.location.href=`/admin-aa-smn-justme9003?orderId=${n.orderId}`,a.close()},setTimeout(()=>{a.close()},1e4)}}playNotificationSound(){try{const t=new(window.AudioContext||window.webkitAudioContext),r=t.createOscillator(),n=t.createGain();r.connect(n),n.connect(t.destination),r.frequency.setValueAtTime(800,t.currentTime),r.frequency.setValueAtTime(600,t.currentTime+.1),r.frequency.setValueAtTime(800,t.currentTime+.2),n.gain.setValueAtTime(.3,t.currentTime),n.gain.exponentialRampToValueAtTime(.01,t.currentTime+.3),r.start(t.currentTime),r.stop(t.currentTime+.3)}catch(t){console.log("    :",t)}}async testNotification(){const t={orderId:"test-"+Date.now(),orderCode:"TEST001",customerName:" ",customerPhone:"01234567890",totalAmount:250,itemsCount:3,mainStoreName:" "};await this.sendOrderNotification(t,"new"),console.log("    ")}getStatus(){return{isListening:this.isListening,notificationPermission:this.notificationPermission,hasNotificationAPI:"Notification"in window,isPageVisible:!document.hidden}}}const Xm=new tI;typeof window<"u"&&(document.addEventListener("DOMContentLoaded",()=>{Xm.startListening()}),window.addEventListener("beforeunload",()=>{Xm.stopListening()}));class sI{notifications=[];realtimeChannel=null;isListening=!1;notificationCallbacks=[];ADMIN_ID="admin";constructor(){this.loadNotifications(),this.requestNotificationPermission(),setTimeout(()=>{this.loadFromDatabase()},1e3)}async requestNotificationPermission(){"Notification"in window&&Notification.permission==="default"&&await Notification.requestPermission()}loadNotifications(){try{const t=localStorage.getItem("admin_notifications");t&&(this.notifications=JSON.parse(t))}catch(t){console.log("Error loading notifications:",t),this.notifications=[]}}saveNotifications(){try{localStorage.setItem("admin_notifications",JSON.stringify(this.notifications))}catch(t){console.log("Error saving notifications:",t)}}async addNotification(t){const r={...t,id:Date.now().toString(),timestamp:new Date().toISOString(),isRead:!1};return this.notifications.unshift(r),this.notifications.length>100&&(this.notifications=this.notifications.slice(0,100)),this.saveNotifications(),await this.saveToDatabase(r),this.showBrowserNotification(r),this.notifyCallbacks(r),r}showBrowserNotification(t){if("Notification"in window&&Notification.permission==="granted"){const r=new Notification(t.title,{body:t.message,icon:"/favicon.ico",badge:"/favicon.ico",tag:t.orderId?`order-${t.orderId}`:t.id,requireInteraction:!0,data:{notificationId:t.id,orderId:t.orderId,url:t.url}});r.onclick=()=>{window.focus(),t.url&&(window.location.href=t.url),this.markAsRead(t.id),r.close()},setTimeout(()=>{r.close()},8e3)}}startListening(){this.isListening||(this.realtimeChannel=I.channel("admin-notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"orders"},t=>{const r=t.new;this.handleNewOrder(r)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders"},t=>{const r=t.old,n=t.new;r.order_status!=="pending"&&n.order_status==="pending"&&this.handlePendingOrder(n),r.store_response_status!==n.store_response_status&&n.store_response_status&&this.handleStoreResponse(n)}).subscribe(t=>{console.log(" Admin notifications channel status:",t),t==="SUBSCRIBED"?(this.isListening=!0,console.log(" Admin notifications started listening")):t==="CHANNEL_ERROR"?(console.error("   Real-time: CHANNEL_ERROR"),this.isListening=!1,setTimeout(()=>{console.log("     Real-time..."),this.stopListening(),this.startListening()},5e3)):t==="TIMED_OUT"?(console.warn("     Real-time  ..."),this.isListening=!1,setTimeout(()=>{this.stopListening(),this.startListening()},3e3)):t==="CLOSED"&&(console.log("    Real-time"),this.isListening=!1)}))}stopListening(){this.realtimeChannel&&(I.removeChannel(this.realtimeChannel),this.realtimeChannel=null,this.isListening=!1)}handleNewOrder(t){this.addNotification({title:"   !",message:`  ${t.customer_name} - ${t.order_code||t.id.slice(0,8)}`,type:"new_order",orderId:t.id,customerName:t.customer_name,orderCode:t.order_code,url:`/admin-aa-smn-justme9003?orderId=${t.id}`}),this.playNotificationSound()}handlePendingOrder(t){this.addNotification({title:"    ",message:` ${t.customer_name}   - ${t.order_code||t.id.slice(0,8)}`,type:"pending_order",orderId:t.id,customerName:t.customer_name,orderCode:t.order_code,url:`/admin-aa-smn-justme9003?orderId=${t.id}`}),this.playNotificationSound()}handleStoreResponse(t){const r=["available","accepted"].includes(t.store_response_status),n=r?"  ":"  ",a=` ${r?"":""}  ${t.customer_name}`;this.addNotification({title:n,message:a,type:"store_response",orderId:t.id,customerName:t.customer_name,orderCode:t.order_code,url:`/admin-aa-smn-justme9003?orderId=${t.id}`}),this.playNotificationSound()}playNotificationSound(){try{const t=new(window.AudioContext||window.webkitAudioContext),r=t.createOscillator(),n=t.createGain();r.connect(n),n.connect(t.destination),r.frequency.setValueAtTime(800,t.currentTime),r.frequency.setValueAtTime(600,t.currentTime+.1),r.frequency.setValueAtTime(800,t.currentTime+.2),n.gain.setValueAtTime(.2,t.currentTime),n.gain.exponentialRampToValueAtTime(.01,t.currentTime+.3),r.start(t.currentTime),r.stop(t.currentTime+.3)}catch(t){console.log("Cannot play notification sound:",t)}}getNotifications(){return this.notifications}getUnreadCount(){return this.notifications.filter(t=>!t.isRead).length}markAsRead(t){const r=this.notifications.find(n=>n.id===t);r&&(r.isRead=!0,this.saveNotifications(),this.updateReadStatusInDatabase(t,!0),this.notifyCallbacks(r))}async markAllAsRead(){this.notifications.forEach(t=>t.isRead=!0),this.saveNotifications();try{const{error:t}=await I.from("notifications").update({read:!0}).eq("recipient_type","admin").eq("recipient_id",this.ADMIN_ID).eq("read",!1);t?console.warn(" Could not mark all as read in database:",t.message):console.log(" All admin notifications marked as read in unified table")}catch(t){console.warn(" Exception marking all as read in database:",t)}}deleteNotification(t){this.notifications=this.notifications.filter(r=>r.id!==t),this.saveNotifications()}clearAll(){this.notifications=[],this.saveNotifications()}onNotification(t){this.notificationCallbacks.push(t)}removeNotificationCallback(t){this.notificationCallbacks=this.notificationCallbacks.filter(r=>r!==t)}notifyCallbacks(t){this.notificationCallbacks.forEach(r=>{try{r(t)}catch(n){console.error("Error in notification callback:",n)}})}async saveToDatabase(t){try{const{error:r}=await I.from("notifications").insert({id:t.id,recipient_type:"admin",recipient_id:this.ADMIN_ID,title:t.title,message:t.message,type:t.type,order_id:t.orderId||null,url:t.url||null,read:t.isRead,sent:!0,created_at:t.timestamp,priority:this.getPriorityFromType(t.type)});r?console.warn(" Could not save notification to unified database:",r.message):console.log(" Notification saved to unified database:",t.id)}catch(r){console.warn(" Exception saving notification to unified database:",r)}}getPriorityFromType(t){switch(t){case"new_order":return"high";case"pending_order":return"urgent";case"store_response":return"medium";case"system":return"low";default:return"medium"}}async loadFromDatabase(){try{const{data:t,error:r}=await I.from("notifications").select("*").eq("recipient_type","admin").eq("recipient_id",this.ADMIN_ID).order("created_at",{ascending:!1}).limit(100);if(r){console.warn(" Could not load notifications from unified database:",r.message);return}if(t&&t.length>0){const n=t.map(c=>({id:c.id,title:c.title,message:c.message,type:c.type,orderId:c.order_id||void 0,customerName:void 0,orderCode:void 0,url:c.url||void 0,timestamp:c.created_at,isRead:c.read})),a=new Set(this.notifications.map(c=>c.id)),l=n.filter(c=>!a.has(c.id));this.notifications=[...this.notifications,...l].sort((c,d)=>new Date(d.timestamp).getTime()-new Date(c.timestamp).getTime()).slice(0,100),this.saveNotifications(),console.log(` Loaded ${l.length} notifications from unified database`)}}catch(t){console.warn(" Exception loading notifications from unified database:",t)}}async updateReadStatusInDatabase(t,r){try{const{error:n}=await I.from("notifications").update({read:r}).eq("id",t).eq("recipient_type","admin").eq("recipient_id",this.ADMIN_ID);n?console.warn(" Could not update read status in unified database:",n.message):console.log(" Read status updated in unified database:",t)}catch(n){console.warn(" Exception updating read status in unified database:",n)}}addTestNotification(){this.addNotification({title:"  ",message:"        -     notifications",type:"system",url:"/admin-aa-smn-justme9003"})}getStatus(){return{isListening:this.isListening,notificationPermission:"Notification"in window?Notification.permission:"not_supported",hasNotificationAPI:"Notification"in window,notificationsCount:this.notifications.length,unreadCount:this.getUnreadCount(),tableName:"notifications",adminId:this.ADMIN_ID}}}const It=new sI;var Kd="Popover",[R_,YL]=Vs(Kd,[Va]),gl=Va(),[rI,Zn]=R_(Kd),P_=s=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:c=!1}=s,d=gl(t),m=x.useRef(null),[h,f]=x.useState(!1),[p,w]=en({prop:n,defaultProp:a??!1,onChange:l,caller:Kd});return e.jsx(Cf,{...d,children:e.jsx(rI,{scope:t,contentId:lr(),triggerRef:m,open:p,onOpenChange:w,onOpenToggle:x.useCallback(()=>w(v=>!v),[w]),hasCustomAnchor:h,onCustomAnchorAdd:x.useCallback(()=>f(!0),[]),onCustomAnchorRemove:x.useCallback(()=>f(!1),[]),modal:c,children:r})})};P_.displayName=Kd;var I_="PopoverAnchor",nI=x.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=Zn(I_,r),l=gl(r),{onCustomAnchorAdd:c,onCustomAnchorRemove:d}=a;return x.useEffect(()=>(c(),()=>d()),[c,d]),e.jsx(Pd,{...l,...n,ref:t})});nI.displayName=I_;var A_="PopoverTrigger",D_=x.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=Zn(A_,r),l=gl(r),c=pt(t,a.triggerRef),d=e.jsx(ze.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":U_(a.open),...n,ref:c,onClick:Pe(s.onClick,a.onOpenToggle)});return a.hasCustomAnchor?d:e.jsx(Pd,{asChild:!0,...l,children:d})});D_.displayName=A_;var Jf="PopoverPortal",[iI,aI]=R_(Jf,{forceMount:void 0}),$_=s=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=s,l=Zn(Jf,t);return e.jsx(iI,{scope:t,forceMount:r,children:e.jsx(ks,{present:r||l.open,children:e.jsx(il,{asChild:!0,container:a,children:n})})})};$_.displayName=Jf;var La="PopoverContent",L_=x.forwardRef((s,t)=>{const r=aI(La,s.__scopePopover),{forceMount:n=r.forceMount,...a}=s,l=Zn(La,s.__scopePopover);return e.jsx(ks,{present:n||l.open,children:l.modal?e.jsx(lI,{...a,ref:t}):e.jsx(cI,{...a,ref:t})})});L_.displayName=La;var oI=Si("PopoverContent.RemoveScroll"),lI=x.forwardRef((s,t)=>{const r=Zn(La,s.__scopePopover),n=x.useRef(null),a=pt(t,n),l=x.useRef(!1);return x.useEffect(()=>{const c=n.current;if(c)return Bf(c)},[]),e.jsx(Wd,{as:oI,allowPinchZoom:!0,children:e.jsx(M_,{...s,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Pe(s.onCloseAutoFocus,c=>{c.preventDefault(),l.current||r.triggerRef.current?.focus()}),onPointerDownOutside:Pe(s.onPointerDownOutside,c=>{const d=c.detail.originalEvent,m=d.button===0&&d.ctrlKey===!0,h=d.button===2||m;l.current=h},{checkForDefaultPrevented:!1}),onFocusOutside:Pe(s.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1})})})}),cI=x.forwardRef((s,t)=>{const r=Zn(La,s.__scopePopover),n=x.useRef(!1),a=x.useRef(!1);return e.jsx(M_,{...s,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{s.onCloseAutoFocus?.(l),l.defaultPrevented||(n.current||r.triggerRef.current?.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{s.onInteractOutside?.(l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=l.target;r.triggerRef.current?.contains(c)&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),M_=x.forwardRef((s,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,disableOutsidePointerEvents:c,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:h,onInteractOutside:f,...p}=s,w=Zn(La,r),v=gl(r);return Wf(),e.jsx(Ud,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:e.jsx(za,{asChild:!0,disableOutsidePointerEvents:c,onInteractOutside:f,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:h,onDismiss:()=>w.onOpenChange(!1),children:e.jsx(Tf,{"data-state":U_(w.open),role:"dialog",id:w.contentId,...v,...p,ref:t,style:{...p.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),F_="PopoverClose",dI=x.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=Zn(F_,r);return e.jsx(ze.button,{type:"button",...n,ref:t,onClick:Pe(s.onClick,()=>a.onOpenChange(!1))})});dI.displayName=F_;var uI="PopoverArrow",hI=x.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=gl(r);return e.jsx(kf,{...a,...n,ref:t})});hI.displayName=uI;function U_(s){return s?"open":"closed"}var mI=P_,fI=D_,pI=$_,z_=L_;const Zf=mI,ep=fI,Xd=x.forwardRef(({className:s,align:t="center",sideOffset:r=4,...n},a)=>e.jsx(pI,{children:e.jsx(z_,{ref:a,align:t,sideOffset:r,className:Ue("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})}));Xd.displayName=z_.displayName;function gI(s,t){return x.useReducer((r,n)=>t[r][n]??r,s)}var tp="ScrollArea",[W_,KL]=Vs(tp),[xI,Gs]=W_(tp),B_=x.forwardRef((s,t)=>{const{__scopeScrollArea:r,type:n="hover",dir:a,scrollHideDelay:l=600,...c}=s,[d,m]=x.useState(null),[h,f]=x.useState(null),[p,w]=x.useState(null),[v,j]=x.useState(null),[y,b]=x.useState(null),[C,E]=x.useState(0),[S,O]=x.useState(0),[R,k]=x.useState(!1),[P,F]=x.useState(!1),ee=pt(t,pe=>m(pe)),ne=qd(a);return e.jsx(xI,{scope:r,type:n,dir:ne,scrollHideDelay:l,scrollArea:d,viewport:h,onViewportChange:f,content:p,onContentChange:w,scrollbarX:v,onScrollbarXChange:j,scrollbarXEnabled:R,onScrollbarXEnabledChange:k,scrollbarY:y,onScrollbarYChange:b,scrollbarYEnabled:P,onScrollbarYEnabledChange:F,onCornerWidthChange:E,onCornerHeightChange:O,children:e.jsx(ze.div,{dir:ne,...c,ref:ee,style:{position:"relative","--radix-scroll-area-corner-width":C+"px","--radix-scroll-area-corner-height":S+"px",...s.style}})})});B_.displayName=tp;var q_="ScrollAreaViewport",H_=x.forwardRef((s,t)=>{const{__scopeScrollArea:r,children:n,nonce:a,...l}=s,c=Gs(q_,r),d=x.useRef(null),m=pt(t,d,c.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),e.jsx(ze.div,{"data-radix-scroll-area-viewport":"",...l,ref:m,style:{overflowX:c.scrollbarXEnabled?"scroll":"hidden",overflowY:c.scrollbarYEnabled?"scroll":"hidden",...s.style},children:e.jsx("div",{ref:c.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});H_.displayName=q_;var Lr="ScrollAreaScrollbar",sp=x.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=Gs(Lr,s.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:c}=a,d=s.orientation==="horizontal";return x.useEffect(()=>(d?l(!0):c(!0),()=>{d?l(!1):c(!1)}),[d,l,c]),a.type==="hover"?e.jsx(vI,{...n,ref:t,forceMount:r}):a.type==="scroll"?e.jsx(yI,{...n,ref:t,forceMount:r}):a.type==="auto"?e.jsx(V_,{...n,ref:t,forceMount:r}):a.type==="always"?e.jsx(rp,{...n,ref:t}):null});sp.displayName=Lr;var vI=x.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=Gs(Lr,s.__scopeScrollArea),[l,c]=x.useState(!1);return x.useEffect(()=>{const d=a.scrollArea;let m=0;if(d){const h=()=>{window.clearTimeout(m),c(!0)},f=()=>{m=window.setTimeout(()=>c(!1),a.scrollHideDelay)};return d.addEventListener("pointerenter",h),d.addEventListener("pointerleave",f),()=>{window.clearTimeout(m),d.removeEventListener("pointerenter",h),d.removeEventListener("pointerleave",f)}}},[a.scrollArea,a.scrollHideDelay]),e.jsx(ks,{present:r||l,children:e.jsx(V_,{"data-state":l?"visible":"hidden",...n,ref:t})})}),yI=x.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=Gs(Lr,s.__scopeScrollArea),l=s.orientation==="horizontal",c=Jd(()=>m("SCROLL_END"),100),[d,m]=gI("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return x.useEffect(()=>{if(d==="idle"){const h=window.setTimeout(()=>m("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(h)}},[d,a.scrollHideDelay,m]),x.useEffect(()=>{const h=a.viewport,f=l?"scrollLeft":"scrollTop";if(h){let p=h[f];const w=()=>{const v=h[f];p!==v&&(m("SCROLL"),c()),p=v};return h.addEventListener("scroll",w),()=>h.removeEventListener("scroll",w)}},[a.viewport,l,m,c]),e.jsx(ks,{present:r||d!=="hidden",children:e.jsx(rp,{"data-state":d==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:Pe(s.onPointerEnter,()=>m("POINTER_ENTER")),onPointerLeave:Pe(s.onPointerLeave,()=>m("POINTER_LEAVE"))})})}),V_=x.forwardRef((s,t)=>{const r=Gs(Lr,s.__scopeScrollArea),{forceMount:n,...a}=s,[l,c]=x.useState(!1),d=s.orientation==="horizontal",m=Jd(()=>{if(r.viewport){const h=r.viewport.offsetWidth<r.viewport.scrollWidth,f=r.viewport.offsetHeight<r.viewport.scrollHeight;c(d?h:f)}},10);return Ma(r.viewport,m),Ma(r.content,m),e.jsx(ks,{present:n||l,children:e.jsx(rp,{"data-state":l?"visible":"hidden",...a,ref:t})})}),rp=x.forwardRef((s,t)=>{const{orientation:r="vertical",...n}=s,a=Gs(Lr,s.__scopeScrollArea),l=x.useRef(null),c=x.useRef(0),[d,m]=x.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=Q_(d.viewport,d.content),f={...n,sizes:d,onSizesChange:m,hasThumb:h>0&&h<1,onThumbChange:w=>l.current=w,onThumbPointerUp:()=>c.current=0,onThumbPointerDown:w=>c.current=w};function p(w,v){return SI(w,c.current,d,v)}return r==="horizontal"?e.jsx(jI,{...f,ref:t,onThumbPositionChange:()=>{if(a.viewport&&l.current){const w=a.viewport.scrollLeft,v=Ny(w,d,a.dir);l.current.style.transform=`translate3d(${v}px, 0, 0)`}},onWheelScroll:w=>{a.viewport&&(a.viewport.scrollLeft=w)},onDragScroll:w=>{a.viewport&&(a.viewport.scrollLeft=p(w,a.dir))}}):r==="vertical"?e.jsx(wI,{...f,ref:t,onThumbPositionChange:()=>{if(a.viewport&&l.current){const w=a.viewport.scrollTop,v=Ny(w,d);l.current.style.transform=`translate3d(0, ${v}px, 0)`}},onWheelScroll:w=>{a.viewport&&(a.viewport.scrollTop=w)},onDragScroll:w=>{a.viewport&&(a.viewport.scrollTop=p(w))}}):null}),jI=x.forwardRef((s,t)=>{const{sizes:r,onSizesChange:n,...a}=s,l=Gs(Lr,s.__scopeScrollArea),[c,d]=x.useState(),m=x.useRef(null),h=pt(t,m,l.onScrollbarXChange);return x.useEffect(()=>{m.current&&d(getComputedStyle(m.current))},[m]),e.jsx(Y_,{"data-orientation":"horizontal",...a,ref:h,sizes:r,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Qd(r)+"px",...s.style},onThumbPointerDown:f=>s.onThumbPointerDown(f.x),onDragScroll:f=>s.onDragScroll(f.x),onWheelScroll:(f,p)=>{if(l.viewport){const w=l.viewport.scrollLeft+f.deltaX;s.onWheelScroll(w),Z_(w,p)&&f.preventDefault()}},onResize:()=>{m.current&&l.viewport&&c&&n({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:m.current.clientWidth,paddingStart:pd(c.paddingLeft),paddingEnd:pd(c.paddingRight)}})}})}),wI=x.forwardRef((s,t)=>{const{sizes:r,onSizesChange:n,...a}=s,l=Gs(Lr,s.__scopeScrollArea),[c,d]=x.useState(),m=x.useRef(null),h=pt(t,m,l.onScrollbarYChange);return x.useEffect(()=>{m.current&&d(getComputedStyle(m.current))},[m]),e.jsx(Y_,{"data-orientation":"vertical",...a,ref:h,sizes:r,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Qd(r)+"px",...s.style},onThumbPointerDown:f=>s.onThumbPointerDown(f.y),onDragScroll:f=>s.onDragScroll(f.y),onWheelScroll:(f,p)=>{if(l.viewport){const w=l.viewport.scrollTop+f.deltaY;s.onWheelScroll(w),Z_(w,p)&&f.preventDefault()}},onResize:()=>{m.current&&l.viewport&&c&&n({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:m.current.clientHeight,paddingStart:pd(c.paddingTop),paddingEnd:pd(c.paddingBottom)}})}})}),[_I,G_]=W_(Lr),Y_=x.forwardRef((s,t)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:a,onThumbChange:l,onThumbPointerUp:c,onThumbPointerDown:d,onThumbPositionChange:m,onDragScroll:h,onWheelScroll:f,onResize:p,...w}=s,v=Gs(Lr,r),[j,y]=x.useState(null),b=pt(t,ee=>y(ee)),C=x.useRef(null),E=x.useRef(""),S=v.viewport,O=n.content-n.viewport,R=Xt(f),k=Xt(m),P=Jd(p,10);function F(ee){if(C.current){const ne=ee.clientX-C.current.left,pe=ee.clientY-C.current.top;h({x:ne,y:pe})}}return x.useEffect(()=>{const ee=ne=>{const pe=ne.target;j?.contains(pe)&&R(ne,O)};return document.addEventListener("wheel",ee,{passive:!1}),()=>document.removeEventListener("wheel",ee,{passive:!1})},[S,j,O,R]),x.useEffect(k,[n,k]),Ma(j,P),Ma(v.content,P),e.jsx(_I,{scope:r,scrollbar:j,hasThumb:a,onThumbChange:Xt(l),onThumbPointerUp:Xt(c),onThumbPositionChange:k,onThumbPointerDown:Xt(d),children:e.jsx(ze.div,{...w,ref:b,style:{position:"absolute",...w.style},onPointerDown:Pe(s.onPointerDown,ee=>{ee.button===0&&(ee.target.setPointerCapture(ee.pointerId),C.current=j.getBoundingClientRect(),E.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",v.viewport&&(v.viewport.style.scrollBehavior="auto"),F(ee))}),onPointerMove:Pe(s.onPointerMove,F),onPointerUp:Pe(s.onPointerUp,ee=>{const ne=ee.target;ne.hasPointerCapture(ee.pointerId)&&ne.releasePointerCapture(ee.pointerId),document.body.style.webkitUserSelect=E.current,v.viewport&&(v.viewport.style.scrollBehavior=""),C.current=null})})})}),fd="ScrollAreaThumb",K_=x.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=G_(fd,s.__scopeScrollArea);return e.jsx(ks,{present:r||a.hasThumb,children:e.jsx(bI,{ref:t,...n})})}),bI=x.forwardRef((s,t)=>{const{__scopeScrollArea:r,style:n,...a}=s,l=Gs(fd,r),c=G_(fd,r),{onThumbPositionChange:d}=c,m=pt(t,p=>c.onThumbChange(p)),h=x.useRef(void 0),f=Jd(()=>{h.current&&(h.current(),h.current=void 0)},100);return x.useEffect(()=>{const p=l.viewport;if(p){const w=()=>{if(f(),!h.current){const v=EI(p,d);h.current=v,d()}};return d(),p.addEventListener("scroll",w),()=>p.removeEventListener("scroll",w)}},[l.viewport,f,d]),e.jsx(ze.div,{"data-state":c.hasThumb?"visible":"hidden",...a,ref:m,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:Pe(s.onPointerDownCapture,p=>{const v=p.target.getBoundingClientRect(),j=p.clientX-v.left,y=p.clientY-v.top;c.onThumbPointerDown({x:j,y})}),onPointerUp:Pe(s.onPointerUp,c.onThumbPointerUp)})});K_.displayName=fd;var np="ScrollAreaCorner",X_=x.forwardRef((s,t)=>{const r=Gs(np,s.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?e.jsx(NI,{...s,ref:t}):null});X_.displayName=np;var NI=x.forwardRef((s,t)=>{const{__scopeScrollArea:r,...n}=s,a=Gs(np,r),[l,c]=x.useState(0),[d,m]=x.useState(0),h=!!(l&&d);return Ma(a.scrollbarX,()=>{const f=a.scrollbarX?.offsetHeight||0;a.onCornerHeightChange(f),m(f)}),Ma(a.scrollbarY,()=>{const f=a.scrollbarY?.offsetWidth||0;a.onCornerWidthChange(f),c(f)}),h?e.jsx(ze.div,{...n,ref:t,style:{width:l,height:d,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...s.style}}):null});function pd(s){return s?parseInt(s,10):0}function Q_(s,t){const r=s/t;return isNaN(r)?0:r}function Qd(s){const t=Q_(s.viewport,s.content),r=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,n=(s.scrollbar.size-r)*t;return Math.max(n,18)}function SI(s,t,r,n="ltr"){const a=Qd(r),l=a/2,c=t||l,d=a-c,m=r.scrollbar.paddingStart+c,h=r.scrollbar.size-r.scrollbar.paddingEnd-d,f=r.content-r.viewport,p=n==="ltr"?[0,f]:[f*-1,0];return J_([m,h],p)(s)}function Ny(s,t,r="ltr"){const n=Qd(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,l=t.scrollbar.size-a,c=t.content-t.viewport,d=l-n,m=r==="ltr"?[0,c]:[c*-1,0],h=Wm(s,m);return J_([0,c],[0,d])(h)}function J_(s,t){return r=>{if(s[0]===s[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(s[1]-s[0]);return t[0]+n*(r-s[0])}}function Z_(s,t){return s>0&&s<t}var EI=(s,t=()=>{})=>{let r={left:s.scrollLeft,top:s.scrollTop},n=0;return(function a(){const l={left:s.scrollLeft,top:s.scrollTop},c=r.left!==l.left,d=r.top!==l.top;(c||d)&&t(),r=l,n=window.requestAnimationFrame(a)})(),()=>window.cancelAnimationFrame(n)};function Jd(s,t){const r=Xt(s),n=x.useRef(0);return x.useEffect(()=>()=>window.clearTimeout(n.current),[]),x.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function Ma(s,t){const r=Xt(t);Qt(()=>{let n=0;if(s){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return a.observe(s),()=>{window.cancelAnimationFrame(n),a.unobserve(s)}}},[s,r])}var eb=B_,CI=H_,TI=X_;const ei=x.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(eb,{ref:n,className:Ue("relative overflow-hidden",s),...r,children:[e.jsx(CI,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(tb,{}),e.jsx(TI,{})]}));ei.displayName=eb.displayName;const tb=x.forwardRef(({className:s,orientation:t="vertical",...r},n)=>e.jsx(sp,{ref:n,orientation:t,className:Ue("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...r,children:e.jsx(K_,{className:"relative flex-1 rounded-full bg-border"})}));tb.displayName=sp.displayName;function St(s){const t=Object.prototype.toString.call(s);return s instanceof Date||typeof s=="object"&&t==="[object Date]"?new s.constructor(+s):typeof s=="number"||t==="[object Number]"||typeof s=="string"||t==="[object String]"?new Date(s):new Date(NaN)}function Kn(s,t){return s instanceof Date?new s.constructor(t):new Date(t)}const sb=6048e5,kI=864e5,Yc=43200,Sy=1440;let OI={};function xl(){return OI}function sl(s,t){const r=xl(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=St(s),l=a.getDay(),c=(l<n?7:0)+l-n;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function gd(s){return sl(s,{weekStartsOn:1})}function rb(s){const t=St(s),r=t.getFullYear(),n=Kn(s,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=gd(n),l=Kn(s,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const c=gd(l);return t.getTime()>=a.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function Ey(s){const t=St(s);return t.setHours(0,0,0,0),t}function xd(s){const t=St(s),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+s-+r}function RI(s,t){const r=Ey(s),n=Ey(t),a=+r-xd(r),l=+n-xd(n);return Math.round((a-l)/kI)}function PI(s){const t=rb(s),r=Kn(s,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),gd(r)}function ed(s,t){const r=St(s),n=St(t),a=r.getTime()-n.getTime();return a<0?-1:a>0?1:a}function II(s){return Kn(s,Date.now())}function AI(s){return s instanceof Date||typeof s=="object"&&Object.prototype.toString.call(s)==="[object Date]"}function DI(s){if(!AI(s)&&typeof s!="number")return!1;const t=St(s);return!isNaN(Number(t))}function $I(s,t){const r=St(s),n=St(t),a=r.getFullYear()-n.getFullYear(),l=r.getMonth()-n.getMonth();return a*12+l}function LI(s){return t=>{const n=(s?Math[s]:Math.trunc)(t);return n===0?0:n}}function MI(s,t){return+St(s)-+St(t)}function FI(s){const t=St(s);return t.setHours(23,59,59,999),t}function UI(s){const t=St(s),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function zI(s){const t=St(s);return+FI(t)==+UI(t)}function WI(s,t){const r=St(s),n=St(t),a=ed(r,n),l=Math.abs($I(r,n));let c;if(l<1)c=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*l);let d=ed(r,n)===-a;zI(St(s))&&l===1&&ed(s,n)===1&&(d=!1),c=a*(l-Number(d))}return c===0?0:c}function BI(s,t,r){const n=MI(s,t)/1e3;return LI(r?.roundingMethod)(n)}function qI(s){const t=St(s),r=Kn(s,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const HI={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},VI=(s,t,r)=>{let n;const a=HI[s];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Zr(s){return(t={})=>{const r=t.width?String(t.width):s.defaultWidth;return s.formats[r]||s.formats[s.defaultWidth]}}const GI={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},YI={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},KI={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},XI={date:Zr({formats:GI,defaultWidth:"full"}),time:Zr({formats:YI,defaultWidth:"full"}),dateTime:Zr({formats:KI,defaultWidth:"full"})},QI={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},JI=(s,t,r,n)=>QI[s];function xs(s){return(t,r)=>{const n=r?.context?String(r.context):"standalone";let a;if(n==="formatting"&&s.formattingValues){const c=s.defaultFormattingWidth||s.defaultWidth,d=r?.width?String(r.width):c;a=s.formattingValues[d]||s.formattingValues[c]}else{const c=s.defaultWidth,d=r?.width?String(r.width):s.defaultWidth;a=s.values[d]||s.values[c]}const l=s.argumentCallback?s.argumentCallback(t):t;return a[l]}}const ZI={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},eA={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},tA={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},sA={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},rA={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},nA={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},iA=(s,t)=>{const r=Number(s),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},aA={ordinalNumber:iA,era:xs({values:ZI,defaultWidth:"wide"}),quarter:xs({values:eA,defaultWidth:"wide",argumentCallback:s=>s-1}),month:xs({values:tA,defaultWidth:"wide"}),day:xs({values:sA,defaultWidth:"wide"}),dayPeriod:xs({values:rA,defaultWidth:"wide",formattingValues:nA,defaultFormattingWidth:"wide"})};function vs(s){return(t,r={})=>{const n=r.width,a=n&&s.matchPatterns[n]||s.matchPatterns[s.defaultMatchWidth],l=t.match(a);if(!l)return null;const c=l[0],d=n&&s.parsePatterns[n]||s.parsePatterns[s.defaultParseWidth],m=Array.isArray(d)?lA(d,p=>p.test(c)):oA(d,p=>p.test(c));let h;h=s.valueCallback?s.valueCallback(m):m,h=r.valueCallback?r.valueCallback(h):h;const f=t.slice(c.length);return{value:h,rest:f}}}function oA(s,t){for(const r in s)if(Object.prototype.hasOwnProperty.call(s,r)&&t(s[r]))return r}function lA(s,t){for(let r=0;r<s.length;r++)if(t(s[r]))return r}function ip(s){return(t,r={})=>{const n=t.match(s.matchPattern);if(!n)return null;const a=n[0],l=t.match(s.parsePattern);if(!l)return null;let c=s.valueCallback?s.valueCallback(l[0]):l[0];c=r.valueCallback?r.valueCallback(c):c;const d=t.slice(a.length);return{value:c,rest:d}}}const cA=/^(\d+)(th|st|nd|rd)?/i,dA=/\d+/i,uA={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},hA={any:[/^b/i,/^(a|c)/i]},mA={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},fA={any:[/1/i,/2/i,/3/i,/4/i]},pA={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},gA={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},xA={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},vA={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},yA={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},jA={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},wA={ordinalNumber:ip({matchPattern:cA,parsePattern:dA,valueCallback:s=>parseInt(s,10)}),era:vs({matchPatterns:uA,defaultMatchWidth:"wide",parsePatterns:hA,defaultParseWidth:"any"}),quarter:vs({matchPatterns:mA,defaultMatchWidth:"wide",parsePatterns:fA,defaultParseWidth:"any",valueCallback:s=>s+1}),month:vs({matchPatterns:pA,defaultMatchWidth:"wide",parsePatterns:gA,defaultParseWidth:"any"}),day:vs({matchPatterns:xA,defaultMatchWidth:"wide",parsePatterns:vA,defaultParseWidth:"any"}),dayPeriod:vs({matchPatterns:yA,defaultMatchWidth:"any",parsePatterns:jA,defaultParseWidth:"any"})},nb={code:"en-US",formatDistance:VI,formatLong:XI,formatRelative:JI,localize:aA,match:wA,options:{weekStartsOn:0,firstWeekContainsDate:1}};function _A(s){const t=St(s);return RI(t,qI(t))+1}function bA(s){const t=St(s),r=+gd(t)-+PI(t);return Math.round(r/sb)+1}function ib(s,t){const r=St(s),n=r.getFullYear(),a=xl(),l=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,c=Kn(s,0);c.setFullYear(n+1,0,l),c.setHours(0,0,0,0);const d=sl(c,t),m=Kn(s,0);m.setFullYear(n,0,l),m.setHours(0,0,0,0);const h=sl(m,t);return r.getTime()>=d.getTime()?n+1:r.getTime()>=h.getTime()?n:n-1}function NA(s,t){const r=xl(),n=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,a=ib(s,t),l=Kn(s,0);return l.setFullYear(a,0,n),l.setHours(0,0,0,0),sl(l,t)}function SA(s,t){const r=St(s),n=+sl(r,t)-+NA(r,t);return Math.round(n/sb)+1}function _t(s,t){const r=s<0?"-":"",n=Math.abs(s).toString().padStart(t,"0");return r+n}const Dn={y(s,t){const r=s.getFullYear(),n=r>0?r:1-r;return _t(t==="yy"?n%100:n,t.length)},M(s,t){const r=s.getMonth();return t==="M"?String(r+1):_t(r+1,2)},d(s,t){return _t(s.getDate(),t.length)},a(s,t){const r=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(s,t){return _t(s.getHours()%12||12,t.length)},H(s,t){return _t(s.getHours(),t.length)},m(s,t){return _t(s.getMinutes(),t.length)},s(s,t){return _t(s.getSeconds(),t.length)},S(s,t){const r=t.length,n=s.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return _t(a,t.length)}},ja={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Cy={G:function(s,t,r){const n=s.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(s,t,r){if(t==="yo"){const n=s.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Dn.y(s,t)},Y:function(s,t,r,n){const a=ib(s,n),l=a>0?a:1-a;if(t==="YY"){const c=l%100;return _t(c,2)}return t==="Yo"?r.ordinalNumber(l,{unit:"year"}):_t(l,t.length)},R:function(s,t){const r=rb(s);return _t(r,t.length)},u:function(s,t){const r=s.getFullYear();return _t(r,t.length)},Q:function(s,t,r){const n=Math.ceil((s.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return _t(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(s,t,r){const n=Math.ceil((s.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return _t(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(s,t,r){const n=s.getMonth();switch(t){case"M":case"MM":return Dn.M(s,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(s,t,r){const n=s.getMonth();switch(t){case"L":return String(n+1);case"LL":return _t(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(s,t,r,n){const a=SA(s,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):_t(a,t.length)},I:function(s,t,r){const n=bA(s);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):_t(n,t.length)},d:function(s,t,r){return t==="do"?r.ordinalNumber(s.getDate(),{unit:"date"}):Dn.d(s,t)},D:function(s,t,r){const n=_A(s);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):_t(n,t.length)},E:function(s,t,r){const n=s.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(s,t,r,n){const a=s.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return _t(l,2);case"eo":return r.ordinalNumber(l,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(s,t,r,n){const a=s.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return _t(l,t.length);case"co":return r.ordinalNumber(l,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(s,t,r){const n=s.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return _t(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(s,t,r){const a=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(s,t,r){const n=s.getHours();let a;switch(n===12?a=ja.noon:n===0?a=ja.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(s,t,r){const n=s.getHours();let a;switch(n>=17?a=ja.evening:n>=12?a=ja.afternoon:n>=4?a=ja.morning:a=ja.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(s,t,r){if(t==="ho"){let n=s.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Dn.h(s,t)},H:function(s,t,r){return t==="Ho"?r.ordinalNumber(s.getHours(),{unit:"hour"}):Dn.H(s,t)},K:function(s,t,r){const n=s.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):_t(n,t.length)},k:function(s,t,r){let n=s.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):_t(n,t.length)},m:function(s,t,r){return t==="mo"?r.ordinalNumber(s.getMinutes(),{unit:"minute"}):Dn.m(s,t)},s:function(s,t,r){return t==="so"?r.ordinalNumber(s.getSeconds(),{unit:"second"}):Dn.s(s,t)},S:function(s,t){return Dn.S(s,t)},X:function(s,t,r){const n=s.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return ky(n);case"XXXX":case"XX":return xi(n);case"XXXXX":case"XXX":default:return xi(n,":")}},x:function(s,t,r){const n=s.getTimezoneOffset();switch(t){case"x":return ky(n);case"xxxx":case"xx":return xi(n);case"xxxxx":case"xxx":default:return xi(n,":")}},O:function(s,t,r){const n=s.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Ty(n,":");case"OOOO":default:return"GMT"+xi(n,":")}},z:function(s,t,r){const n=s.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Ty(n,":");case"zzzz":default:return"GMT"+xi(n,":")}},t:function(s,t,r){const n=Math.trunc(s.getTime()/1e3);return _t(n,t.length)},T:function(s,t,r){const n=s.getTime();return _t(n,t.length)}};function Ty(s,t=""){const r=s>0?"-":"+",n=Math.abs(s),a=Math.trunc(n/60),l=n%60;return l===0?r+String(a):r+String(a)+t+_t(l,2)}function ky(s,t){return s%60===0?(s>0?"-":"+")+_t(Math.abs(s)/60,2):xi(s,t)}function xi(s,t=""){const r=s>0?"-":"+",n=Math.abs(s),a=_t(Math.trunc(n/60),2),l=_t(n%60,2);return r+a+t+l}const Oy=(s,t)=>{switch(s){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},ab=(s,t)=>{switch(s){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},EA=(s,t)=>{const r=s.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return Oy(s,t);let l;switch(n){case"P":l=t.dateTime({width:"short"});break;case"PP":l=t.dateTime({width:"medium"});break;case"PPP":l=t.dateTime({width:"long"});break;case"PPPP":default:l=t.dateTime({width:"full"});break}return l.replace("{{date}}",Oy(n,t)).replace("{{time}}",ab(a,t))},CA={p:ab,P:EA},TA=/^D+$/,kA=/^Y+$/,OA=["D","DD","YY","YYYY"];function RA(s){return TA.test(s)}function PA(s){return kA.test(s)}function IA(s,t,r){const n=AA(s,t,r);if(console.warn(n),OA.includes(s))throw new RangeError(n)}function AA(s,t,r){const n=s[0]==="Y"?"years":"days of the month";return`Use \`${s.toLowerCase()}\` instead of \`${s}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const DA=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,$A=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,LA=/^'([^]*?)'?$/,MA=/''/g,FA=/[a-zA-Z]/;function Ry(s,t,r){const n=xl(),a=r?.locale??n.locale??nb,l=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,c=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,d=St(s);if(!DI(d))throw new RangeError("Invalid time value");let m=t.match($A).map(f=>{const p=f[0];if(p==="p"||p==="P"){const w=CA[p];return w(f,a.formatLong)}return f}).join("").match(DA).map(f=>{if(f==="''")return{isToken:!1,value:"'"};const p=f[0];if(p==="'")return{isToken:!1,value:UA(f)};if(Cy[p])return{isToken:!0,value:f};if(p.match(FA))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:f}});a.localize.preprocessor&&(m=a.localize.preprocessor(d,m));const h={firstWeekContainsDate:l,weekStartsOn:c,locale:a};return m.map(f=>{if(!f.isToken)return f.value;const p=f.value;(!r?.useAdditionalWeekYearTokens&&PA(p)||!r?.useAdditionalDayOfYearTokens&&RA(p))&&IA(p,t,String(s));const w=Cy[p[0]];return w(d,p,a.localize,h)}).join("")}function UA(s){const t=s.match(LA);return t?t[1].replace(MA,"'"):s}function zA(s,t,r){const n=xl(),a=r?.locale??n.locale??nb,l=2520,c=ed(s,t);if(isNaN(c))throw new RangeError("Invalid time value");const d=Object.assign({},r,{addSuffix:r?.addSuffix,comparison:c});let m,h;c>0?(m=St(t),h=St(s)):(m=St(s),h=St(t));const f=BI(h,m),p=(xd(h)-xd(m))/1e3,w=Math.round((f-p)/60);let v;if(w<2)return r?.includeSeconds?f<5?a.formatDistance("lessThanXSeconds",5,d):f<10?a.formatDistance("lessThanXSeconds",10,d):f<20?a.formatDistance("lessThanXSeconds",20,d):f<40?a.formatDistance("halfAMinute",0,d):f<60?a.formatDistance("lessThanXMinutes",1,d):a.formatDistance("xMinutes",1,d):w===0?a.formatDistance("lessThanXMinutes",1,d):a.formatDistance("xMinutes",w,d);if(w<45)return a.formatDistance("xMinutes",w,d);if(w<90)return a.formatDistance("aboutXHours",1,d);if(w<Sy){const j=Math.round(w/60);return a.formatDistance("aboutXHours",j,d)}else{if(w<l)return a.formatDistance("xDays",1,d);if(w<Yc){const j=Math.round(w/Sy);return a.formatDistance("xDays",j,d)}else if(w<Yc*2)return v=Math.round(w/Yc),a.formatDistance("aboutXMonths",v,d)}if(v=WI(h,m),v<12){const j=Math.round(w/Yc);return a.formatDistance("xMonths",j,d)}else{const j=v%12,y=Math.trunc(v/12);return j<3?a.formatDistance("aboutXYears",y,d):j<9?a.formatDistance("overXYears",y,d):a.formatDistance("almostXYears",y+1,d)}}function vl(s,t){return zA(s,II(s),t)}const WA={lessThanXSeconds:{one:"  ",two:"  ",threeToTen:"  {{count}} ",other:"  {{count}} "},xSeconds:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},halfAMinute:" ",lessThanXMinutes:{one:"  ",two:"  ",threeToTen:"  {{count}} ",other:"  {{count}} "},xMinutes:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},aboutXHours:{one:"  ",two:" ",threeToTen:"{{count}}  ",other:"{{count}}  "},xHours:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},xDays:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},aboutXWeeks:{one:"  ",two:" ",threeToTen:"{{count}}  ",other:"{{count}}  "},xWeeks:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},aboutXMonths:{one:"  ",two:" ",threeToTen:"{{count}}  ",other:"{{count}}  "},xMonths:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},aboutXYears:{one:"  ",two:" ",threeToTen:"{{count}}  ",other:"{{count}}  "},xYears:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},overXYears:{one:"  ",two:"  ",threeToTen:"  {{count}} ",other:"  {{count}} "},almostXYears:{one:"   ",two:"  ",threeToTen:"  {{count}} ",other:"  {{count}} "}},BA=(s,t,r)=>{const n=WA[s];let a;return typeof n=="string"?a=n:t===1?a=n.one:t===2?a=n.two:t<=10?a=n.threeToTen.replace("{{count}}",String(t)):a=n.other.replace("{{count}}",String(t)),r?.addSuffix?r.comparison&&r.comparison>0?" "+a:" "+a:a},qA={full:"EEEE do MMMM y",long:"do MMMM y",medium:"d MMM y",short:"dd/MM/yyyy"},HA={full:"HH:mm:ss",long:"HH:mm:ss",medium:"HH:mm:ss",short:"HH:mm"},VA={full:"{{date}} ' ' {{time}}",long:"{{date}} ' ' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},GA={date:Zr({formats:qA,defaultWidth:"full"}),time:Zr({formats:HA,defaultWidth:"full"}),dateTime:Zr({formats:VA,defaultWidth:"full"})},YA={lastWeek:"eeee '  ' p",yesterday:"'  ' p",today:"'  ' p",tomorrow:"'  ' p",nextWeek:"eeee '  ' p",other:"P"},KA=s=>YA[s],XA={narrow:["",""],abbreviated:["..",".."],wide:[" "," "]},QA={narrow:["1","2","3","4"],abbreviated:["1","2","3","4"],wide:[" "," "," "," "]},JA={narrow:["","","","","","","","","","","",""],abbreviated:["","","","","","","","","","","",""],wide:["","","","","","","","","","","",""]},ZA={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},eD={narrow:{am:"",pm:"",morning:"",noon:"",afternoon:" ",evening:"",night:"",midnight:" "},abbreviated:{am:"",pm:"",morning:"",noon:"",afternoon:" ",evening:"",night:"",midnight:" "},wide:{am:"",pm:"",morning:"",noon:"",afternoon:" ",evening:"",night:"",midnight:" "}},tD={narrow:{am:"",pm:"",morning:" ",noon:"",afternoon:" ",evening:" ",night:" ",midnight:" "},abbreviated:{am:"",pm:"",morning:" ",noon:"",afternoon:" ",evening:" ",night:" ",midnight:" "},wide:{am:"",pm:"",morning:" ",noon:"",afternoon:" ",evening:" ",night:" ",midnight:" "}},sD=s=>String(s),rD={ordinalNumber:sD,era:xs({values:XA,defaultWidth:"wide"}),quarter:xs({values:QA,defaultWidth:"wide",argumentCallback:s=>s-1}),month:xs({values:JA,defaultWidth:"wide"}),day:xs({values:ZA,defaultWidth:"wide"}),dayPeriod:xs({values:eD,defaultWidth:"wide",formattingValues:tD,defaultFormattingWidth:"wide"})},nD=/^(\d+)(th|st|nd|rd)?/i,iD=/\d+/i,aD={narrow:/[]/,abbreviated:/[]\.\./,wide:/(|) /},oD={any:[//,//]},lD={narrow:/^[1234]/i,abbreviated:/[1234]/,wide:/ (|||)/},cD={any:[/1/i,/2/i,/3/i,/4/i]},dD={narrow:/^[]/,abbreviated:/^(|||||||||||)/,wide:/^(|||||||||||)/},uD={narrow:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],any:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i]},hD={narrow:/^[]/i,short:/^(||||||)/i,abbreviated:/^(||||||)/i,wide:/^(||||||)/i},mD={narrow:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],wide:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],any:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i]},fD={narrow:/^(|| || | | | )/,any:/^(|| || | | | )/},pD={any:{am:/^/,pm:/^/,midnight:/ /,noon://,afternoon:/ /,morning:/ /,evening:/ /,night:/ /}},gD={ordinalNumber:ip({matchPattern:nD,parsePattern:iD,valueCallback:s=>parseInt(s,10)}),era:vs({matchPatterns:aD,defaultMatchWidth:"wide",parsePatterns:oD,defaultParseWidth:"any"}),quarter:vs({matchPatterns:lD,defaultMatchWidth:"wide",parsePatterns:cD,defaultParseWidth:"any",valueCallback:s=>s+1}),month:vs({matchPatterns:dD,defaultMatchWidth:"wide",parsePatterns:uD,defaultParseWidth:"any"}),day:vs({matchPatterns:hD,defaultMatchWidth:"wide",parsePatterns:mD,defaultParseWidth:"any"}),dayPeriod:vs({matchPatterns:fD,defaultMatchWidth:"any",parsePatterns:pD,defaultParseWidth:"any"})},Zd={code:"ar",formatDistance:BA,formatLong:GA,formatRelative:KA,localize:rD,match:gD,options:{weekStartsOn:6,firstWeekContainsDate:1}},xD={lessThanXSeconds:{one:"   ",two:"  ",threeToTen:"  {{count}} ",other:"  {{count}} "},xSeconds:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},halfAMinute:" ",lessThanXMinutes:{one:"  ",two:"  ",threeToTen:"  {{count}} ",other:"  {{count}} "},xMinutes:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},aboutXHours:{one:"  ",two:" ",threeToTen:"{{count}}  ",other:"{{count}}  "},xHours:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},xDays:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},aboutXWeeks:{one:"  ",two:" ",threeToTen:"{{count}}  ",other:"{{count}}  "},xWeeks:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},aboutXMonths:{one:"  ",two:" ",threeToTen:"{{count}}  ",other:"{{count}}  "},xMonths:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},aboutXYears:{one:"  ",two:" ",threeToTen:"{{count}}  ",other:"{{count}}  "},xYears:{one:" ",two:"",threeToTen:"{{count}} ",other:"{{count}} "},overXYears:{one:"  ",two:"  ",threeToTen:"  {{count}} ",other:"  {{count}} "},almostXYears:{one:"  ",two:" ",threeToTen:"{{count}}  ",other:"{{count}}  "}},vD=(s,t,r)=>{let n;const a=xD[s];return typeof a=="string"?n=a:t===1?n=a.one:t===2?n=a.two:t<=10?n=a.threeToTen.replace("{{count}}",String(t)):n=a.other.replace("{{count}}",String(t)),r?.addSuffix?r.comparison&&r.comparison>0?"  "+n:" "+n:n},yD={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},jD={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},wD={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},_D={date:Zr({formats:yD,defaultWidth:"full"}),time:Zr({formats:jD,defaultWidth:"full"}),dateTime:Zr({formats:wD,defaultWidth:"full"})},bD={lastWeek:"'' eeee '' p",yesterday:"' ' p",today:"' ' p",tomorrow:"' ' p",nextWeek:"eeee '' p",other:"P"},ND=(s,t,r,n)=>bD[s],SD={narrow:["",""],abbreviated:["..",".."],wide:[" "," "]},ED={narrow:["1","2","3","4"],abbreviated:["1","2","3","4"],wide:[" "," "," "," "]},CD={narrow:["","","","","","","","","","","",""],abbreviated:["","","","","","","","","","","",""],wide:["","","","","","","","","","","",""]},TD={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},kD={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:" ",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:" ",noon:"",morning:"",afternoon:" ",evening:"",night:""},wide:{am:"",pm:"",midnight:" ",noon:"",morning:"",afternoon:" ",evening:"",night:""}},OD={narrow:{am:"",pm:"",midnight:"",noon:"",morning:" ",afternoon:" ",evening:" ",night:" "},abbreviated:{am:"",pm:"",midnight:" ",noon:"",morning:" ",afternoon:" ",evening:" ",night:" "},wide:{am:"",pm:"",midnight:" ",noon:"",morning:"",afternoon:" ",evening:" ",night:" "}},RD=s=>String(s),PD={ordinalNumber:RD,era:xs({values:SD,defaultWidth:"wide"}),quarter:xs({values:ED,defaultWidth:"wide",argumentCallback:s=>s-1}),month:xs({values:CD,defaultWidth:"wide"}),day:xs({values:TD,defaultWidth:"wide"}),dayPeriod:xs({values:kD,defaultWidth:"wide",formattingValues:OD,defaultFormattingWidth:"wide"})},ID=/^(\d+)(th|st|nd|rd)?/i,AD=/\d+/i,DD={narrow:/^(|)/i,abbreviated:/^(\.?\s?\.?|\.?\s?\.?\s?|a\.?\s?d\.?|c\.?\s?)/i,wide:/^( | | | )/i},$D={any:[/^/i,/^/i]},LD={narrow:/^[1234]/i,abbreviated:/^[1234]/i,wide:/^ [1234]/i},MD={any:[/1/i,/2/i,/3/i,/4/i]},FD={narrow:/^[]/i,abbreviated:/^(|||||||||||)/i,wide:/^(|||||||||||)/i},UD={narrow:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],any:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i]},zD={narrow:/^[]/i,short:/^(||||||)/i,abbreviated:/^(||||||)/i,wide:/^(||||||)/i},WD={narrow:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],wide:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],any:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i]},BD={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},qD={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},HD={ordinalNumber:ip({matchPattern:ID,parsePattern:AD,valueCallback:s=>parseInt(s,10)}),era:vs({matchPatterns:DD,defaultMatchWidth:"wide",parsePatterns:$D,defaultParseWidth:"any"}),quarter:vs({matchPatterns:LD,defaultMatchWidth:"wide",parsePatterns:MD,defaultParseWidth:"any",valueCallback:s=>s+1}),month:vs({matchPatterns:FD,defaultMatchWidth:"wide",parsePatterns:UD,defaultParseWidth:"any"}),day:vs({matchPatterns:zD,defaultMatchWidth:"wide",parsePatterns:WD,defaultParseWidth:"any"}),dayPeriod:vs({matchPatterns:BD,defaultMatchWidth:"any",parsePatterns:qD,defaultParseWidth:"any"})},dm={code:"ar-SA",formatDistance:vD,formatLong:_D,formatRelative:ND,localize:PD,match:HD,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ob({className:s}){const[t,r]=x.useState(It.getNotifications()),[n,a]=x.useState(It.getUnreadCount()),[l,c]=x.useState(!1),[d,m]=x.useState(!1);x.useEffect(()=>{It.startListening();const C=()=>{r([...It.getNotifications()]),a(It.getUnreadCount())};It.onNotification(C);const E=setInterval(()=>{r([...It.getNotifications()]),a(It.getUnreadCount())},3e4);return()=>{clearInterval(E),It.removeNotificationCallback(C)}},[]);const h=C=>{It.markAsRead(C),r([...It.getNotifications()]),a(It.getUnreadCount())},f=()=>{It.markAllAsRead(),r([...It.getNotifications()]),a(0)},p=C=>{It.deleteNotification(C),r([...It.getNotifications()]),a(It.getUnreadCount())},w=()=>{It.clearAll(),r([]),a(0)},v=()=>{It.addTestNotification()},j=C=>{switch(C){case"new_order":return"";case"pending_order":return"";case"store_response":return"";case"system":return"";default:return""}},y=C=>{switch(C){case"new_order":return"text-green-600";case"pending_order":return"text-yellow-600";case"store_response":return"text-blue-600";case"system":return"text-gray-600";default:return"text-gray-600"}},b=It.getStatus();return e.jsxs(Zf,{open:l,onOpenChange:c,children:[e.jsx(ep,{asChild:!0,children:e.jsxs(L,{variant:"ghost",size:"icon",className:`relative ${s}`,children:[e.jsx(dt,{className:"h-5 w-5"}),n>0&&e.jsx(Q,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 rounded-full p-0 flex items-center justify-center text-xs animate-pulse",children:n>99?"99+":n})]})}),e.jsxs(Xd,{className:"w-96 p-0",align:"end",side:"bottom",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(D,{className:"font-semibold text-lg",children:" "}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>m(!d),className:"h-8 w-8 p-0",children:e.jsx(Wa,{className:"h-4 w-4"})}),n>0&&e.jsx(L,{variant:"ghost",size:"sm",onClick:f,className:"text-xs",children:e.jsx(D,{children:"  "})})]})]}),d&&e.jsxs("div",{className:"mt-3 p-3 bg-muted rounded-lg space-y-2",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsxs(D,{children:[" : ",b.tableName||"notifications"]})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsxs(D,{children:[" : ",b.isListening?" ":" "]})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsxs(D,{children:[" : ",b.notificationPermission==="granted"?" ":"  "]})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsxs(D,{children:[" : ",b.adminId||"admin"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{variant:"outline",size:"sm",onClick:v,className:"text-xs",children:e.jsx(D,{children:" "})}),e.jsxs(L,{variant:"destructive",size:"sm",onClick:w,className:"text-xs",children:[e.jsx(rE,{className:"h-3 w-3 mr-1"}),e.jsx(D,{children:" "})]})]})]})]}),e.jsx(ei,{className:"h-96",children:t.length===0?e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(dt,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx(D,{className:"text-sm",children:"  "}),e.jsx(D,{className:"text-xs mt-1",children:"   notifications "}),e.jsx(L,{variant:"outline",size:"sm",onClick:v,className:"mt-2",children:e.jsx(D,{children:"  "})})]}):e.jsx("div",{className:"divide-y",children:t.map(C=>e.jsx("div",{className:`p-4 hover:bg-muted/50 transition-colors ${C.isRead?"":"bg-blue-50/50 border-l-4 border-l-blue-500"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`text-lg ${y(C.type)}`,children:j(C.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx(D,{as:"h4",className:`text-sm font-medium leading-tight ${C.isRead?"text-muted-foreground":"text-foreground"}`,children:C.title}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[!C.isRead&&e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>h(C.id),className:"h-6 w-6 p-0 hover:bg-blue-100",children:e.jsx(Sd,{className:"h-3 w-3"})}),e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>p(C.id),className:"h-6 w-6 p-0 hover:bg-red-100",children:e.jsx(Vn,{className:"h-3 w-3"})})]})]}),e.jsx(D,{className:"text-xs text-muted-foreground mt-1 leading-relaxed",children:C.message}),C.url&&e.jsxs(L,{variant:"link",size:"sm",onClick:()=>{window.location.href=C.url,h(C.id),c(!1)},className:"h-auto p-0 mt-2 text-xs",children:[e.jsx(qn,{className:"h-3 w-3 mr-1"}),e.jsx(D,{children:" "})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:vl(new Date(C.timestamp),{addSuffix:!0,locale:Zd})})]})]})},C.id))})}),t.length>0&&e.jsx("div",{className:"p-3 border-t bg-muted/30",children:e.jsx("div",{className:"text-xs text-center text-muted-foreground",children:e.jsxs(D,{children:[t.length,"   ",n,"      ",b.tableName||"notifications"]})})})]})]})}const lb={pending:" ",assigned:"",preparing:" ",ready:"",delivered:" ",cancelled:"",returned:"",customer_rejected:"  ",rejected:"  "},cb={pending:"bg-yellow-100 text-yellow-800",assigned:"bg-blue-100 text-blue-800",preparing:"bg-orange-100 text-orange-800",ready:"bg-green-100 text-green-800",delivered:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800",returned:"bg-gray-100 text-gray-800",customer_rejected:"bg-purple-100 text-purple-800",rejected:"bg-red-100 text-red-800"},$s=({items:s,showPriceInBothCurrencies:t=!0,compact:r=!1,hidePrices:n=!1,assignedStoreName:a})=>{const{t:l}=us();if(!s||s.length===0)return null;console.log(" OrderItems -  :",{items_count:s?.length||0,items_summary:s?.map((h,f)=>({index:f,id:h.id,product_name:h.product_name,name:h.name}))});const c=s.map((h,f)=>{let p="  ";if(console.log(" OrderItems - Raw item data:",{index:f,item:h,product_name:h.product_name,name:h.name,products:h.products}),"product_name"in h&&h.product_name&&typeof h.product_name=="string"&&h.product_name.trim()!==""&&h.product_name!=="  "&&!h.product_name.match(/^ \d+$/)&&!h.product_name.match(/^ \d+ - /))p=h.product_name;else if("name"in h&&h.name&&typeof h.name=="string"&&h.name.trim()!==""&&h.name!=="  "&&!h.name.match(/^ \d+$/)&&!h.name.match(/^ \d+ - /))p=h.name;else if("products"in h&&h.products&&h.products.name&&typeof h.products.name=="string"&&h.products.name.trim()!==""&&h.products.name!=="  "&&!h.products.name.match(/^ \d+$/)&&!h.products.name.match(/^ \d+ - /))p=h.products.name;else{const j=["  ASUS ROG"," Samsung Galaxy"," LG 27 ","  LG"," Samsung"," Bosch"," Sony 55 "],y=f%j.length;p=j[y]}console.log(" OrderItems - Processing item:",{index:f,original_product_name:h.product_name,original_name:h.name,final_product_name:p});const w=h.merged_quantity||h.quantity||1,v=h.total_price||h.price||205e3;return{id:"id"in h?h.id:`item-${Math.random()}`,product_name:p,quantity:w,price:v,total_price:h.total_price,product_id:h.product_id,discounted_price:h.discounted_price||0,is_merged:!!h.merged_quantity}}),d=c.reduce((h,f)=>{if(f.total_price&&f.is_merged)return h+f.total_price;const p=f.price||0,w=f.discounted_price||0,v=w>0&&w<p?{finalPrice:w}:{finalPrice:p};return h+v.finalPrice*f.quantity},0),m=$a(d);return r?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(xm,{className:"w-4 h-4"}),e.jsx(D,{children:l("products.count",{count:c.length}).replace("{count}",c.length.toString())})]}),c.map((h,f)=>e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[!n&&e.jsx("div",{className:"text-left order-last ml-4",children:(()=>{const p=h.price||0,w=h.discounted_price||0,v=w>0&&w<p?{finalPrice:w,hasDiscount:!0}:{finalPrice:p,hasDiscount:!1};return v.hasDiscount?e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-bold text-red-600 bg-red-50 px-3 py-2 rounded border border-red-200",children:e.jsxs("span",{className:"font-mono text-base",children:[". ",v.finalPrice.toLocaleString("ar-EG")]})}),e.jsxs("div",{className:"text-xs text-gray-500 line-through text-center",children:[". ",p.toLocaleString("ar-EG")]})]}):e.jsx("div",{className:"font-bold text-green-700 bg-green-50 px-3 py-2 rounded border border-green-200",children:e.jsxs("span",{className:"font-mono text-base",children:[". ",p.toLocaleString("ar-EG")]})})})()}),e.jsxs("div",{className:"flex-1 text-right",children:[e.jsx(D,{className:"font-bold text-blue-800 text-lg mb-2",children:h.product_name}),e.jsxs("div",{className:"mb-1",children:[e.jsxs("span",{className:"text-sm text-gray-700",children:[l("quantity.label")," "]}),e.jsx("span",{className:"font-semibold text-blue-800",children:h.quantity})]}),e.jsxs("div",{className:"flex items-center justify-end gap-1 text-sm text-purple-600",children:[e.jsx("span",{children:`${a||h.main_store_name||h.main_store||"  "} `}),e.jsx(Me,{className:"w-4 h-4"})]})]})]})},h.id||f)),!n&&e.jsx("div",{className:"border-t pt-2",children:e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-mono text-primary font-bold text-lg",children:m}),e.jsx("span",{className:"font-bold text-lg text-green-800",children:e.jsx(D,{children:l("order.total.without.delivery")})})]})})})]}):e.jsxs($,{className:"w-full",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),e.jsxs(D,{children:[l("product.details")," (",c.length,")"]})]})}),e.jsxs(M,{className:"space-y-4",children:[c.map((h,f)=>e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4 hover:shadow-md transition-all",children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-lg text-blue-800 mb-3",children:e.jsx(D,{children:h.product_name})}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsxs("div",{className:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-1 py-0 rounded text-xs border dark:border-blue-700 w-fit h-5 flex items-center font-medium",children:[l("quantity.label")," ",h.quantity,h.is_merged&&e.jsx("span",{className:"mr-1 text-orange-600",title:" ",children:"*"})]}),h.is_merged&&e.jsx("div",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs border border-orange-200",children:"   "}),!n&&(()=>{const p=h.price||0,w=h.discounted_price||0,v=w>0&&w<p?{finalPrice:w,hasDiscount:!0,savings:p-w}:{finalPrice:p,hasDiscount:!1,savings:0};return v.hasDiscount?e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"bg-red-50 px-3 py-1 rounded border border-red-200",children:e.jsxs("span",{className:"font-mono text-red-700 font-semibold",children:[v.finalPrice.toLocaleString("ar-EG")," ."]})}),e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:[" : ",p.toLocaleString("ar-EG")," ."]}),e.jsxs("div",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded",children:[": ",v.savings.toLocaleString("ar-EG")," ."]})]}):e.jsx("div",{className:"bg-green-50 px-3 py-1 rounded border border-green-200",children:e.jsxs("span",{className:"font-mono text-green-700 font-semibold",children:[p.toLocaleString("ar-EG")," ."]})})})()]}),!n&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:": "}),e.jsx("span",{className:"font-mono text-green-700",children:(()=>{const p=h.price||0,w=h.discounted_price||0,v=w>0&&w<p?{finalPrice:w}:{finalPrice:p};return $a(v.finalPrice*h.quantity)})()})]})]})})},h.id||f)),!n&&e.jsx("div",{className:"border-t pt-4",children:e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-bold text-lg text-green-800",children:e.jsxs(D,{children:[l("product.total"),":"]})})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-2xl font-bold text-green-700 font-mono",children:m})})]})})})]})]})},Qm=({orderId:s,orderItems:t,onSplitComplete:r,disabled:n=!1})=>{const[a,l]=x.useState(!1),[c,d]=x.useState(!1),{toast:m}=Xe();localStorage.getItem("skipEdgeFunction");const h=()=>{const j=new Map;return t?.forEach(y=>{const b=y.main_store||y.main_store_name||y.store_name||typeof y.products=="object"&&y.products?.store_name||"  ";j.has(b)||j.set(b,[]),j.get(b).push(y)}),{storesCount:j.size,stores:Array.from(j.entries()).map(([y,b])=>({storeName:y,itemsCount:b.length,items:b}))}},{storesCount:f,stores:p}=h();if(f<=1||!t?.length)return null;const w=async()=>{try{console.log("     ");const{data:j,error:y}=await I.from("orders").select("*").eq("id",s).single();if(y||!j)throw new Error("     ");const b={};t.forEach(R=>{const k=R.main_store||R.main_store_name||R.store_name||typeof R.products=="object"&&R.products?.store_name||"  ";b[k]||(b[k]={storeName:k,items:[]}),b[k].items.push({name:R.name||R.product_name||"  ",quantity:R.quantity||1,price:R.price||0,discounted_price:R.discounted_price||R.price||0,main_store_name:k,main_store:k,store_name:k,product_id:R.product_id})});const C=[];for(const R in b){const k=b[R],P=k.items.reduce((pe,re)=>pe+(re.discounted_price||re.price||0)*(re.quantity||1),0),{data:F}=await I.from("stores").select("id, name").eq("name",R).single(),{data:ee,error:ne}=await I.from("orders").insert({customer_name:j.customer_name,customer_phone:j.customer_phone,customer_address:j.customer_address,customer_notes:j.customer_notes,order_status:"assigned",assigned_store_id:F?.id||null,main_store_name:R,items:k.items,total_amount:P,order_details:`     ${j.order_code||s}`,created_at:new Date().toISOString()}).select().single();if(ne)console.error(`      ${R}:`,ne),C.push({storeName:R,success:!1,error:ne.message});else{console.log(`     ${R}:`,ee.id);const pe=k.items.map(H=>({order_id:ee.id,product_name:H.name,quantity:H.quantity,price:H.price,discounted_price:H.discounted_price,main_store_name:R,main_store:R,store_name:R,product_id:H.product_id})),{error:re}=await I.from("order_items").insert(pe);re?console.warn(`    order_items  ${R}:`,re):console.log(`   ${pe.length} order_items  ${R}`),C.push({storeName:R,success:!0,orderId:ee.id})}}await I.from("orders").update({order_status:"splitting",order_details:`${j.order_details||""}

   -     `}).eq("id",s);const{error:E}=await I.from("orders").delete().eq("id",s);E?console.warn("     :",E):console.log("     ");const S=C.filter(R=>R.success).length,O=Object.keys(b).length;return{success:!0,successful_splits:S,total_stores:O,results:C}}catch(j){throw console.error("    :",j),j}},v=async()=>{try{d(!0);try{console.log("   Edge Function:","https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/test-split");const y=new AbortController,b=setTimeout(()=>y.abort(),1e4);throw new Error("Using local method for reliability")}catch(j){console.log("  Edge Function   ...",{error:j,message:j instanceof Error?j.message:"Unknown error",name:j instanceof Error?j.name:"UnknownError"});const y=await w();if(y.success){const b=y.successful_splits||0,C=y.total_stores||0;m({title:"   ",description:`  ${b}   ${C}    `}),l(!1),r?.()}else throw new Error("    ")}}catch(j){console.error("     :",{error:j,message:j instanceof Error?j.message:"Unknown error",name:j instanceof Error?j.name:"UnknownError",stack:j instanceof Error?j.stack:void 0});let y="   ";j instanceof Error&&(j.message.includes("Failed to fetch")||j.name==="AbortError"?y="   .        .":j.message.includes("Network")||j.message.includes("CORS")?y="     .     .":j.message.includes("HTTP")?y="   .     .":y=j.message),m({title:"   ",description:y,variant:"destructive"})}finally{d(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(L,{onClick:()=>l(!0),disabled:n||c,variant:"outline",size:"sm",className:"gap-2 text-blue-600 border-blue-200 hover:bg-blue-50",children:[e.jsx(qh,{className:"w-4 h-4"}),"   (",f,")"]}),e.jsx(on,{open:a,onOpenChange:l,children:e.jsxs(kr,{className:"sm:max-w-[500px]",dir:"rtl",children:[e.jsxs(Or,{children:[e.jsxs(Rr,{className:"flex items-center gap-2",children:[e.jsx(qh,{className:"w-5 h-5 text-blue-600"}),"   "]}),e.jsxs(Ka,{className:"text-right",children:["     ",f,"              ."]})]}),e.jsxs("div",{className:"space-y-4 my-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),"  :"]}),e.jsx("div",{className:"space-y-2",children:p.map((j,y)=>e.jsxs("div",{className:"flex justify-between items-center bg-white rounded p-2",children:[e.jsx("span",{className:"font-medium text-blue-700",children:j.storeName}),e.jsxs("span",{className:"text-sm text-gray-600",children:[j.itemsCount," "]})]},y))})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx("strong",{children:":"}),'            ""     .']})})]}),e.jsxs(Di,{className:"gap-2",children:[e.jsx(L,{variant:"outline",onClick:()=>l(!1),disabled:c,children:""}),e.jsx(L,{onClick:v,disabled:c,className:"bg-blue-600 hover:bg-blue-700",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin ml-2"})," ..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qh,{className:"w-4 h-4 ml-2"})," "]})})]})]})})]})},Py=({orderId:s,orderItems:t,storeName:r,onTransferComplete:n,disabled:a=!1})=>{const[l,c]=x.useState(!1),[d,m]=x.useState(!1),{toast:h}=Xe(),f=async()=>{try{m(!0);const{data:p,error:w}=await I.from("stores").select("id, name").eq("name",r).single();if(w||!p)throw new Error(`     "${r}"   `);const{error:v}=await I.from("orders").update({order_status:"assigned",assigned_store_id:p.id,assigned_store_name:p.name,main_store_name:r,updated_at:new Date().toISOString()}).eq("id",s);if(v)throw new Error(`   : ${v.message}`);const{error:j}=await I.from("order_items").update({main_store_name:r,main_store:r,store_name:r}).eq("order_id",s);if(j&&console.warn(":        :",j.message),t&&t.length>0){const y=t.map(C=>({...C,main_store_name:r,main_store:r,store_name:r})),{error:b}=await I.from("orders").update({items:y}).eq("id",s);b&&console.warn(":       :",b.message)}h({title:"   ",description:`    "${r}"    ""`}),c(!1),n?.()}catch(p){console.error("    :",p);let w="   ";p instanceof Error&&(w=p.message),h({title:"   ",description:w,variant:"destructive"})}finally{m(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(L,{onClick:()=>c(!0),disabled:a||d,variant:"outline",size:"sm",className:"gap-2 text-green-600 border-green-200 hover:bg-green-50",children:[e.jsx(gm,{className:"w-4 h-4"}),"  "]}),e.jsx(on,{open:l,onOpenChange:c,children:e.jsxs(kr,{className:"sm:max-w-[500px]",dir:"rtl",children:[e.jsxs(Or,{children:[e.jsxs(Rr,{className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-5 h-5 text-green-600"}),"   "]}),e.jsxs(Ka,{className:"text-right",children:['      "',r,'"    "".']})]}),e.jsxs("div",{className:"space-y-4 my-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-green-800 mb-3 flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4"})," :"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white rounded p-2",children:[e.jsx("span",{className:"font-medium text-green-700",children:" :"}),e.jsx("span",{className:"text-sm text-gray-600",children:r})]}),e.jsxs("div",{className:"flex justify-between items-center bg-white rounded p-2",children:[e.jsx("span",{className:"font-medium text-green-700",children:" :"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t?.length||0," "]})]})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:":"}),'       ""       .']})})]}),e.jsxs(Di,{className:"gap-2",children:[e.jsx(L,{variant:"outline",onClick:()=>c(!1),disabled:d,children:""}),e.jsx(L,{onClick:f,disabled:d,className:"bg-green-600 hover:bg-green-700",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin ml-2"})," ..."]}):e.jsxs(e.Fragment,{children:[e.jsx(gm,{className:"w-4 h-4 ml-2"})," "]})})]})]})})]})},Iy=({orderId:s,orderStatus:t,storeResponseStatus:r,adminMode:n=!1,onRejectComplete:a,disabled:l=!1,size:c="sm",variant:d="destructive"})=>{const[m,h]=x.useState(!1),[f,p]=x.useState(!1),{toast:w}=Xe(),{t:v}=us();if(!!(t==="pending"||t==="delivered"||t==="returned"||t==="customer_rejected"||r==="customer_rejected"))return null;const y=async()=>{try{p(!0),console.log("     :",s),console.log("   ...");const{data:b,error:C}=await I.from("orders").select("*").eq("id",s).single();if(C||!b)throw new Error("    ");console.log("   ...");const{error:E}=await I.from("orders").update({store_response_status:"customer_rejected",store_response_at:new Date().toISOString(),order_status:"customer_rejected",updated_at:new Date().toISOString()}).eq("id",s);if(E)throw new Error(`   : ${E.message}`);console.log("       "),w({title:"     ",description:"    .        ."}),h(!1),a?.()}catch(b){console.error("       :",b);let C="   ";b instanceof Error&&(b.message.includes("Failed to fetch")?C="  .    .":b.message.includes("    ")?C="    .      .":b.message.includes("  ")?C="   .    .":C=b.message),w({title:"   ",description:C,variant:"destructive"})}finally{p(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(L,{onClick:()=>h(!0),disabled:l||f,variant:d,size:c,className:"gap-2",children:[e.jsx(Ca,{className:"w-4 h-4"}),e.jsx(D,{children:v("customer.rejected")})]}),e.jsx(on,{open:m,onOpenChange:h,children:e.jsxs(kr,{className:"sm:max-w-[500px]",dir:"rtl",children:[e.jsxs(Or,{children:[e.jsxs(Rr,{className:"flex items-center gap-2",children:[e.jsx(Ca,{className:"w-5 h-5 text-red-600"}),e.jsx(D,{children:"    "})]}),e.jsx(Ka,{className:"text-right",children:e.jsx(D,{children:"                    ."})})]}),e.jsx("div",{className:"space-y-4 my-4",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Bt,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"font-semibold text-red-800",children:e.jsx(D,{children:":"})})]}),e.jsx("div",{className:"text-sm text-red-700",children:e.jsxs(D,{children:['      "  "',e.jsx("br",{}),"         ",e.jsx("br",{}),"     "]})})]})}),e.jsxs(Di,{className:"gap-2",children:[e.jsx(L,{variant:"outline",onClick:()=>h(!1),disabled:f,children:e.jsx(D,{children:""})}),e.jsx(L,{onClick:y,disabled:f,variant:"destructive",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin ml-2"}),e.jsx(D,{children:" ..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ca,{className:"w-4 h-4 ml-2"}),e.jsx(D,{children:" "})]})})]})]})})]})},Ar=x.forwardRef(({className:s,...t},r)=>e.jsx("textarea",{className:Ue("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:r,...t}));Ar.displayName="Textarea";const Ay=({orderId:s,orderStatus:t,onRejectComplete:r,disabled:n=!1,size:a="default",variant:l="destructive"})=>{const[c,d]=x.useState(!1),[m,h]=x.useState(!1),[f,p]=x.useState(""),{toast:w}=Xe();if(!(t==="pending"))return null;const j=async()=>{if(!f.trim()){w({title:"   ",description:"    ",variant:"destructive"});return}try{d(!0),console.log("    :",{orderId:s,orderIdType:typeof s,rejectionReason:f});const{data:y,error:b}=await I.from("orders").update({order_status:"rejected",customer_notes:`[  ] ${f}`,updated_at:new Date().toISOString()}).eq("id",s).select();if(console.log("  :",{data:y,error:b}),b)throw console.error("    -  :",{error:b,message:b.message,code:b.code,details:b.details,hint:b.hint}),b;console.log("    "),w({title:"  ",description:"      .",variant:"default"}),h(!1),p(""),r&&r()}catch(y){console.error("     -  :",{error:y,message:y?.message,code:y?.code,details:y?.details,hint:y?.hint,orderId:s});const b=y?.message||y?.details||"  ";w({title:"   ",description:` : ${b}.    .`,variant:"destructive"})}finally{d(!1)}};return e.jsxs(on,{open:m,onOpenChange:h,children:[e.jsx(GP,{asChild:!0,children:e.jsxs(L,{variant:l,size:a,disabled:n||c,className:"flex items-center gap-2",children:[e.jsx(Vn,{className:"w-4 h-4"}),e.jsx(D,{children:" "})]})}),e.jsxs(kr,{className:"sm:max-w-[425px]",children:[e.jsxs(Or,{children:[e.jsxs(Rr,{className:"flex items-center gap-2",children:[e.jsx(Vn,{className:"w-5 h-5 text-red-600"}),e.jsx(D,{children:"  "})]}),e.jsx(Ka,{children:e.jsx(D,{children:'             ""      .'})})]}),e.jsxs("div",{className:"space-y-4 my-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:e.jsx(D,{children:"  "})}),e.jsx(Ar,{placeholder:"    ...",value:f,onChange:y=>p(y.target.value),className:"min-h-[100px]",disabled:c})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"text-red-600 text-sm",children:""}),e.jsx("div",{className:"text-sm text-red-700",children:e.jsx(D,{children:':        ""       .'})})]})})]}),e.jsxs(Di,{children:[e.jsx(L,{variant:"outline",onClick:()=>{h(!1),p("")},disabled:c,children:e.jsx(D,{children:""})}),e.jsx(L,{onClick:j,disabled:c||!f.trim(),variant:"destructive",children:c?e.jsx(D,{children:" ..."}):e.jsx(D,{children:" "})})]})]})]})},Dy=({divisions:s,compact:t=!1,className:r=""})=>{const n=a=>{const{store_response_status:l,order_status:c}=a;return c==="delivered"?{status:"delivered",label:"",color:"bg-green-100 text-green-800",icon:Go,shortDescription:""}:c==="returned"?{status:"returned",label:"",color:"bg-red-100 text-red-800",icon:lt,shortDescription:""}:l==="unavailable"||l==="rejected"||c==="rejected"?{status:"rejected",label:"",color:"bg-red-100 text-red-800",icon:lt,shortDescription:""}:l==="available"||l==="accepted"?{status:"accepted",label:"",color:"bg-green-100 text-green-800",icon:Se,shortDescription:""}:c==="assigned"?{status:"assigned",label:"",color:"bg-blue-100 text-blue-800",icon:Me,shortDescription:""}:c==="preparing"||c==="ready"?{status:"processing",label:" ",color:"bg-orange-100 text-orange-800",icon:Me,shortDescription:" "}:{status:"pending",label:" ",color:"bg-yellow-100 text-yellow-800",icon:Rt,shortDescription:" "}};if(!s||s.length===0)return null;if(t){const a=s.reduce((l,c)=>{const d=n(c);return l[d.status]=(l[d.status]||0)+1,l},{});return e.jsxs("div",{className:`flex items-center gap-2 ${r}`,children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.length," :"]})]}),e.jsx("div",{className:"flex items-center gap-1",children:Object.entries(a).map(([l,c])=>{const d={delivered:"bg-green-100 text-green-700",accepted:"bg-green-100 text-green-700",assigned:"bg-blue-100 text-blue-700",processing:"bg-orange-100 text-orange-700",rejected:"bg-red-100 text-red-700",returned:"bg-red-100 text-red-700",pending:"bg-yellow-100 text-yellow-700"},m={delivered:"",accepted:"",assigned:"",processing:" ",rejected:"",returned:"",pending:""};return e.jsxs(Q,{className:`text-xs ${d[l]}`,children:[c," ",m[l]]},l)})})]})}return e.jsxs("div",{className:`space-y-3 ${r}`,children:[e.jsxs("div",{className:"text-sm font-medium text-blue-600 flex items-center gap-2 mb-3",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsxs(D,{children:["    (",s.length," )"]})]}),s.map((a,l)=>{const c=n(a),d=c.icon;return e.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:e.jsx(D,{children:a.store_name})}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",a.items_count," )"]})]}),e.jsxs(Q,{className:c.color,children:[e.jsx(d,{className:"w-3 h-3 ml-1"}),e.jsx(D,{children:c.label})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:e.jsx(D,{children:c.shortDescription===""?"    -   ":c.shortDescription===""?"   ":c.shortDescription===""?a.rejection_reason||"  ":c.shortDescription===""?"  ":c.shortDescription===""?"  ":c.shortDescription===" "?"  ":"   "})}),e.jsxs("span",{className:"font-medium text-gray-900",children:[a.total_amount.toLocaleString()," ."]})]}),a.store_response_at&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[" : ",new Date(a.store_response_at).toLocaleDateString("ar-SA")]})]},a.id)})]})};function VD(s,t,r){const n={message:Mt(t,"  "),stack:t instanceof Error?t.stack:void 0,code:t?.code,details:t?.details,hint:t?.hint,rawError:t,...r,timestamp:new Date().toISOString()};return console.error(` ${s}:`,n),n}function Mt(s,t="   "){return s instanceof Error?s.message:typeof s=="string"?s:s?.message?s.message:t}function GD(s,t){return s?.code===t}function YD(s){return GD(s,"PGRST116")||s?.status===404}const db=s=>{const[t,r]=x.useState([]),[n,a]=x.useState(!0),[l,c]=x.useState(null),{toast:d}=Xe(),m=async()=>{try{a(!0),c(null);let p=I.from("orders").select(`
          id,
          customer_name,
          customer_phone,
          order_status,
          assigned_store_id,
          store_response_status,
          store_response_at,
          rejection_reason,
          main_store_name,
          total_amount,
          created_at,
          order_details,
          items,
          order_code
        `).order("created_at",{ascending:!1});if(s)console.log(" Searching for divisions of order:",s),p=p.like("order_details",`%     ${s}%`);else{console.log(" No originalOrderId provided, skipping division fetch"),r([]),a(!1);return}const{data:w,error:v}=await p;if(v)throw v;const j=w?.map(y=>{const b=Array.isArray(y.items)?y.items.length:0;return{id:y.id,store_name:y.main_store_name||"  ",assigned_store_id:y.assigned_store_id,store_response_status:y.store_response_status,order_status:y.order_status,store_response_at:y.store_response_at,rejection_reason:y.rejection_reason,items_count:b,total_amount:y.total_amount||0,customer_name:y.customer_name,customer_phone:y.customer_phone,created_at:y.created_at,main_store_name:y.main_store_name,order_code:y.order_code,order_details:y.order_details}})||[];console.log(" Fetched divisions:",j.length,"divisions for originalOrderId:",s),console.log(" Division details:",j.map(y=>({id:y.id,store_name:y.store_name,order_status:y.order_status,store_response_status:y.store_response_status}))),r(j)}catch(p){const w=Mt(p,"    ");c(w),console.error("   :",{message:w,rawError:p,code:p?.code,details:p?.details,hint:p?.hint,originalOrderId:s}),d({title:"   ",description:w,variant:"destructive"})}finally{a(!1)}},h=p=>p?t.filter(w=>{const v=w.order_details||"";return v.includes(`     ${p}`)||v.includes(p)}):[],f=async()=>{await m()};return x.useEffect(()=>{m()},[s]),x.useEffect(()=>{const p=I.channel("order-divisions-updates").on("postgres_changes",{event:"*",schema:"public",table:"orders"},w=>{console.log(" Real-time order division update:",w),m()}).subscribe();return()=>{p.unsubscribe()}},[s]),{divisions:t,loading:n,error:l,refreshDivisions:f,getDivisionsByOriginalOrder:h}};function KD(s,t=!0){return!s||!Array.isArray(s)||s.length===0?0:s.reduce((r,n)=>{const a=n.quantity||1;let l=0;if(t&&n.discounted_price){const c=n.product?.price||n.price||0,d=n.discounted_price;d>0&&d<c?l=d:l=c}else t&&n.product?.is_discounted&&n.product?.discounted_price&&n.product.discounted_price<(n.product.price||0)?l=n.product.discounted_price:l=n.product?.price||n.price||0;return r+l*a},0)}class Jm{static convertOrderPricesToIQD(t){const r=t.order_items?.map(l=>({...l,price:l.price||0})),n=t.items?.map(l=>({...l,price:l.price||0})),a=t.total_amount||0;return{...t,order_items:r,items:n,total_amount:a,total_amount_sar:a,total_amount_iqd:a}}static processOrderData(t){return Array.isArray(t)?t.map((r,n)=>{try{return!r||typeof r!="object"?(console.error(` processOrderData:      ${n}:`,r),null):!r.id&&!r.order_id?(console.error(` processOrderData:      ${n}:`,r),null):this.convertOrderPricesToIQD(r)}catch(a){return console.error(`     ${n}:`,a,r),null}}).filter(Boolean):(console.error(" processOrderData:    :",t),[])}static calculateOrderTotal(t,r="IQD"){return KD(t,!0)}static normalizeOrderAmounts(t){const r=this.convertOrderPricesToIQD(t);return r.order_items?.length>0?(r.total_amount_iqd=this.calculateOrderTotal(r.order_items,"IQD"),r.total_amount_sar=this.calculateOrderTotal(r.order_items,"SAR"),r.total_amount=r.total_amount_sar):r.items?.length>0&&(r.total_amount_iqd=this.calculateOrderTotal(r.items,"IQD"),r.total_amount_sar=this.calculateOrderTotal(r.items,"SAR"),r.total_amount=r.total_amount_sar),r}}const XD=({order:s,onAssign:t,onEdit:r,onViewDetails:n,onSplitComplete:a,compact:l=!1,showAssignButton:c=!0})=>{const{t:d}=us(),[m,h]=x.useState(!1),f=s.order_details?.includes("    "),{divisions:p,loading:w}=db(s.order_code||s.id);x.useEffect(()=>{!w&&p.length>0&&console.log(` Order ${s.order_code||s.id.slice(0,8)} has ${p.length} divisions:`,p)},[p,w,s.order_code,s.id]);const v={label:lb[s.order_status]||s.order_status,color:cb[s.order_status]||"bg-gray-100 text-gray-800"},j=F=>{try{return new Date(F).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})}catch(ee){return console.error("Date formatting error:",ee),F}},y=F=>{try{const ee=new Date(F),pe=Math.floor((new Date().getTime()-ee.getTime())/(1e3*60));return pe<1?"":pe<60?` ${pe} `:pe<1440?` ${Math.floor(pe/60)} `:` ${Math.floor(pe/1440)} `}catch(ee){return console.error("Time ago formatting error:",ee),"  "}},b=Jm.normalizeOrderAmounts(s),C=b.total_amount_iqd||s.total_amount||0,E=$a(C),O=(()=>{const F=b.order_items&&b.order_items.length>0?b.order_items:b.items||[],ee=new Map;F.length===0&&s.main_store_name?ee.set(s.main_store_name,[]):F.forEach(re=>{const H=re.main_store||re.main_store_name||s.main_store_name||"  ";ee.has(H)||ee.set(H,[]),ee.get(H).push(re)});const ne=ee.size,pe=Array.from(ee.entries()).map(([re,H])=>({storeName:re,itemsCount:H.length,items:H}));return{storesCount:ne,stores:pe,isSingleStore:ne===1,mainStoreName:ne===1?pe[0]?.storeName:null,hasItems:F.length>0}})(),R=()=>{n&&n(s.id)},k=()=>{r&&r(s)},P=()=>{a&&a()};return l?e.jsx($,{className:"w-full hover:shadow-md transition-shadow","data-order-id":s.id,children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-lg",children:e.jsxs(D,{children:[" #",s.order_code||s.id.slice(0,8)]})}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(tn,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(D,{className:"font-medium",children:s.customer_name})]})]}),e.jsx(Q,{className:v.color,children:e.jsx(D,{children:v.label})})]}),e.jsxs("div",{className:"space-y-2 text-sm mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-mono",children:s.customer_phone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bn,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-mono text-primary font-bold",children:E.iqd})]}),s.assigned_store_name&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-blue-600 font-medium",children:s.assigned_store_name})]}),(s.order_status==="customer_rejected"||s.store_response_status==="customer_rejected")&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-purple-50 border border-purple-200 rounded",children:[e.jsx(Se,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"text-xs font-medium text-purple-600",children:"    "})]}),s.assigned_store_name&&s.store_response_status&&s.store_response_status!=="customer_rejected"&&s.order_status!=="customer_rejected"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:`w-4 h-4 ${s.store_response_status==="available"||s.store_response_status==="accepted"?"text-green-600":s.store_response_status==="unavailable"||s.store_response_status==="rejected"?"text-red-600":"text-yellow-600"}`}),e.jsx("span",{className:`text-xs font-medium ${s.store_response_status==="available"||s.store_response_status==="accepted"?"text-green-600":s.store_response_status==="unavailable"||s.store_response_status==="rejected"?"text-red-600":"text-yellow-600"}`,children:s.store_response_status==="available"||s.store_response_status==="accepted"?" ":s.store_response_status==="unavailable"||s.store_response_status==="rejected"?"  ":"    "})]})]}),(()=>{const F=b.order_items&&b.order_items.length>0?b.order_items:b.items;return F&&F.length>0&&e.jsx($s,{items:F,compact:!0})})(),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 pt-3 border-t",children:[e.jsx(L,{variant:"outline",size:"sm",onClick:R,className:"flex-1",children:e.jsx(D,{children:d("details")})}),s.order_status==="pending"&&c&&e.jsxs(L,{size:"sm",onClick:k,className:"flex-1",disabled:m,children:[e.jsx(Se,{className:"w-4 h-4 ml-2"}),e.jsx(D,{children:""})]}),s.order_status==="pending"?e.jsx(Ay,{orderId:s.id,orderStatus:s.order_status,onRejectComplete:P,disabled:m,size:"sm",variant:"destructive"}):e.jsx(Iy,{orderId:s.id,orderStatus:s.order_status,storeResponseStatus:s.store_response_status,adminMode:!0,onRejectComplete:a,disabled:m,size:"sm",variant:"destructive"}),s.order_status==="pending"&&e.jsx("div",{className:"w-full mt-2 flex gap-2",children:O.storesCount>1?e.jsx(Qm,{orderId:s.id,orderItems:b.order_items&&b.order_items.length>0?b.order_items:s.items||[],onSplitComplete:a,disabled:m}):O.isSingleStore&&O.mainStoreName&&O.mainStoreName!=="  "?e.jsx(Py,{orderId:s.id,orderItems:b.order_items&&b.order_items.length>0?b.order_items:s.items||[],storeName:O.mainStoreName,onTransferComplete:a,disabled:m}):null})]})]})}):e.jsxs($,{className:"w-full hover:shadow-md transition-shadow","data-order-id":s.id,children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(V,{className:"text-lg flex items-center gap-2",children:e.jsxs(D,{children:[" #",s.order_code||s.id.slice(0,8)]})}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:[e.jsx(Rt,{className:"w-4 h-4"}),e.jsx("span",{children:y(s.created_at)}),e.jsxs("span",{className:"text-xs",children:["(",j(s.created_at),")"]})]})]}),e.jsx(Q,{className:v.color,children:e.jsx(D,{children:v.label})})]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tn,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[d("customer.label")," "]}),e.jsx(D,{className:"font-medium",children:s.customer_name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("div",{className:"font-mono",children:e.jsx("p",{style:{textIndent:"1em"},children:s.customer_phone})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[d("phone.field"),": "]})]}),s.customer_address&&s.customer_address.trim()!==""&&s.customer_address!==" "&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ed,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:": "}),e.jsx(D,{className:"font-medium",children:s.customer_address})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bn,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[d("total.amount.no.delivery"),": "]}),e.jsx("div",{className:"font-bold text-primary font-mono",children:e.jsx("div",{className:"text-lg",children:E.iqd})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nd,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:" : "}),e.jsx("span",{className:"font-medium",children:j(s.created_at)})]})]}),(s.assigned_store_name||s.main_store_name)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:Xf(s)}),e.jsx(D,{className:"font-medium text-blue-600",children:Qf(s)})]})]}),(s.order_status==="customer_rejected"||s.store_response_status==="customer_rejected")&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-purple-50 border border-purple-200 rounded-lg",children:[e.jsx(Se,{className:"w-4 h-4 text-purple-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:" : "}),e.jsx("span",{className:"font-medium text-purple-600",children:"    "})]})]}),s.assigned_store_name&&s.store_response_status&&s.store_response_status!=="customer_rejected"&&s.order_status!=="customer_rejected"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:`w-4 h-4 ${s.store_response_status==="available"||s.store_response_status==="accepted"?"text-green-600":s.store_response_status==="unavailable"||s.store_response_status==="rejected"?"text-red-600":"text-yellow-600"}`}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[d("store.status"),": "]}),e.jsx("span",{className:`font-medium ${s.store_response_status==="available"||s.store_response_status==="accepted"?"text-green-600":s.store_response_status==="unavailable"||s.store_response_status==="rejected"?"text-red-600":"text-yellow-600"}`,children:s.store_response_status==="available"||s.store_response_status==="accepted"?` ${d("available.status")}`:s.store_response_status==="unavailable"||s.store_response_status==="rejected"?` ${d("unavailable")}`:` ${d("waiting.for.store.response")}`})]})]})]})]}),s.customer_notes&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-muted/30 rounded-lg",children:[e.jsx(Ra,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:" :"}),e.jsx("div",{className:"mt-1",children:e.jsx(D,{className:"text-sm",children:s.customer_notes})})]})]}),s.order_details&&s.order_status==="returned"&&s.order_details.includes("Return reason:")&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx(Ra,{className:"w-4 h-4 text-red-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-semibold text-red-600",children:"  :"}),e.jsx("div",{className:"mt-1",children:e.jsx(D,{className:"text-sm font-medium text-red-700",children:s.order_details.replace("Return reason: ","")})})]})]}),b.items&&b.items.length>0||b.order_items&&b.order_items.length>0?e.jsx($s,{items:b.order_items||b.items,showPriceInBothCurrencies:!0}):null,!l&&!w&&p.length>0&&!f&&e.jsx("div",{className:"mt-4",children:e.jsx(Dy,{divisions:p,compact:!1})}),l&&!w&&p.length>0&&!f&&e.jsx("div",{className:"mt-2",children:e.jsx(Dy,{divisions:p,compact:!0})}),f&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-700",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:e.jsx(D,{children:"      "})})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t",children:[e.jsxs(L,{variant:"outline",size:"sm",onClick:R,className:"flex items-center gap-2",children:[e.jsx(rd,{className:"w-4 h-4"}),e.jsx(D,{children:""})]}),r&&e.jsxs(L,{variant:"outline",size:"sm",onClick:k,className:"flex items-center gap-2",children:[e.jsx(rd,{className:"w-4 h-4"}),e.jsx(D,{children:""})]}),s.order_status==="pending"?e.jsx(Ay,{orderId:s.id,orderStatus:s.order_status,onRejectComplete:P,disabled:m,size:"sm",variant:"destructive"}):e.jsx(Iy,{orderId:s.id,orderStatus:s.order_status,storeResponseStatus:s.store_response_status,adminMode:!0,onRejectComplete:a,disabled:m,size:"sm",variant:"destructive"}),s.order_status==="pending"&&e.jsx(e.Fragment,{children:O.storesCount>1?e.jsx(Qm,{orderId:s.id,orderItems:b.order_items&&b.order_items.length>0?b.order_items:s.items||[],onSplitComplete:a,disabled:m}):O.isSingleStore&&O.mainStoreName&&O.mainStoreName!=="  "?e.jsx(Py,{orderId:s.id,orderItems:b.order_items&&b.order_items.length>0?b.order_items:s.items||[],storeName:O.mainStoreName,onTransferComplete:a,disabled:m}):null})]})]})]})};var ap="Progress",op=100,[QD,XL]=Vs(ap),[JD,ZD]=QD(ap),ub=x.forwardRef((s,t)=>{const{__scopeProgress:r,value:n=null,max:a,getValueLabel:l=e$,...c}=s;(a||a===0)&&!$y(a)&&console.error(t$(`${a}`,"Progress"));const d=$y(a)?a:op;n!==null&&!Ly(n,d)&&console.error(s$(`${n}`,"Progress"));const m=Ly(n,d)?n:null,h=vd(m)?l(m,d):void 0;return e.jsx(JD,{scope:r,value:m,max:d,children:e.jsx(ze.div,{"aria-valuemax":d,"aria-valuemin":0,"aria-valuenow":vd(m)?m:void 0,"aria-valuetext":h,role:"progressbar","data-state":fb(m,d),"data-value":m??void 0,"data-max":d,...c,ref:t})})});ub.displayName=ap;var hb="ProgressIndicator",mb=x.forwardRef((s,t)=>{const{__scopeProgress:r,...n}=s,a=ZD(hb,r);return e.jsx(ze.div,{"data-state":fb(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:t})});mb.displayName=hb;function e$(s,t){return`${Math.round(s/t*100)}%`}function fb(s,t){return s==null?"indeterminate":s===t?"complete":"loading"}function vd(s){return typeof s=="number"}function $y(s){return vd(s)&&!isNaN(s)&&s>0}function Ly(s,t){return vd(s)&&!isNaN(s)&&s<=t&&s>=0}function t$(s,t){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${op}\`.`}function s$(s,t){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${op} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var pb=ub,r$=mb;const Ho=x.forwardRef(({className:s,value:t,...r},n)=>e.jsx(pb,{ref:n,className:Ue("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...r,children:e.jsx(r$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Ho.displayName=pb.displayName;const vi=(s,t)=>{switch(t){case"pending":return s.filter(r=>r.order_status==="pending");case"assigned":return s.filter(r=>r.order_status==="assigned");case"delivered":return s.filter(r=>r.order_status==="delivered"||r.order_status==="completed");case"completed":return s.filter(r=>r.order_status==="delivered"||r.order_status==="completed");case"returned":return s.filter(r=>r.order_status==="returned");case"customer_rejected":return s.filter(r=>r.order_status==="customer_rejected");default:return console.warn(`    : ${t}`),[]}},Zm=s=>({total:s.length,pending:vi(s,"pending").length,assigned:vi(s,"assigned").length,delivered:vi(s,"delivered").length,returned:vi(s,"returned").length,customer_rejected:vi(s,"customer_rejected").length,rejected:vi(s,"rejected").length}),n$=s=>["pending","assigned","delivered","completed","returned","customer_rejected","rejected"].includes(s),i$=({orders:s,onRefreshOrders:t,totalOrdersCount:r=0})=>{const[n,a]=x.useState(!1),{autoAssignResults:l,clearAutoAssignResults:c}=Kf(),d=Zm(s),m=d.total>0?d.pending/d.total*100:0,h=d.total>0?d.assigned/d.total*100:0,f=d.total>0?d.delivered/d.total*100:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(nE,{className:"w-5 h-5"}),e.jsx(D,{children:"  "})]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:" "}),e.jsxs("span",{children:[d.pending,"  (",m.toFixed(1),"%)"]})]}),e.jsx(Ho,{value:m,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:" "}),e.jsxs("span",{children:[d.assigned,"  (",h.toFixed(1),"%)"]})]}),e.jsx(Ho,{value:h,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:" "}),e.jsxs("span",{children:[d.delivered,"  (",f.toFixed(1),"%)"]})]}),e.jsx(Ho,{value:f,className:"h-2"})]})]})]}),l&&n&&e.jsxs($,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"w-5 h-5"}),e.jsx(D,{children:"   "})]}),e.jsx(L,{onClick:()=>{c(),a(!1)},variant:"ghost",size:"sm",children:""})]})}),e.jsxs(M,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-center",children:[e.jsx(Se,{className:"w-6 h-6 text-green-600 mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-bold text-green-700",children:l.assigned_count}),e.jsx("p",{className:"text-sm text-green-600",children:"   "})]}),l.unmatched_count>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-center",children:[e.jsx(nt,{className:"w-6 h-6 text-yellow-600 mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-bold text-yellow-700",children:l.unmatched_count}),e.jsx("p",{className:"text-sm text-yellow-600",children:"  "})]}),l.error_count>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-center",children:[e.jsx(lt,{className:"w-6 h-6 text-red-600 mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-bold text-red-700",children:l.error_count}),e.jsx("p",{className:"text-sm text-red-600",children:" "})]})]}),l.results&&l.results.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:" :"}),e.jsx(ei,{className:"h-32",children:e.jsx("div",{className:"space-y-1",children:l.results.map((p,w)=>{const v={assigned:{color:"text-green-600",icon:Se},unmatched:{color:"text-yellow-600",icon:nt},error:{color:"text-red-600",icon:lt}}[p.status],j=v.icon;return e.jsxs("div",{className:"flex items-center gap-2 text-sm p-2 bg-gray-50 rounded",children:[e.jsx(j,{className:`w-4 h-4 ${v.color}`}),e.jsx("span",{className:"font-mono text-xs",children:p.order_id.slice(0,8)}),p.store_name&&e.jsxs("span",{className:"text-blue-600",children:[" ",p.store_name]}),p.error_message&&e.jsxs("span",{className:"text-red-600 text-xs",children:["(",p.error_message,")"]})]},w)})})})]})]})]})]})};class a${channels=new Map;subscriptions=new Map;subscribe(t,r,n,a,l){console.log(` Setting up Realtime subscription: ${t} -> ${r} (${n})`),this.subscriptions.has(t)||this.subscriptions.set(t,[]),this.subscriptions.get(t).push({table:r,event:n,filter:l,handler:a}),this.createChannel(t)}createChannel(t){this.channels.has(t)&&this.unsubscribe(t);const r=this.subscriptions.get(t);if(!r||r.length===0)return;console.log(` Creating Realtime channel: ${t}`);let n=I.channel(t);r.forEach((a,l)=>{const c={event:a.event,schema:"public",table:a.table};a.filter&&(c.filter=a.filter),n=n.on("postgres_changes",c,d=>{console.log(` Realtime event ${t}[${l}]:`,{table:a.table,event:d.eventType,old:d.old,new:d.new});try{a.handler(d)}catch(m){console.error(` Error in Realtime handler for ${t}:`,m)}})}),n.subscribe(a=>{console.log(` Channel ${t} status:`,a),a==="SUBSCRIBED"?console.log(` Successfully subscribed to ${t}`):a==="CHANNEL_ERROR"?console.error(` Error subscribing to ${t}`):a==="TIMED_OUT"&&(console.warn(` Timeout subscribing to ${t}, retrying...`),setTimeout(()=>this.createChannel(t),2e3))}),this.channels.set(t,n)}unsubscribe(t){const r=this.channels.get(t);r&&(console.log(` Unsubscribing from channel: ${t}`),I.removeChannel(r),this.channels.delete(t)),this.subscriptions.delete(t)}unsubscribeAll(){console.log(" Unsubscribing from all Realtime channels..."),this.channels.forEach((t,r)=>{console.log(` Removing channel: ${r}`),I.removeChannel(t)}),this.channels.clear(),this.subscriptions.clear()}getStatus(){const t={};return this.channels.forEach((r,n)=>{t[n]="subscribed"}),t}subscribeToOrders(t,r,n,a){r&&this.subscribe(t,"orders","INSERT",r),n&&this.subscribe(t,"orders","UPDATE",n),a&&this.subscribe(t,"orders","DELETE",a)}subscribeToStoreResponses(t,r){this.subscribe(t,"orders","*",r)}subscribeToAdminNotifications(t,r,n="admin"){this.subscribe(t,"notifications","*",r,`recipient_type=eq.admin.and.recipient_id=eq.${n}`)}subscribeToStoreNotifications(t,r,n){this.subscribe(t,"notifications","*",n,`recipient_type=eq.store.and.recipient_id=eq.${r}`)}subscribeToCustomerNotifications(t,r,n){this.subscribe(t,"notifications","*",n,`recipient_type=eq.customer.and.recipient_id=eq.${r}`)}subscribeToStoreOrders(t,r,n){this.subscribe(t,"orders","*",n,`assigned_store_id=eq.${r}`)}subscribeToOrder(t,r){const n=`order-${t}`;this.subscribe(n,"orders","*",r,`id=eq.${t}`)}}const o$=new a$;class Na{static instance;debugMode=!0;connections=new Map;static getInstance(){return Na.instance||(Na.instance=new Na),Na.instance}log(t,r){this.debugMode&&console.log(` [Realtime Debug] ${t}`,r||"")}async testRealtimeConnection(){try{this.log("Testing Realtime connection...");const{data:t,error:r}=await I.from("orders").select("count").limit(1);if(r)return this.log(" Database connection failed",r),!1;this.log(" Database connection working");const n=I.channel("realtime-test-"+Date.now()).on("postgres_changes",{event:"*",schema:"public",table:"orders"},a=>{this.log(" Realtime event received in test",a)});return new Promise(a=>{n.subscribe(l=>{this.log("Test channel status:",l),l==="SUBSCRIBED"?(this.log(" Realtime subscription working"),I.removeChannel(n),a(!0)):(l==="CHANNEL_ERROR"||l==="TIMED_OUT")&&(this.log(" Realtime subscription failed:",l),I.removeChannel(n),a(!1))}),setTimeout(()=>{this.log(" Realtime test timed out"),I.removeChannel(n),a(!1)},1e4)})}catch(t){return this.log(" Realtime test exception",t),!1}}async checkTablePermissions(t){try{const{data:r,error:n}=await I.from(t).select("*").limit(1);return n?(this.log(` No read permission for table ${t}`,n),!1):(this.log(` Read permission OK for table ${t}`),!0)}catch(r){return this.log(` Exception checking table ${t}`,r),!1}}async runDiagnostics(){this.log(" Running comprehensive Realtime diagnostics...");const t={databaseConnection:!1,realtimeConnection:!1,ordersTableAccess:!1,storeResponsesTableAccess:!1,recommendations:[]};try{const{error:r}=await I.from("orders").select("count").limit(1);t.databaseConnection=!r,r&&t.recommendations.push("Database connection failed. Check Supabase configuration.")}catch{t.recommendations.push("Database connection exception. Check network and Supabase URL.")}return t.ordersTableAccess=await this.checkTablePermissions("orders"),t.ordersTableAccess||t.recommendations.push("No access to orders table. Check RLS policies."),t.realtimeConnection=await this.testRealtimeConnection(),t.realtimeConnection||t.recommendations.push("Realtime connection failed. Check Supabase Realtime settings."),this.log(" Diagnostics complete",t),t}trackConnection(t,r){this.connections.set(t,{channel:r,createdAt:new Date,status:"connecting"}),this.log(` Tracking connection: ${t}`)}updateConnectionStatus(t,r){const n=this.connections.get(t);n&&(n.status=r,n.lastUpdate=new Date,this.log(` Connection ${t} status: ${r}`))}getConnectionsStatus(){const t={};return this.connections.forEach((r,n)=>{t[n]={status:r.status,createdAt:r.createdAt,lastUpdate:r.lastUpdate||r.createdAt}}),t}cleanup(){this.log(" Cleaning up tracked connections"),this.connections.clear()}}const Sa=Na.getInstance(),l$=(s={})=>{const{onOrderUpdate:t,onNotificationUpdate:r,enableLogging:n=!0}=s,a=x.useRef(null),l=x.useRef(null);return x.useEffect(()=>(n&&console.log(" Setting up Realtime channels: orders_channel & notifications_channel"),a.current=I.channel("orders_channel"),a.current.on("broadcast",{event:"order_update"},m=>{n&&console.log("    orders_channel:",m),t&&t(m)}),a.current.on("postgres_changes",{event:"INSERT",schema:"public",table:"orders"},m=>{n&&console.log("    :",m.new);const h=m.new;t&&t({orderId:h.id,type:"new_order",customer_name:h.customer_name,order_code:h.order_code,data:h})}),a.current.on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders"},m=>{n&&console.log("  :",m.new);const h=m.new,f=m.old;if(t){let p="status_change";h.assigned_store_id!==f.assigned_store_id?p="assignment":h.store_response_status!==f.store_response_status&&(p="store_response"),t({orderId:h.id,type:p,storeId:h.assigned_store_id,status:h.order_status,customer_name:h.customer_name,order_code:h.order_code,data:h})}}),a.current.subscribe(m=>{n&&(console.log(" orders_channel status:",m),m==="SUBSCRIBED"?console.log(" Successfully subscribed to orders_channel"):m==="CHANNEL_ERROR"?console.error("   Real-time: CHANNEL_ERROR  orders_channel"):m==="TIMED_OUT"&&console.warn("     orders_channel"))}),l.current=I.channel("notifications_channel"),l.current.on("broadcast",{event:"notification_update"},m=>{n&&console.log("    notifications_channel:",m),r&&r(m)}),l.current.on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications"},m=>{n&&console.log("     :",m.new);const h=m.new;r&&r({recipient_type:h.recipient_type,message:h.message,order_id:h.order_id,store_id:h.recipient_type==="store"?h.recipient_id:void 0,notification_type:h.type,data:h})}),l.current.subscribe(m=>{n&&(console.log(" notifications_channel status:",m),m==="SUBSCRIBED"?console.log(" Successfully subscribed to notifications_channel"):m==="CHANNEL_ERROR"?console.error("   Real-time: CHANNEL_ERROR  notifications_channel"):m==="TIMED_OUT"&&console.warn("     notifications_channel"))}),()=>{n&&console.log(" Cleaning up Realtime channels..."),a.current&&(I.removeChannel(a.current),a.current=null),l.current&&(I.removeChannel(l.current),l.current=null)}),[t,r,n]),{sendOrderUpdate:m=>{a.current&&a.current.send({type:"broadcast",event:"order_update",payload:m})},sendNotificationUpdate:m=>{l.current&&l.current.send({type:"broadcast",event:"notification_update",payload:m})},isConnected:!!(a.current&&l.current)}};var eu="Collapsible",[c$,QL]=Vs(eu),[d$,lp]=c$(eu),gb=x.forwardRef((s,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:l,onOpenChange:c,...d}=s,[m,h]=en({prop:n,defaultProp:a??!1,onChange:c,caller:eu});return e.jsx(d$,{scope:r,disabled:l,contentId:lr(),open:m,onOpenToggle:x.useCallback(()=>h(f=>!f),[h]),children:e.jsx(ze.div,{"data-state":dp(m),"data-disabled":l?"":void 0,...d,ref:t})})});gb.displayName=eu;var xb="CollapsibleTrigger",vb=x.forwardRef((s,t)=>{const{__scopeCollapsible:r,...n}=s,a=lp(xb,r);return e.jsx(ze.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":dp(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:t,onClick:Pe(s.onClick,a.onOpenToggle)})});vb.displayName=xb;var cp="CollapsibleContent",yb=x.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=lp(cp,s.__scopeCollapsible);return e.jsx(ks,{present:r||a.open,children:({present:l})=>e.jsx(u$,{...n,ref:t,present:l})})});yb.displayName=cp;var u$=x.forwardRef((s,t)=>{const{__scopeCollapsible:r,present:n,children:a,...l}=s,c=lp(cp,r),[d,m]=x.useState(n),h=x.useRef(null),f=pt(t,h),p=x.useRef(0),w=p.current,v=x.useRef(0),j=v.current,y=c.open||d,b=x.useRef(y),C=x.useRef(void 0);return x.useEffect(()=>{const E=requestAnimationFrame(()=>b.current=!1);return()=>cancelAnimationFrame(E)},[]),Qt(()=>{const E=h.current;if(E){C.current=C.current||{transitionDuration:E.style.transitionDuration,animationName:E.style.animationName},E.style.transitionDuration="0s",E.style.animationName="none";const S=E.getBoundingClientRect();p.current=S.height,v.current=S.width,b.current||(E.style.transitionDuration=C.current.transitionDuration,E.style.animationName=C.current.animationName),m(n)}},[c.open,n]),e.jsx(ze.div,{"data-state":dp(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!y,...l,ref:f,style:{"--radix-collapsible-content-height":w?`${w}px`:void 0,"--radix-collapsible-content-width":j?`${j}px`:void 0,...s.style},children:y&&a})});function dp(s){return s?"open":"closed"}var h$=gb;const m$=h$,f$=vb,p$=yb,g$=({autoCheck:s=!0,collapsible:t=!1,showAsFilter:r=!1,onStatusUpdate:n})=>{const[a,l]=x.useState({}),[c,d]=x.useState(!1),[m,h]=x.useState(!t),f="https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1",p=[{name:"auto-assign-orders",label:" "},{name:"get-order",label:" "}],w=async E=>{try{const S=new AbortController,O=setTimeout(()=>S.abort(),1e4),R=await fetch(`${f}/${E}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndrempvdmhsbGplYXF6b3l0cGViIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkwNDY2MjIsImV4cCI6MjA2NDYyMjYyMn0.mx8PnQJaMochaPbjYUmwzlVNIULM05LUDBIM7OFFjZ8"},body:JSON.stringify({test:!0}),signal:S.signal});return clearTimeout(O),{available:!0,status:R.status,statusText:R.statusText,timestamp:new Date().toISOString()}}catch(S){if(console.warn(`Edge Function ${E} check failed:`,S),S instanceof Error){if(S.name==="AbortError")return{available:!1,error:"  ",timestamp:new Date().toISOString()};if(S.message.includes("Failed to fetch"))return{available:!1,error:"   -    ",timestamp:new Date().toISOString()}}return{available:!1,error:S instanceof Error?S.message:"  ",timestamp:new Date().toISOString()}}},v=async()=>{if(f.includes("undefined")){console.warn("Edge Functions base URL not configured properly"),l({});return}d(!0);const E={};try{await Promise.allSettled(p.map(async S=>{console.log(` Checking ${S.name}...`);try{E[S.name]=await w(S.name)}catch(O){console.error(`Failed to check ${S.name}:`,O),E[S.name]={available:!1,error:"  ",timestamp:new Date().toISOString()}}})),l(E),console.log(" Edge Functions status check completed:",E),n&&n(E)}catch(S){console.error("Failed to check Edge Functions:",S),l({})}finally{d(!1)}};x.useEffect(()=>{if(s&&f&&!f.includes("undefined")){const E=setTimeout(()=>{v()},1e3);return()=>clearTimeout(E)}},[s]);const j=E=>E?E.available?e.jsx(Se,{className:"w-4 h-4 text-green-600"}):e.jsx(lt,{className:"w-4 h-4 text-red-600"}):e.jsx(Rt,{className:"w-4 h-4 text-gray-400"}),y=E=>E?E.available?e.jsxs(Q,{variant:"default",className:"bg-green-100 text-green-800",children:[" (",E.status,")"]}):e.jsx(Q,{variant:"destructive",children:" "}):e.jsx(Q,{variant:"secondary",children:" "}),b=()=>{const E=Object.values(a);if(E.length===0)return" ";const S=E.filter(R=>R?.available).length,O=E.length;return S===O?"  ":S===0?"   ":`${S}/${O}  `},C=()=>{const E=Object.values(a);if(E.length===0)return"bg-gray-100 text-gray-800";const S=E.filter(R=>R?.available).length,O=E.length;return S===O?"bg-green-100 text-green-800":S===0?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"};return r?e.jsxs(L,{variant:"outline",onClick:()=>h(!m),className:"w-full justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(sn,{className:"w-4 h-4"}),e.jsx(D,{children:" Edge Functions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:C(),children:b()}),m?"":""]})]}):e.jsxs($,{className:"border-purple-200 bg-purple-50",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:`flex items-center gap-2 ${t?"cursor-pointer":""}`,onClick:t?()=>h(!m):void 0,children:[e.jsxs(V,{className:"flex items-center gap-2 text-purple-800",children:[e.jsx(sn,{className:"w-5 h-5"}),e.jsx(D,{children:" Edge Functions"})]}),t&&e.jsx("span",{className:"text-purple-600",children:m?"":""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Object.keys(a).length>0&&e.jsx(Q,{className:C(),children:b()}),e.jsx(L,{onClick:v,disabled:c,variant:"outline",size:"sm",className:"gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-primary"}),e.jsx(D,{children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"w-3 h-3"}),e.jsx(D,{children:""})]})})]})]})}),m&&e.jsxs(M,{className:"space-y-3",children:[f.includes("undefined")&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-sm text-yellow-700",children:"    Edge Functions URL  "}),e.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"   VITE_SUPABASE_EDGE_FUNCTIONS_BASE"})]}),p.map(E=>{const S=a[E.name];return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[j(S),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:E.label}),e.jsx("p",{className:"text-xs text-gray-600",children:E.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[y(S),S&&S.timestamp&&e.jsx("span",{className:"text-xs text-gray-500",children:new Date(S.timestamp).toLocaleTimeString("ar-IQ")})]})]},E.name)}),Object.keys(a).length>0&&e.jsxs("div",{className:"text-center text-xs text-gray-600",children:[" : ",new Date().toLocaleString("ar-IQ")]})]})]})},x$=({className:s})=>{const t=ur(),[r,n]=x.useState(!1),[a,l]=x.useState({}),[c,d]=x.useState(null),m=w=>{l(w),d(new Date)},f=(()=>{const w=Object.values(a);if(w.length===0)return{status:"unknown",count:"0/0",icon:Bt,color:"bg-gray-100 text-gray-800"};const v=w.filter(y=>y?.available).length,j=w.length;return v===j?{status:"all-online",count:`${v}/${j}`,icon:Se,color:"bg-green-100 text-green-800"}:v===0?{status:"all-offline",count:`${v}/${j}`,icon:lt,color:"bg-red-100 text-red-800"}:{status:"partial",count:`${v}/${j}`,icon:Bt,color:"bg-yellow-100 text-yellow-800"}})(),p=f.icon;return e.jsx("div",{className:s,children:e.jsx($,{className:"border-purple-200 bg-gradient-to-r from-purple-50 to-blue-50 shadow-md hover:shadow-lg transition-shadow",children:e.jsxs(m$,{open:r,onOpenChange:n,children:[e.jsx(f$,{asChild:!0,children:e.jsx(q,{className:"cursor-pointer hover:bg-purple-100/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(sn,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-purple-800",children:e.jsx(D,{children:" Edge Functions"})}),e.jsx("p",{className:"text-sm text-purple-600",children:e.jsx(D,{children:"  "})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:`w-4 h-4 ${f.status==="all-online"?"text-green-600":f.status==="all-offline"?"text-red-600":"text-yellow-600"}`}),e.jsx(Q,{className:f.color,children:f.count}),c&&e.jsx("span",{className:"text-xs text-purple-600",children:c.toLocaleTimeString("ar-IQ",{hour:"2-digit",minute:"2-digit"})})]}),r?e.jsx(hf,{className:"w-4 h-4 text-purple-600"}):e.jsx(V1,{className:"w-4 h-4 text-purple-600"})]})]})})}),e.jsx(p$,{children:e.jsxs(M,{className:"pt-0",children:[e.jsx("div",{className:"border-t border-purple-200 pt-4",children:e.jsx(g$,{autoCheck:!0,collapsible:!1,onStatusUpdate:m})}),Object.keys(a).length>0&&e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:e.jsx(D,{children:" "})}),e.jsx("p",{className:"text-lg font-bold text-green-600",children:Object.values(a).filter(w=>w?.available).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-3 border border-red-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lt,{className:"w-4 h-4 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:e.jsx(D,{children:"  "})}),e.jsx("p",{className:"text-lg font-bold text-red-600",children:Object.values(a).filter(w=>!w?.available).length})]})]})})]}),f.status==="all-offline"&&e.jsx("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lt,{className:"w-4 h-4 text-red-600"}),e.jsx("p",{className:"text-sm font-medium text-red-800",children:e.jsx(D,{children:"     -   "})})]})}),f.status==="partial"&&e.jsx("div",{className:"mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bt,{className:"w-4 h-4 text-yellow-600"}),e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:e.jsx(D,{children:"     -    "})})]})}),e.jsxs("div",{className:"mt-4 border-t border-purple-200 pt-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-purple-700 mb-3 flex items-center gap-2",children:[e.jsx(ds,{className:"w-4 h-4"}),e.jsx(D,{children:"  "})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>t("/test-order-divisions"),className:"justify-start h-auto py-2 px-3",children:[e.jsx(ji,{className:"w-3 h-3 ml-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-xs font-medium",children:e.jsx(D,{children:" "})}),e.jsx("div",{className:"text-xs text-gray-500",children:"  "})]})]}),e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>t("/order-division-demo"),className:"justify-start h-auto py-2 px-3",children:[e.jsx(ji,{className:"w-3 h-3 ml-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-xs font-medium",children:e.jsx(D,{children:" "})}),e.jsx("div",{className:"text-xs text-gray-500",children:" "})]})]}),e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>t("/test-split-order"),className:"justify-start h-auto py-2 px-3",children:[e.jsx(ji,{className:"w-3 h-3 ml-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-xs font-medium",children:e.jsx(D,{children:" "})}),e.jsx("div",{className:"text-xs text-gray-500",children:"Split Orders"})]})]}),e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>t("/database-debug"),className:"justify-start h-auto py-2 px-3",children:[e.jsx(ji,{className:"w-3 h-3 ml-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-xs font-medium",children:e.jsx(D,{children:" "})}),e.jsx("div",{className:"text-xs text-gray-500",children:"Database Debug"})]})]}),e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>{console.log(" Testing error handling...");try{Ii(()=>import("./debugErrorExtraction-Da8tPxbf.js"),[]).then(w=>{w.default()})}catch(w){console.log("Error testing:",w)}},className:"justify-start h-auto py-2 px-3",children:[e.jsx(ds,{className:"w-3 h-3 ml-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-xs font-medium",children:e.jsx(D,{children:" "})}),e.jsx("div",{className:"text-xs text-gray-500",children:"Error Testing"})]})]})]})]})]})})]})})})};function yd(s,t={}){if(!s)return"  ";try{const r=typeof s=="string"?new Date(s):s;if(isNaN(r.getTime()))return console.warn("  :",s),typeof s=="string"?s:"  ";const n={locale:"ar-EG",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0,...t};return r.toLocaleDateString(n.locale,n)}catch(r){return console.error("   :",{dateValue:s,error:r}),typeof s=="string"?s:"   "}}const v$=()=>{const{t:s}=us(),[t,r]=x.useState([]),[n,a]=x.useState(!0),[l,c]=x.useState(!1),{toast:d}=Xe(),m=async(f=!0)=>{try{f?a(!0):c(!0),console.log("   ...");const{data:p,error:w}=await I.from("orders").select(`
          id,
          order_code,
          customer_name,
          customer_phone,
          customer_address,
          total_amount,
          subtotal,
          created_at,
          rejection_reason,
          store_response_at,
          main_store_name,
          assigned_store_id,
          items,
          stores:assigned_store_id (
            id,
            name
          ),
          order_items (
            id,
            product_name,
            quantity,
            price
          )
        `).eq("store_response_status","unavailable").not("rejection_reason","is",null).order("store_response_at",{ascending:!1});if(w)throw console.error("     :",w),w;const v=p?.map(j=>({id:j.id,order_code:j.order_code||`ORD-${j.id.slice(0,8)}`,customer_name:j.customer_name||`${s("customer")} ${j.order_code||j.id.slice(0,8)}`,customer_phone:j.customer_phone||" ",customer_address:j.customer_address||" ",total_amount:j.total_amount||0,subtotal:j.subtotal||0,created_at:j.created_at,rejection_reason:j.rejection_reason||"   ",store_response_at:j.store_response_at,store_name:j.stores?.name||j.main_store_name||"  ",product_quantity:j.order_items&&Array.isArray(j.order_items)&&j.order_items.length>0?j.order_items.reduce((y,b)=>y+(b.quantity||1),0):j.items&&Array.isArray(j.items)&&j.items.length>0?j.items.reduce((y,b)=>y+(b.quantity||1),0):1,product_name:(()=>{if(j.order_items&&Array.isArray(j.order_items)&&j.order_items.length>0){const y=j.order_items.map(b=>b.product_name||b.name).filter(b=>b&&b.trim()!==""&&b!=="  ").join(", ");if(y)return y}if(j.items&&Array.isArray(j.items)&&j.items.length>0){const y=j.items.map(b=>b.name||b.product_name).filter(b=>b&&b.trim()!==""&&b!=="  ").join(", ");if(y)return y}return`  ${j.order_code||j.id.slice(0,8)}`})()}))||[];r(v),console.log("    :",{count:v.length,orders:v.slice(0,3).map(j=>({id:j.id,order_code:j.order_code,rejection_reason:j.rejection_reason,store_name:j.store_name}))})}catch(p){console.error("     :",p),d({title:"",description:"    ",variant:"destructive"})}finally{f?a(!1):c(!1)}},h=async f=>{try{console.log("   :",f);const{error:p}=await I.from("orders").update({order_status:"pending",store_response_status:null,store_response_at:null,rejection_reason:null,assigned_store_id:null,updated_at:new Date().toISOString()}).eq("id",f);if(p)throw p;d({title:"   ",description:"      "}),m(!1)}catch(p){console.error("     :",p),d({title:"",description:"    ",variant:"destructive"})}};return x.useEffect(()=>{m()},[]),n?e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Rt,{className:"w-4 h-4 animate-spin"}),"   ..."]})})})}):e.jsxs($,{className:"border-red-200",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bt,{className:"w-5 h-5 text-red-600"}),e.jsxs(V,{className:"text-red-800",children:["  (",t.length,")"]})]}),e.jsx(L,{onClick:()=>m(!1),variant:"outline",disabled:l,className:"gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"})," ..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"w-4 h-4"}),""]})})]})}),e.jsx(M,{children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Me,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"   "})]}):e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:t.map(f=>e.jsx($,{className:"border-red-100 bg-red-50/50",children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg text-red-800",children:f.product_name}),e.jsxs("p",{className:"text-sm text-red-600",children:[" #",f.order_code]})]}),e.jsx(Q,{variant:"destructive",children:""})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx("span",{style:{margin:"auto -249px 0 auto"},children:f.customer_name}),e.jsx("span",{className:"font-medium",style:{marginLeft:"auto"},children:":"})]})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:":"})," ",e.jsx("span",{style:{paddingRight:"5px"},children:f.customer_phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:":"})," ",f.customer_address||" "]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:":"})," ",Ut(f.total_amount)]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:" :"})," ",f.store_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s("quantity.label")})," ",f.product_quantity]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:" :"})," ",yd(f.store_response_at)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:" :"})," ",yd(f.created_at)]})]})]}),e.jsx("div",{className:"bg-red-100 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Bt,{className:"w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-red-800",children:" :"}),e.jsx("p",{className:"text-red-700 mt-1",children:f.rejection_reason})]})]})}),e.jsx("div",{className:"flex gap-2 justify-end",children:e.jsxs(L,{size:"sm",className:"gap-1",onClick:()=>h(f.id),children:[e.jsx(bd,{className:"w-4 h-4"})," "]})})]})})},f.id))})})]})};function y$(s){if(s instanceof Error)return{message:s.message,details:s.message,stack:s.stack};if(typeof s=="string")return{message:s,details:s};if(s&&typeof s=="object"){const t=s;if(t.message)return{message:t.message,details:t.details||t.hint||t.message,context:{code:t.code,details:t.details,hint:t.hint}};if(t.status||t.statusText)return{message:t.statusText||`HTTP Error ${t.status}`,details:` HTTP: ${t.status} - ${t.statusText}`,context:{status:t.status,statusText:t.statusText}};try{return{message:"   ",details:JSON.stringify(s,null,2)}}catch{return{message:"   ",details:"     "}}}return{message:"   ",details:"   "}}function jb(s,t,r){const n=y$(t),a={operation:s,errorType:t?.constructor?.name||typeof t,message:n.message,details:n.details,stack:n.stack,context:{...n.context,...r,timestamp:new Date().toISOString()}};return console.error(` ${s}:`,a),n}function td(s,t,r,n){const a=jb(s,t,n);return r({title:`  ${s}`,description:a.message,variant:"destructive"}),a}function j$(){const{t:s}=us(),[t,r]=x.useState(null),{toast:n}=Xe();return x.useEffect(()=>{const a=I.channel("store_responses").on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders",filter:"store_response_status=not.is.null"},l=>{const c=l.new;if(t===c.id)return;const d=new Date(c.store_response_at).getTime(),m=Date.now()-60*1e3;if(d>m){const h=c.store_response_status==="available"||c.store_response_status==="accepted";n({title:h?"    ":"    ",description:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"font-medium",children:[": ",c.order_code]}),e.jsxs("div",{children:[": ",c.assigned_store_name]}),e.jsxs("div",{className:h?"text-green-600":"text-red-600",children:[": ",s(h?"available":"unavailable")]})]}),duration:5e3}),r(c.id)}}).subscribe();return()=>{a.unsubscribe()}},[t,n]),null}const ef=({divisions:s,originalOrderId:t,className:r=""})=>{const n=()=>{if(!s||s.length===0)return{status:"empty",label:"  ",color:"gray"};const m=s.every(v=>v.order_status==="delivered"),h=s.every(v=>v.order_status==="returned"),f=s.every(v=>v.store_response_status==="available"||v.store_response_status==="accepted"),p=s.some(v=>!v.store_response_status||v.store_response_status==="pending"||v.order_status==="pending"||v.order_status==="assigned"),w=s.some(v=>v.store_response_status==="unavailable"||v.store_response_status==="rejected"||v.order_status==="rejected");return m?{status:"delivered",label:"",color:"green"}:h?{status:"returned",label:"",color:"red"}:f&&!w?{status:"complete",label:"",color:"green"}:p?{status:"incomplete",label:" ",color:"yellow"}:w?{status:"mixed",label:"",color:"orange"}:{status:"processing",label:" ",color:"blue"}},a=m=>{const{store_response_status:h,order_status:f}=m;return f==="delivered"?{status:"delivered",label:"",color:"bg-green-100 text-green-800",icon:Go,description:"  "}:f==="returned"?{status:"returned",label:"",color:"bg-red-100 text-red-800",icon:lv,description:"  "}:h==="unavailable"||h==="rejected"||f==="rejected"?{status:"rejected",label:"",color:"bg-red-100 text-red-800",icon:lt,description:m.rejection_reason||"  "}:h==="available"||h==="accepted"?{status:"accepted",label:"",color:"bg-green-100 text-green-800",icon:Se,description:"   "}:f==="assigned"?{status:"assigned",label:"",color:"bg-blue-100 text-blue-800",icon:Me,description:"    -   "}:f==="preparing"||f==="ready"?{status:"processing",label:" ",color:"bg-orange-100 text-orange-800",icon:Me,description:"  "}:{status:"pending",label:" ",color:"bg-yellow-100 text-yellow-800",icon:Rt,description:"   "}},l=n(),d=(()=>{switch(l.status){case"delivered":return Go;case"returned":return lv;case"complete":return Se;case"incomplete":return Bt;default:return Rt}})();return!s||s.length===0?e.jsx($,{className:r,children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(Me,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx(D,{children:"   "})]})})}):e.jsxs($,{className:r,children:[e.jsx(q,{className:"pb-3",children:e.jsxs(V,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),e.jsx(D,{children:"  "}),t&&e.jsxs("span",{className:"text-sm text-gray-500",children:["(",s.length," )"]})]}),e.jsxs(Q,{className:`
              ${l.color==="green"?"bg-green-100 text-green-800":""}
              ${l.color==="yellow"?"bg-yellow-100 text-yellow-800":""}
              ${l.color==="red"?"bg-red-100 text-red-800":""}
              ${l.color==="blue"?"bg-blue-100 text-blue-800":""}
              ${l.color==="gray"?"bg-gray-100 text-gray-800":""}
            `,children:[e.jsx(d,{className:"w-4 h-4 ml-1"}),e.jsx(D,{children:l.label})]})]})}),e.jsxs(M,{className:"space-y-3",children:[s.map((m,h)=>{const f=a(m),p=f.icon;return e.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:e.jsx(D,{children:m.store_name})}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",m.items_count," )"]})]}),e.jsxs(Q,{className:f.color,children:[e.jsx(p,{className:"w-3 h-3 ml-1"}),e.jsx(D,{children:f.label})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:e.jsx(D,{children:f.description})}),e.jsxs("span",{className:"font-medium text-gray-900",children:[m.total_amount.toLocaleString()," ."]})]}),m.store_response_at&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[" : ",new Date(m.store_response_at).toLocaleDateString("ar-SA")]})]},m.id)}),e.jsx("div",{className:"border-t pt-3 mt-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.filter(m=>{const h=a(m);return h.status==="accepted"||h.status==="delivered"}).length}),e.jsx("div",{className:"text-gray-600",children:e.jsx(D,{children:"/"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.filter(m=>{const h=a(m);return h.status==="pending"||h.status==="processing"}).length}),e.jsx("div",{className:"text-gray-600",children:e.jsx(D,{children:" "})})]})]})})]})]})},wb=()=>{const{toast:s}=Xe(),[t,r]=x.useState([]),[n,a]=x.useState(!0),[l,c]=x.useState(null),d=async()=>{try{a(!0);const{data:p,error:w}=await I.from("orders").select(`
          id,
          customer_name,
          customer_phone,
          order_code,
          order_status,
          assigned_store_id,
          store_response_status,
          store_response_at,
          rejection_reason,
          main_store_name,
          total_amount,
          created_at,
          order_details,
          items
        `).order("created_at",{ascending:!1});if(w)throw w;const v=new Map;p?.forEach(y=>{if(y.order_details?.includes("    ")){const C=y.order_details?.match(/     (.+)/);if(!C)return;const E=C[1].trim();v.has(E)||v.set(E,{originalOrderId:E,originalOrderCode:E,customerName:y.customer_name,totalAmount:0,createdAt:y.created_at,divisions:[],overallStatus:"incomplete",isSingleOrder:!1});const S=v.get(E);S.totalAmount+=y.total_amount||0,S.divisions.push({id:y.id,store_name:y.main_store_name||"  ",assigned_store_id:y.assigned_store_id,store_response_status:y.store_response_status,order_status:y.order_status,store_response_at:y.store_response_at,rejection_reason:y.rejection_reason,items_count:Array.isArray(y.items)?y.items.length:0,total_amount:y.total_amount||0})}else{const C=y.order_code||y.id;v.set(C,{originalOrderId:C,originalOrderCode:y.order_code||y.id.slice(0,8),customerName:y.customer_name,totalAmount:y.total_amount||0,createdAt:y.created_at,divisions:[{id:y.id,store_name:y.main_store_name||"  ",assigned_store_id:y.assigned_store_id,store_response_status:y.store_response_status,order_status:y.order_status,store_response_at:y.store_response_at,rejection_reason:y.rejection_reason,items_count:Array.isArray(y.items)?y.items.length:0,total_amount:y.total_amount||0}],overallStatus:m(y),isSingleOrder:!0})}});const j=Array.from(v.values()).map(y=>(y.isSingleOrder||(y.overallStatus=h(y.divisions)),y));r(j)}catch(p){console.error("Error fetching orders:",p),s({title:"   ",description:"   ",variant:"destructive"})}finally{a(!1)}},m=p=>p.order_status==="delivered"?"delivered":p.order_status==="returned"?"returned":p.store_response_status==="available"||p.store_response_status==="accepted"?"complete":p.store_response_status==="unavailable"||p.store_response_status==="rejected"?"mixed":"incomplete",h=p=>{if(p.length===0)return"incomplete";const w=p.every(b=>b.order_status==="delivered"),v=p.every(b=>b.order_status==="returned"),j=p.every(b=>b.store_response_status==="available"||b.store_response_status==="accepted"),y=p.some(b=>!b.store_response_status||b.store_response_status==="pending"||b.order_status==="pending"||b.order_status==="assigned");return w?"delivered":v?"returned":j&&!y?"complete":y?"incomplete":"mixed"},f=p=>{const w={complete:{label:"",color:"bg-green-100 text-green-800",icon:Se,description:"  "},incomplete:{label:" ",color:"bg-yellow-100 text-yellow-800",icon:Rt,description:"   "},delivered:{label:"",color:"bg-blue-100 text-blue-800",icon:Se,description:"  "},returned:{label:"",color:"bg-red-100 text-red-800",icon:lt,description:" "},mixed:{label:"",color:"bg-orange-100 text-orange-800",icon:Bt,description:" "},single:{label:" ",color:"bg-gray-100 text-gray-800",icon:Me,description:"   "}};return w[p]||w.incomplete};return x.useEffect(()=>{d();const p=I.channel("all-orders-updates").on("postgres_changes",{event:"*",schema:"public",table:"orders"},w=>{console.log(" Orders update:",w),d()}).subscribe();return()=>{p.unsubscribe()}},[]),n?e.jsx($,{children:e.jsxs(M,{className:"p-8 text-center",children:[e.jsx(ft,{className:"w-8 h-8 mx-auto mb-4 animate-spin text-blue-500"}),e.jsx(D,{children:"  ..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Me,{className:"w-6 h-6 text-blue-600"}),e.jsx("h2",{className:"text-xl font-bold",children:e.jsx(D,{children:"  ( )"})}),e.jsx(Q,{variant:"secondary",children:t.length})]}),e.jsxs(L,{onClick:d,disabled:n,className:"flex items-center gap-2",children:[e.jsx(ft,{className:`w-4 h-4 ${n?"animate-spin":""}`}),e.jsx(D,{children:""})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:["complete","incomplete","delivered","mixed","single"].map(p=>{const w=t.filter(y=>p==="single"?y.isSingleOrder:y.overallStatus===p).length,v=f(p),j=v.icon;return e.jsx($,{children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:e.jsx(D,{children:v.label})}),e.jsx("p",{className:"text-2xl font-bold",children:w})]}),e.jsx(j,{className:`w-8 h-8 ${p==="complete"||p==="delivered"?"text-green-500":p==="incomplete"?"text-yellow-500":p==="mixed"?"text-orange-500":p==="single"?"text-gray-500":"text-red-500"}`})]})})},p)})}),t.length===0?e.jsx($,{children:e.jsxs(M,{className:"p-8 text-center",children:[e.jsx(Me,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:e.jsx(D,{children:"  "})}),e.jsx("p",{className:"text-gray-600",children:e.jsx(D,{children:"       "})})]})}):e.jsx("div",{className:"space-y-4",children:t.map(p=>{const w=f(p.isSingleOrder?"single":p.overallStatus),v=w.icon,j=l===p.originalOrderId;return e.jsxs($,{className:`transition-all ${j?"ring-2 ring-blue-500":"hover:shadow-md"}`,children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(V,{className:"text-lg flex items-center gap-2",children:[e.jsxs(D,{children:[" #",p.originalOrderCode]}),p.isSingleOrder&&e.jsx(Q,{variant:"outline",className:"text-xs",children:e.jsx(D,{children:""})})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Hn,{className:"w-4 h-4"}),e.jsx(D,{children:p.customerName})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsx("span",{children:p.isSingleOrder?"1 ":`${p.divisions.length} `})]}),e.jsxs("div",{children:[p.totalAmount.toLocaleString()," ."]}),e.jsx("div",{children:new Date(p.createdAt).toLocaleDateString("ar-SA")})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Q,{className:w.color,children:[e.jsx(v,{className:"w-3 h-3 ml-1"}),e.jsx(D,{children:w.label})]}),e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>c(j?null:p.originalOrderId),children:[e.jsx(qn,{className:"w-4 h-4 ml-1"}),e.jsx(D,{children:j?"":""})]})]})]})}),j&&e.jsx(M,{children:p.isSingleOrder?e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsx(D,{children:"  "})]}),e.jsx("div",{className:"space-y-2",children:p.divisions.map(y=>e.jsxs("div",{className:"bg-white rounded p-3 border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:e.jsx(D,{children:y.store_name})}),e.jsx(Q,{className:f(y.order_status==="delivered"?"delivered":y.order_status==="returned"?"returned":y.store_response_status==="available"||y.store_response_status==="accepted"?"complete":y.store_response_status==="unavailable"||y.store_response_status==="rejected"?"mixed":"incomplete").color,children:y.order_status==="delivered"?"":y.order_status==="returned"?"":y.store_response_status==="available"||y.store_response_status==="accepted"?"":y.store_response_status==="unavailable"||y.store_response_status==="rejected"?" ":" "})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[y.items_count,"  - ",y.total_amount.toLocaleString()," ."]})]},y.id))})]}):e.jsx(ef,{divisions:p.divisions,originalOrderId:p.originalOrderId})})]},p.originalOrderId)})})]})},_b=(s,t="   ")=>{if(!s)return t;if(typeof s=="string")return s||t;if(s instanceof Error)return s.message||t;if(s&&typeof s=="object"){const r=s;if(r.message&&typeof r.message=="string")return r.message;if(r.details&&typeof r.details=="string")return r.details;if(r.hint&&typeof r.hint=="string")return r.hint;if(r.error&&typeof r.error=="string")return r.error;if(r.description&&typeof r.description=="string")return r.description;if(r.code&&r.message)return`[${r.code}] ${r.message}`;try{const n=JSON.stringify(s);if(n!=="{}"&&n!=="[object Object]")return n}catch{}}return t},bb=(s,t="")=>{const r=_b(s);if(s&&typeof s=="object")switch(s.code){case"23505":return"   ";case"23503":return"        ";case"42P01":return"      ";case"42501":return"     ";case"08003":return"    ";default:if(r.includes("duplicate key value violates unique constraint"))return"   ";if(r.includes("violates foreign key constraint"))return"        ";if(r.includes("permission denied"))return"     ";break}return r},Nb=s=>{const t=bb(s," ");return t.includes("stores_name_key")?"       ":t.includes("stores_password_check")?"       3 ":t.includes("name")?"    ":t.includes("password")?"    ":t},My="https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1",w$=()=>{const[s,t]=x.useState([]),[r,n]=x.useState([]),[a,l]=x.useState(""),[c,d]=x.useState(""),[m,h]=x.useState(!1),[f,p]=x.useState(!0),[w,v]=x.useState(!1),[j,y]=x.useState(null),[b,C]=x.useState(!1),[E,S]=x.useState(!1),{isAutoAssigning:O}=Kf(),[R,k]=x.useState(!1),[P,F]=x.useState(null),[ee,ne]=x.useState(null),[pe,re]=x.useState(!1),H=ur(),{toast:G}=Xe(),{t:ge,dir:ie}=us(),{isConnected:xe}=l$({onOrderUpdate:J=>{if(console.log("   :",J),J.type==="new_order")X(),G({title:"  !",description:`   ${J.customer_name||"  "}`});else if(J.type==="assignment")t(ue=>ue.map(be=>be.order_id===J.orderId?{...be,order_status:"assigned",assigned_store_id:J.storeId}:be)),G({title:"   ",description:` ${J.order_code}   `});else if(J.type==="store_response"){t(be=>be.map(Ce=>Ce.order_id===J.orderId?{...Ce,store_response_status:J.data?.store_response_status,store_response_at:J.data?.store_response_at,rejection_reason:J.data?.rejection_reason}:Ce));const ue={available:" ",unavailable:"  ",accepted:" ",rejected:" "}[J.data?.store_response_status]||J.data?.store_response_status;G({title:"   ",description:`${J.order_code}: ${ue}`})}else J.type==="status_change"&&(t(ue=>ue.map(be=>be.order_id===J.orderId?{...be,order_status:J.status}:be)),G({title:"   ",description:`${J.order_code}: ${J.status}`}))},onNotificationUpdate:J=>{console.log("  :",J),J.recipient_type==="admin"&&G({title:"  ",description:J.message})},enableLogging:!0});ye.useEffect(()=>{if(console.log("   :"),console.log("  :",s.length),s.length>0){const J=s.reduce((Ce,je)=>{const ke=je.order_status||" ";return Ce[ke]=(Ce[ke]||0)+1,Ce},{});console.log("   :",J);const ue=Zm(s);console.log("  :",ue);const be=s.filter(Ce=>Ce.order_status==="pending"||Ce.order_status===" "||Ce.order_status===null||Ce.order_status===void 0||Ce.order_status==="");console.log("   :",{count:be.length,details:be.map(Ce=>({id:Ce.order_id,status:Ce.order_status,statusType:typeof Ce.order_status,customer:Ce.customer_name}))}),console.log("   :",s[0])}else console.log("    ")},[s]),x.useEffect(()=>{console.log(" AdminDashboard useEffect started"),console.log(" Current URL:",window.location.href),console.log(" Environment check:",{supabase:!!I,localStorage:!!localStorage,navigate:!!H});const J=localStorage.getItem("adminAuth");if(console.log(" adminAuth from localStorage:",J),!J){console.log(" No adminAuth found, redirecting to login"),H("/admin-login");return}console.log(" adminAuth found, proceeding with dashboard initialization"),I.auth.getSession().then(({data:{session:je}})=>{console.log("  Current session:",je),F(je)});const{data:{subscription:ue}}=I.auth.onAuthStateChange((je,ke)=>{console.log(" Auth state changed:",je,ke),F(ke),je==="SIGNED_OUT"&&(localStorage.removeItem("adminAuth"),H("/admin-login"))});Xm.startListening(),It.startListening(),console.log(" Notification services started"),console.log(" Starting to load initial data...");const be=setTimeout(()=>{console.warn(" Loading timeout reached, forcing isLoading to false"),p(!1)},1e4);Promise.all([X().catch(je=>console.error(" fetchOrders failed:",je)),te().catch(je=>console.error(" fetchStores failed:",je)),oe().catch(je=>console.error(" fetchSettings failed:",je))]).finally(()=>{clearTimeout(be),p(!1),console.log(" All initial data loading completed")}),console.log(" Setting up enhanced Realtime with diagnostics..."),Sa.runDiagnostics().then(je=>{console.log(" Realtime Diagnostics:",je),je.realtimeConnection||G({title:"    ",description:"   .    Supabase Realtime.",variant:"destructive"})});const Ce=I.channel("admin-orders-direct").on("postgres_changes",{event:"INSERT",schema:"public",table:"orders"},je=>{console.log(" [DIRECT]  :",je);const ke=je.new;X(),G({title:"   !",description:` ${ke.customer_name||"  "}`})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders"},je=>{console.log(" [DIRECT]  :",je);const ke=je.new,Je=je.old;if(t(z=>{const me=z.map($e=>$e.order_id===ke.id?{...$e,...ke,order_id:ke.id}:$e);return console.log("    :",{orderId:ke.id,oldStatus:Je.order_status,newStatus:ke.order_status,totalOrders:me.length}),me}),ke.order_status!==Je.order_status&&G({title:"   ",description:` ${ke.order_code||ke.id.slice(0,8)}: ${ke.order_status}`}),ke.store_response_status!==Je.store_response_status){const z={available:" ",unavailable:"  ",accepted:" ",rejected:" "}[ke.store_response_status]||ke.store_response_status;G({title:"   ",description:` ${ke.order_code||ke.id.slice(0,8)}: ${z}`})}ke.assigned_store_id!==Je.assigned_store_id&&ke.assigned_store_id&&G({title:"  ",description:`   ${ke.order_code||ke.id.slice(0,8)} `})}).on("postgres_changes",{event:"DELETE",schema:"public",table:"orders"},je=>{console.log(" [DIRECT]  :",je);const ke=je.old;t(z=>{const me=z.filter($e=>$e.order_id!==ke.id);return console.log("    :",{deletedOrderId:ke.id,remainingOrders:me.length}),me});const Je=ke.order_status==="splitting"||ke.order_details?.includes("  ")||ke.order_details?.includes("")||ke.order_details?.includes("split");console.log(Je?"         ":`    ${ke.order_code||ke.id.slice(0,8)}`)}).subscribe(je=>{console.log(" Orders channel status:",je),Sa.updateConnectionStatus("admin-orders",je),je==="SUBSCRIBED"?G({title:"   ",description:"      "}):je==="CHANNEL_ERROR"&&G({title:"    ",description:"   ",variant:"destructive"})});return Sa.trackConnection("admin-orders",Ce),()=>{console.log(" Cleaning up Realtime subscriptions..."),ue.unsubscribe(),Ce&&I.removeChannel(Ce),Sa.cleanup(),o$.unsubscribeAll()}},[H]);const X=async()=>{try{v(!0),console.log(" fetchOrders started"),console.log(" Supabase client available:",!!I);const{data:J,error:ue}=await I.from("orders").select(`
          id,
          customer_name,
          customer_phone,
          customer_address,
          customer_city,
          customer_notes,
          main_store_name,
          assigned_store_id,
          status,
          order_status,
          store_response_status,
          store_response_at,
          rejection_reason,
          total_amount,
          subtotal,
          order_code,
          order_details,
          items,
          created_at,
          updated_at,
          order_items:order_items(
            id,
            product_name,
            quantity,
            price,
            discounted_price,
            availability_status,
            product_id,
            products:product_id(
              id,
              name
            )
          ),
          stores!assigned_store_id(name)
        `).order("created_at",{ascending:!1});if(console.log(" fetchOrders raw response:",{dataLength:J?.length,error:ue,firstItem:J?.[0]}),J&&J.length>0&&(console.log("   :"),J.forEach((je,ke)=>{ke<3&&console.log(` ${ke+1}:`,{id:je.id,status:je.status,order_status:je.order_status,customer_name:je.customer_name})})),ue){console.error(" Supabase query error:",ue),console.error(" Error details:",{message:ue.message,details:ue.details,hint:ue.hint,code:ue.code}),console.log(" Database error - showing empty list"),t([]);return}console.log(" Orders fetched successfully:",{count:J?.length||0,sample:J?.[0]});const be=J?.map(je=>{const ke=je.order_status||je.status||"pending";return{...je,order_id:je.id,order_status:ke,customer_name:je.customer_name||" ",total_amount:Number(je.total_amount)||0}})||[];console.log(" Data normalized:",{count:be.length,statusDistribution:be.reduce((je,ke)=>(je[ke.order_status]=(je[ke.order_status]||0)+1,je),{}),storeResponseStatuses:be.map(je=>({id:je.id,store_response_status:je.store_response_status,assigned_store_id:je.assigned_store_id})).filter(je=>je.store_response_status)});const Ce=be.length>0?Jm.processOrderData(be):[];console.log(" Orders processed:",{count:Ce.length,sampleProcessed:Ce[0]}),t(Ce)}catch(J){console.log(" Error fetching orders - showing empty list"),t([]),td(" ",J,G)}finally{v(!1)}},te=async()=>{try{console.log(" fetchStores started"),console.log(" Supabase client:",I?"available":"not available");const{data:J,error:ue}=await I.from("stores").select("*").order("name");if(console.log(" fetchStores raw response:",{data:J,error:ue}),ue)throw console.error(" Error fetching stores:",ue),console.error(" Error details:",{message:ue.message,details:ue.details,hint:ue.hint}),ue;console.log(" Stores fetched successfully:",J?.length||0,"stores"),n(J||[])}catch(J){console.error(" Error fetching stores:",J),console.log("Raw error object for stores:",JSON.stringify(J,null,2));const ue=bb(J," ");G({title:"   ",description:ue,variant:"destructive"})}finally{console.log(" fetchStores completed")}},oe=async()=>{try{console.log(" fetchSettings started");const{data:J,error:ue}=await I.from("settings").select("auto_assign_enabled").order("id",{ascending:!1}).limit(1).maybeSingle();if(ue)throw console.error(" Error fetching settings:",ue),ue;console.log(" Settings fetched:",J),J&&h(J.auto_assign_enabled)}catch(J){console.error(" Error fetching settings:",J)}},W=async()=>{try{await X()}catch(J){console.error(" Error refreshing orders data:",J)}},se=async(J,ue)=>{try{if(y(J),console.log(" Assign Order:",{orderId:J,storeId:ue}),console.log(" Sending assignment request:"),console.log("orderId:",J,typeof J),console.log("storeId:",ue,typeof ue),console.log("Request body:",JSON.stringify({orderId:J,storeId:ue})),console.log("URL:","https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/auto-assign-orders (manual mode)"),!J||!ue){console.error(" Missing values:",{orderId:J,storeId:ue}),G({title:"  ",description:"      ",variant:"destructive"});return}console.log(" Current state:",{ordersCount:s.length,storesCount:r.length,targetOrder:s.find(Je=>Je.order_id===J),targetStore:r.find(Je=>Je.id===ue)});const be=r.find(Je=>Je.id===ue);if(!be){console.error(" Store not found:",{storeId:ue,availableStores:r.map(Je=>({id:Je.id,name:Je.name}))}),G({title:"",description:`    (ID: ${ue})`,variant:"destructive"});return}const Ce=s.find(Je=>Je.order_id===J);if(!Ce){console.error(" Order not found:",{orderId:J,availableOrders:s.map(Je=>({id:Je.order_id,status:Je.order_status}))}),G({title:"",description:`    (ID: ${J.substring(0,8)}...)`,variant:"destructive"});return}console.log(" Pre-assignment validation passed:",{order:{id:Ce.order_id,status:Ce.order_status,customer:Ce.customer_name},store:{id:be.id,name:be.name}}),console.log(' Using enhanced OrderAssignmentService (fixing "[object Object]" error)...');const{OrderAssignmentService:je}=await Ii(async()=>{const{OrderAssignmentService:Je}=await import("./orderAssignmentService-C4xKxEKD.js");return{OrderAssignmentService:Je}},[]),ke=await je.assignOrderToStore({orderId:J,storeId:ue,assignedBy:"admin",mode:"manual"});if(console.log(" Assignment result:",ke),ke.success){const Je=ke.store_name||be.name;G({title:"  ",description:ke.message||`     "${Je}"`}),t(z=>z.map(me=>me.order_id===J?{...me,order_status:"assigned",assigned_store_id:ue,assigned_store_name:Je}:me)),await W(),console.log(" Order assignment completed successfully:",{orderId:J.substring(0,8)+"...",storeName:Je,newStatus:"assigned"})}else throw new Error(ke.error||"   ")}catch(be){let Ce="  ",je={};be instanceof Error?(Ce=be.message,je={name:be.name,message:be.message,stack:be.stack?.split(`
`).slice(0,3).join(`
`)}):typeof be=="string"?(Ce=be,je={message:be}):be&&typeof be=="object"?(Ce=be.message||be.error||be.toString()||"  ",je={type:typeof be,keys:Object.keys(be),stringified:JSON.stringify(be,null,2)}):(Ce=String(be),je={type:typeof be,value:be}),console.error(" Error in handleAssignOrder:",{errorMessage:Ce,errorDetails:je,orderId:J,storeId:ue,timestamp:new Date().toISOString(),edgeFunctionUrl:`${My}/auto-assign-orders`}),Ce.includes("fetch")?Ce="   -    ":Ce.includes("timeout")?Ce="   -    ":Ce.includes("Failed to fetch")&&(Ce="   -    "),G({title:"  ",description:Ce,variant:"destructive"})}finally{y(null)}},we=async J=>{if(J.preventDefault(),!(!a.trim()||!c.trim()))try{k(!0);const{error:ue}=await I.from("stores").insert([{name:a.trim(),password:c.trim()}]);if(ue)throw ue;G({title:"  ",description:`   "${a}" `}),l(""),d(""),te()}catch(ue){console.error("Error creating store:",ue),console.log("Error type:",typeof ue),console.log("Error constructor:",ue?.constructor?.name),console.log("Error keys:",ue?Object.keys(ue):"no keys"),console.log("Raw error object:",JSON.stringify(ue,null,2));const be=Nb(ue);console.log("Extracted error message:",be),console.log("Message length:",be.length);const Ce=ue?.message||ue?.details||ue?.hint||String(ue)||"     ";console.log("Fallback message:",Ce),G({title:"   ",description:be||Ce,variant:"destructive"})}finally{k(!1)}},_e=async()=>{try{S(!0),console.log(" Calling auto-assign-orders (bulk mode)");const J=await fetch(`${My}/auto-assign-orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});console.log(" Auto-assign response status:",J.status,J.statusText);const ue=await J.json();if(!J.ok){console.error(" Auto-assign Error:",ue),G({title:"   ",description:ue.error||J.statusText||"   ",variant:"destructive"});return}if(console.log(" Auto-assign completed:",ue),ue.success){const be=ue.assigned_count||0,Ce=ue.unmatched_count||0,je=ue.error_count||0;let ke=`  ${be}  `;Ce>0&&(ke+=`
${Ce}       `),je>0&&(ke+=`
${je}    `),G({title:"  ",description:ke}),console.log(" Refreshing orders after auto-assign..."),await X()}else G({title:"   ",description:ue.error||"  ",variant:"destructive"})}catch(J){console.error(" Error in handleAutoAssignOrders:",J),G({title:"   ",description:J instanceof Error?J.message:"    ",variant:"destructive"})}finally{S(!1)}},Le=J=>{ne(J),re(!0)},He=()=>{X()},de=async()=>{localStorage.removeItem("adminAuth"),await I.auth.signOut(),H("/admin-login")},Ne=J=>{if(console.log(`    : ${J}`,{totalOrders:s.length,orderStatuses:s.map(ue=>ue.order_status)}),J==="pending"){const ue=s.filter(be=>be.order_status==="pending"||be.order_status===" "||be.order_status===null||be.order_status===void 0||be.order_status==="");return console.log("   :",{count:ue.length,orders:ue.map(be=>({id:be.order_id,status:be.order_status,customer:be.customer_name}))}),ue}if(n$(J)){const ue=vi(s,J);return console.log(`  ${J}:`,ue.length),ue}return console.warn(`     : ${J}`),[]},Ve=J=>{const ue={id:J.order_id,order_code:J.order_code,customer_name:J.customer_name,customer_phone:J.customer_phone,customer_address:J.customer_address,customer_city:J.customer_city,customer_notes:J.customer_notes,order_details:J.order_details,order_status:J.order_status,assigned_store_id:J.assigned_store_id,assigned_store_name:J.assigned_store_name,main_store_name:J.main_store_name,store_response_status:J.store_response_status,store_response_at:J.store_response_at,rejection_reason:J.rejection_reason,items:J.items,order_items:J.order_items,total_amount:J.total_amount,created_at:J.created_at};return Jm.normalizeOrderAmounts(ue)},Ye=()=>Zm(s),tt=()=>Ne("pending").filter(ue=>ue.main_store_name?r.some(be=>be.name.toLowerCase().trim()===ue.main_store_name.toLowerCase().trim()):!1).length,ut=J=>{if(!J.order_id||!J.customer_name)return console.error("   :",J),e.jsxs("div",{className:"p-4 border border-red-200 rounded bg-red-50",children:[e.jsx("p",{className:"text-red-600 text-sm",children:"   "}),e.jsx("pre",{className:"text-xs text-gray-600 mt-2",children:JSON.stringify(J,null,2)})]},`error-${J.order_id||"unknown"}`);try{const ue=Ve(J),be=J.order_status==="pending";return e.jsx(X4,{children:e.jsx("div",{className:"bg-card border rounded-lg p-4 space-y-4",children:e.jsx(XD,{order:ue,onViewDetails:Ce=>Le(Ce),onAssign:async(Ce,je)=>{await se(Ce,je)},onSplitComplete:()=>{X()},showAssignButton:be,compact:!1})})},J.order_id)}catch(ue){return console.error("   :",ue,J),e.jsxs("div",{className:"p-4 border border-red-200 rounded bg-red-50",children:[e.jsxs("p",{className:"text-red-600 text-sm",children:["   : ",J.order_id]}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:ue instanceof Error?ue.message:"  "})]},`error-${J.order_id}`)}};if(f)return console.log(" Showing loading screen, isLoading =",f),e.jsxs("div",{className:"min-h-screen flex items-center justify-center flex-col gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),e.jsx("div",{className:"text-lg",children:" ..."}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"         (F12)   "})]});const gt=Ye();return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 to-secondary/5 p-6 arabic-text",dir:ie,children:[e.jsx(j$,{}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-primary",children:ge("admin.dashboard")}),e.jsx("p",{className:"text-muted-foreground",children:ge("admin.stores.management")}),!1]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 rounded-full bg-card border",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${xe?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-xs text-muted-foreground",children:e.jsx(D,{children:ge(xe?"realtime.connected":"disconnected")})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ob,{}),e.jsx(hl,{}),e.jsx(ml,{})]}),e.jsxs(L,{onClick:()=>{console.log("   ..."),X()},variant:"outline",className:"gap-2",disabled:w,children:[e.jsx(ft,{className:`w-4 h-4 ${w?"animate-spin":""}`}),ge(w?"loading":"admin.refresh")]}),e.jsxs(L,{onClick:de,variant:"outline",className:"gap-2",children:[e.jsx(w0,{className:"w-4 h-4"}),ge("admin.logout")]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8",children:[e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Me,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:gt.total}),e.jsx("p",{className:"text-muted-foreground",children:ge("admin.orders.total")})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Rt,{className:"w-8 h-8 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:gt.pending}),e.jsx("p",{className:"text-muted-foreground",children:ge("admin.orders.pending")})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Me,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:gt.assigned}),e.jsx("p",{className:"text-muted-foreground",children:ge("assigned")})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Se,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:gt.delivered}),e.jsx("p",{className:"text-muted-foreground",children:ge("delivered")})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(lt,{className:"w-8 h-8 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:gt.returned}),e.jsx("p",{className:"text-muted-foreground",children:ge("returned")})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ca,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:gt.customer_rejected}),e.jsx("p",{className:"text-muted-foreground",children:e.jsx(D,{children:" "})})]})]})})})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(x$,{})}),e.jsx(i$,{orders:s,onRefreshOrders:X,totalOrdersCount:s.length}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs($,{className:"mt-6",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(_0,{className:"w-5 h-5"}),"  "]})}),e.jsx(M,{children:e.jsxs("form",{onSubmit:we,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(et,{htmlFor:"storeName",children:" "}),e.jsx(it,{id:"storeName",value:a,onChange:J=>l(J.target.value),placeholder:"  ",className:"text-right"})]}),e.jsxs("div",{children:[e.jsxs(et,{htmlFor:"storePassword",className:"flex items-center gap-2",children:[e.jsx(j0,{className:"w-4 h-4"}),e.jsx("span",{style:{height:"22px"},children:" "})]}),e.jsx(it,{id:"storePassword",type:"password",value:c,onChange:J=>d(J.target.value),placeholder:"  ",className:"text-right"})]}),e.jsx(L,{type:"submit",className:"w-full",disabled:R||!a.trim()||!c.trim(),children:R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"  ..."]}):" "})]})})]})}),e.jsxs($,{className:"lg:col-span-2",children:[e.jsxs(q,{children:[e.jsx(V,{children:ge("admin.orders.list")}),e.jsx(Ze,{children:ge("admin.orders.all.description")})]}),e.jsx(M,{children:e.jsxs(dn,{defaultValue:"pending",className:"w-full",children:[e.jsxs($r,{className:"grid w-full grid-cols-2 lg:grid-cols-7",children:[e.jsxs(ht,{value:"pending",children:[ge("pending")," (",gt.pending,")"]}),e.jsxs(ht,{value:"assigned",children:[ge("assigned")," (",gt.assigned,")"]}),e.jsxs(ht,{value:"delivered",children:[ge("delivered")," (",gt.delivered,")"]}),e.jsxs(ht,{value:"returned",children:[ge("returned")," (",gt.returned,")"]}),e.jsxs(ht,{value:"customer_rejected",className:"text-purple-600",children:[" ",e.jsx(D,{children:" "})," (",gt.customer_rejected,")"]}),e.jsx(ht,{value:"rejected",className:"text-red-600",children:ge("rejected")}),e.jsxs(ht,{value:"order_divisions",className:"text-blue-600",children:[" ",e.jsx(D,{children:""})]})]}),e.jsxs(mt,{value:"pending",className:"space-y-4 max-h-96 overflow-y-auto",children:[Ne("pending").length>0&&e.jsxs("div",{className:"hidden",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 text-sm",children:e.jsx(D,{children:"   "})}),e.jsx("p",{className:"text-xs text-yellow-600",children:e.jsx(D,{children:"        "})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{onClick:_e,disabled:E||O||tt()===0,className:"gap-2 bg-green-600 hover:bg-green-700 text-white whitespace-nowrap",size:"sm",children:E||O?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),e.jsx(D,{children:" ..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(sE,{className:"w-4 h-4"}),e.jsxs(D,{children:["  (",tt(),")"]})]})}),tt()<Ne("pending").length&&e.jsx("div",{className:"text-xs text-orange-600 self-center",children:e.jsxs(D,{children:[Ne("pending").length-tt(),"    "]})})]})]}),w?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),"  ..."]}):e.jsxs(e.Fragment,{children:[Ne("pending").map(ut),Ne("pending").length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:ge("no.orders.pending")})]})]}),e.jsx(mt,{value:"assigned",className:"space-y-4 max-h-96 overflow-y-auto",children:w?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),ge("loading")]}):e.jsxs(e.Fragment,{children:[Ne("assigned").map(ut),Ne("assigned").length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:ge("no.orders.assigned")})]})}),e.jsx(mt,{value:"delivered",className:"space-y-4 max-h-96 overflow-y-auto",children:w?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),"  ..."]}):e.jsxs(e.Fragment,{children:[Ne("delivered").map(ut),Ne("delivered").length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:ge("no.orders.delivered")})]})}),e.jsx(mt,{value:"returned",className:"space-y-4 max-h-96 overflow-y-auto",children:w?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),ge("loading")]}):e.jsxs(e.Fragment,{children:[Ne("returned").map(ut),Ne("returned").length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:ge("no.orders.returned")})]})}),e.jsx(mt,{value:"customer_rejected",className:"space-y-4 max-h-96 overflow-y-auto",children:w?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),ge("loading")]}):e.jsxs(e.Fragment,{children:[Ne("customer_rejected").map(ut),Ne("customer_rejected").length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx(D,{children:ge("no.rejected.orders.customer")})})]})}),e.jsx(mt,{value:"rejected",className:"space-y-4",children:e.jsx(v$,{})}),e.jsx(mt,{value:"order_divisions",className:"space-y-4",children:e.jsx(wb,{})})]})})]})]})]}),e.jsx(on,{open:pe,onOpenChange:re,children:e.jsxs(kr,{className:"max-w-[95vw] sm:max-w-4xl max-h-[80vh] overflow-y-auto",dir:ie,children:[e.jsx(Or,{children:e.jsx(Rr,{children:ge("admin.order.details")})}),ee&&e.jsx(O_,{orderId:ee,stores:r,onOrderUpdated:He})]})})]})},_$=()=>{const[s,t]=x.useState(""),[r,n]=x.useState(""),[a,l]=x.useState(!1),c=ur(),{toast:d}=Xe(),m=async h=>{if(h.preventDefault(),!(!s.trim()||!r.trim())){l(!0),console.log(" Attempting store login:",{storeName:s.trim()});try{const{data:f,error:p}=await I.rpc("authenticate_store",{store_name:s.trim(),store_password:r.trim()});if(console.log(" Authentication response:",{storeId:f,error:p}),p){console.error("Store login error:",p),d({title:"   ",description:`${p.message||"      "}`,variant:"destructive"});return}if(f){const{data:w,error:v}=await I.from("stores").select("id, name").eq("id",f).single();if(v||!w){console.error("Error fetching store info:",v),d({title:"",description:"     ",variant:"destructive"});return}const j={id:w.id,name:w.name};localStorage.setItem("storeAuth",JSON.stringify(j)),console.log(" Store auth saved to localStorage:",j),d({title:"  ",description:`    ${w.name}`}),console.log(" Navigating to /store-dashboard..."),c("/store-dashboard")}else d({title:"   ",description:"      ",variant:"destructive"})}catch(f){console.error("Store login error:",f),d({title:"",description:"    ",variant:"destructive"})}finally{l(!1)}}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/10 to-secondary/10 p-4",dir:"rtl",children:[e.jsxs("div",{className:"fixed top-4 left-4 z-50 flex gap-2",children:[e.jsx(hl,{}),e.jsx(ml,{})]}),e.jsxs($,{className:"w-full max-w-md",children:[e.jsxs(q,{className:"text-center",children:[e.jsxs(V,{className:"text-2xl font-bold text-primary flex items-center justify-center gap-2",children:[e.jsx(is,{className:"w-6 h-6"})," "]}),e.jsx(Ze,{children:"     "})]}),e.jsx(M,{children:e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(et,{htmlFor:"storeName",className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4"})," "]}),e.jsx(it,{id:"storeName",type:"text",value:s,onChange:h=>t(h.target.value),placeholder:"  ",required:!0,className:"text-right"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(et,{htmlFor:"password",className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4"})," "]}),e.jsx(it,{id:"password",type:"password",value:r,onChange:h=>n(h.target.value),placeholder:"  ",required:!0,className:"text-right"})]}),e.jsx(L,{type:"submit",className:"w-full",disabled:a||!s.trim()||!r.trim(),children:a?"  ...":" "})]})})]})]})};function b$({isOpen:s,onClose:t,onConfirm:r,orderCode:n}){const[a,l]=x.useState(""),[c,d]=x.useState(!1),m=async()=>{if(a.trim()){d(!0);try{await r(a.trim()),l(""),t()}finally{d(!1)}}},h=()=>{c||(l(""),t())};return e.jsx(on,{open:s,onOpenChange:h,children:e.jsxs(kr,{className:"sm:max-w-md",children:[e.jsxs(Or,{children:[e.jsx(Rr,{children:"  "}),e.jsx(Ka,{children:n?`: ${n}`:"     "})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(et,{htmlFor:"return-reason",children:"  *"}),e.jsx(Ar,{id:"return-reason",placeholder:":        ...",value:a,onChange:f=>l(f.target.value),className:"min-h-[100px] text-right",dir:"rtl",disabled:c,maxLength:500}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[a.length,"/500 "]})]})}),e.jsxs(Di,{children:[e.jsx(L,{variant:"outline",onClick:h,disabled:c,children:""}),e.jsx(L,{onClick:m,disabled:!a.trim()||c,className:"bg-red-600 hover:bg-red-700",children:c?" ...":" "})]})]})})}async function yl(s){try{console.log("     :",s);const{data:t,error:r}=await I.from("orders").select(`
        id,
        main_store_name,
        store_response_status,
        order_status,
        rejection_reason,
        order_details
      `).like("order_details",`%     ${s}%`);if(r){const w=Mt(r,"    ");throw console.info("    (  ):",{message:w,rawError:r,code:r.code,details:r.details,hint:r.hint,originalOrderId:s}),r}if(!t||t.length===0)return console.log("      :",s),{isComplete:!1,totalDivisions:0,acceptedDivisions:0,rejectedDivisions:0,pendingDivisions:0,completionPercentage:0,status:"incomplete",statusLabel:"  "};const n=t.length,a=t.filter(w=>w.store_response_status==="available"||w.store_response_status==="accepted").length,l=t.filter(w=>w.store_response_status==="unavailable"||w.store_response_status==="rejected").length,c=t.filter(w=>!w.store_response_status||w.store_response_status==="pending").length,d=Math.round(a/n*100);let m,h,f;a===n?(m="completed",h=" -   ",f=!0):l===n?(m="incomplete",h="  -   ",f=!1):c===0?(m="partially_completed",h=`  - ${a}  ${n}  `,f=!1):(m="incomplete",h=`  - ${c}    `,f=!1);const p={isComplete:f,totalDivisions:n,acceptedDivisions:a,rejectedDivisions:l,pendingDivisions:c,completionPercentage:d,status:m,statusLabel:h};return console.log("    :",p),p}catch(t){const r=Mt(t,"    ");return console.info("    (  ):",{message:r,rawError:t,code:t?.code,details:t?.details,hint:t?.hint,originalOrderId:s}),{isComplete:!1,totalDivisions:0,acceptedDivisions:0,rejectedDivisions:0,pendingDivisions:0,completionPercentage:0,status:"incomplete",statusLabel:"   "}}}async function Sb(s){try{console.log("      :",s);const{data:t,error:r}=await I.from("orders").select(`
        id,
        main_store_name,
        store_response_status,
        order_status,
        rejection_reason,
        order_details,
        customer_name,
        total_amount,
        created_at
      `).like("order_details",`%     ${s}%`).order("created_at",{ascending:!1});if(r)throw r;const n=(t||[]).map(l=>({id:l.id,store_name:l.main_store_name||"  ",store_response_status:l.store_response_status,order_status:l.order_status,rejection_reason:l.rejection_reason})),a=await yl(s);return{divisions:n,completionStatus:a}}catch(t){const r=Mt(t,"      ");throw console.info("      (  ):",{message:r,rawError:t,code:t?.code,details:t?.details,hint:t?.hint,originalOrderId:s}),t}}async function Eb(s){try{console.log("       :",s);const t=await yl(s);let r,n="";switch(t.status){case"completed":r="assigned",n=`  -   (${t.totalDivisions}) `;break;case"partially_completed":r="assigned",n=`   - ${t.acceptedDivisions}  ${t.totalDivisions}  `;break;case"incomplete":t.rejectedDivisions===t.totalDivisions?(r="rejected",n=`  -   (${t.totalDivisions}) `):(r="pending",n=`  - ${t.pendingDivisions}    `);break;default:r="pending",n="  "}const{data:a,error:l}=await I.from("orders").select("id, order_status, order_details").eq("id",s).single();if(l&&!YD(l)){const c=Mt(l,"     ");console.info("     (  ):",{message:c,code:l.code,details:l.details,originalOrderId:s})}if(a){const{error:c}=await I.from("orders").update({order_status:r,order_details:`${a.order_details||""}

 : ${n}`,updated_at:new Date().toISOString()}).eq("id",s);if(c){const d=Mt(c,"    ");return console.info("    (  ):",{message:d,code:c.code,details:c.details,originalOrderId:s}),{success:!1,error:Mt(c)}}console.log("     :",{orderId:s,newStatus:r,notes:n})}else console.log("     (    )");return{success:!0}}catch(t){const r=Mt(t,"     ");return console.info("     (  ):",{message:r,code:t?.code,details:t?.details,originalOrderId:s}),{success:!1,error:Mt(t,"      ")}}}async function Fa({orderId:s,storeId:t,status:r,rejectionReason:n}){try{console.log("   :",{orderId:s,storeId:t,status:r,rejectionReason:n,timestamp:new Date().toISOString()});let a=r;r==="accepted"?a="available":r==="rejected"&&(a="unavailable");const l={store_response_status:a,store_response_at:new Date().toISOString(),updated_at:new Date().toISOString()};(r==="rejected"||r==="unavailable")&&n&&(l.rejection_reason=n,console.log("       :",n),l.order_status="rejected");const{data:c,error:d}=await I.from("orders").update(l).eq("id",s).eq("assigned_store_id",t).select("*");if(d)return console.error("     :",{error:d,formattedError:JSON.stringify(d,null,2),operation:"updateOrderStoreResponse",orderId:s,storeId:t,status:r,rejectionReason:n,updateData:l,stack:d?.stack}),{success:!1,error:`   : ${d.message}`};if(!c||c.length===0)return console.error("         "),{success:!1,error:"           "};console.log("     :",c[0]);const m=c[0].order_details||"";if(m.includes("    ")){const h=m.match(/     (\S+)/);if(h&&h[1]){const f=h[1];console.log("       :",f),Eb(f).catch(p=>{console.info("    (  ):",Mt(p,"  "))})}}return{success:!0,data:c[0]}}catch(a){return console.error("      :",{error:a,formattedError:JSON.stringify(a,null,2),operation:"updateOrderStoreResponse",orderId:s,storeId:t,status:r,rejectionReason:n,stack:a?.stack}),{success:!1,error:a instanceof Error?a.message:"  "}}}async function N$({orderId:s,storeId:t,status:r,returnReason:n}){try{console.log("   :",{orderId:s,storeId:t,status:r,returnReason:n,timestamp:new Date().toISOString()});const{data:a,error:l}=await I.from("orders").select("*").eq("id",s).eq("assigned_store_id",t).single();if(l||!a)return console.error("     :",l),{success:!1,error:"         "};const c={order_status:r,updated_at:new Date().toISOString()};r==="delivered"&&(c.completed_at=new Date().toISOString(),console.log('    ""'));const{data:d,error:m}=await I.from("orders").update(c).eq("id",s).select("*");if(m)return console.error("     :",m),{success:!1,error:`   : ${m.message}`};if(!d||d.length===0)return console.error("     "),{success:!1,error:"    "};console.log("     :",d[0]);try{const h=r==="delivered"?" ":" ",f=a.order_code||a.id.slice(0,8);if(await I.from("notifications").insert({recipient_type:"admin",recipient_id:null,message:`${h}  ${f}   `,order_id:s,created_at:new Date().toISOString()}),a.customer_phone){const p=r==="delivered"?`   ${f} `:`   ${f} - : ${n}`;await I.from("notifications").insert({recipient_type:"customer",recipient_id:a.customer_phone,message:p,order_id:s,created_at:new Date().toISOString()})}}catch(h){console.warn("     (   ):",h)}return{success:!0,data:d[0]}}catch(a){return console.error("      :",a),{success:!1,error:a instanceof Error?a.message:"  "}}}const S$=({isOpen:s,onClose:t,onConfirm:r,orderCode:n,productName:a,isProcessing:l=!1})=>{const[c,d]=x.useState(""),[m,h]=x.useState(""),{t:f,dir:p}=us(),w=[{key:"rejection.reason.out.of.stock",label:f("rejection.reason.out.of.stock")},{key:"rejection.reason.damaged",label:f("rejection.reason.damaged")},{key:"rejection.reason.price.incorrect",label:f("rejection.reason.price.incorrect")},{key:"rejection.reason.info.inaccurate",label:f("rejection.reason.info.inaccurate")},{key:"rejection.reason.supply.issue",label:f("rejection.reason.supply.issue")},{key:"rejection.reason.discontinued",label:f("rejection.reason.discontinued")},{key:"rejection.reason.insufficient.quantity",label:f("rejection.reason.insufficient.quantity")},{key:"rejection.reason.other",label:f("rejection.reason.other")}],v=b=>{h(b),b!==f("rejection.reason.other")?d(b):d("")},j=async()=>{const b=c.trim();if(b)try{await r(b),d(""),h("")}catch(C){console.error("Error in rejection confirmation:",C)}},y=()=>{d(""),h(""),t()};return e.jsx(on,{open:s,onOpenChange:y,children:e.jsxs(kr,{className:"max-w-md",dir:p,children:[e.jsx(Or,{children:e.jsxs(Rr,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(Bt,{className:"w-5 h-5"}),f("reject.order")]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsxs("h4",{className:"font-semibold text-red-800 mb-2",children:[f("order.details"),":"]}),e.jsxs("div",{className:"text-sm text-red-700 space-y-1",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[f("order.number"),":"]})," #",n]}),a&&e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[f("product"),":"]})," ",a]})]})]}),e.jsxs("div",{children:[e.jsxs(et,{className:"text-base font-semibold",children:[f("choose.rejection.reason"),":"]}),e.jsx("div",{className:"mt-2 space-y-2",children:w.map((b,C)=>e.jsxs("label",{className:"flex items-center space-x-2 space-x-reverse cursor-pointer p-2 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"rejection_reason",value:b.label,checked:m===b.label,onChange:E=>v(E.target.value),className:"text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:b.label})]},C))})]}),(m===f("rejection.reason.other")||m==="")&&e.jsxs("div",{children:[e.jsx(et,{htmlFor:"custom_reason",children:m===f("rejection.reason.other")?f("explain.reason")+":":f("write.custom.reason")+":"}),e.jsx(Ar,{id:"custom_reason",value:c,onChange:b=>d(b.target.value),placeholder:f("write.rejection.reason.placeholder"),className:"mt-1 min-h-[80px]",disabled:l})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Bt,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-yellow-800",children:f("rejection.warning")})]})})]}),e.jsxs(Di,{className:"flex gap-2",children:[e.jsxs(L,{variant:"outline",onClick:y,disabled:l,className:"flex items-center gap-2",children:[e.jsx(Vn,{className:"w-4 h-4"}),f("cancel")]}),e.jsxs(L,{variant:"destructive",onClick:j,disabled:!c.trim()||l,className:"flex items-center gap-2",children:[l?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(Sd,{className:"w-4 h-4"}),f(l?"rejecting":"confirm.rejection")]})]})]})})};function rl({originalOrderId:s,autoRefresh:t=!0,showDetails:r=!1,onStatusChange:n}){const[a,l]=x.useState(null),[c,d]=x.useState([]),[m,h]=x.useState(!0),[f,p]=x.useState(null),{toast:w}=Xe(),v=async()=>{try{if(h(!0),p(null),r){const E=await Sb(s);l(E.completionStatus),d(E.divisions)}else{const E=await yl(s);l(E)}}catch(E){const S=Mt(E,"    ");p(S),VD("    ",E,{originalOrderId:s,showDetails:r,autoRefresh:t})}finally{h(!1)}};x.useEffect(()=>{if(v(),t){const E=setInterval(v,3e4);return()=>clearInterval(E)}},[s,t,r]),x.useEffect(()=>{a&&n&&n(a)},[a,n]);const j=()=>{v(),w({title:" ",description:"   "})},y=E=>{switch(E){case"completed":return e.jsx(Se,{className:"h-5 w-5 text-green-600"});case"incomplete":return e.jsx(lt,{className:"h-5 w-5 text-red-600"});case"partially_completed":return e.jsx(nt,{className:"h-5 w-5 text-yellow-600"});default:return e.jsx(Rt,{className:"h-5 w-5 text-gray-600"})}},b=E=>{switch(E){case"completed":return"default";case"incomplete":return"destructive";case"partially_completed":return"secondary";default:return"outline"}},C=E=>{switch(E){case"available":case"accepted":return e.jsx(Q,{variant:"default",className:"bg-green-100 text-green-800",children:""});case"unavailable":case"rejected":return e.jsx(Q,{variant:"destructive",children:" "});case"pending":return e.jsx(Q,{variant:"outline",children:" "});default:return e.jsx(Q,{variant:"outline",children:" "})}};return m?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",dir:"rtl",children:[e.jsx(ft,{className:"h-4 w-4 animate-spin"}),"   ..."]}):f?e.jsxs("div",{className:"text-sm text-red-600",dir:"rtl",children:[": ",f]}):a?r?e.jsxs($,{className:"w-full",dir:"rtl",children:[e.jsx(q,{className:"pb-3",children:e.jsxs(V,{className:"flex items-center justify-between text-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[y(a.status),"   "]}),e.jsx(L,{variant:"ghost",size:"sm",onClick:j,className:"h-8 w-8 p-0",children:e.jsx(ft,{className:"h-4 w-4"})})]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(Q,{variant:b(a.status),className:"text-sm",children:a.statusLabel})}),e.jsxs("div",{className:"text-sm font-medium",children:[a.completionPercentage,"% "]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 text-center",children:[e.jsxs("div",{className:"p-2 bg-blue-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:a.totalDivisions}),e.jsx("div",{className:"text-xs text-blue-600",children:" "})]}),e.jsxs("div",{className:"p-2 bg-green-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:a.acceptedDivisions}),e.jsx("div",{className:"text-xs text-green-600",children:""})]}),e.jsxs("div",{className:"p-2 bg-red-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:a.rejectedDivisions}),e.jsx("div",{className:"text-xs text-red-600",children:""})]}),e.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-gray-600",children:a.pendingDivisions}),e.jsx("div",{className:"text-xs text-gray-600",children:" "})]})]}),c.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:" :"}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:c.map((E,S)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:E.store_name}),E.rejection_reason&&e.jsxs("span",{className:"text-xs text-red-600",children:["(",E.rejection_reason,")"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:C(E.store_response_status)})]},E.id))})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${a.status==="completed"?"bg-green-600":a.status==="partially_completed"?"bg-yellow-600":"bg-red-600"}`,style:{width:`${a.completionPercentage}%`}})})]})]}):e.jsxs("div",{className:"flex items-center gap-2",dir:"rtl",children:[y(a.status),e.jsx(Q,{variant:b(a.status),children:a.statusLabel}),e.jsxs("span",{className:"text-sm text-gray-600",children:["(",a.acceptedDivisions,"/",a.totalDivisions,")"]}),e.jsx(L,{variant:"ghost",size:"sm",onClick:j,className:"h-6 w-6 p-0",children:e.jsx(ft,{className:"h-3 w-3"})})]}):e.jsx("div",{className:"text-sm text-gray-600",dir:"rtl",children:"    "})}function E$({order:s,storeId:t,onAvailableResponse:r,onUnavailableResponse:n,onDeliveryConfirm:a,onReturnOrder:l,onOrderUpdated:c}){const{t:d}=us(),m=()=>(s.order_details||"").includes("    "),h=()=>{const H=(s.order_details||"").match(/     (\S+)/);return H?H[1]:null};console.log(" StoreProductAvailabilityCheck -  :",{order_id:s.id,order_code:s.order_code,order_items:s.order_items,order_items_count:s.order_items?.length||0,order_items_details:s.order_items?.map(re=>({id:re?.id,product_name:re?.product_name,name:re?.name,products:re?.products}))});const[f,p]=x.useState(!1),[w,v]=x.useState(!1),[j,y]=x.useState(!1),[b,C]=x.useState(!1),[E,S]=x.useState("initial"),[O,R]=x.useState(!1),{toast:k}=Xe();x.useEffect(()=>{s.store_response_status==="available"?(S("available"),R(!0)):s.store_response_status==="unavailable"?(S("rejected"),R(!0)):(s.store_response_status==="customer_rejected"||s.order_status==="customer_rejected")&&(S("customer_rejected"),R(!0))},[s.store_response_status,s.order_status]);const P=async()=>{p(!0);try{console.log("   :",{orderId:s.id,storeId:t});const re=await Fa({orderId:s.id,storeId:t,status:"accepted"});if(re.success)k({title:"   ",description:"    .     ."}),S("available"),v(!0),R(!0),r&&r(s.id),c&&c();else throw new Error(re.error||"   ")}catch(re){console.error("   :",re),k({title:"  ",description:re instanceof Error?re.message:"   ",variant:"destructive"})}finally{p(!1)}},F=()=>{C(!0)},ee=async re=>{p(!0);try{console.log("  :",{orderId:s.id,storeId:t,rejectionReason:re});const H=await Fa({orderId:s.id,storeId:t,status:"rejected",rejectionReason:re});if(H.success)k({title:"   ",description:"    .      .",variant:"destructive"}),S("rejected"),C(!1),R(!0),n&&n(s.id),c&&c();else throw new Error(H.error||"   ")}catch(H){console.error("  :",H),k({title:"  ",description:H instanceof Error?H.message:"   ",variant:"destructive"})}finally{p(!1)}},ne=()=>{C(!1)},pe=()=>{S("delivery"),y(!0),a&&a(s.id)};return E==="rejected"||s.store_response_status==="unavailable"?null:E==="delivery"||j?e.jsx($,{className:"border-blue-200 bg-blue-50/50",children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Go,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-blue-800",children:(()=>{const re=s.order_code||s.id.slice(0,8);return`${s.order_items?.[0]?.product_name||s.order_items?.[0]?.name||`  ${re}`} - ${d("ready.for.delivery")}`})()}),e.jsx("p",{className:"text-sm text-blue-600",children:d("store.dialog.customer.delivery")})]})]}),e.jsxs(Q,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:[" ",d("ready.for.delivery")]})]}),e.jsxs("div",{className:"bg-white border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-bold text-blue-800 mb-4 flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),d("customer.details")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[(()=>{const re=s.customer_name?.trim(),H=s.order_code||s.id.slice(0,8);return!re||re===""||re===`${d("customer")} ${H}`||re.startsWith("Customer ")||re.startsWith(" ")?null:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"font-semibold text-gray-700",children:[" ",d("name.label")]}),e.jsx("span",{className:"text-gray-900",children:e.jsx(D,{children:re})})]})})(),s.customer_phone&&s.customer_phone.trim()!==""&&s.customer_phone!==" "&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"font-semibold text-gray-700",children:[" ",d("phone.label")]}),e.jsx("span",{className:"text-gray-900 font-mono",children:s.customer_phone})]}),s.customer_address&&s.customer_address.trim()!==""&&s.customer_address!==" "&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"font-semibold text-gray-700",children:[" ",d("address.label")]}),e.jsx("span",{className:"text-gray-900",children:s.customer_address})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"font-semibold text-gray-700",children:[" ",d("order.date.label")]}),e.jsx("span",{className:"text-gray-900",children:yd(s.created_at)})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"font-semibold text-gray-700",children:[" ",d("total.amount.label")]}),e.jsx("span",{className:"text-blue-600 font-bold",children:s.subtotal?Ut(s.subtotal):s.total_amount?Ut(s.total_amount):" "})]})]})]}),s.customer_notes&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"font-semibold text-yellow-700",children:[" ",d("customer.notes"),":"]}),e.jsx("span",{className:"text-yellow-900",children:s.customer_notes})]})})]}),e.jsxs("div",{className:"bg-white border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-bold text-blue-800 mb-4 flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),d("products.required")]}),(()=>{if(s.order_items&&Array.isArray(s.order_items)&&s.order_items.length>0)return e.jsx($s,{items:s.order_items,compact:!1});const H=`  ${s.order_code||s.id.slice(0,8)}`,G={id:`default-${s.id}`,product_name:H,quantity:1,price:s.total_amount||s.subtotal||205e3,discounted_price:s.total_amount||s.subtotal||205e3};return e.jsx($s,{items:[G],compact:!1})})()]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(L,{size:"lg",className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 text-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed",onClick:async()=>{try{const re=await N$({orderId:s.id,storeId:t,status:"delivered"});re.success?(k({title:`${d("ready.for.delivery")} `,description:"    "}),a&&a(s.id),c&&c()):k({title:"",description:re.error||"    ",variant:"destructive"})}catch{k({title:"",description:"    ",variant:"destructive"})}},disabled:s.order_status==="customer_rejected"||s.store_response_status==="customer_rejected",children:[" ",d("ready.for.delivery")]})})]})})}):(console.log(" StoreProductAvailabilityCheck state:",{orderId:s.id,store_response_status:s.store_response_status,showProductDetails:w,showCustomerDetails:j,order_items:s.order_items?.length||0}),(()=>{if(console.log(" StoreProductAvailabilityCheck - extracting product names:",{order_items:s.order_items,order_items_length:s.order_items?.length||0,order_items_details:s.order_items?.map(ie=>({id:ie?.id,product_name:ie?.product_name,name:ie?.name,quantity:ie?.quantity,price:ie?.price}))}),s.order_items&&Array.isArray(s.order_items)&&s.order_items.length>0){console.log("   :");const ie=s.order_items.filter((xe,X)=>{const te=!!xe,oe=!!(xe.product_name||xe.name),W=xe.product_name?.trim()!==""||xe.name?.trim()!=="";return console.log(`   ${X+1}:`,{item:xe,hasItem:te,hasProductName:oe,hasNonEmptyName:W,product_name:xe?.product_name,name:xe?.name,isValid:te&&oe&&W}),te&&oe&&W});if(console.log("   :",ie),ie.length>0){const xe=ie.map(X=>X.product_name||X.name).join(", ");return console.log(" Found valid product names from order_items:",xe),xe}}const re=s.order_code||s.id.slice(0,8),H=["  55 ","   HP","  14","  LG 1.5 ","  18 "],ge=`${H[Math.floor(Math.random()*H.length)]} -  ${re}`;return console.log(" No valid product names found, using fallback:",ge),ge})(),E==="available"||s.store_response_status==="available"?e.jsx($,{className:"border-green-200 bg-green-50/50",children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Sd,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-lg text-green-800",children:[d("order.word")," ",s.order_code||s.id.slice(0,8)," - ",d("order.available")]}),e.jsx("p",{className:"text-sm text-green-600",children:d("product.details")})]})]}),e.jsxs(Q,{variant:"secondary",className:"bg-green-100 text-green-800",children:[" ",d("available")]})]}),e.jsxs("div",{className:"bg-white border border-green-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-bold text-green-800 mb-4 flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),d("product.details")]}),(()=>{if(s.order_items&&Array.isArray(s.order_items)&&s.order_items.length>0){console.log("  order_items:",s.order_items);const ge=s.order_items.map((ie,xe)=>{let X="  ";if(ie.product_name&&ie.product_name.trim()!==""&&ie.product_name!=="  ")X=ie.product_name;else if(ie.name&&ie.name.trim()!==""&&ie.name!=="  ")X=ie.name;else if(ie.products?.name&&ie.products.name.trim()!==""&&ie.products.name!=="  ")X=ie.products.name;else{const te=s.order_code||s.id.slice(0,8);X=` ${xe+1} -  ${te}`}return{...ie,product_name:X,price:ie.price||205e3,quantity:ie.quantity||1,id:ie.id||`item-${xe}`}});return console.log(" Enhanced items:",ge),e.jsx($s,{items:ge,compact:!1})}const re=s.order_code||s.id.slice(0,8);let H=` ${re}`;H=` ${re}`;const G={id:`default-${s.id}`,product_name:H,name:H,quantity:1,price:s.total_amount||s.subtotal||205e3,discounted_price:s.total_amount||s.subtotal||205e3};return console.log("   :",G),e.jsx($s,{items:[G],compact:!1})})(),e.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-semibold text-green-700",children:[" ",d("total.amount.label")]}),e.jsx("span",{className:"text-green-800 font-bold text-lg",children:s.subtotal?Ut(s.subtotal):s.total_amount?Ut(s.total_amount):" "})]})})]}),m()&&h()&&e.jsxs("div",{className:"bg-white border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-bold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),"   "]}),e.jsx(rl,{originalOrderId:h(),autoRefresh:!0,showDetails:!0}),e.jsx("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(nt,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-semibold mb-1",children:"   :"}),e.jsx("p",{children:'        ""'}),e.jsx("p",{children:'  ""        '}),e.jsx("p",{children:'    " "     '})]})]})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(L,{size:"lg",className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg font-bold",onClick:pe,children:[" ",d("ready.for.delivery")]})})]})})}):E==="customer_rejected"||s.store_response_status==="customer_rejected"||s.order_status==="customer_rejected"?e.jsx($,{className:"border-purple-200 bg-purple-50/50",children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"flex justify-center items-center gap-3",children:e.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-3xl",children:""})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-800",children:e.jsx(D,{children:d("order.rejected.by.customer")})}),e.jsx("p",{className:"text-purple-700",children:e.jsx(D,{children:d("cannot.deliver.rejected")})})]}),e.jsx("div",{className:"bg-purple-100 border border-purple-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[e.jsx(nt,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-purple-800",children:e.jsxs(D,{children:[" : ",s.order_code||s.id.slice(0,8)]})})]})})]})})}):E==="rejected"||O||s.store_response_status==="available"||s.store_response_status==="unavailable"||s.store_response_status==="customer_rejected"?null:e.jsxs(e.Fragment,{children:[e.jsx($,{className:"border-orange-200 bg-orange-50/50",children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h3",{className:"font-bold text-xl text-orange-800 mb-2",children:["",d("order.word")," ",s.order_code||s.id.slice(0,8)]}),e.jsx("p",{className:"text-sm text-orange-600"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[d("amount.label")," ",s.subtotal?Ut(s.subtotal):Ut(s.total_amount||0)]})]}),e.jsxs("div",{className:"bg-white border border-orange-200 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-orange-800 mb-2 text-sm",children:d("product.details.label")}),e.jsxs("div",{className:"text-sm text-gray-700 space-y-1",children:[e.jsx("div",{}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:d("quantity.label")})," ",s.order_items?.[0]?.quantity||1]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:":"})," ",s.subtotal?Ut(s.subtotal):Ut(s.total_amount||0)]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(L,{onClick:P,disabled:f,size:"lg",className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2",children:f?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4 animate-spin"}),"..."]}):` ${d("available")}`}),e.jsx(L,{onClick:F,disabled:f,size:"lg",variant:"destructive",className:"px-6 py-2",children:f?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4 animate-spin"}),"..."]}):` ${d("unavailable")}`})]}),e.jsxs("div",{className:"text-center text-xs text-orange-600 bg-orange-100 p-2 rounded-lg",children:[e.jsxs("p",{children:[e.jsx("strong",{children:" :"}),"     "]}),e.jsx("p",{children:e.jsxs("strong",{children:[" ",d("unavailable.reason")]})})]})]})})}),e.jsx(S$,{isOpen:b,onClose:ne,onConfirm:ee,orderCode:s.order_code||s.id.slice(0,8),productName:` ${s.order_code||s.id.slice(0,8)}`,isProcessing:f})]}))}function C$({order:s,productName:t,onDeliveryComplete:r,onReturnOrder:n,onClose:a,storeName:l}){const{t:c}=us(),{toast:d}=Xe();console.log(" CustomerDeliveryDetails -  :",{orderId:s.id,orderCode:s.order_code,productName:t,storeName:l,orderItemsCount:s.order_items?.length||0,itemsCount:s.items?.length||0,orderItems:s.order_items,items:s.items});const h=(()=>{if(s.order_items&&Array.isArray(s.order_items)&&s.order_items.length>0){const w=s.order_items.map(v=>v.product_name&&v.product_name.trim()!==""&&v.product_name!=="  "&&!v.product_name.match(/^ \d+$/)?v.product_name:v.name&&v.name.trim()!==""&&v.name!=="  "&&!v.name.match(/^ \d+$/)?v.name:null).filter(v=>v!==null);if(w.length>0)return w.join(", ")}if(s.items&&Array.isArray(s.items)&&s.items.length>0){const w=s.items.map(v=>v.name&&v.name.trim()!==""&&v.name!=="  "&&!v.name.match(/^ \d+$/)?v.name:v.product_name&&v.product_name.trim()!==""&&v.product_name!=="  "&&!v.product_name.match(/^ \d+$/)?v.product_name:null).filter(v=>v!==null);if(w.length>0)return w.join(", ")}return t&&t.trim()!==""&&t!=="  "&&!t.match(/^ \d+$/)&&!t.match(/^/)?t:`    ${s.order_code||s.id.slice(0,8)}`})(),f=()=>{d({title:"  ",description:"     "}),r&&r(s.id)};return e.jsx($,{className:"border-blue-200 bg-blue-50/50",children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Go,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-lg text-blue-800",children:[h," - ",c("ready.for.delivery")]}),e.jsx("p",{className:"text-sm text-blue-600",children:c("store.dialog.customer.delivery")})]})]}),e.jsxs(Q,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:[" ",c("ready.for.delivery")]})]}),e.jsxs("div",{className:"bg-white border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-bold text-blue-800 mb-4 flex items-center gap-2",children:[e.jsx(tn,{className:"w-4 h-4"}),c("customer.details")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[(()=>{const p=s.customer_name?.trim(),w=s.order_code||s.id.slice(0,8);return!p||p===""||p===`${c("customer")} ${w}`||p.startsWith("Customer ")||p.startsWith(" ")?null:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(tn,{className:"w-4 h-4 text-gray-500 mt-1"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-700",children:c("name.label")}),e.jsx("p",{className:"text-gray-900 font-medium",children:e.jsx(D,{children:p})})]})]})})(),s.customer_phone&&s.customer_phone.trim()!==""&&s.customer_phone!==" "&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Pa,{className:"w-4 h-4 text-gray-500 mt-1"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-700",children:c("phone.label")}),e.jsx("p",{className:"text-gray-900 font-mono text-lg",children:s.customer_phone})]})]}),s.customer_address&&s.customer_address.trim()!==""&&s.customer_address!==" "&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ed,{className:"w-4 h-4 text-gray-500 mt-1"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-700",children:c("address.label")}),e.jsx("p",{className:"text-gray-900",children:s.customer_address})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Nd,{className:"w-4 h-4 text-gray-500 mt-1"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-700",children:c("order.date.label")}),e.jsx("p",{className:"text-gray-900",children:yd(s.created_at)})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Bn,{className:"w-4 h-4 text-gray-500 mt-1"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-700",children:c("total.amount.label")}),e.jsx("p",{className:"text-blue-600 font-bold text-lg",children:s.subtotal?Ut(s.subtotal):s.total_amount?Ut(s.total_amount):" "})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Me,{className:"w-4 h-4 text-gray-500 mt-1"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-700",children:" :"}),e.jsxs("p",{className:"text-gray-900 font-mono",children:["#",s.order_code||s.id.slice(0,8)]})]})]})]})]}),s.customer_notes&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"font-semibold text-yellow-700",children:[" ",c("customer.notes"),":"]}),e.jsx("span",{className:"text-yellow-900",children:s.customer_notes})]})})]}),e.jsxs("div",{className:"bg-white border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-bold text-blue-800 mb-4 flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),c("products.required")]}),(()=>{if(s.order_items&&Array.isArray(s.order_items)&&s.order_items.length>0)return console.log("  order_items :",s.order_items),e.jsx($s,{items:s.order_items,compact:!1});if(s.items&&Array.isArray(s.items)&&s.items.length>0){console.log("  items :",s.items);const w=s.items.map((v,j)=>({id:v.id||`item-${j}`,product_name:v.name||v.product_name||h,name:v.name||v.product_name||h,quantity:v.quantity||1,price:v.price||0,discounted_price:v.discounted_price||0,product_id:v.product_id,main_store_name:l||""}));return e.jsx($s,{items:w,compact:!1})}console.log("   order_items  items   "),s.order_code||s.id.slice(0,8);const p={id:`default-${s.id}`,product_name:h,name:h,quantity:1,price:s.total_amount||s.subtotal||0,discounted_price:s.total_amount||s.subtotal||0,product_id:0,main_store_name:l||""};return e.jsx($s,{items:[p],compact:!1})})()]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(L,{size:"lg",className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 text-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed",onClick:f,disabled:s.order_status==="customer_rejected"||s.store_response_status==="customer_rejected",children:[" ",c("ready.for.delivery")]})}),e.jsxs("div",{className:"text-center text-xs text-blue-600 bg-blue-100 p-3 rounded-lg",children:[e.jsx("p",{className:"font-medium",children:" :"}),e.jsx("p",{children:'             " "  '})]})]})})})}function T$(s){if(!s)return null;const t=s.match(/     (\S+)/);return t?t[1]:null}function k$(s){return!!s?.includes("    ")}var O$="Separator",Fy="horizontal",R$=["horizontal","vertical"],Cb=x.forwardRef((s,t)=>{const{decorative:r,orientation:n=Fy,...a}=s,l=P$(n)?n:Fy,d=r?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return e.jsx(ze.div,{"data-orientation":l,...d,...a,ref:t})});Cb.displayName=O$;function P$(s){return R$.includes(s)}var Tb=Cb;const jl=x.forwardRef(({className:s,orientation:t="horizontal",decorative:r=!0,...n},a)=>e.jsx(Tb,{ref:a,decorative:r,orientation:t,className:Ue("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...n}));jl.displayName=Tb.displayName;const I$=({storeId:s,refreshInterval:t=30})=>{const[r,n]=x.useState([]),[a,l]=x.useState(0),[c,d]=x.useState(!1),[m,h]=x.useState(!1),f=async()=>{try{h(!0);const{data:j,error:y}=await I.from("notifications").select("*").eq("recipient_id",s).eq("recipient_type","store").order("created_at",{ascending:!1}).limit(20);if(y){console.error(" Error fetching store notifications:",{message:y.message||String(y),code:y.code,details:y.details,hint:y.hint,storeId:s});return}if(j){n(j);const b=j.filter(C=>!C.read).length;l(b)}}catch(j){console.error(" Exception fetching store notifications:",{message:j instanceof Error?j.message:String(j),storeId:s})}finally{h(!1)}},p=async j=>{try{const{error:y}=await I.from("notifications").update({read:!0}).eq("id",j);y||(n(b=>b.map(C=>C.id===j?{...C,read:!0}:C)),l(b=>Math.max(0,b-1)))}catch(y){console.error("Error marking notification as read:",y)}},w=j=>{switch(j){case"order_assigned":return"";case"order_reminder":return"";case"system":return"";default:return""}};x.useEffect(()=>{s&&f()},[s]),x.useEffect(()=>{if(!s)return;const j=I.channel(`store-notifications-bell-${s}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`recipient_id=eq.${s}`},y=>{console.log("New notification received:",y);const b=y.new;if(b&&(n(C=>C.some(S=>S.id===b.id||S.order_id===b.order_id&&S.type===b.type&&S.order_id&&Math.abs(new Date(S.created_at).getTime()-new Date(b.created_at).getTime())<6e4)?(console.log("Duplicate notification prevented:",b.id),C):[b,...C].slice(0,20)),b.read||l(C=>C+1)),"Notification"in window&&Notification.permission==="granted"&&b){const C=b.order_id?`store-${s}-order-${b.order_id}-${b.type}`:`store-${s}-${b.type}-${Date.now()}`;new Notification(b.title||" ",{body:b.message,icon:"/favicon.ico",tag:C,requireInteraction:!1,renotify:!1})}}).subscribe();return()=>{I.removeChannel(j)}},[s]);const v=async()=>{"Notification"in window&&Notification.permission==="default"&&await Notification.requestPermission()};return x.useEffect(()=>{v()},[]),e.jsxs(Zf,{open:c,onOpenChange:d,children:[e.jsx(ep,{asChild:!0,children:e.jsxs(L,{variant:"ghost",size:"sm",className:"relative",children:[a>0?e.jsx(uf,{className:"h-5 w-5 text-orange-500"}):e.jsx(dt,{className:"h-5 w-5 text-muted-foreground"}),a>0&&e.jsx(Q,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 rounded-full p-0 flex items-center justify-center text-xs",children:a>99?"99+":a})]})}),e.jsx(Xd,{className:"w-96 p-0",align:"end",children:e.jsxs($,{className:"border-0 shadow-lg",children:[e.jsx(q,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(D,{as:V,className:"text-lg",children:""}),e.jsx(D,{as:Ze,children:a>0?`${a}   `:"  "})]}),e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>d(!1),children:e.jsx(Vn,{className:"h-4 w-4"})})]})}),e.jsx(jl,{}),e.jsx(M,{className:"p-0",children:e.jsx(ei,{className:"h-96",children:m?e.jsx("div",{className:"p-4 text-center text-muted-foreground",children:e.jsx(D,{children:" ..."})}):r.length===0?e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(dt,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx(D,{children:"  "})]}):e.jsx("div",{className:"space-y-1",children:r.map(j=>e.jsx("div",{className:`p-4 hover:bg-accent/50 cursor-pointer transition-colors ${j.read?"":"bg-blue-50 border-r-4 border-blue-500"}`,onClick:()=>!j.read&&p(j.id),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-lg",children:w(j.type)}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:`text-sm font-medium ${j.read?"text-foreground":"text-blue-900"}`,children:e.jsx(D,{children:j.title||""})}),!j.read&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),e.jsx(D,{className:"text-sm text-muted-foreground leading-relaxed",children:j.message}),j.order_code&&e.jsxs("p",{className:"text-xs text-blue-600 font-medium",children:[": ",j.order_code]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:vl(new Date(j.created_at),{addSuffix:!0,locale:Zd})})]})]})},j.id))})})})]})})]})},A$=()=>{const[s,t]=x.useState([]),[r,n]=x.useState(null),[a,l]=x.useState(!0),[c,d]=x.useState(null),[m,h]=x.useState(null),[f,p]=x.useState(!1),[w,v]=x.useState(!1),[j,y]=x.useState(!1),[b,C]=x.useState(null),[E,S]=x.useState(!1),[O,R]=x.useState(null),[k,P]=x.useState(!1),[F,ee]=x.useState([]),ne=x.useRef(null),pe=x.useRef(null),re=ur(),{toast:H}=Xe(),{t:G,dir:ge}=us(),ie=z=>{const me={order_id:z.id,order_code:z.order_code,has_order_items:!!z.order_items,order_items_count:z.order_items?.length||0,has_items_json:!!z.items,items_json_count:Array.isArray(z.items)?z.items.length:0,data_source:"unknown"};return z.order_items&&Array.isArray(z.order_items)&&z.order_items.length>0?me.data_source="order_items_table":z.items&&Array.isArray(z.items)&&z.items.length>0?me.data_source="items_json":me.data_source="no_data",console.log("   :",me),me},xe=z=>{console.log("   real-time subscriptions :",z);try{const me=`store-orders-realtime-${z}-${Date.now()}`,$e=I.channel(me);console.log("  :",me),$e.on("postgres_changes",{event:"*",schema:"public",table:"orders"},Re=>{console.log("    orders:",Re);const Ge=Re.new||Re.old;Ge&&Ge.assigned_store_id===z?(console.log("    :",Ge),Re.eventType==="INSERT"?(console.log("     "),te(z,!1),H({title:" ! ",description:`     - : ${Ge.order_code||Ge.id.slice(0,8)}`})):Re.eventType==="UPDATE"?(console.log("    "),t(ae=>ae.find(at=>at.order_id===Ge.id)?(console.log("   :",Ge.id),ae.map(at=>at.order_id===Ge.id?{...at,order_status:Ge.order_status||at.order_status,store_response_status:Ge.store_response_status||at.store_response_status,customer_name:Ge.customer_name||at.customer_name,total_amount:Ge.total_amount||at.total_amount}:at)):(console.log("      "),te(z,!1),ae)),Ge.order_status&&["delivered","returned","customer_rejected"].includes(Ge.order_status)&&H({title:"  ",description:{delivered:"   ",returned:"   ",customer_rejected:"     "}[Ge.order_status]||"  "})):Re.eventType==="DELETE"&&(console.log("    "),t(ae=>ae.filter(le=>le.order_id!==Ge.id)),H({title:"  ",description:"     ",variant:"destructive"}))):console.log("     :",{orderStoreId:Ge?.assigned_store_id,currentStoreId:z})}).subscribe(Re=>{if(console.log(`  : ${Re}`,{channelName:me,storeId:z,timestamp:new Date().toISOString()}),Re==="SUBSCRIBED")P(!0),ee([]),console.log("    Real-time "),H({title:"  ",description:"   "});else if(Re==="CHANNEL_ERROR"){P(!1);const Ge=`   Real-time: ${Re}`;ee(ae=>[...ae,Ge]),console.error("   Real-time:",Re),setTimeout(()=>{console.log("     Real-time..."),xe(z)},5e3)}else Re==="CLOSED"&&(P(!1),console.log("    Real-time"))}),ne.current=$e,console.log("   Real-time subscription")}catch(me){console.error("    Real-time:",me),P(!1);const $e=`   Real-time: ${me instanceof Error?me.message:me}`;ee(Re=>[...Re,$e]),X(z)}},X=z=>{console.log("  polling   Real-time..."),pe.current&&clearInterval(pe.current),pe.current=setInterval(()=>{console.log("    (polling fallback)"),te(z,!1)},1e4),H({title:"   ",description:"    10 ",variant:"default"})};x.useEffect(()=>{console.log(" StoreDashboard: Checking authentication...");const z=localStorage.getItem("storeAuth");if(!z){console.log("No storeAuth found, redirecting to login..."),re("/store-login-space9003",{replace:!0});return}try{const me=JSON.parse(z);return console.log(" Store authenticated:",me),n(me),te(me.id).then(()=>{xe(me.id)}),()=>{console.log("  subscriptions..."),ne.current&&(I.removeChannel(ne.current),ne.current=null),pe.current&&(clearInterval(pe.current),pe.current=null),P(!1)}}catch(me){jb("   ",me,{storeAuth:z}),localStorage.removeItem("storeAuth"),re("/store-login-space9003",{replace:!0})}},[re,H]);const te=async(z,me=!0)=>{try{if(console.log("  fetchOrders:",{storeId:z,showLoading:me,storeInfo:r}),!z||z.trim()==="")throw new Error("     ");me?l(!0):v(!0),d(null),console.log("   :",z),console.log("   :",r);const{data:$e,error:Re}=await I.from("orders").select(`
          id,
          customer_name,
          customer_phone,
          customer_address,
          customer_city,
          items,
          total_amount,
          subtotal,
          customer_notes,
          order_details,
          order_code,
          order_status,
          status,
          assigned_store_id,
          store_response_status,
          store_response_at,
          created_at,
          stores!assigned_store_id(name),
          order_items(
            id,
            product_name,
            quantity,
            price,
            discounted_price,
            availability_status,
            product_id,
            main_store_name,
            products!product_id(
              id,
              name
            )
          )
        `).eq("assigned_store_id",z).in("order_status",["assigned","delivered","returned","customer_rejected"]).or("store_response_status.is.null,store_response_status.neq.unavailable,store_response_status.eq.customer_rejected").order("created_at",{ascending:!1});if(console.log("   Supabase:",{dataLength:$e?.length,error:Re,storeId:z}),Re)throw console.error("    Supabase:",Re),console.error("  :",{code:Re.code,details:Re.details,hint:Re.hint,message:Re.message}),Re;const Ge=$e?.map(ae=>(ie(ae),{order_id:ae.id,customer_name:(()=>{const le=ae.customer_name?.trim();if(le&&le!=="")return le;const at=ae.order_code||ae.id.slice(0,8);return`${G("customer")} ${at}`})(),customer_phone:ae.customer_phone||"",customer_address:ae.customer_address||"",customer_city:ae.customer_city||"",product_name:(()=>{if(console.log(" StoreDashboard - processing order product name:",{order_id:ae.id,order_code:ae.order_code,order_items:ae.order_items,items:ae.items}),ae.order_items&&Array.isArray(ae.order_items)&&ae.order_items.length>0){const xt=ae.order_items.map(We=>We.product_name&&We.product_name.trim()!==""&&We.product_name!=="  "&&!We.product_name.match(/^ \d+$/)?We.product_name:We.name&&We.name.trim()!==""&&We.name!=="  "&&!We.name.match(/^ \d+$/)?We.name:We.products?.name&&We.products.name.trim()!==""&&We.products.name!=="  "&&!We.products.name.match(/^ \d+$/)?We.products.name:null).filter(We=>We!==null);if(xt.length>0)return console.log(" Found valid product names from order_items:",xt),xt.join(", ")}if(ae.items&&Array.isArray(ae.items)&&ae.items.length>0){const xt=ae.items.map(We=>We.name&&We.name.trim()!==""&&We.name!=="  "&&!We.name.match(/^ \d+$/)?We.name:We.product_name&&We.product_name.trim()!==""&&We.product_name!=="  "&&!We.product_name.match(/^ \d+$/)?We.product_name:null).filter(We=>We!==null);if(xt.length>0)return console.log(" Found valid product names from items:",xt),xt.join(", ")}const at=` ${ae.order_code||ae.id.slice(0,8)}`;return console.log(" Using fallback name:",at),at})(),product_price:ae.order_items?.[0]?.price||ae.items?.[0]?.price||0,assigned_store_name:ae.stores?.name||" ",created_at:ae.created_at,order_code:ae.order_code||"",order_status:ae.order_status||ae.status||"pending",assigned_store_id:ae.assigned_store_id||"",total_amount:ae.total_amount||0,subtotal:ae.subtotal||0,customer_notes:ae.customer_notes||"",order_details:ae.order_details||"",store_response_status:ae.store_response_status,store_response_at:ae.store_response_at,order_items:ae.order_items||[],items:ae.order_items&&Array.isArray(ae.order_items)&&ae.order_items.length>0?ae.order_items.map(le=>{let at="  ";if(le.product_name&&le.product_name.trim()!==""&&le.product_name!=="  "&&!le.product_name.match(/^ \d+$/))at=le.product_name;else if(le.name&&le.name.trim()!==""&&le.name!=="  "&&!le.name.match(/^ \d+$/))at=le.name;else if(le.products?.name&&le.products.name.trim()!==""&&le.products.name!=="  "&&!le.products.name.match(/^ \d+$/))at=le.products.name;else{const xt=["  55  QLED","   HP","  14","  LG 1.5 ","  18 "],We=(le.id?parseInt(le.id.toString().slice(-1)):0)%xt.length;at=xt[We]}return{id:le.id,name:at,product_name:at,price:le.price||0,quantity:le.quantity||1,discounted_price:le.discounted_price||0,product_id:le.product_id||0,products:le.products||null,main_store_name:le.main_store_name||r?.name||""}}):ae.items&&Array.isArray(ae.items)&&ae.items.length>0?ae.items.map((le,at)=>{let xt="  ";if(le.name&&le.name.trim()!==""&&le.name!=="  "&&!le.name.match(/^ \d+$/))xt=le.name;else if(le.product_name&&le.product_name.trim()!==""&&le.product_name!=="  "&&!le.product_name.match(/^ \d+$/))xt=le.product_name;else{const We=["  55  QLED","   HP","  14","  LG 1.5 ","  18 "];xt=We[at%We.length]}return{id:`json-item-${at}`,name:xt,product_name:xt,price:le.price||0,quantity:le.quantity||1,product_id:le.product_id||0}}):[]}))||[];console.log("    :",{storeId:z,totalOrders:Ge.length,ordersByStatus:{assigned:Ge.filter(ae=>ae.order_status==="assigned").length,delivered:Ge.filter(ae=>ae.order_status==="delivered").length,returned:Ge.filter(ae=>ae.order_status==="returned").length}}),t(Ge)}catch($e){console.error("     - :",typeof $e),console.error("     - :",$e);let Re="    ";if($e instanceof Error)Re=$e.message;else if($e&&typeof $e=="object"){const Ge=$e;if(Ge.message)Re=Ge.message;else if(Ge.details)Re=Ge.details;else if(Ge.hint)Re=Ge.hint;else try{Re=JSON.stringify($e)}catch{Re="     "}}else typeof $e=="string"&&(Re=$e);console.error("   :",Re),d(Re),t([]),H({title:"   ",description:Re,variant:"destructive"})}finally{me?l(!1):v(!1)}},oe=async(z,me)=>{const $e=s.find(Re=>Re.order_id===z);if(!$e){H({title:"",description:"    ",variant:"destructive"});return}if($e.order_status==="delivered"){H({title:" ",description:"      ",variant:"destructive"});return}if($e.order_status==="returned"){H({title:" ",description:"     ",variant:"destructive"});return}if(me==="returned"){if($e.store_response_status!=="available"){H({title:" ",description:"      ",variant:"destructive"});return}C({id:z,code:$e.order_code||z}),y(!0);return}if(me==="delivered"&&$e.store_response_status!=="available"){H({title:" ",description:"      ",variant:"destructive"});return}await W(z,me)},W=async(z,me,$e)=>{try{console.log("    :",{orderId:z,newStatus:me,returnReason:$e});const Re={order_status:me,status:me,updated_at:new Date().toISOString()};$e&&me==="returned"&&(Re.order_details=`Return reason: ${$e}`);const{data:Ge,error:ae}=await I.from("orders").update(Re).eq("id",z).select();if(ae)throw ae;H({title:" ",description:{delivered:"   ",returned:"   ",assigned:"   "}[me]||"    "}),te(r.id,!1)}catch(Re){console.error("      - :",typeof Re),console.error("      - :",Re);let Ge="     ";if(Re instanceof Error)Ge=Re.message;else if(Re&&typeof Re=="object"){const ae=Re;if(ae.message)Ge=ae.message;else if(ae.details)Ge=ae.details;else try{Ge=JSON.stringify(Re)}catch{Ge="      "}}else typeof Re=="string"&&(Ge=Re);H({title:"    ",description:Ge,variant:"destructive"})}},se=async z=>{if(b)try{await W(b.id,"returned",z),C(null),y(!1)}catch(me){console.error("     - :",typeof me),console.error("     - :",me);let $e="    ";if(me instanceof Error)$e=me.message;else if(me&&typeof me=="object"){const Re=me;if(Re.message)$e=Re.message;else if(Re.details)$e=Re.details;else try{$e=JSON.stringify(me)}catch{$e="     "}}else typeof me=="string"&&($e=me);H({title:"   ",description:$e,variant:"destructive"})}},we=()=>{C(null),y(!1)},_e=()=>{localStorage.removeItem("storeAuth"),re("/store-login-space9003")},Le=z=>{h(z),p(!0)},He=()=>{p(!1),h(null)},de=()=>{r?.id&&te(r.id,!1)},Ne=()=>{r?.id&&te(r.id,!1)},Ve=async z=>{try{r?.id&&await te(r.id,!1)}catch(me){console.error("   callback  :",me)}},Ye=async z=>{try{r?.id&&await te(r.id,!1),p(!1)}catch(me){console.error("   callback  :",me)}},tt=async z=>{try{R(z),S(!0),p(!1),H({title:G("ready.for.delivery"),description:"    .    ."})}catch(me){console.error("    :",me),td(" ",me,H,{orderId:z})}},ut=async z=>{try{S(!1),R(null),r?.id&&te(r.id,!1),H({title:"   ",description:"     "})}catch(me){console.error("    :",me),td(" ",me,H,{orderId:z})}},gt=async(z,me)=>{try{S(!1),R(null),p(!1),r?.id&&await te(r.id,!1),H({title:"   ",description:`    - : ${me}`,variant:"destructive"})}catch($e){console.error("    :",$e),td(" ",$e,H,{orderId:z,returnReason:me})}},J=z=>k$(z.order_details),ue=z=>T$(z.order_details),be=z=>({pending:{label:"",variant:"secondary",icon:Rt},assigned:{label:G("assigned"),variant:"default",icon:Me},delivered:{label:G("delivered"),variant:"default",icon:Se},completed:{label:G("delivered"),variant:"default",icon:Se},returned:{label:G("returned"),variant:"destructive",icon:lt},customer_rejected:{label:G("customer.rejected"),variant:"destructive",icon:Ca}})[z]||{label:z,variant:"secondary",icon:Me},Ce=()=>({total:s.length,assigned:s.filter(me=>me.order_status==="assigned").length,delivered:s.filter(me=>me.order_status==="delivered").length,returned:s.filter(me=>me.order_status==="returned").length,customer_rejected:s.filter(me=>me.order_status==="customer_rejected").length}),je=z=>s.filter(me=>me.order_status===z),ke=z=>{const me=be(z.order_status||"assigned"),$e=me.icon,Re=z.order_status==="delivered"||z.order_status==="returned",Ge=()=>{if(z.order_status==="returned"&&z.order_details){const ae=z.order_details.match(/Return reason: (.+)/);return ae?ae[1]:null}return null};return e.jsx("div",{className:"p-4 border rounded-lg bg-card hover:bg-accent/50 transition-colors",children:e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($e,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"font-bold text-lg text-blue-800",children:(()=>{const ae=z.customer_name?.trim();if(ae&&ae!=="")return ae;const le=z.order_code||z.order_id.slice(0,8);return`${G("customer")} ${le}`})()}),e.jsxs("p",{className:"text-sm text-gray-600",children:[G("order.word")," #",z.order_code||z.order_id.slice(0,8)]})]}),e.jsx(Q,{variant:me.variant,children:me.label})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(L,{size:"sm",variant:"outline",onClick:()=>Le(z.order_id),className:"flex items-center gap-1",children:[e.jsx(qn,{className:"w-4 h-4"}),G("details")]}),e.jsxs(ln,{value:z.order_status||"assigned",onValueChange:ae=>oe(z.order_id,ae),disabled:z.order_status==="delivered"||z.order_status==="returned"||z.order_status==="customer_rejected",children:[e.jsx(Pr,{className:`w-40 ${z.order_status==="delivered"||z.order_status==="returned"||z.order_status==="customer_rejected"?"opacity-60 cursor-not-allowed":""}`,children:e.jsx(cn,{})}),e.jsxs(Ir,{children:[e.jsx(Nt,{value:"assigned",children:G("assigned")}),e.jsx(Nt,{value:"delivered",disabled:z.store_response_status!=="available",children:G("delivered")}),e.jsx(Nt,{value:"returned",disabled:z.store_response_status!=="available",children:G("returned")})]})]})]})]}),Re&&e.jsxs("div",{className:`bg-gradient-to-r ${z.order_status==="delivered"?"from-green-50 to-emerald-50 border-green-200":"from-red-50 to-rose-50 border-red-200"} border rounded-lg p-4`,children:[e.jsxs("h4",{className:`font-bold mb-3 flex items-center gap-2 ${z.order_status==="delivered"?"text-green-800":"text-red-800"}`,children:[e.jsx(tn,{className:"w-4 h-4"}),G("customer.details.title")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[(()=>{const ae=z.customer_name?.trim(),le=z.order_code||z.order_id.slice(0,8);return!ae||ae===""||ae===`${G("customer")} ${le}`||ae.startsWith("Customer ")||ae.startsWith(" ")?null:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tn,{className:"w-4 h-4 text-gray-500"}),e.jsxs("div",{children:[e.jsxs("span",{className:"font-semibold text-gray-700",children:[G("name.label")," "]}),e.jsx(D,{className:"text-gray-900",children:ae})]})]})})(),z.customer_phone&&z.customer_phone.trim()!==""&&z.customer_phone!==" "&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"w-4 h-4 text-gray-500"}),e.jsxs("div",{children:[e.jsxs("span",{className:"font-semibold text-gray-700",children:[G("phone.label")," "]}),e.jsx("span",{className:"text-gray-900 font-mono",children:z.customer_phone})]})]}),(z.customer_address&&z.customer_address.trim()!==""&&z.customer_address!==" "||z.customer_city&&z.customer_city.trim()!=="")&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ed,{className:"w-4 h-4 text-gray-500"}),e.jsxs("div",{children:[e.jsxs("span",{className:"font-semibold text-gray-700",children:[G("address.label")," "]}),e.jsx("span",{className:"text-gray-900",children:[z.customer_address,z.customer_city].filter(ae=>ae&&ae.trim()!==""&&ae!==" ").join(", ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bn,{className:"w-4 h-4 text-gray-500"}),e.jsxs("div",{children:[e.jsxs("span",{className:"font-semibold text-gray-700",children:[G("amount.label")," "]}),e.jsx("span",{className:`font-bold ${z.order_status==="delivered"?"text-green-600":"text-red-600"}`,children:z.subtotal?Ut(z.subtotal):z.total_amount?Ut(z.total_amount):" "})]})]})]}),z.order_status==="returned"&&Ge()&&e.jsx("div",{className:"mt-3 p-3 bg-red-100 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"font-semibold text-red-700",children:[" ",G("return.reason.label")]}),e.jsx("span",{className:"text-red-900",children:Ge()})]})}),z.customer_notes&&z.customer_notes.trim()!==""&&e.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"font-semibold text-yellow-700",children:[" ",G("customer.notes.label")]}),e.jsx("span",{className:"text-yellow-900",children:z.customer_notes})]})})]}),e.jsx("div",{className:"space-y-3",children:(()=>{let ae=[];if(z.order_items&&Array.isArray(z.order_items)&&z.order_items.length>0)ae=z.order_items.map((le,at)=>{let xt="  ";if(le.product_name&&le.product_name.trim()!==""&&le.product_name!=="  "&&!le.product_name.match(/^ \d+$/))xt=le.product_name;else if(le.name&&le.name.trim()!==""&&le.name!=="  "&&!le.name.match(/^ \d+$/))xt=le.name;else if(le.products?.name&&le.products.name.trim()!==""&&le.products.name!=="  "&&!le.products.name.match(/^ \d+$/))xt=le.products.name;else{const We=["  55  QLED","   HP","  14","  LG 1.5 ","  18 "],Mr=(le.id?parseInt(le.id.toString().slice(-1)):at)%We.length;xt=We[Mr]}return{id:le.id||`order-item-${at}`,product_name:xt,name:xt,quantity:le.quantity||1,price:le.price||0,discounted_price:le.discounted_price||0,product_id:le.product_id}});else if(z.items&&Array.isArray(z.items)&&z.items.length>0)ae=z.items.map((le,at)=>{let xt="  ";if(le.name&&le.name.trim()!==""&&le.name!=="  "&&!le.name.match(/^ \d+$/))xt=le.name;else if(le.product_name&&le.product_name.trim()!==""&&le.product_name!=="  "&&!le.product_name.match(/^ \d+$/))xt=le.product_name;else{const We=["  55  QLED","   HP","  14","  LG 1.5 ","  18 "];xt=We[at%We.length]}return{id:le.product_id||`item-${at}`,product_name:xt,name:xt,quantity:le.quantity||1,price:le.price||0,discounted_price:0,product_id:le.product_id}});else{const le=z.product_name&&z.product_name.trim()!==""&&!z.product_name.match(/^ \d+$/)&&!z.product_name.match(/^/)?z.product_name:"  55  QLED";ae=[{id:`default-${z.order_id}`,product_name:le,name:le,quantity:1,price:z.total_amount||0,discounted_price:0}]}return ae&&ae.length>0&&e.jsx($s,{items:ae,compact:!0,hidePrices:!1,assignedStoreName:z.assigned_store_name||r?.name})})()}),J(z)&&ue(z)&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("h4",{className:"text-sm font-semibold mb-2 text-blue-800 flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),"   "]}),e.jsx(rl,{originalOrderId:ue(z),autoRefresh:!0,showDetails:!1})]})]})},z.order_id)};if(a)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-3 text-lg",children:[e.jsx(Jr,{className:"w-6 h-6 animate-spin"})," ..."]})});if(c)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg text-destructive mb-4",children:c}),e.jsx(L,{onClick:()=>te(r?.id||""),children:"  "})]})});const Je=Ce();return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 to-secondary/5 p-6",dir:ge,children:[e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-primary",children:[G("store.name"),": ",r?.name]}),e.jsxs("p",{className:"text-muted-foreground flex items-center gap-2",children:[G("store.dashboard"),k?e.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(sn,{className:"w-4 h-4"}),e.jsx(D,{children:G("realtime.connected")})]}):e.jsxs("span",{className:"flex items-center gap-1 text-orange-600",children:[e.jsx(ll,{className:"w-4 h-4"}),e.jsx(D,{children:G("periodic.update")})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(hl,{}),e.jsx(ml,{})]}),r?.id&&e.jsx(I$,{storeId:r.id,refreshInterval:30}),e.jsx(L,{onClick:Ne,variant:"outline",disabled:w,className:"gap-2",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),G("loading")]}):e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"w-4 h-4"}),G("store.refresh")]})}),e.jsxs(L,{onClick:_e,variant:"outline",className:"gap-2",children:[e.jsx(w0,{className:"w-4 h-4"}),G("store.logout")]})]})]}),F.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:" Real-time:"}),e.jsx("ul",{className:"text-sm text-yellow-700",children:F.map((z,me)=>e.jsxs("li",{children:[" ",z]},me))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8",children:[e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Me,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Je.total}),e.jsx("p",{className:"text-muted-foreground",children:G("store.orders.total")})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Rt,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Je.assigned}),e.jsx("p",{className:"text-muted-foreground",children:G("store.orders.assigned")})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Se,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Je.delivered}),e.jsx("p",{className:"text-muted-foreground",children:G("store.orders.delivered")})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(lt,{className:"w-8 h-8 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Je.returned}),e.jsx("p",{className:"text-muted-foreground",children:G("store.orders.returned")})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ca,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Je.customer_rejected}),e.jsx("p",{className:"text-muted-foreground",children:e.jsx(D,{children:G("customer.rejected")})})]})]})})})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:G("store.orders")}),e.jsxs(Ze,{children:[G("store.orders.description"),""]})]}),e.jsx(M,{children:e.jsxs(dn,{defaultValue:"assigned",className:"w-full",children:[e.jsxs($r,{className:"grid w-full grid-cols-4",children:[e.jsxs(ht,{value:"assigned",children:[" ",G("store.tab.assigned")," (",Je.assigned,")"]}),e.jsxs(ht,{value:"delivered",children:[" ",G("delivered")," (",Je.delivered,")"]}),e.jsxs(ht,{value:"returned",children:[" ",G("returned")," (",Je.returned,")"]}),e.jsxs(ht,{value:"customer_rejected",children:[" ",e.jsx(D,{children:G("customer.rejected")})," (",Je.customer_rejected,")"]})]}),e.jsxs(mt,{value:"assigned",className:"space-y-4 max-h-96 overflow-y-auto",children:[je("assigned").map(z=>ke(z)),je("assigned").length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:G("no.orders.assigned")})]}),e.jsxs(mt,{value:"delivered",className:"space-y-4 max-h-96 overflow-y-auto",children:[je("delivered").map(z=>ke(z)),je("delivered").length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:G("no.orders.delivered")})]}),e.jsxs(mt,{value:"returned",className:"space-y-4 max-h-96 overflow-y-auto",children:[je("returned").map(z=>ke(z)),je("returned").length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:G("no.orders.returned")})]}),e.jsxs(mt,{value:"customer_rejected",className:"space-y-4 max-h-96 overflow-y-auto",children:[je("customer_rejected").map(z=>ke(z)),je("customer_rejected").length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx(D,{children:G("no.rejected.orders.customer")})})]})]})})]})]}),e.jsx(on,{open:f,onOpenChange:p,children:e.jsxs(kr,{className:"max-w-[95vw] sm:max-w-4xl max-h-[80vh] overflow-y-auto",dir:ge,children:[e.jsx(Or,{children:e.jsx(Rr,{children:(()=>{if(!m)return G("store.order.details");const z=s.find(me=>me.order_id===m);if(z?.order_status==="assigned")if(z?.store_response_status){if(z?.store_response_status==="available")return G("store.dialog.available.customer")}else return G("store.dialog.inventory.status");return G("store.order.details")})()})}),m&&(()=>{const z=s.find(me=>me.order_id===m);return z?.order_status==="assigned"?e.jsx(E$,{storeId:r?.id||"",order:{id:z.order_id,order_code:z.order_code,customer_name:z.customer_name,customer_phone:z.customer_phone,customer_address:z.customer_address,customer_notes:z.customer_notes,total_amount:z.total_amount,subtotal:z.subtotal,created_at:z.created_at,order_status:z.order_status,store_response_status:z.store_response_status,order_items:z.order_items||[],items:z.items||[]},onAvailableResponse:Ve,onUnavailableResponse:Ye,onDeliveryConfirm:tt}):e.jsx(O_,{orderId:z?.order_id||"",onClose:He,onOrderUpdated:de})})()]})}),e.jsx(b$,{isOpen:j,onClose:we,onConfirm:se,orderCode:b?.code||""}),e.jsx(on,{open:E,onOpenChange:S,children:e.jsxs(kr,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",dir:ge,children:[e.jsx(Or,{children:e.jsx(Rr,{children:G("customer.details.delivery")})}),O&&(()=>{const z=s.find(me=>me.order_id===O);return z&&e.jsx(C$,{order:{id:z.order_id,order_code:z.order_code,customer_name:z.customer_name,customer_phone:z.customer_phone,customer_address:z.customer_address,customer_city:z.customer_city,customer_notes:z.customer_notes,total_amount:z.total_amount,subtotal:z.subtotal,created_at:z.created_at,order_status:z.order_status,store_response_status:z.store_response_status,order_items:z.order_items||[],items:z.items||[]},storeName:r?.name,onDeliveryComplete:ut,onReturnOrder:gt,onClose:()=>S(!1)})})()]})})]})},D$=()=>{const[s,t]=x.useState([]),[r,n]=x.useState([]),[a,l]=x.useState([]),[c,d]=x.useState(!1),{toast:m}=Xe(),h=async()=>{try{console.log(" Testing RPC: get_orders_with_products");const{data:j,error:y}=await I.rpc("get_orders_with_products");if(y)throw console.error(" RPC Error:",y),y;return console.log(" RPC Success:",{count:j?.length||0,sample:j?.[0]}),t(j||[]),j}catch(j){return console.error(" RPC Failed:",j),m({title:"  RPC",description:j.message||"   ",variant:"destructive"}),null}},f=async()=>{try{console.log(" Testing Direct SQL with JOIN");const{data:j,error:y}=await I.from("orders").select(`
          id,
          customer_name,
          customer_phone,
          assigned_store_id,
          order_status,
          status,
          created_at,
          store:stores(
            id,
            name
          )
        `).order("created_at",{ascending:!1});if(y)throw console.error(" SQL Error:",y),y;return console.log(" SQL Success:",{count:j?.length||0,sample:j?.[0]}),n(j||[]),j}catch(j){return console.error(" SQL Failed:",j),m({title:"  SQL",description:j.message||"    ",variant:"destructive"}),null}},p=async()=>{try{console.log(" Testing Stores fetch");const{data:j,error:y}=await I.from("stores").select("*").order("name");if(y)throw console.error(" Stores Error:",y),y;return console.log(" Stores Success:",{count:j?.length||0,stores:j}),l(j||[]),j}catch(j){return console.error(" Stores Failed:",j),m({title:"  ",description:j.message||"   ",variant:"destructive"}),null}},w=async()=>{if(s.length===0){m({title:"  ",description:"  ",variant:"destructive"});return}const j=s[0],y=a[0];if(!y){m({title:"  ",description:"  ",variant:"destructive"});return}try{console.log(" Testing Order Update:",{orderId:j.order_id,storeId:y.id});const{data:b,error:C}=await I.from("orders").update({assigned_store_id:y.id,order_status:"assigned",status:"assigned",updated_at:new Date().toISOString()}).eq("id",j.order_id).select();if(C)throw console.error(" Update Error:",C),C;console.log(" Update Success:",b),m({title:" ",description:`   ${j.order_id.slice(0,8)}  ${y.name}`}),setTimeout(async()=>{await h(),await f()},1e3)}catch(b){console.error(" Update Failed:",b),m({title:"  ",description:b.message||"   ",variant:"destructive"})}},v=async()=>{d(!0);try{await p(),await h(),await f()}finally{d(!1)}};return x.useEffect(()=>{v()},[]),e.jsxs("div",{className:"p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx(L,{onClick:h,disabled:c,children:" RPC Function"}),e.jsx(L,{onClick:f,disabled:c,children:" SQL Direct"}),e.jsx(L,{onClick:p,disabled:c,children:" "}),e.jsx(L,{onClick:w,disabled:c,variant:"destructive",children:"  "}),e.jsx(L,{onClick:v,disabled:c,variant:"outline",children:"  "})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{children:[" RPC Function (",s.length,")"]})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:s.slice(0,3).map((j,y)=>e.jsxs("div",{className:"p-2 bg-gray-50 rounded text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",j.order_id?.slice(0,8)]}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",j.customer_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",j.assigned_store_id||" "]}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",j.store_name||" "]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",j.order_status||" "]})]},y))})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{children:[" SQL Direct (",r.length,")"]})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:r.slice(0,3).map((j,y)=>e.jsxs("div",{className:"p-2 bg-gray-50 rounded text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",j.id?.slice(0,8)]}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",j.customer_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",j.assigned_store_id||" "]}),e.jsxs("p",{children:[e.jsx("strong",{children:" JOIN:"})," ",j.store?.name||" "]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",j.order_status||" "]})]},y))})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{children:["  (",a.length,")"]})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:a.map((j,y)=>e.jsxs("div",{className:"p-2 bg-blue-50 rounded text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",j.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",j.name]})]},y))})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:["   (RPC): ",s.length]}),e.jsxs("p",{children:["   (SQL): ",r.length]}),e.jsxs("p",{children:["  : ",a.length]}),e.jsxs("p",{children:["  :"," ",s.filter(j=>j.assigned_store_id).length]}),e.jsxs("p",{children:["   :"," ",s.filter(j=>!j.assigned_store_id).length]})]})})]})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:" Console"})}),e.jsx(M,{children:e.jsx("p",{className:"text-sm text-gray-600",children:"   (F12)    Console      ."})})]})]})},$$=()=>e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"  "}),e.jsx("p",{className:"text-gray-600",children:"       "})]}),e.jsx(D$,{})]})}),L$=()=>{const[s,t]=x.useState([]),[r,n]=x.useState(!1),a=(d,m,h,f)=>{t(p=>[...p,{name:d,status:m,message:h,data:f,timestamp:new Date().toISOString()}])},l=async()=>{n(!0),t([]);try{a(" Supabase","success",` : ${I.supabaseUrl}`);try{const{data:d}=await I.auth.getSession();a(" ",d.session?"success":"warning",d.session?"  ":"   ",d.session)}catch(d){a(" ","error",`: ${Mt(d,"  ")}`)}try{const{data:d,error:m}=await I.from("stores").select("*").limit(5);if(m)throw m;a(" ","success",`   ${d?.length||0} `,d)}catch(d){a(" ","error",`: ${Mt(d,"   ")}`)}try{const{data:d,error:m}=await I.rpc("get_orders_with_products");if(m)throw m;a(" get_orders_with_products","success",`   ${d?.length||0} `,d?.slice(0,2))}catch(d){a(" get_orders_with_products","error",`: ${Mt(d,"   ")}`)}try{const{data:d,error:m}=await I.from("settings").select("*").limit(1);if(m)throw m;a(" ","success",`   ${d?.length||0} `,d)}catch(d){a(" ","error",`: ${Mt(d,"   ")}`)}try{const{data:d,error:m}=await I.functions.invoke("admin-login-v2",{body:{email:"test@test.com",password:"wrong"}});a(" admin-login-v2","success","  (  )",d)}catch(d){a(" admin-login-v2","error",`: ${Mt(d,"    ")}`)}}catch(d){a(" ","error",`  : ${Mt(d,"  ")}`)}finally{n(!1)}},c=d=>{switch(d){case"success":return e.jsx(Se,{className:"w-5 h-5 text-green-600"});case"error":return e.jsx(lt,{className:"w-5 h-5 text-red-600"});case"warning":return e.jsx(nt,{className:"w-5 h-5 text-yellow-600"});default:return e.jsx(Hs,{className:"w-5 h-5 text-gray-600"})}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",dir:"rtl",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs($,{className:"mb-6",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"w-6 h-6"}),"  "]})}),e.jsx(M,{children:e.jsx(L,{onClick:l,disabled:r,className:"w-full",children:r?" ...":" "})})]}),s.length>0&&e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-4",children:s.map((d,m)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c(d.status),e.jsx("span",{className:"font-semibold",children:d.name}),e.jsx("span",{className:"text-sm text-gray-500",children:d.timestamp})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:d.message}),d.data&&e.jsxs("details",{className:"text-xs",children:[e.jsx("summary",{className:"cursor-pointer text-blue-600",children:" "}),e.jsx("pre",{className:"mt-2 bg-gray-100 p-2 rounded overflow-auto",children:JSON.stringify(d.data,null,2)})]})]},m))})})]})]})})},M$=()=>{const[s,t]=x.useState([]),[r,n]=x.useState(!1),[a,l]=x.useState(null),c=async()=>{n(!0),l(null);try{console.log(" Testing direct orders table access...");const{data:m,error:h}=await I.from("orders").select("*").limit(3);console.log(" Direct orders data:",m),console.log(" Direct orders error:",h);const{data:f,error:p}=await I.rpc("get_orders_with_products");console.log(" RPC orders data:",f),console.log(" RPC orders error:",p),p?l(`RPC Error: ${p.message}`):h?l(`Direct Access Error: ${h.message}`):t(f||m||[])}catch(m){console.error(" Catch error:",m),l(m instanceof Error?m.message:"Unknown error")}finally{n(!1)}},d=async()=>{try{console.log(" Checking table structure...");const{data:m,error:h}=await I.from("orders").select("*").limit(1);console.log(" Table structure test:",{data:m,error:h}),m&&m.length>0&&(console.log(" Available columns:",Object.keys(m[0])),console.log(" Sample data:",m[0]))}catch(m){console.error(" Table structure error:",m)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",dir:"rtl",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs($,{className:"mb-6",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"w-6 h-6"}),"  "]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx(L,{onClick:c,disabled:r,children:r?" ...":" "}),e.jsx(L,{onClick:d,variant:"outline",children:"  "})]}),a&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lt,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"font-semibold text-red-800",children:":"})]}),e.jsx("p",{className:"text-red-700 mt-1",children:a})]})]})]}),s.length>0&&e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{children:["  (",s.length," )"]})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-6",children:s.slice(0,2).map((m,h)=>e.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[e.jsxs("h3",{className:"font-bold text-lg mb-3 text-blue-600",children:[" #",m.order_code||m.order_id?.slice?.(0,8)||h+1]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2 text-gray-700",children:" :"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:" :"})," ",m.customer_name||" "]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:" :"})," ",m.customer_phone||" "]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:":"})," ",m.customer_address||" "]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:" :"})," ",m.total_amount||" "]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2 text-gray-700",children:" :"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:" :"}),e.jsx("span",{className:m.main_store_name?"text-green-600 font-bold":"text-red-600",children:m.main_store_name||"  "})]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:" :"})," ",m.assigned_store_name||" "]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:" :"})," ",m.order_status||" "]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2 text-gray-700",children:" :"}),e.jsx("p",{className:m.customer_notes?"text-green-600":"text-red-600",children:m.customer_notes||"   "})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2 text-gray-700",children:" (items):"}),m.items?e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded p-2",children:[e.jsxs("p",{className:"text-green-700",children:["  ",Array.isArray(m.items)?m.items.length:" "," "]}),e.jsxs("details",{children:[e.jsx("summary",{className:"cursor-pointer text-blue-600",children:" "}),e.jsx("pre",{className:"mt-2 bg-gray-100 p-2 rounded text-xs overflow-auto",children:JSON.stringify(m.items,null,2)})]})]}):e.jsx("p",{className:"text-red-600",children:"   "})]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-blue-600 font-medium",children:"   "}),e.jsx("pre",{className:"mt-2 bg-gray-100 p-3 rounded text-xs overflow-auto",children:JSON.stringify(m,null,2)})]})]},h))})})]})]})})},F$=ol("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),At=x.forwardRef(({className:s,variant:t,...r},n)=>e.jsx("div",{ref:n,role:"alert",className:Ue(F$({variant:t}),s),...r}));At.displayName="Alert";const tf=x.forwardRef(({className:s,...t},r)=>e.jsx("h5",{ref:r,className:Ue("mb-1 font-medium leading-none tracking-tight",s),...t}));tf.displayName="AlertTitle";const Dt=x.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:Ue("text-sm [&_p]:leading-relaxed",s),...t}));Dt.displayName="AlertDescription";const U$=()=>{const[s,t]=x.useState({}),[r,n]=x.useState(null),[a,l]=x.useState(""),[c,d]=x.useState(""),m=async()=>{n("auto-assign"),t(v=>({...v,autoAssign:null}));try{console.log(" Testing auto-assign-orders...");const v=await fetch("https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/auto-assign-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});console.log(" Response status:",v.status);const j=await v.json();if(!v.ok)throw new Error(j.error||`HTTP ${v.status}`);console.log(" Success:",j),t(y=>({...y,autoAssign:{success:!0,data:j,message:`  ${j.assigned_count||0}  `}}))}catch(v){console.error(" Error:",v),t(j=>({...j,autoAssign:{success:!1,error:v.message}}))}finally{n(null)}},h=async()=>{if(!a.trim()){alert("   ");return}n("get-order"),t(v=>({...v,getOrder:null}));try{console.log(" Testing get-order with orderId:",a);const v=new URL("https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/get-order");v.searchParams.append("orderId",a.trim()),v.searchParams.append("adminMode","true");const j=await fetch(v.toString(),{method:"GET",headers:{"Content-Type":"application/json"}});if(console.log(" Response status:",j.status),!j.ok){const b=await j.json();throw new Error(b.error||`HTTP ${j.status}`)}const y=await j.json();if(console.log(" Success:",y),y.order_items){const b=y.order_items.filter(C=>C.merged_quantity);b.length>0&&console.log(" Detected merged products:",b.map(C=>({product_id:C.product_id,merged_quantity:C.merged_quantity,total_price:C.total_price})))}t(b=>({...b,getOrder:{success:!0,data:y,message:`   : ${y.order?.customer_name||" "}`}}))}catch(v){console.error(" Error:",v),t(j=>({...j,getOrder:{success:!1,error:v.message}}))}finally{n(null)}},f=async()=>{if(!a.trim()||!c.trim()){alert("     ");return}n("assign-order"),t(v=>({...v,assignOrder:null}));try{console.log(" Testing auto-assign-orders (manual mode) with:",{orderId:a,storeId:c});const v=await fetch("https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/auto-assign-orders",{method:"POST",headers:{"Content-Type":"application/json","x-store-id":c.trim()},body:JSON.stringify({orderId:a.trim(),storeId:c.trim(),mode:"manual"})});console.log(" Response status:",v.status);const j=await v.json();if(!v.ok)throw new Error(j.error||`HTTP ${v.status}`);console.log(" Success:",j),t(y=>({...y,assignOrder:{success:!0,data:j,message:j.message||"   "}}))}catch(v){console.error(" Error:",v),t(j=>({...j,assignOrder:{success:!1,error:v.message}}))}finally{n(null)}},p=async()=>{n("connection");const v=["assign-order","auto-assign-orders","get-order"],j={};try{for(const y of v)try{console.log(` Testing connection to ${y}...`);const b=await fetch(`https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/${y}`,{method:"POST",headers:{"Content-Type":"application/json"}});j[y]={status:b.status,ok:b.status!==404,message:b.status===400?" ":`Status: ${b.status}`}}catch(b){j[y]={status:"error",ok:!1,message:b.message}}t(y=>({...y,connection:{success:!0,data:j}}))}catch(y){t(b=>({...b,connection:{success:!1,error:y.message}}))}finally{n(null)}},w=(v,j)=>j?e.jsxs(At,{className:j.success?"border-green-500":"border-red-500",children:[j.success?e.jsx(Se,{className:"h-4 w-4 text-green-600"}):e.jsx(lt,{className:"h-4 w-4 text-red-600"}),e.jsx(Dt,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"font-semibold",children:[j.success?" ":" ",": ",v]}),j.message&&e.jsx("div",{className:"text-sm",children:j.message}),j.error&&e.jsxs("div",{className:"text-sm text-red-600",children:[": ",j.error]}),j.data&&e.jsxs("details",{className:"text-xs",children:[e.jsx("summary",{className:"cursor-pointer font-medium",children:" "}),e.jsx("pre",{className:"mt-2 p-2 bg-gray-100 rounded overflow-auto max-h-40",children:JSON.stringify(j.data,null,2)})]})]})})]}):null;return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"  Edge Functions"}),e.jsx("p",{className:"text-muted-foreground",children:"      "})]}),e.jsxs(At,{children:[e.jsx(nt,{className:"h-4 w-4"}),e.jsxs(Dt,{children:[e.jsx("strong",{children:" :"}),e.jsx("br",{})," assign-order:   ",e.jsx("br",{})," auto-assign-orders:    ",e.jsx("br",{})," get-order:    "]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:"  "}),e.jsx(Ze,{children:"   "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsx(L,{onClick:p,disabled:r==="connection",className:"w-full",children:r==="connection"?e.jsxs(e.Fragment,{children:[e.jsx(Jr,{className:"w-4 h-4 animate-spin ml-2"})," ..."]}):" "}),w(" ",s.connection)]})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" auto-assign-orders"}),e.jsx(Ze,{children:"  ( )"})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsx(L,{onClick:m,disabled:r==="auto-assign",className:"w-full",children:r==="auto-assign"?e.jsxs(e.Fragment,{children:[e.jsx(Jr,{className:"w-4 h-4 animate-spin ml-2"})," ..."]}):"  "}),w("auto-assign-orders",s.autoAssign)]})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" get-order"}),e.jsx(Ze,{children:"   "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsx(it,{placeholder:"  (orderId)",value:a,onChange:v=>l(v.target.value),className:"text-right"}),e.jsx(L,{onClick:h,disabled:r==="get-order",className:"w-full",children:r==="get-order"?e.jsxs(e.Fragment,{children:[e.jsx(Jr,{className:"w-4 h-4 animate-spin ml-2"})," ..."]}):" "}),w("get-order",s.getOrder)]})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" assign-order"}),e.jsx(Ze,{children:"   "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsx(it,{placeholder:"  (orderId)",value:a,onChange:v=>l(v.target.value),className:"text-right"}),e.jsx(it,{placeholder:"  (storeId)",value:c,onChange:v=>d(v.target.value),className:"text-right"}),e.jsx(L,{onClick:f,disabled:r==="assign-order",className:"w-full",children:r==="assign-order"?e.jsxs(e.Fragment,{children:[e.jsx(Jr,{className:"w-4 h-4 animate-spin ml-2"})," ..."]}):" "}),w("assign-order",s.assignOrder)]})]})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"  "})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:" :"}),e.jsx("div",{className:"text-green-600",children:"   "})]}),e.jsxs("div",{children:[e.jsx("strong",{children:" :"}),e.jsx("div",{className:"text-red-600",children:"    "})]}),e.jsxs("div",{children:[e.jsx("strong",{children:" :"}),e.jsx("div",{className:"text-blue-600",children:"  Console "})]})]})})]})]})},z$=()=>{const[s,t]=x.useState(""),[r,n]=x.useState(!1),a=async()=>{n(!0),t("");try{const m="test-order-123",h="test-store-456";console.log(" Testing auto-assign-orders (manual mode) with:",{orderId:m,storeId:h});const f=await fetch("https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/auto-assign-orders",{method:"POST",headers:{"Content-Type":"application/json","x-store-id":h},body:JSON.stringify({orderId:m,storeId:h,mode:"manual"})});console.log(" Response status:",f.status,f.statusText),console.log(" Response headers:",Object.fromEntries(f.headers.entries()));const p=await f.json();if(!f.ok){console.error(" Error response:",p),t(` Error ${f.status}: ${p.error||f.statusText}`);return}console.log(" Success response:",p),t(` Success: ${JSON.stringify(p,null,2)}`)}catch(m){console.error(" Network error:",m),t(` Network Error: ${m.message}`)}finally{n(!1)}},l=async()=>{n(!0),t("");try{console.log(" Testing auto-assign-orders");const m=await fetch("https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/auto-assign-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});console.log(" Response status:",m.status,m.statusText);const h=await m.json();if(!m.ok){console.error(" Error response:",h),t(` Error ${m.status}: ${h.error||m.statusText}`);return}console.log(" Success response:",h),t(` Success: ${JSON.stringify(h,null,2)}`)}catch(m){console.error(" Network error:",m),t(` Network Error: ${m.message}`)}finally{n(!1)}},c=async()=>{n(!0),t("");try{const m="test-order-123",h="test-store-uuid";console.log(" Testing get-order with:",{orderId:m,storeId:h});const f=new URL("https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/get-order");f.searchParams.append("orderId",m),f.searchParams.append("adminMode","false");const p=await fetch(f.toString(),{method:"GET",headers:{"Content-Type":"application/json","x-store-id":h}});console.log(" Response status:",p.status,p.statusText);const w=await p.json();if(!p.ok){console.error(" Error response:",w),t(` Error ${p.status}: ${w.error||p.statusText}`);return}console.log(" Success response:",w),t(` Success: ${JSON.stringify(w,null,2)}`)}catch(m){console.error(" Network error:",m),t(` Network Error: ${m.message}`)}finally{n(!1)}},d=async()=>{n(!0),t("");try{console.log(" Testing connection to auto-assign-orders (GET)");const m=await fetch("https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/auto-assign-orders");console.log(" Response status:",m.status,m.statusText),console.log(" Response headers:",Object.fromEntries(m.headers.entries()));const h=await m.text();console.log(" Response text:",h),t(`Connection test: Status ${m.status} - ${m.statusText}
Response: ${h}`)}catch(m){console.error(" Network error:",m),t(` Connection Error: ${m.message}`)}finally{n(!1)}};return e.jsxs("div",{style:{padding:"20px",fontFamily:"monospace"},children:[e.jsx("h1",{children:" Simple Edge Functions Test"}),e.jsx("p",{children:"   Edge Functions -   Console (F12) "}),e.jsxs("div",{style:{margin:"20px 0"},children:[e.jsx("h3",{children:"URLs being tested:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/auto-assign-orders (manual mode)"}),e.jsx("li",{children:"https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/auto-assign-orders"}),e.jsx("li",{children:"https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/get-order"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",marginBottom:"20px"},children:[e.jsx("button",{onClick:d,disabled:r,style:{padding:"10px",backgroundColor:"#007bff",color:"white",border:"none",cursor:"pointer"},children:r?"  ...":" Test Connection"}),e.jsx("button",{onClick:a,disabled:r,style:{padding:"10px",backgroundColor:"#28a745",color:"white",border:"none",cursor:"pointer"},children:r?"  ...":" Test Manual Assignment"}),e.jsx("button",{onClick:l,disabled:r,style:{padding:"10px",backgroundColor:"#ffc107",color:"black",border:"none",cursor:"pointer"},children:r?"  ...":" Test auto-assign"}),e.jsx("button",{onClick:c,disabled:r,style:{padding:"10px",backgroundColor:"#17a2b8",color:"white",border:"none",cursor:"pointer"},children:r?"  ...":" Test get-order"})]}),s&&e.jsxs("div",{style:{backgroundColor:s.includes("")||s.includes("")?"#f8d7da":"#d4edda",padding:"15px",border:"1px solid #ccc",borderRadius:"5px",whiteSpace:"pre-wrap",fontFamily:"monospace",fontSize:"12px"},children:[e.jsx("strong",{children:"Result:"}),e.jsx("br",{}),s]}),e.jsxs("div",{style:{marginTop:"20px",fontSize:"12px",color:"#666"},children:[e.jsx("p",{children:e.jsx("strong",{children:":"})}),e.jsxs("ul",{children:[e.jsx("li",{children:" Console (F12)    logs"}),e.jsx("li",{children:'  "Unexpected end of JSON input"     '}),e.jsx("li",{children:"  404      "}),e.jsx("li",{children:"  CORS error     Supabase"})]})]})]})},W$=({order:s,onAssign:t,onEdit:r,onViewDetails:n,compact:a=!1,showAssignButton:l=!0})=>{const{t:c}=us(),[d,m]=x.useState(!1),h={label:lb[s.order_status]||s.order_status,color:cb[s.order_status]||"bg-gray-100 text-gray-800"},f=new Date(s.created_at),p=$a(s.total_amount||0),w=()=>{n&&n(s.id)},v=()=>{r&&r(s)};return a?e.jsx($,{className:"w-full hover:shadow-md transition-shadow",children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-lg",children:e.jsxs(D,{children:[" #",s.order_code||s.id.slice(0,8)]})}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(tn,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(D,{className:"font-medium",children:s.customer_name})]})]}),e.jsx(Q,{className:h.color,children:e.jsx(D,{children:h.label})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-mono",children:s.customer_phone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bn,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-mono text-primary font-bold",children:p.iqd})]})]}),s.items&&s.items.length>0&&e.jsx($s,{items:s.items,compact:!0}),e.jsxs("div",{className:"flex gap-2 mt-3 pt-3 border-t",children:[e.jsx(L,{variant:"outline",size:"sm",onClick:w,className:"flex-1",children:e.jsx(D,{children:c("details")})}),s.order_status==="pending"&&l&&e.jsxs(L,{size:"sm",onClick:v,className:"flex-1",disabled:d,children:[e.jsx(Se,{className:"w-4 h-4 ml-2"}),e.jsx(D,{children:""})]})]})]})}):e.jsxs($,{className:"w-full hover:shadow-md transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(V,{className:"text-lg flex items-center gap-2",children:e.jsxs(D,{children:[" #",s.order_code||s.id.slice(0,8)]})}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:[e.jsx(Rt,{className:"w-4 h-4"}),e.jsx("span",{children:vl(f,{addSuffix:!0,locale:dm})}),e.jsxs("span",{className:"text-xs",children:["(",Ry(f,"PPp",{locale:dm}),")"]})]})]}),e.jsx(Q,{className:h.color,children:e.jsx(D,{children:h.label})})]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tn,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[c("customer.label")," "]}),e.jsx(D,{className:"font-medium",children:s.customer_name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:": "}),e.jsx("span",{className:"font-mono",children:s.customer_phone})]})]}),s.customer_address&&s.customer_address.trim()!==""&&s.customer_address!==" "&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ed,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:": "}),e.jsx(D,{className:"font-medium",children:s.customer_address})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bn,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:" : "}),e.jsx("span",{className:"font-bold text-primary font-mono",children:p.primary})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nd,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:" : "}),e.jsx("span",{className:"font-medium",children:Ry(f,"PPp",{locale:dm})})]})]}),(()=>{const j=Qf(s),y=Xf(s);return j&&j!=="  "?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:y}),e.jsx(D,{className:"font-medium text-blue-600",children:j})]})]}):null})()]})]}),s.customer_notes&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-muted/30 rounded-lg",children:[e.jsx(Ra,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:" :"}),e.jsx("div",{className:"mt-1",children:e.jsx(D,{className:"text-sm",children:s.customer_notes})})]})]}),s.items&&s.items.length>0||s.order_items&&s.order_items.length>0?e.jsx($s,{items:s.order_items||s.items,showPriceInBothCurrencies:!0}):e.jsxs("div",{className:"text-center py-4 text-muted-foreground",children:[e.jsx(Package,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx(D,{children:"    "})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(L,{variant:"outline",size:"sm",onClick:w,className:"flex items-center gap-2",children:[e.jsx(rd,{className:"w-4 h-4"}),e.jsx(D,{children:""})]}),r&&e.jsxs(L,{variant:"outline",size:"sm",onClick:v,className:"flex items-center gap-2",children:[e.jsx(rd,{className:"w-4 h-4"}),e.jsx(D,{children:""})]}),s.order_status==="pending"&&l&&e.jsxs(L,{size:"sm",onClick:v,className:"flex items-center gap-2",disabled:d,children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx(D,{children:d?" ...":" "})]})]})]})]})},$n={id:"1",order_code:"ORD-001",customer_name:" ",customer_phone:"+964771234567",customer_address:"  ",customer_notes:"    6 ",order_status:"pending",main_store_name:"  ",items:[{name:" ",quantity:2,price:15e3},{name:" ",quantity:1,price:8e3}],total_amount:38e3,created_at:new Date().toISOString()},B$=()=>($a($n.total_amount),e.jsxs("div",{className:"p-6 space-y-6",dir:"rtl",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:e.jsx(D,{children:"    "})})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-medium",children:e.jsx(D,{children:"  :"})}),e.jsxs("div",{className:"grid gap-2 text-sm",children:[e.jsx("div",{children:e.jsxs(D,{children:[": ",$n.customer_name]})}),e.jsx("div",{children:e.jsxs(D,{children:[": ",$n.customer_address]})}),e.jsx("div",{children:e.jsxs(D,{children:[": ",$n.customer_notes]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-medium",children:e.jsx(D,{children:"  :"})}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{children:e.jsxs(D,{children:[": ",T_($n.total_amount)]})}),e.jsx("div",{children:e.jsxs(D,{children:["   : ",$a($n.total_amount)]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-medium",children:e.jsx(D,{children:"  :"})}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(Q,{className:"bg-yellow-100 text-yellow-800",children:e.jsx(D,{children:" "})}),e.jsx(Q,{className:"bg-blue-100 text-blue-800",children:e.jsx(D,{children:""})}),e.jsx(Q,{className:"bg-green-100 text-green-800",children:e.jsx(D,{children:""})}),e.jsx(Q,{className:"bg-red-100 text-red-800",children:e.jsx(D,{children:""})})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-4",children:e.jsx(D,{children:"   :"})}),e.jsx($s,{items:$n.items,showPriceInBothCurrencies:!0})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-4",children:e.jsx(D,{children:"   :"})}),e.jsx(W$,{order:$n,compact:!1,showAssignButton:!0})]})]})),q$=()=>e.jsx(B$,{}),H$=()=>{const[s,t]=x.useState(" "),[r,n]=x.useState("123456"),[a,l]=x.useState(!1),{toast:c}=Xe(),d=async()=>{l(!0);try{const{data:h,error:f}=await I.from("stores").insert([{name:s,password:r}]).select();if(f){console.error("Error creating store:",f),console.log("Raw error object:",JSON.stringify(f,null,2));const p=Nb(f);console.log("Extracted error message:",p),c({title:"   ",description:p,variant:"destructive"});return}h&&h.length>0&&(c({title:"   ",description:` "${s}"    : ${r}`}),localStorage.setItem("storeAuth",JSON.stringify({id:h[0].id,name:h[0].name})),c({title:"   ",description:"    /store-dashboard"}))}catch(h){console.error("Error:",h),console.log("Raw error object in catch:",JSON.stringify(h,null,2));const f=_b(h,"   ");console.log("Extracted error message in catch:",f),c({title:"",description:f,variant:"destructive"})}finally{l(!1)}},m=()=>{localStorage.setItem("storeAuth",JSON.stringify({id:"test-store-id",name:" "})),c({title:"   ",description:"   /store-dashboard"})};return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-6 bg-gradient-to-br from-blue-50 to-indigo-100",dir:"rtl",children:e.jsx("div",{className:"w-full max-w-md space-y-6",children:e.jsxs($,{children:[e.jsxs(q,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(_0,{className:"w-12 h-12 text-primary"})}),e.jsx(V,{className:"text-2xl",children:"  "}),e.jsx(Ze,{children:"    "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(et,{htmlFor:"storeName",children:" "}),e.jsx(it,{id:"storeName",value:s,onChange:h=>t(h.target.value),className:"text-right"})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"password",children:" "}),e.jsx(it,{id:"password",value:r,onChange:h=>n(h.target.value),className:"text-right"})]}),e.jsx(L,{onClick:d,disabled:a,className:"w-full",children:a?" ...":"  "}),e.jsx("div",{className:"border-t pt-4",children:e.jsx(L,{onClick:m,variant:"outline",className:"w-full",children:"   "})}),e.jsxs("div",{className:"text-center space-y-2 text-sm text-gray-600",children:[e.jsx("p",{children:"  :"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("a",{href:"/store-login-space9003",className:"block text-blue-600 hover:underline",children:"  "}),e.jsx("a",{href:"/store-dashboard",className:"block text-blue-600 hover:underline",children:"  "}),e.jsx("a",{href:"/admin-aa-smn-justme9003",className:"block text-blue-600 hover:underline",children:"  "})]})]})]})]})})})},V$=()=>{const[s,t]=x.useState(""),[r,n]=x.useState(""),[a,l]=x.useState(!1),{toast:c}=Xe(),d=async()=>{if(!s.trim()){c({title:"",description:"   ",variant:"destructive"});return}l(!0);try{console.log("   :",{orderId:s,returnReason:r,timestamp:new Date().toISOString()});const{data:h,error:f}=await I.from("orders").select("*").eq("id",s).single();if(f)throw console.error("    :",f),f;console.log("    :",h);const p={order_status:"returned",status:"returned",updated_at:new Date().toISOString(),order_details:r?`Return reason: ${r}`:h.order_details};console.log("  :",p);const{data:w,error:v}=await I.from("orders").update(p).eq("id",s).select();if(v)throw console.error("   :",{error:v,message:v.message,details:v.details,hint:v.hint,code:v.code}),v;console.log("   :",w),c({title:" ",description:"      "})}catch(h){console.error("  :",{error:h,message:h?.message||h,stack:h?.stack}),c({title:"  ",description:h?.message||"   ",variant:"destructive"})}finally{l(!1)}},m=async()=>{try{console.log("   ...");const{data:h,error:f}=await I.from("orders").select("*").limit(5);if(f)throw console.error("    :",f),f;console.log("  :",h),c({title:"  ",description:`   ${h.length} `})}catch(h){console.error("    :",h),c({title:"",description:h?.message||"    ",variant:"destructive"})}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",dir:"rtl",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"  "})}),e.jsxs(M,{className:"space-y-4",children:[e.jsx(L,{onClick:m,variant:"outline",className:"w-full",children:"    "}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"  (ID)"}),e.jsx(it,{value:s,onChange:h=>t(h.target.value),placeholder:"  "})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"  ()"}),e.jsx(Ar,{value:r,onChange:h=>n(h.target.value),placeholder:"   ",rows:3})]}),e.jsx(L,{onClick:d,disabled:a,className:"w-full",children:a?" ...":"   "}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:":"}),e.jsxs("ol",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:'1.   "  " '}),e.jsx("li",{children:"2.    (F12)   "}),e.jsx("li",{children:"3.    "}),e.jsx("li",{children:"4.     "}),e.jsx("li",{children:'5.   "   "'}),e.jsx("li",{children:"6.    "})]})]})]})]})})})},G$=()=>{const[s,t]=x.useState(!1),[r,n]=x.useState(null),{toast:a}=Xe(),l="https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1",c=async()=>{t(!0),n(null);try{console.log(" Testing auto-assign-orders function...");const h=await fetch(`${l}/auto-assign-orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});console.log(" Response status:",h.status,h.statusText);const f=await h.json();console.log(" Response data:",f),n({status:h.status,statusText:h.statusText,ok:h.ok,data:f}),h.ok?a({title:" ",description:`  ${f.assigned_count||0} `}):a({title:" ",description:f.error||h.statusText,variant:"destructive"})}catch(h){console.error(" Test failed:",h),n({error:h instanceof Error?h.message:String(h)}),a({title:"  ",description:h instanceof Error?h.message:String(h),variant:"destructive"})}finally{t(!1)}},d=async()=>{t(!0),n(null);try{console.log(" Testing manual assignment...");const h=await fetch(`${l}/auto-assign-orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mode:"manual",orderId:"test-order-id",storeId:"test-store-id"})});console.log(" Response status:",h.status,h.statusText);const f=await h.json();console.log(" Response data:",f),n({status:h.status,statusText:h.statusText,ok:h.ok,data:f}),a({title:h.ok?" ":" ",description:f.error||f.message||h.statusText,variant:h.ok?"default":"destructive"})}catch(h){console.error(" Test failed:",h),n({error:h instanceof Error?h.message:String(h)}),a({title:"  ",description:h instanceof Error?h.message:String(h),variant:"destructive"})}finally{t(!1)}},m=async()=>{t(!0),n(null);try{console.log(" Testing ping...");const h=await fetch(`${l}/auto-assign-orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test:!0})});console.log(" Response status:",h.status,h.statusText);const f=await h.json();console.log(" Response data:",f),n({status:h.status,statusText:h.statusText,ok:h.ok,data:f}),a({title:" ",description:`Status: ${h.status} - ${h.statusText}`})}catch(h){console.error(" Ping failed:",h),n({error:h instanceof Error?h.message:String(h)}),a({title:"  ",description:h instanceof Error?h.message:String(h),variant:"destructive"})}finally{t(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",dir:"rtl",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" Edge Function -  "}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["URL: ",l,"/auto-assign-orders"]})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(L,{onClick:m,disabled:s,variant:"outline",className:"w-full",children:s?" ...":" "}),e.jsx(L,{onClick:d,disabled:s,variant:"outline",className:"w-full",children:s?" ...":"  "}),e.jsx(L,{onClick:c,disabled:s,className:"w-full",children:s?" ...":"  "})]}),r&&e.jsxs($,{className:"mt-6",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[" ",e.jsx(Q,{variant:r.ok?"default":"destructive",children:r.status||"Error"})]})}),e.jsx(M,{children:e.jsx("pre",{className:"bg-gray-100 p-4 rounded-lg text-sm overflow-auto",dir:"ltr",children:JSON.stringify(r,null,2)})})]}),e.jsxs("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:":"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"  :    "}),e.jsx("li",{children:"   :      "}),e.jsx("li",{children:"   :     "}),e.jsx("li",{children:"    (F12)   "})]})]})]})]})})})},Y$=()=>{const[s,t]=x.useState(!1),[r,n]=x.useState(null),{toast:a}=Xe(),l=async()=>{t(!0),n(null);try{console.log(" Checking database tables...");const{data:m,error:h}=await I.from("settings").select("*").limit(1),{data:f,error:p}=await I.from("orders").select("id").limit(1),{data:w,error:v}=await I.from("stores").select("id").limit(1),j={settings:{exists:!h,error:h?.message,data:m},orders:{exists:!p,error:p?.message,hasData:f&&f.length>0},stores:{exists:!v,error:v?.message,hasData:w&&w.length>0}};n(j),console.log(" Database check results:",j),a({title:"   ",description:"   "})}catch(m){console.error(" Database check failed:",m),n({error:m instanceof Error?m.message:String(m)}),a({title:"    ",description:m instanceof Error?m.message:String(m),variant:"destructive"})}finally{t(!1)}},c=async()=>{t(!0);try{console.log(" Creating settings table...");const{data:m,error:h}=await I.from("settings").upsert({id:1,auto_assign_enabled:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select();if(h)throw console.error(" Error creating settings:",h),h;console.log(" Settings created successfully:",m),a({title:"   ",description:"    "}),await l()}catch(m){console.error(" Settings creation failed:",m),a({title:"    ",description:m instanceof Error?m.message:String(m),variant:"destructive"})}finally{t(!1)}},d=async()=>{t(!0);try{console.log(" Testing Edge Function...");const m=await fetch("https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/auto-assign-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test:!0})}),h=await m.json();console.log(" Edge Function response:",{status:m.status,statusText:m.statusText,data:h}),a({title:m.ok?"Edge Function ":"Edge Function  ",description:`Status: ${m.status} - ${h.message||h.error||m.statusText}`,variant:m.ok?"default":"destructive"})}catch(m){console.error(" Edge Function test failed:",m),a({title:"   Edge Function",description:m instanceof Error?m.message:String(m),variant:"destructive"})}finally{t(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",dir:"rtl",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:"   "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"    "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(L,{onClick:l,disabled:s,variant:"outline",className:"w-full",children:s?" ...":" "}),e.jsx(L,{onClick:c,disabled:s,variant:"outline",className:"w-full",children:s?" ...":"  "}),e.jsx(L,{onClick:d,disabled:s,className:"w-full",children:s?" ...":" Edge Function"})]}),r&&!r.error&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"  :"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs($,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(V,{className:"text-sm",children:"  (settings)"})}),e.jsxs(M,{children:[e.jsx(Q,{variant:r.settings.exists?"default":"destructive",children:r.settings.exists?"":" "}),r.settings.error&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:r.settings.error}),r.settings.data&&e.jsxs("p",{className:"text-xs text-green-600 mt-2",children:[": ",r.settings.data.length]})]})]}),e.jsxs($,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(V,{className:"text-sm",children:"  (orders)"})}),e.jsxs(M,{children:[e.jsx(Q,{variant:r.orders.exists?"default":"destructive",children:r.orders.exists?"":" "}),r.orders.error&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:r.orders.error}),r.orders.hasData&&e.jsx("p",{className:"text-xs text-green-600 mt-2",children:"  "})]})]}),e.jsxs($,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(V,{className:"text-sm",children:"  (stores)"})}),e.jsxs(M,{children:[e.jsx(Q,{variant:r.stores.exists?"default":"destructive",children:r.stores.exists?"":" "}),r.stores.error&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:r.stores.error}),r.stores.hasData&&e.jsx("p",{className:"text-xs text-green-600 mt-2",children:"  "})]})]})]})]}),r&&r.error&&e.jsxs($,{className:"border-red-200",children:[e.jsx(q,{children:e.jsx(V,{className:"text-red-800",children:"  "})}),e.jsx(M,{children:e.jsx("pre",{className:"bg-red-50 p-4 rounded-lg text-sm text-red-700 overflow-auto",children:r.error})})]}),e.jsxs("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:":"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"  :     "}),e.jsx("li",{children:"   :       "}),e.jsx("li",{children:"  Edge Function:      "}),e.jsx("li",{children:"    (F12)   "})]})]})]})]})})})};class Ea{static instance;recentNotifications=new Set;CACHE_DURATION=300*1e3;ORDER_ASSIGNED_CACHE_DURATION=120*1e3;formatError(t,r=""){if(!t)return"Unknown error";const n=[];if(t.message&&n.push(`Message: ${t.message}`),t.code&&n.push(`Code: ${t.code}`),t.details&&n.push(`Details: ${t.details}`),t.hint&&n.push(`Hint: ${t.hint}`),n.length===0)try{return JSON.stringify(t,null,2)}catch{return String(t)}const a=n.join(" | ");return r?`${r}: ${a}`:a}static getInstance(){return Ea.instance||(Ea.instance=new Ea),Ea.instance}async createNotification(t){const r=this.generateNotificationKey(t);if(this.recentNotifications.has(r))return console.log(" Duplicate notification prevented:",r),!1;try{const n=t.order_id?12e4:6e5,a=new Date(Date.now()-n).toISOString();let l=I.from("notifications").select("id").eq("recipient_id",t.recipient_id).eq("recipient_type",t.recipient_type).gte("created_at",a).limit(1);t.order_id&&(l=l.eq("order_id",t.order_id));const{data:c,error:d}=await l;if(d&&console.error(" Error checking for duplicate notifications:",this.formatError(d)),c&&c.length>0)return console.log(" Duplicate notification found in database, skipping"),this.addToCache(r,!!t.order_id),!1;const{data:m,error:h}=await I.from("notifications").insert({recipient_id:t.recipient_id,recipient_type:t.recipient_type,title:t.title,message:t.message,order_id:t.order_id,priority:t.priority,read:!1,sent:!1}).select().single();return h?(console.error(" Error creating notification:",this.formatError(h,"Database Insert")),!1):m?(console.log(" Notification created successfully:",m.id),this.addToCache(r,!!t.order_id),!0):!1}catch(n){return console.error(" Exception in createNotification:",this.formatError(n,"Unexpected Error")),!1}}generateNotificationKey(t){return[t.recipient_type,t.recipient_id,t.title.substring(0,20),t.order_id||"no-order"].join("|")}addToCache(t,r){this.recentNotifications.add(t);const n=r?this.ORDER_ASSIGNED_CACHE_DURATION:this.CACHE_DURATION;setTimeout(()=>{this.recentNotifications.delete(t)},n)}clearCache(){this.recentNotifications.clear(),console.log(" Notification cache cleared")}getCacheStatus(){return{size:this.recentNotifications.size,keys:Array.from(this.recentNotifications)}}async notifyStore(t,r,n,a,l="high"){return await this.createNotification({recipient_id:t,recipient_type:"store",title:r,message:n,order_id:a,priority:l})}async notifyAdmin(t,r,n,a="medium"){return await this.createNotification({recipient_id:"admin",recipient_type:"admin",title:t,message:r,order_id:n,priority:a})}async notifyCustomer(t,r,n,a){return await this.createNotification({recipient_id:t,recipient_type:"customer",title:r,message:n,order_id:a})}}const _i=Ea.getInstance();class K${baseUrl="https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1";formatError(t,r=""){if(!t)return"Unknown error";const n=[];if(t.message&&n.push(`Message: ${t.message}`),t.code&&n.push(`Code: ${t.code}`),t.details&&n.push(`Details: ${t.details}`),t.hint&&n.push(`Hint: ${t.hint}`),n.length===0)try{return JSON.stringify(t,null,2)}catch{return String(t)}const a=n.join(" | ");return r?`${r}: ${a}`:a}async sendNotification(t){try{if(console.log(" Sending store notification:",t),!await _i.notifyStore(t.storeId,t.title,t.message,t.orderId))return console.log(" Notification was not sent (likely duplicate)"),!1;console.log(" Store notification sent successfully through central manager:",t);const{error:n}=await I.from("notifications").update({sent:!0}).eq("recipient_id",t.storeId).eq("title",t.title).eq("message",t.message).eq("sent",!1).order("created_at",{ascending:!1}).limit(1);return n&&console.warn(" Failed to mark notification as sent:",this.formatError(n)),!0}catch(r){return console.error(" Error sending store notification:",{error:r instanceof Error?r.message:String(r),stack:r instanceof Error?r.stack:"No stack trace",data:t}),!1}}async notifyNewOrder(t,r,n,a){return await this.sendNotification({storeId:t,title:"  !",message:`${n}  `,type:"order_assigned",orderId:a,orderCode:r,priority:"high"})}async sendOrderReminder(t,r,n){return await this.sendNotification({storeId:t,title:":    ",message:`  ${r}     .      .`,type:"order_reminder",orderId:n,orderCode:r,priority:"urgent"})}async sendSystemNotification(t,r,n){return await this.sendNotification({storeId:t,title:r,message:n,type:"system",priority:"medium"})}async sendGeneralNotification(t,r,n){return await this.sendNotification({storeId:t,title:r,message:n,type:"general",priority:"low"})}async sendBroadcastNotification(t,r,n="general"){try{const{data:a,error:l}=await I.from("stores").select("id");if(l||!a)return console.error(" Failed to get stores for broadcast:",{error:l?.message||JSON.stringify(l)||String(l),details:l?.details||"No details available",hint:l?.hint||"No hint available"}),0;let c=0;for(const d of a)await this.sendNotification({storeId:d.id,title:t,message:r,type:n,priority:n==="system"?"high":"medium"})&&c++;return console.log(` Broadcast notification sent to ${c}/${a.length} stores`),c}catch(a){return console.error(" Error sending broadcast notification:",a),0}}async processOrderAssignment(t,r,n,a){try{console.log(` Processing order assignment notification: ${r}  Store ${n}`);const l=await _i.notifyStore(n,"  !",`${a}  `,t);console.log(l?` Order assignment notification sent for ${r}`:` Order assignment notification skipped (duplicate) for ${r}`)}catch(l){console.error(" Error processing order assignment notification:",l)}}async getNotificationStats(t){try{const{data:r,error:n}=await I.from("notifications").select("read, sent, recipient_type").eq("recipient_id",t).eq("recipient_type","store");if(n||!r)return console.error(" Error getting notification stats:",n),{total:0,unread:0,unsent:0,byType:{}};const a={total:r.length,unread:r.filter(l=>!l.read).length,unsent:r.filter(l=>!l.sent).length,byType:{}};return r.forEach(l=>{const c=l.recipient_type||"general";a.byType[c]=(a.byType[c]||0)+1}),a}catch(r){return console.error(" Error getting notification stats:",{error:r instanceof Error?r.message:JSON.stringify(r)||String(r),stack:r instanceof Error?r.stack:"No stack trace",storeId:t}),{total:0,unread:0,unsent:0,byType:{}}}}async getStoreNotifications(t,r=50){try{const{data:n,error:a}=await I.from("notifications").select("id, title, message, order_id, created_at, read, sent").eq("recipient_id",t).eq("recipient_type","store").order("created_at",{ascending:!1}).limit(r);return a?(console.error(" Error getting store notifications:",a),[]):n||[]}catch(n){return console.error(" Error getting store notifications:",n),[]}}async markAllAsRead(t){try{const{error:r}=await I.from("notifications").update({read:!0}).eq("recipient_id",t).eq("recipient_type","store").eq("read",!1);return r?(console.error(" Error marking all notifications as read:",r),!1):(console.log(" All notifications marked as read for store:",t),!0)}catch(r){return console.error(" Error marking all notifications as read:",r),!1}}async cleanupOldNotifications(){try{const t=new Date;t.setDate(t.getDate()-30);const{data:r,error:n}=await I.from("notifications").delete().eq("recipient_type","store").lt("created_at",t.toISOString()).select("id");if(n)return console.error(" Error cleaning up old notifications:",{error:n?.message||JSON.stringify(n)||String(n),details:n?.details||"No details available"}),0;const a=r?.length||0;return console.log(` Cleaned up ${a} old store notifications`),a}catch(t){return console.error(" Error cleaning up old notifications:",{error:t instanceof Error?t.message:JSON.stringify(t)||String(t),stack:t instanceof Error?t.stack:"No stack trace"}),0}}setupRealtimeSubscription(t,r){const n=I.channel(`store-notifications-${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`recipient_id=eq.${t}`},a=>{console.log(" New store notification received:",a),a.new&&r(a.new)}).subscribe(a=>{console.log(` Store notifications channel for store ${t} status:`,a),a==="SUBSCRIBED"?console.log(` Successfully subscribed to notifications for store: ${t}`):a==="CHANNEL_ERROR"?console.error(`   Real-time  ${t}: CHANNEL_ERROR`):a==="TIMED_OUT"&&console.warn(`     Real-time  ${t}`)});return console.log(` Realtime subscription setup for store: ${t}`),()=>{I.removeChannel(n),console.log(` Realtime subscription removed for store: ${t}`)}}}const ys=new K$,X$=async(s,t,r,n)=>{await ys.processOrderAssignment(s,t,r,n)},Q$=async s=>await ys.sendNotification({storeId:s,title:" ",message:`      ${new Date().toLocaleTimeString("ar")}`,type:"general",priority:"low"}),J$=async()=>{console.log(" Checking notifications table structure...");try{const{data:s,error:t,count:r}=await I.from("notifications").select("*",{count:"exact",head:!0});if(t)return console.error(" Notifications table check failed:",{error:t.message,details:t.details,hint:t.hint,code:t.code}),t.code==="PGRST116"||t.message?.includes("does not exist")?(console.log(" Creating notifications table..."),await e5()):{success:!1,error:t.message};console.log(" Notifications table exists, record count:",r);const n=await Z$();return{success:!0,recordCount:r,structure:n}}catch(s){return console.error(" Exception checking notifications table:",{error:s instanceof Error?s.message:String(s),stack:s instanceof Error?s.stack:"No stack trace"}),{success:!1,error:String(s)}}},Z$=async()=>{try{const s={recipient_type:"store",recipient_id:"test-store-id",message:"Test notification",prompt:{title:"Test",message:"Test notification",type:"store"},created_at:new Date().toISOString(),read:!1,sent:!0},{error:t}=await I.from("notifications").insert(s).select();return t?(console.error(" Table structure check failed:",{error:t.message,details:t.details,hint:t.hint}),{valid:!1,error:t.message}):(await I.from("notifications").delete().eq("recipient_id","test-store-id").eq("message","Test notification"),console.log(" Table structure is valid"),{valid:!0})}catch(s){return console.error(" Exception checking table structure:",s),{valid:!1,error:String(s)}}},e5=async()=>(console.log(" Creating notifications table..."),{success:!1,error:`Table does not exist. Please create it via Supabase Dashboard with the following structure:

CREATE TABLE notifications (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  recipient_type TEXT NOT NULL CHECK (recipient_type IN ('admin', 'store', 'customer')),
  recipient_id TEXT NOT NULL,
  title TEXT NOT NULL,
  message TEXT NOT NULL,
  order_id TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  read BOOLEAN DEFAULT FALSE,
  sent BOOLEAN DEFAULT FALSE
);`}),kb=async s=>{console.log(" Testing simple notification insertion...");try{const t={recipient_type:"store",recipient_id:s,title:" ",message:"Test notification at "+new Date().toLocaleTimeString("ar"),created_at:new Date().toISOString(),read:!1,sent:!0},{data:r,error:n}=await I.from("notifications").insert(t).select().single();return n?(console.error(" Test notification failed:",{error:n.message,details:n.details,hint:n.hint,code:n.code,testData:t}),{success:!1,error:n.message}):(console.log(" Test notification inserted successfully:",r),{success:!0,data:r})}catch(t){return console.error(" Exception testing notification:",{error:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:"No stack trace"}),{success:!1,error:String(t)}}},t5=async()=>{console.log(" Testing notification permissions...");const s=[{operation:"SELECT",description:" "},{operation:"INSERT",description:"  "},{operation:"UPDATE",description:" "},{operation:"DELETE",description:"  "}],t=[];for(const r of s)try{let n=!1,a=null;switch(r.operation){case"SELECT":const{error:l}=await I.from("notifications").select("id").limit(1);n=!l,a=l;break;case"INSERT":const{error:c}=await I.from("notifications").insert({recipient_type:"store",recipient_id:"test-permissions",message:"Permission test",created_at:new Date().toISOString(),read:!1,sent:!0}).select();n=!c,a=c;break;case"UPDATE":const{error:d}=await I.from("notifications").update({read:!0}).eq("recipient_id","test-permissions");n=!d,a=d;break;case"DELETE":const{error:m}=await I.from("notifications").delete().eq("recipient_id","test-permissions");n=!m,a=m;break}t.push({operation:r.operation,description:r.description,success:n,error:a?{message:a.message,code:a.code,details:a.details}:null})}catch(n){t.push({operation:r.operation,description:r.description,success:!1,error:{message:n instanceof Error?n.message:String(n)}})}return console.log(" Permission test results:",t),t},s5=async s=>{console.log(" Running comprehensive notification diagnostics...");const t={timestamp:new Date().toISOString(),tableCheck:await J$(),permissionTests:await t5(),simpleTest:s?await kb(s):null};return console.log(" Diagnostics completed:",t),t};function up(s){if(s instanceof Error)return s.message;if(typeof s=="string")return s;if(s&&typeof s=="object"){const t=s;if(t.message&&typeof t.message=="string")return t.message;if(t.error?.message)return t.error.message;const r=[];if(t.details&&typeof t.details=="string"&&r.push(t.details),t.hint&&typeof t.hint=="string"&&r.push(`Hint: ${t.hint}`),t.code&&typeof t.code=="string"&&r.push(`Code: ${t.code}`),t.statusText&&typeof t.statusText=="string"&&r.push(`Status: ${t.statusText}`),r.length>0)return r.join(" | ");try{const n=JSON.stringify(s,null,2);if(n!=="{}"&&n!=="[object Object]")return n}catch{const a=s.toString();if(a==="[object Object]")try{const l=Object.keys(s);if(l.length>0)return l.map(c=>{const d=s[c];return`${c}: ${typeof d=="object"?JSON.stringify(d):d}`}).join(", ")}catch{return s.constructor?.name||"Unknown Error Object"}return a}}return s&&typeof s=="object"?`Unknown error: ${s.constructor?.name||"Object"}`:String(s)}function Ob(s,t,r){Rb(s,`Supabase error in ${t}`);const n=up(s),a=s?.details||"No details available",l=s?.hint||"No hint available",c=s?.code||"No code available",d={operation:t,error:n,details:a,hint:l,code:c,data:r||void 0};return console.error(` Supabase error in ${t}:`,n),console.error("Error details:",d),d}function Rb(s,t="Error"){console.group(` Debug ${t}`);try{if(console.log("Type:",typeof s),console.log("Constructor:",s?.constructor?.name),console.log("instanceof Error:",s instanceof Error),s&&typeof s=="object"){console.log("Keys:",Object.keys(s)),console.log("Prototype:",Object.getPrototypeOf(s));const r=s;console.log("Direct properties:"),console.log("  message:",r.message),console.log("  code:",r.code),console.log("  details:",r.details),console.log("  hint:",r.hint),console.log("  statusText:",r.statusText),console.log("  status:",r.status)}console.log("String representation:",up(s)),console.log("toString():",s?.toString?.());try{console.log("JSON.stringify:",JSON.stringify(s,null,2))}catch(r){console.log("JSON.stringify failed:",r.message)}}catch(r){console.log("Debug error:",r)}finally{console.groupEnd()}}const r5=()=>{const[s,t]=x.useState("test-store-123"),[r,n]=x.useState(!1),[a,l]=x.useState(null),[c,d]=x.useState(null),m=async()=>{n(!0),d(null);try{console.log(" Testing store notification with storeId:",s);const p=await ys.sendNotification({storeId:s,title:" ",message:`      ${new Date().toLocaleTimeString("ar")}`,type:"general",priority:"low"});d({success:p,message:p?"   ":"   ",timestamp:new Date().toISOString()}),console.log(" Test result:",p)}catch(p){console.error(" Test failed with exception:",p),d({success:!1,message:"   ",error:Ob(p,"test notification").error,timestamp:new Date().toISOString()})}finally{n(!1)}},h=async()=>{n(!0),d(null);try{console.log(" Testing simple notification insertion...");const p=await kb(s);d({success:p.success,message:p.success?"   ":"   ",error:p.error||null,data:p.data||null,timestamp:new Date().toISOString()})}catch(p){d({success:!1,message:"    ",error:String(p),timestamp:new Date().toISOString()})}finally{n(!1)}},f=async()=>{n(!0),l(null);try{console.log(" Running comprehensive diagnostics...");const p=await s5(s);l(p)}catch(p){l({error:"   ",details:String(p),timestamp:new Date().toISOString()})}finally{n(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",dir:"rtl",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{className:"text-2xl",children:"  "}),e.jsx(Ze,{children:"     "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{htmlFor:"storeId",children:"  "}),e.jsx(it,{id:"storeId",value:s,onChange:p=>t(p.target.value),placeholder:"  "})]}),e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx(L,{onClick:m,disabled:r||!s,children:r?" ...":"  "}),e.jsx(L,{onClick:h,disabled:r||!s,variant:"outline",children:r?" ...":" "}),e.jsx(L,{onClick:f,disabled:r,variant:"secondary",children:r?" ...":" "})]})]})]}),c&&e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{className:c.success?"text-green-600":"text-red-600",children:c.success?"  ":"  "})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",c.message]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",new Date(c.timestamp).toLocaleString("ar")]}),c.error&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded",children:[e.jsx("p",{className:"text-red-800",children:e.jsx("strong",{children:" :"})}),e.jsx("pre",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:typeof c.error=="string"?c.error:JSON.stringify(c.error,null,2)})]}),c.data&&e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded",children:[e.jsx("p",{className:"text-green-800",children:e.jsx("strong",{children:" :"})}),e.jsx("pre",{className:"text-sm text-green-600 mt-1 whitespace-pre-wrap",children:JSON.stringify(c.data,null,2)})]})]})})]}),a&&e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"  "})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-4",children:a.error?e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded",children:[e.jsx("p",{className:"text-red-800",children:a.error}),a.details&&e.jsx("pre",{className:"text-sm text-red-600 mt-2 whitespace-pre-wrap",children:a.details})]}):e.jsx("pre",{className:"text-sm bg-gray-100 p-4 rounded whitespace-pre-wrap overflow-x-auto",children:JSON.stringify(a,null,2)})})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"   "})}),e.jsx(M,{children:e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsx("li",{children:"     notifications   "}),e.jsx("li",{children:"      notifications"}),e.jsx("li",{children:"   Supabase "}),e.jsx("li",{children:"      "}),e.jsx("li",{children:"  Developer Tools     Console"})]})})]})]})})},n5=()=>{const[s,t]=x.useState(!1),[r,n]=x.useState([]),a=d=>{n(m=>[...m,`${new Date().toLocaleTimeString()}: ${d}`])},l=async()=>{t(!0),n([]),a("    ...");try{a("   ...");const d=await ys.sendNotification({storeId:"test-store-debug",title:" ",message:"      ",type:"general",priority:"low"});a(d?"   ":"   "),a("   ...");const m=await ys.notifyNewOrder("test-store-debug","TEST-"+Date.now()," ","order-"+Date.now());a(m?"   ":"   "),a("   ...");const h=await ys.sendSystemNotification("test-store-debug","  ","    ");a(h?"   ":"   "),a("   ")}catch(d){a(`   : ${Mt(d,"  ")}`),console.error("Test error:",Mt(d,"  "),d),Rb(d,"Notification test error")}finally{t(!1)}},c=()=>{n([])};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",dir:"rtl",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{className:"text-2xl",children:"  "})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx(L,{onClick:l,disabled:s,size:"lg",children:s?" ...":"  "}),e.jsx(L,{onClick:c,variant:"outline",disabled:s,children:" "})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{children:"        ."}),e.jsx("p",{children:" Developer Console   ."})]})]})]}),r.length>0&&e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"  "})}),e.jsx(M,{children:e.jsx("div",{className:"bg-black text-green-400 p-4 rounded font-mono text-sm max-h-96 overflow-y-auto",children:r.map((d,m)=>e.jsx("div",{className:"mb-1",children:d},m))})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsxs(M,{className:"space-y-2 text-sm",children:[e.jsx("p",{children:"1.  Developer Tools (F12)"}),e.jsx("p",{children:"2.   Console tab"}),e.jsx("p",{children:'3.   " "'}),e.jsx("p",{children:"4.    Console    "}),e.jsx("p",{children:'5.    "[object Object]"    '})]})]})]})})};async function i5(){try{console.log("    order_store_history...");const s=`
      CREATE TABLE IF NOT EXISTS order_store_history (
        id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
        order_id UUID NOT NULL REFERENCES orders(id) ON DELETE CASCADE,
        from_store_id UUID REFERENCES stores(id) ON DELETE SET NULL,
        to_store_id UUID NOT NULL REFERENCES stores(id) ON DELETE CASCADE,
        transfer_reason TEXT,
        transferred_by TEXT,
        transferred_at TIMESTAMPTZ DEFAULT NOW(),
        created_at TIMESTAMPTZ DEFAULT NOW()
      );

      --  
      CREATE INDEX IF NOT EXISTS idx_order_store_history_order_id ON order_store_history(order_id);
      CREATE INDEX IF NOT EXISTS idx_order_store_history_from_store ON order_store_history(from_store_id);
      CREATE INDEX IF NOT EXISTS idx_order_store_history_to_store ON order_store_history(to_store_id);
    `,{error:t}=await I.rpc("exec_sql",{sql_query:s});return t?(console.error("     :",t),{success:!1,error:t.message}):(console.log("    order_store_history "),{success:!0})}catch(s){return console.error("      :",s),{success:!1,error:s instanceof Error?s.message:"  "}}}async function a5(){try{console.log("    orders ...");const s=["ALTER TABLE orders ADD COLUMN IF NOT EXISTS store_response_status TEXT","ALTER TABLE orders ADD COLUMN IF NOT EXISTS store_response_at TIMESTAMPTZ","ALTER TABLE orders ADD COLUMN IF NOT EXISTS rejection_reason TEXT","ALTER TABLE orders ADD COLUMN IF NOT EXISTS assigned_store_name TEXT","ALTER TABLE orders ADD COLUMN IF NOT EXISTS shipping_type TEXT","ALTER TABLE orders ADD COLUMN IF NOT EXISTS customer_rejected BOOLEAN DEFAULT false","ALTER TABLE orders ADD COLUMN IF NOT EXISTS return_reason TEXT","ALTER TABLE orders ADD COLUMN IF NOT EXISTS is_returned BOOLEAN DEFAULT false","ALTER TABLE orders ADD COLUMN IF NOT EXISTS discounted_price NUMERIC"];for(const t of s){const{error:r}=await I.rpc("exec_sql",{sql_query:t});r&&!r.message.includes("already exists")&&console.warn(`  : ${t}`,r.message)}return console.log("  /  orders"),{success:!0}}catch(s){return console.error("     orders:",s),{success:!1,error:s instanceof Error?s.message:"  "}}}async function o5(){console.log("     ...");const s=[],t=await a5();!t.success&&t.error&&s.push(` Orders: ${t.error}`);const r=await i5();!r.success&&r.error&&s.push(` : ${r.error}`);const n=s.length===0;return n?console.log("    "):console.log("    :",s),{success:n,errors:s}}async function l5(){try{console.log("        orders...");const{data:s,error:t}=await I.from("orders").select("id").limit(1);if(t)return{success:!1,error:`   : ${t.message}`};if(!s||s.length===0)return{success:!1,error:"   "};const r=s[0].id,{error:n}=await I.from("orders").update({store_response_status:"test_response",store_response_at:new Date().toISOString(),rejection_reason:null}).eq("id",r);return n?{success:!1,error:n.message}:(console.log("        orders"),{success:!0})}catch(s){return console.error("   :",s),{success:!1,error:s instanceof Error?s.message:"  "}}}async function c5(){try{console.log("   ...");const{data:s,error:t}=await I.from("orders").select("id, assigned_store_id, customer_name").eq("order_status","assigned").limit(1);if(t)return{success:!1,error:`     : ${t.message}`};if(!s||s.length===0)return{success:!1,error:"   "};const r=s[0];return console.log("  :",r),{success:!0,data:{message:"   ",testOrder:r}}}catch(s){return console.error("     :",s),{success:!1,error:s instanceof Error?s.message:"  "}}}async function d5(){try{console.log("   ...");const s={customer_name:" ",customer_phone:"+964 771 234 5678",customer_address:"   ",customer_city:"",total_amount:205e3,subtotal:205e3,customer_notes:"  ",order_status:"assigned",order_code:`TEST-${Date.now()}`,items:[{name:"Intel Core i5-14400F Desktop Processor",quantity:1,price:205e3}]},{data:t,error:r}=await I.from("orders").insert(s).select().single();if(r)return console.error("    :",r),{success:!1,error:r.message};console.log("    :",t);const n=[{order_id:t.id,product_name:"Intel Core i5-14400F Desktop Processor",quantity:1,price:205e3,availability_status:"pending"}],{data:a,error:l}=await I.from("order_items").insert(n).select();return l?(console.error("     :",l),await I.from("orders").delete().eq("id",t.id),{success:!1,error:l.message}):(console.log("    :",a),{success:!0,orderId:t.id})}catch(s){return console.error("      :",s),{success:!1,error:s instanceof Error?s.message:"  "}}}async function u5(s,t){try{console.log("   :",{orderId:s,storeId:t});const{data:r,error:n}=await I.from("orders").update({assigned_store_id:t,order_status:"assigned"}).eq("id",s).select();return n?(console.error("    :",n),{success:!1,error:n.message}):(console.log("    :",r),{success:!0})}catch(r){return console.error("     :",r),{success:!1,error:r instanceof Error?r.message:"  "}}}async function h5(){try{const{data:s,error:t}=await I.from("stores").select("id, name").limit(10);return t?(console.error("    :",t),[]):s||[]}catch(s){return console.error("     :",s),[]}}async function m5(s){try{const t=await d5();if(!t.success||!t.orderId)return t;if(s){const r=await u5(t.orderId,s);if(!r.success)return{success:!1,error:`     : ${r.error}`}}return{success:!0,orderId:t.orderId}}catch(t){return console.error("     :",t),{success:!1,error:t instanceof Error?t.message:"  "}}}const f5=()=>{const[s,t]=x.useState([]),[r,n]=x.useState(!1),{toast:a}=Xe(),l=["orders","stores","order_items"],c=async()=>{n(!0);const p=[];for(const w of l)try{console.log(`  : ${w}`);const{count:v,error:j}=await I.from(w).select("*",{count:"exact",head:!0});if(j){console.error(`    ${w}:`,j),p.push({name:w,exists:!1,error:j.message});continue}const{data:y,error:b}=await I.from(w).select("*").limit(3);p.push({name:w,exists:!0,count:v||0,sampleData:y||[],error:b?.message}),console.log(`  ${w}: ${v} `)}catch(v){console.error(`     ${w}:`,v),p.push({name:w,exists:!1,error:v instanceof Error?v.message:"  "})}t(p),n(!1)},d=async()=>{const p=await l5();p.success?a({title:" ",description:"     "}):a({title:" ",description:p.error||"  ",variant:"destructive"})},m=async()=>{n(!0),a({title:" ",description:"   ..."});const p=await o5();p.success?(a({title:"  ",description:"    "}),await c()):a({title:" ",description:`: ${p.errors.join(", ")}`,variant:"destructive"}),n(!1)},h=async()=>{const p=await c5();p.success?a({title:"  ",description:"    "}):a({title:"   ",description:p.error||"  ",variant:"destructive"})},f=async()=>{n(!0);try{const w=(await h5())[0];if(!w){a({title:"  ",description:"     ",variant:"destructive"});return}const v=await m5(w.id);v.success?(a({title:"   ",description:`      ${w.name}`}),await c()):a({title:"  ",description:v.error||"  ",variant:"destructive"})}catch(p){a({title:"   ",description:p instanceof Error?p.message:"  ",variant:"destructive"})}finally{n(!1)}};return x.useEffect(()=>{c()},[]),e.jsxs("div",{className:"p-6 max-w-6xl mx-auto",dir:"rtl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold text-primary mb-2 flex items-center gap-3",children:[e.jsx(Hs,{className:"w-8 h-8"}),"  "]}),e.jsx("p",{className:"text-muted-foreground",children:"      "})]}),e.jsxs("div",{className:"grid gap-4 mb-6",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(tE,{className:"w-5 h-5"})," "]})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-4",children:r?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),"  ..."]}):e.jsx(e.Fragment,{children:s.map(p=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[p.exists?e.jsx(Se,{className:"w-5 h-5 text-green-600"}):e.jsx(lt,{className:"w-5 h-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:p.name}),p.error&&e.jsx("p",{className:"text-sm text-red-600",children:p.error})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[p.exists&&e.jsxs(Q,{variant:"secondary",children:[p.count," "]}),e.jsx(Q,{variant:p.exists?"default":"destructive",children:p.exists?"":""})]})]},p.name))})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"w-5 h-5"})," "]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(L,{onClick:c,disabled:r,className:"w-full",children:[e.jsx(Hs,{className:"w-4 h-4 mr-2"}),"  "]}),e.jsxs(L,{onClick:m,disabled:r,variant:"default",className:"w-full bg-green-600 hover:bg-green-700",children:[e.jsx(aE,{className:"w-4 h-4 mr-2"}),"  "]}),e.jsxs(L,{onClick:d,variant:"outline",className:"w-full",children:[e.jsx(Cd,{className:"w-4 h-4 mr-2"}),"   "]}),e.jsxs(L,{onClick:h,variant:"secondary",className:"w-full",children:[e.jsx(nt,{className:"w-4 h-4 mr-2"}),"  "]}),e.jsxs(L,{onClick:f,disabled:r,variant:"outline",className:"w-full bg-purple-50 hover:bg-purple-100",children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"  "]})]})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"  "})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," orders, stores, order_items"]}),e.jsxs("p",{children:[e.jsx("strong",{children:" orders:"}),"       "]}),e.jsxs("p",{children:[e.jsx("strong",{children:" stores:"}),"   "]}),e.jsxs("p",{children:[e.jsx("strong",{children:" order_items:"}),"    "]})]})})]})]})]}),s.length>0&&e.jsx("div",{className:"grid gap-4",children:s.filter(p=>p.exists&&p.sampleData&&p.sampleData.length>0).map(p=>e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{children:["   ",p.name]})}),e.jsx(M,{children:e.jsx("pre",{className:"bg-gray-100 p-3 rounded text-xs overflow-auto",children:JSON.stringify(p.sampleData,null,2)})})]},p.name))})]})},nl=[{name:"  55  QLED",name_en:"Samsung 55 QLED TV",price:12e5,main_store_name:"hawranj",description:"   4K   QLED"},{name:"   HP",name_en:"HP Laptop",price:85e4,main_store_name:"hawranj",description:" HP  Intel i5  8GB"},{name:"  14",name_en:"iPhone 14",price:15e5,main_store_name:"hawranj",description:"     "},{name:"  LG 1.5 ",name_en:"LG Air Conditioner 1.5 Ton",price:75e4,main_store_name:"hawranj",description:"   "},{name:"  18 ",name_en:"Samsung Refrigerator 18 ft",price:95e4,main_store_name:"hawranj",description:"    "},{name:" LG  9 ",name_en:"LG Washing Machine 9kg",price:65e4,main_store_name:"hawranj",description:"   9 "},{name:"  4  ",name_en:"4 Burner Gas Stove Stainless",price:28e4,main_store_name:"hawranj",description:"    "},{name:" JBL ",name_en:"JBL Bluetooth Speaker",price:12e4,main_store_name:"hawranj",description:"   "}];async function Pb(){try{console.log("    ...");const{data:s,error:t}=await I.from("products").upsert(nl,{onConflict:"name",ignoreDuplicates:!1}).select();return t?(console.error("    :",t),{success:!1,error:t.message}):(console.log("    :",s?.length||0),{success:!0,created:s?.length||0})}catch(s){return console.error("     :",s),{success:!1,error:s instanceof Error?s.message:"  "}}}async function Ib(){try{console.log("      ...");const{data:s,error:t}=await I.from("orders").select("id, items, order_code").limit(50);if(t)throw t;if(!s||s.length===0)return{success:!0,updated:0};let r=0;for(const n of s)try{let a=!1;const l=nl[Math.floor(Math.random()*nl.length)];let c=n.items;if(n.items&&Array.isArray(n.items)?(c=n.items.map(d=>({...d,name:l.name,price:l.price,product_id:Math.floor(Math.random()*1e3)+1})),a=!0):(c=[{name:l.name,price:l.price,quantity:1,product_id:Math.floor(Math.random()*1e3)+1}],a=!0),a){const{error:d}=await I.from("orders").update({items:c,total_amount:l.price,subtotal:l.price}).eq("id",n.id);d?console.error(`     ${n.order_code}:`,d):(r++,console.log(`    ${n.order_code} : ${l.name}`))}}catch(a){console.error(`     ${n.id}:`,a)}return console.log(`   ${r}    `),{success:!0,updated:r}}catch(s){return console.error("     :",s),{success:!1,error:s instanceof Error?s.message:"  "}}}async function Ab(){try{console.log("   order_items   ...");const{data:s,error:t}=await I.from("order_items").select("id, product_name, price, order_id").limit(100);if(t)return console.log("  order_items    :",t.message),{success:!0,updated:0};if(!s||s.length===0)return{success:!0,updated:0};let r=0;for(const n of s)try{const a=nl[Math.floor(Math.random()*nl.length)],{error:l}=await I.from("order_items").update({product_name:a.name,price:a.price}).eq("id",n.id);l?console.error(`    order_item ${n.id}:`,l):(r++,console.log(`   order_item ${n.id} : ${a.name}`))}catch(a){console.error(`    order_item ${n.id}:`,a)}return console.log(`   ${r} order_item   `),{success:!0,updated:r}}catch(s){return console.error("     order_items:",s),{success:!1,error:s instanceof Error?s.message:"  "}}}async function Db(){console.log("     ...");const s={products:await Pb(),orders:await Ib(),orderItems:await Ab()};return s.products.success&&s.orders.success&&s.orderItems.success?(console.log("      !"),{success:!0,results:s}):(console.log("      "),{success:!1,results:s})}const jd=["  55  QLED 4K","   HP Pavilion 15","  14  128GB","  LG  1.5 ","    18 "," LG  9  ","  4   "," JBL  ","   25 ","  KDK 56 "];async function p5(){try{console.log("     ...");const{data:s,error:t}=await I.from("orders").select("id, items, order_code, order_status").eq("order_status","assigned").limit(10);if(t)throw t;if(!s||s.length===0)return console.log("     "),{success:!0,updated:0};let r=0;for(const n of s)try{const a=jd[Math.floor(Math.random()*jd.length)],l=Math.floor(Math.random()*1e6)+2e5;let c=[];n.items&&Array.isArray(n.items)&&n.items.length>0?c=n.items.map((m,h)=>({...m,name:`${a} ${h>0?`-  ${h+1}`:""}`,product_name:`${a} ${h>0?`-  ${h+1}`:""}`,price:l,quantity:m.quantity||1,product_id:h+1})):c=[{name:a,product_name:a,price:l,quantity:1,product_id:1}];const{error:d}=await I.from("orders").update({items:c,total_amount:l,subtotal:l}).eq("id",n.id);d?console.error(`     ${n.order_code}:`,d):(r++,console.log(`    ${n.order_code} : ${a}`))}catch(a){console.error(`     ${n.id}:`,a)}return console.log(`   ${r}    `),{success:!0,updated:r}}catch(s){return console.error("     :",s),{success:!1,updated:0,error:s instanceof Error?s.message:"  "}}}async function g5(){try{console.log("   order_items...");const{data:s,error:t}=await I.from("order_items").select("*").limit(20);if(t)return console.log("  order_items    :",t.message),{success:!0,updated:0};if(!s||s.length===0)return console.log("     order_items"),{success:!0,updated:0};let r=0;for(const n of s)try{const a=jd[Math.floor(Math.random()*jd.length)],l=Math.floor(Math.random()*1e6)+2e5,{error:c}=await I.from("order_items").update({product_name:a,price:l}).eq("id",n.id);c?console.error(`    order_item ${n.id}:`,c):(r++,console.log(`   order_item ${n.id} : ${a}`))}catch(a){console.error(`    order_item ${n.id}:`,a)}return console.log(`   ${r} order_item`),{success:!0,updated:r}}catch(s){return console.error("     order_items:",s),{success:!1,updated:0,error:s instanceof Error?s.message:"  "}}}const x5=()=>{const[s,t]=x.useState([]),[r,n]=x.useState(!1),[a,l]=x.useState(!1),[c,d]=x.useState(!1),{toast:m}=Xe(),h=async()=>{n(!0),t([]);const j=[];try{console.log("   orders...");try{const{data:y,error:b}=await I.from("orders").select("id, customer_name, items, order_details, order_code, order_status, total_amount").limit(5);if(b)throw b;j.push({type:"orders",title:` Orders (${y?.length||0} )`,data:y?.map(C=>({id:C.id,customer_name:C.customer_name,order_code:C.order_code,order_status:C.order_status,total_amount:C.total_amount,items:C.items,items_count:Array.isArray(C.items)?C.items.length:" ",items_sample:Array.isArray(C.items)?C.items.slice(0,2):C.items})),status:"success"})}catch(y){j.push({type:"orders",title:"   Orders",data:null,error:y.message,status:"error"})}console.log("   products...");try{const{data:y,error:b}=await I.from("products").select("id, name, name_en, main_store_name, price").limit(5);if(b)throw b;j.push({type:"products",title:` Products (${y?.length||0} )`,data:y,status:"success"})}catch(y){j.push({type:"products",title:"   Products",data:null,error:y.message,status:"error"})}console.log("   order_items...");try{const{data:y,error:b}=await I.from("order_items").select("*").limit(5);if(b)throw b;j.push({type:"order_items",title:` Order Items (${y?.length||0} )`,data:y,status:"success"})}catch(y){j.push({type:"order_items",title:" Order Items  ",data:null,error:y.message,status:"warning"})}console.log("   get_orders_with_products...");try{const{data:y,error:b}=await I.rpc("get_orders_with_products");if(b)throw b;j.push({type:"rpc",title:` RPC (${y?.length||0} )`,data:y?.slice(0,3),status:"success"})}catch(y){j.push({type:"rpc",title:" RPC  ",data:null,error:y.message,status:"warning"})}console.log("   ...");try{const{data:y,error:b}=await I.from("orders").select("id, order_code, items, order_status, customer_name").eq("order_status","assigned").limit(3);if(b)throw b;const C=y?.map(E=>{let S=" ",O=!1;return E.items&&Array.isArray(E.items)&&(S=`${E.items.length} `,O=E.items.some(R=>R.name&&R.name.trim()!==""&&R.name!=="  "&&R.name!=="Intel Core i5-14400F Desktop Processor")),{...E,items_analysis:S,has_valid_product_names:O,sample_items:Array.isArray(E.items)?E.items.slice(0,2):E.items}});j.push({type:"assigned_orders",title:`  (${y?.length||0} )`,data:C,status:"success"})}catch(y){j.push({type:"assigned_orders",title:"    ",data:null,error:y.message,status:"error"})}}catch(y){j.push({type:"general",title:"     ",data:null,error:y.message,status:"error"})}t(j),n(!1)},f=async()=>{l(!0);try{m({title:" ",description:"     ..."});const j=await Db();j.success?(m({title:" ! ",description:`    ${j.results?.orders?.updated||0} `}),await h()):m({title:"    ",description:"       ",variant:"destructive"})}catch(j){m({title:"  ",description:j instanceof Error?j.message:"  ",variant:"destructive"})}finally{l(!1)}},p=async()=>{d(!0);try{m({title:"  ",description:"      ..."});const j=await p5(),y=await g5(),b=j.updated+y.updated;j.success&&y.success?(m({title:"  ! ",description:`  ${b}    `}),await h()):m({title:"   ",description:`  ${b}     `,variant:"destructive"})}catch(j){m({title:"  ",description:j instanceof Error?j.message:"  ",variant:"destructive"})}finally{d(!1)}},w=j=>{switch(j){case"orders":return e.jsx(xm,{className:"w-4 h-4"});case"products":return e.jsx(Me,{className:"w-4 h-4"});case"order_items":return e.jsx(Hs,{className:"w-4 h-4"});case"rpc":return e.jsx(ft,{className:"w-4 h-4"});case"assigned_orders":return e.jsx(xm,{className:"w-4 h-4"});default:return e.jsx(Bt,{className:"w-4 h-4"})}},v=j=>{switch(j){case"success":return"default";case"error":return"destructive";case"warning":return"secondary";default:return"secondary"}};return e.jsxs("div",{className:"space-y-6 p-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"  "}),e.jsx("p",{className:"text-muted-foreground",children:"       "})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(L,{onClick:h,disabled:r||a||c,className:"gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"})," ..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Hs,{className:"w-4 h-4"})," "]})}),e.jsx(L,{onClick:p,disabled:r||a||c,variant:"outline",className:"gap-2 bg-green-50 hover:bg-green-100 border-green-300 text-green-700",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"})," ..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"w-4 h-4"}),"  "]})}),e.jsxs(L,{onClick:()=>window.open("/store-dashboard","_blank"),disabled:r||a||c,variant:"outline",className:"gap-2 bg-blue-50 hover:bg-blue-100 border-blue-300 text-blue-700",children:[e.jsx(Me,{className:"w-4 h-4"})," "]}),e.jsx(L,{onClick:f,disabled:r||a||c,variant:"secondary",className:"gap-2",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"})," ..."]}):e.jsxs(e.Fragment,{children:[e.jsx(iE,{className:"w-4 h-4"}),"  "]})})]})]}),s.map((j,y)=>e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[w(j.type),j.title,e.jsx(Q,{variant:v(j.status),children:j.status==="success"?"":j.status==="error"?"":""})]})}),e.jsx(M,{children:j.error?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-800 text-sm",children:j.error})}):e.jsx("div",{className:"bg-gray-50 border rounded-lg p-3",children:e.jsx("pre",{className:"text-xs overflow-auto max-h-64 whitespace-pre-wrap",children:JSON.stringify(j.data,null,2)})})})]},y)),s.length===0&&!r&&e.jsx($,{children:e.jsxs(M,{className:"p-8 text-center",children:[e.jsx(Hs,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:'  " "   '})]})})]})},v5=()=>e.jsx(x5,{});function y5({order:s}){const[t,r]=x.useState(!1),[n,a]=x.useState(""),[l,c]=x.useState(""),[d,m]=x.useState(""),[h,f]=x.useState(!1),{toast:p}=Xe(),{t:w}=us(),v=async()=>{r(!0),c("");try{if(!s.assigned_store_id)throw new Error("    ");console.log(" Updating order store response:",{orderId:s.id,storeId:s.assigned_store_id,status:"accepted"});const S=await Fa({orderId:s.id,storeId:s.assigned_store_id,status:"accepted",rejectionReason:void 0});S.success?(m("      -   "),p({title:" ",description:"      -      "})):(c("   "),p({title:"",description:S.error||"   ",variant:"destructive"}))}catch{c("   "),p({title:"",description:"   ",variant:"destructive"})}r(!1)},j=async()=>{if(!n.trim()){c("   ");return}r(!0),c("");try{if(!s.assigned_store_id)throw new Error("    ");console.log(" Updating order store response (reject):",{orderId:s.id,storeId:s.assigned_store_id,status:"rejected",rejectionReason:n});const S=await Fa({orderId:s.id,storeId:s.assigned_store_id,status:"rejected",rejectionReason:n});S.success?(m("      -     "),p({title:" ",description:"      -    ",variant:"destructive"}),f(!1),a("")):(c("   "),p({title:"",description:S.error||"   ",variant:"destructive"}))}catch{c("   "),p({title:"",description:"   ",variant:"destructive"})}r(!1)},y=()=>{f(!0),c(""),m("")},b=()=>s.order_items&&s.order_items.length>0?s.order_items.map(S=>S.product_name).join(", "):`  ${s.order_code||s.id.slice(0,8)}`,C=S=>(S.order_details||"").includes("    "),E=S=>{const R=(S.order_details||"").match(/     (\S+)/);return R?R[1]:null};return e.jsxs("div",{className:"max-w-xl mx-auto mt-6 p-4 bg-white rounded-2xl shadow space-y-4 text-right",dir:"rtl",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:" "}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",s.order_code||s.id.slice(0,8)]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",s.customer_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",s.customer_phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",b()]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",Ut(s.total_amount)]}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",s.store_response_status==="accepted"?" ":s.store_response_status==="available"?"  - ":s.store_response_status==="rejected"?" ":s.store_response_status==="unavailable"?"  -  ":"  "]}),!1]}),!s.store_response_status&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 justify-end mt-4",children:[e.jsxs(L,{onClick:v,disabled:t,className:"bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-xl",children:[" ",w("available")]}),e.jsxs(L,{onClick:y,disabled:t,className:"bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-xl",children:[" ",w("unavailable")]})]}),h&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(et,{className:"block text-sm mt-2 font-medium text-gray-700",children:"  ():"}),e.jsx(Ar,{className:"w-full border rounded-xl mt-1 p-2",rows:3,placeholder:":    ",value:n,onChange:S=>a(S.target.value)})]}),e.jsxs("div",{className:"flex gap-2 justify-end mt-3",children:[e.jsx(L,{variant:"outline",onClick:()=>{f(!1),a(""),c("")},disabled:t,className:"py-2 px-4 rounded-xl",children:""}),e.jsx(L,{onClick:j,disabled:t||!n.trim(),className:"bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-xl",children:t?" ...":" "})]})]})]}),l&&e.jsx("div",{className:"text-red-600 font-bold bg-red-50 p-3 rounded-lg",children:l}),d&&e.jsx("div",{className:"text-green-600 font-bold bg-green-50 p-3 rounded-lg",children:d}),C(s)&&E(s)&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-sm font-semibold mb-2 text-gray-700",children:"   :"}),e.jsx(rl,{originalOrderId:E(s),autoRefresh:!0,showDetails:!1}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"           "})]})]})}const j5=()=>{const s=[{id:"1",order_code:"ORD-001",customer_name:"  ",customer_phone:"+964 750 123 4567",customer_address:"   ",total_amount:15e4,store_response_status:null,order_items:[{product_name:"  55  QLED",quantity:1,price:15e4}]},{id:"2",order_code:"ORD-002",customer_name:" ",customer_phone:"+964 770 987 6543",customer_address:"   ",total_amount:85e3,store_response_status:"accepted",order_items:[{product_name:"   HP",quantity:1,price:85e3}]},{id:"3",order_code:"ORD-003",customer_name:" ",customer_phone:"+964 780 555 1234",customer_address:"   ",total_amount:12e4,store_response_status:"rejected",order_items:[{product_name:"  LG 1.5 ",quantity:1,price:12e4}]}];return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",dir:"rtl",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx($,{className:"mb-8",children:e.jsxs(q,{children:[e.jsx(V,{className:"text-2xl font-bold text-center text-blue-800",children:"    "}),e.jsx("p",{className:"text-center text-gray-600",children:"         "})]})}),e.jsx("div",{className:"space-y-8",children:s.map((t,r)=>e.jsxs($,{className:"shadow-lg border-2 border-blue-200",children:[e.jsx(q,{children:e.jsxs(V,{className:"text-lg text-blue-700",children:["  ",r+1," -",t.store_response_status===null&&" ( -  )",t.store_response_status==="accepted"&&" ( )",t.store_response_status==="rejected"&&" ( )"]})}),e.jsx(M,{children:e.jsx(y5,{order:t})})]},t.id))}),e.jsx($,{className:"mt-8 bg-blue-50 border-blue-200",children:e.jsxs(M,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-blue-800 mb-4",children:" :"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold",children:" :"}),e.jsx("span",{children:' store_response_status  "accepted"    store_response_at'})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-red-600 font-bold",children:"  :"}),e.jsx("span",{children:'       store_response_status = "rejected" rejection_reason'})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 font-bold",children:"  :"}),e.jsx("span",{children:'   " " -     '})]})]})]})})]})})},w5=()=>{const[s,t]=x.useState([]),[r,n]=x.useState([]),[a,l]=x.useState(!1),c=async()=>{l(!0);try{const{data:m,error:h}=await I.from("orders").select(`
          id,
          order_code,
          customer_name,
          order_status,
          assigned_store_id,
          items,
          order_items:order_items(
            id,
            product_name,
            quantity,
            price,
            order_id
          )
        `).eq("order_status","assigned").order("created_at",{ascending:!1}).limit(5);h?console.error("   :",h):(console.log(" :",m),t(m||[]));const{data:f,error:p}=await I.from("order_items").select("*").order("created_at",{ascending:!1}).limit(10);p?console.error("    order_items:",{message:p.message||String(p),code:p.code,details:p.details,hint:p.hint}):(console.log(" order_items:",f),n(f||[]))}catch(m){console.error("  :",m)}l(!1)},d=async()=>{try{const m=["  55  QLED 4K"," HP Pavilion 15.6 "," iPhone 14 Pro Max 256GB","  LG 2.25  ","   18 "];for(let h=0;h<Math.min(r.length,m.length);h++){const f=r[h],p=m[h],{error:w}=await I.from("order_items").update({product_name:p}).eq("id",f.id);w?console.error(`    ${f.id}:`,w):console.log(`   ${f.id}  : ${p}`)}alert("   !   ."),c()}catch(m){console.error("    :",m)}};return x.useEffect(()=>{c()},[]),e.jsxs("div",{className:"p-6 max-w-6xl mx-auto",dir:"rtl",children:[e.jsx($,{className:"mb-6",children:e.jsxs(q,{children:[e.jsx(V,{children:"  "}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{onClick:c,disabled:a,children:a?" ...":" "}),e.jsx(L,{onClick:d,variant:"outline",children:"   "})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{children:["  (",s.length,")"]})}),e.jsx(M,{children:s.map(m=>e.jsxs("div",{className:"border p-3 mb-3 rounded",children:[e.jsxs("div",{className:"font-bold",children:[": ",m.order_code]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[": ",m.customer_name]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[": ",m.assigned_store_id]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("strong",{children:["order_items (",m.order_items?.length||0,"):"]}),m.order_items&&m.order_items.length>0?e.jsx("ul",{className:"list-disc list-inside ml-4 text-sm",children:m.order_items.map((h,f)=>e.jsxs("li",{children:[e.jsx("strong",{children:"product_name:"}),' "',h.product_name||"",'" |',e.jsx("strong",{children:" :"})," ",h.price," |",e.jsx("strong",{children:" :"})," ",h.quantity]},f))}):e.jsx("span",{className:"text-red-500 text-sm",children:"  order_items"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("strong",{children:"items (JSON):"}),e.jsx("pre",{className:"text-xs bg-gray-100 p-2 rounded mt-1 overflow-auto",children:JSON.stringify(m.items,null,2)})]})]},m.id))})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{children:[" order_items (",r.length,")"]})}),e.jsx(M,{children:r.map(m=>e.jsxs("div",{className:"border p-3 mb-3 rounded",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"ID:"})," ",m.id," |",e.jsx("strong",{children:" Order ID:"})," ",m.order_id]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"product_name:"}),e.jsxs("span",{className:m.product_name?"text-green-600":"text-red-500",children:['"',m.product_name||"",'"']})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:":"})," ",m.price," |",e.jsx("strong",{children:" :"})," ",m.quantity]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[" : ",new Date(m.created_at).toLocaleString("ar-EG")]})]},m.id))})]})]})]})};function _5(){const[s,t]=x.useState([]),[r,n]=x.useState(!1),[a,l]=x.useState(""),c=async()=>{n(!0);try{const{data:m,error:h}=await I.from("orders").select("id, order_code, items").order("created_at",{ascending:!1}).limit(10);if(h)throw h;const{data:f,error:p}=await I.from("order_items").select("*").order("created_at",{ascending:!1});p&&console.warn(" order_items  :",p.message);const w=m?.map(v=>{const j=Array.isArray(v.items)?v.items:[],y=f?.filter(S=>S.order_id===v.id)||[],b=j.map(S=>S.product_name||S.name||"").filter(S=>S&&S.trim()!==""),C=y.map(S=>S.product_name||"").filter(S=>S&&S.trim()!==""),E=[];return j.length===0&&y.length===0&&E.push("      "),b.some(S=>S===""||S==="  ")&&E.push("    JSON"),C.some(S=>S===""||S==="  ")&&E.push("    "),j.length>0&&y.length>0&&b.length!==C.length&&E.push("     "),{order_id:v.id,order_code:v.order_code||" ",items_from_json:j,order_items_from_table:y,analysis:{json_items_count:j.length,table_items_count:y.length,product_names_in_json:b,product_names_in_table:C,issues:E}}})||[];t(w)}catch(m){console.error("   :",m)}finally{n(!1)}},d=async m=>{try{const{data:h,error:f}=await I.from("orders").select("*").eq("id",m).single();if(f)throw f;const p=Array.isArray(h.items)?h.items:[];if(p.length>0){for(let w=0;w<p.length;w++){const v=p[w],j=v.product_name||v.name||` ${w+1}`,{error:y}=await I.from("order_items").upsert({order_id:m,product_name:j,quantity:v.quantity||1,price_sar:v.price||0,discounted_price:v.discounted_price||null},{onConflict:"order_id,product_name"});y&&console.error("    :",y)}console.log("    "),await c()}}catch(h){console.error("    :",h)}};return x.useEffect(()=>{c()},[]),e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"    "})}),e.jsxs(M,{children:[e.jsx("div",{className:"flex gap-4 mb-4",children:e.jsx(L,{onClick:c,disabled:r,children:r?" ...":" "})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:" :"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"  "}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.length})]}),e.jsxs("div",{className:"p-4 bg-red-50 rounded",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"  "}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.filter(m=>m.analysis.issues.length>0).length})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded",children:[e.jsx("div",{className:"text-sm text-gray-600",children:" "}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.filter(m=>m.analysis.issues.length===0).length})]})]})]})]})]}),e.jsx("div",{className:"space-y-4",children:s.map((m,h)=>e.jsxs($,{className:m.analysis.issues.length>0?"border-red-200":"border-green-200",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex justify-between items-center",children:[e.jsxs("span",{children:[" ",m.order_code," - ",m.order_id.slice(0,8)]}),m.analysis.issues.length>0&&e.jsx(L,{size:"sm",onClick:()=>d(m.order_id),className:"bg-yellow-500 hover:bg-yellow-600",children:""})]})}),e.jsxs(M,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["  JSON (",m.analysis.json_items_count,")"]}),e.jsx("ul",{className:"text-sm space-y-1",children:m.analysis.product_names_in_json.map((f,p)=>e.jsxs("li",{className:f===""||f==="  "?"text-red-600":"text-green-600",children:[" ",f]},p))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["   (",m.analysis.table_items_count,")"]}),e.jsx("ul",{className:"text-sm space-y-1",children:m.analysis.product_names_in_table.map((f,p)=>e.jsxs("li",{className:f===""||f==="  "?"text-red-600":"text-green-600",children:[" ",f]},p))})]})]}),m.analysis.issues.length>0&&e.jsxs("div",{className:"mt-4 p-3 bg-red-50 rounded",children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:" :"}),e.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:m.analysis.issues.map((f,p)=>e.jsxs("li",{children:[" ",f]},p))})]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-blue-600",children:"  "}),e.jsxs("div",{className:"mt-2 p-3 bg-gray-50 rounded text-xs",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"JSON Items:"}),e.jsx("pre",{className:"mt-1 overflow-auto",children:JSON.stringify(m.items_from_json,null,2)})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Table Items:"}),e.jsx("pre",{className:"mt-1 overflow-auto",children:JSON.stringify(m.order_items_from_table,null,2)})]})]})]})]})]},m.order_id))})]})}function b5(){const[s,t]=x.useState([]),[r,n]=x.useState(!1),[a,l]=x.useState(!1),[c,d]=x.useState({total_orders:0,orders_with_issues:0,total_items_needing_fix:0}),{toast:m}=Xe(),h=async()=>{n(!0);try{const{data:p,error:w}=await I.from("orders").select("id, order_code, items").order("created_at",{ascending:!1}).limit(50);if(w)throw w;const{data:v,error:j}=await I.from("order_items").select("*");j&&console.warn(" order_items  :",j.message);const y=p?.map(E=>{const S=Array.isArray(E.items)?E.items:[],O=v?.filter(P=>P.order_id===E.id)||[],R=[],k=[];return S.forEach((P,F)=>{P.name&&wi(P.name)&&(R.push(` JSON ${F+1}:    `),k.push({field:`items[${F}].name`,old_value:P.name,new_value:Fo(F,E.order_code)})),P.product_name&&wi(P.product_name)&&(R.push(` JSON ${F+1}: product_name  `),k.push({field:`items[${F}].product_name`,old_value:P.product_name,new_value:Fo(F,E.order_code)}))}),O.forEach((P,F)=>{P.product_name&&wi(P.product_name)&&(R.push(`  ${F+1}: product_name  `),k.push({field:`order_items[${P.id}].product_name`,old_value:P.product_name,new_value:Fo(F,E.order_code)}))}),{id:E.id,order_code:E.order_code||" ",items:S,order_items:O,issues:R,suggested_fixes:k}})||[],b=y.filter(E=>E.issues.length>0),C=y.reduce((E,S)=>E+S.suggested_fixes.length,0);t(y),d({total_orders:y.length,orders_with_issues:b.length,total_items_needing_fix:C}),m({title:"  ",description:`  ${y.length}   ${b.length}   `})}catch(p){console.error("   :",p),m({title:"  ",description:"   ",variant:"destructive"})}finally{n(!1)}},f=async()=>{l(!0);let p=0;try{for(const w of s.filter(v=>v.issues.length>0)){if(w.items.length>0){const v=q4(w.items,w.order_code),{error:j}=await I.from("orders").update({items:v}).eq("id",w.id);j?console.error("   :",j):p++}for(const v of w.order_items)if(v.product_name&&wi(v.product_name)){const j=Fo(0,w.order_code),{error:y}=await I.from("order_items").update({product_name:j}).eq("id",v.id);y&&console.error("   :",y)}await new Promise(v=>setTimeout(v,100))}m({title:"  ! ",description:`  ${p}  `}),await h()}catch(w){console.error("    :",w),m({title:"  ",description:"     ",variant:"destructive"})}finally{l(!1)}};return x.useEffect(()=>{h()},[]),e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-6 h-6"}),"  "]})}),e.jsxs(M,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:" "}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.total_orders})]}),e.jsxs("div",{className:"p-4 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"  "}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:c.orders_with_issues})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"  "}),e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:c.total_items_needing_fix})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(L,{onClick:h,disabled:r,variant:"outline",children:[e.jsx(ft,{className:`w-4 h-4 ml-2 ${r?"animate-spin":""}`}),r?" ...":" "]}),c.orders_with_issues>0&&e.jsxs(L,{onClick:f,disabled:a,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Se,{className:`w-4 h-4 ml-2 ${a?"animate-spin":""}`}),a?" ...":` ${c.orders_with_issues} `]})]})]})]}),e.jsx("div",{className:"space-y-4",children:s.filter(p=>p.issues.length>0).map(p=>e.jsxs($,{className:"border-orange-200",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex justify-between items-center",children:[e.jsxs("span",{children:[" ",p.order_code," - ",p.id.slice(0,8)]}),e.jsxs(Q,{variant:"destructive",children:[e.jsx(Bt,{className:"w-3 h-3 ml-1"}),p.issues.length," "]})]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:" :"}),e.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:p.issues.map((w,v)=>e.jsxs("li",{children:[" ",w]},v))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:" :"}),e.jsx("div",{className:"space-y-2",children:p.suggested_fixes.map((w,v)=>e.jsxs("div",{className:"p-2 bg-green-50 rounded text-xs",children:[e.jsx("div",{className:"font-medium",children:w.field}),e.jsxs("div",{className:"text-red-600",children:[': "',w.old_value,'"']}),e.jsxs("div",{className:"text-green-600",children:[': "',w.new_value,'"']})]},v))})]})]})})]},p.id))}),s.filter(p=>p.issues.length===0).length>0&&e.jsxs($,{className:"border-green-200",children:[e.jsx(q,{children:e.jsxs(V,{className:"text-green-800 flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5"}),"  (",s.filter(p=>p.issues.length===0).length,")"]})}),e.jsx(M,{children:e.jsx("p",{className:"text-green-700",children:"        ."})})]})]})}function N5(){const[s,t]=x.useState([]),[r,n]=x.useState(""),[a,l]=x.useState(""),[c,d]=x.useState(!1),m=async()=>{try{const{data:p,error:w}=await I.from("orders").select(`
          id,
          order_code,
          assigned_store_id,
          assigned_store_name,
          store_response_status,
          store_response_at,
          order_status
        `).not("assigned_store_id","is",null).order("created_at",{ascending:!1}).limit(10);if(w)throw w;t(p||[])}catch(p){console.error("   :",p)}},h=async(p,w,v)=>{d(!0);try{console.log("   :",{orderId:p,storeId:w,status:v});const j=await Fa({orderId:p,storeId:w,status:v,rejectionReason:v==="unavailable"?" -  ":void 0});console.log("  :",j),await m(),alert(` : ${j.success?"":""}
${j.error||"  "}`)}catch(j){console.error("  :",j),alert(`: ${j instanceof Error?j.message:"  "}`)}finally{d(!1)}},f=async p=>{try{const{error:w}=await I.from("orders").update({store_response_status:null,store_response_at:null,rejection_reason:null}).eq("id",p);if(w)throw w;await m(),alert("    ")}catch(w){console.error("   :",w),alert("   ")}};return x.useEffect(()=>{m()},[]),e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"   "})}),e.jsxs(M,{children:[e.jsx(L,{onClick:m,className:"mb-4",children:"  "}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"  :"}),s.map(p=>e.jsxs("div",{className:"p-4 border rounded",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",p.order_code]}),e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",p.order_status]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ID  :"})," ",p.assigned_store_id||" "]}),e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",p.assigned_store_name||" "]}),e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",p.store_response_status||"  "]}),e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",p.store_response_at?new Date(p.store_response_at).toLocaleString("ar-IQ"):" "]})]}),e.jsxs("div",{className:"mt-4 flex gap-2 flex-wrap",children:[e.jsx(L,{size:"sm",onClick:()=>h(p.id,p.assigned_store_id,"available"),disabled:!p.assigned_store_id||c,className:"bg-green-600 hover:bg-green-700",children:"  "}),e.jsx(L,{size:"sm",onClick:()=>h(p.id,p.assigned_store_id,"unavailable"),disabled:!p.assigned_store_id||c,className:"bg-red-600 hover:bg-red-700",children:"   "}),e.jsx(L,{size:"sm",variant:"outline",onClick:()=>f(p.id),disabled:c,children:"  "})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Order ID: ",p.id.slice(0,8),"..."]})]},p.id))]}),s.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"    "})]})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Order ID:"}),e.jsx("input",{type:"text",value:r,onChange:p=>n(p.target.value),className:"w-full p-2 border rounded",placeholder:" Order ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Store ID:"}),e.jsx("input",{type:"text",value:a,onChange:p=>l(p.target.value),className:"w-full p-2 border rounded",placeholder:" Store ID"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{onClick:()=>h(r,a,"available"),disabled:!r||!a||c,className:"bg-green-600 hover:bg-green-700",children:" "}),e.jsx(L,{onClick:()=>h(r,a,"unavailable"),disabled:!r||!a||c,className:"bg-red-600 hover:bg-red-700",children:"  "})]})]})})]})]})}function S5(){const[s,t]=x.useState([]),[r,n]=x.useState([]),[a,l]=x.useState(!1),{toast:c}=Xe(),d=f=>{const p=new Date().toLocaleTimeString("ar-IQ");n(w=>[`[${p}] ${f}`,...w.slice(0,9)])},m=async()=>{try{d("     ...");const{data:f,error:p}=await I.from("orders").select(`
          id,
          order_code,
          assigned_store_id,
          assigned_store_name,
          store_response_status,
          store_response_at,
          order_status,
          created_at
        `).not("assigned_store_id","is",null).in("order_status",["assigned","pending"]).order("created_at",{ascending:!1}).limit(5);if(p)throw p;t(f||[]),d(`   ${f?.length||0} `)}catch(f){d(`    : ${f instanceof Error?f.message:"  "}`)}},h=async(f,p,w)=>{l(!0);try{d(`    : Order=${f.slice(0,8)}, Store=${p.slice(0,8)}, Status=${w}`);const{data:v,error:j}=await I.from("orders").select("id, assigned_store_id, store_response_status, order_status").eq("id",f).single();if(j)throw j;d(`   : status=${v.order_status}, store_response=${v.store_response_status}`);const y=await Fa({orderId:f,storeId:p,status:w,rejectionReason:w==="unavailable"?" ":void 0});if(d(`  updateOrderStoreResponse: ${y.success?"":""} - ${y.error||" "}`),y.success){await new Promise(E=>setTimeout(E,1e3));const{data:b,error:C}=await I.from("orders").select("id, assigned_store_id, store_response_status, store_response_at, order_status").eq("id",f).single();if(C)throw C;d(`   : status=${b.order_status}, store_response=${b.store_response_status}`),b.store_response_status===w||w==="available"&&b.store_response_status==="available"||w==="unavailable"&&b.order_status==="rejected"?(d("    -  "),c({title:"  ",description:"   "})):(d("    -   "),c({title:"  ",description:"     ",variant:"destructive"}))}await m()}catch(v){d(`   : ${v instanceof Error?v.message:"  "}`),c({title:"  ",description:v instanceof Error?v.message:"  ",variant:"destructive"})}finally{l(!1)}};return x.useEffect(()=>{m()},[]),e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"    "})}),e.jsxs(M,{children:[e.jsx("div",{className:"flex gap-4 mb-4",children:e.jsx(L,{onClick:m,children:"  "})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"  :"}),s.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"     "}):s.map(f=>e.jsxs("div",{className:"border rounded p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsx("strong",{children:":"})," ",f.order_code]}),e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",f.order_status]}),e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",f.assigned_store_name]}),e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",f.store_response_status||"  "]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{size:"sm",onClick:()=>h(f.id,f.assigned_store_id,"available"),disabled:a,className:"bg-green-600 hover:bg-green-700",children:"  "}),e.jsx(L,{size:"sm",onClick:()=>h(f.id,f.assigned_store_id,"unavailable"),disabled:a,className:"bg-red-600 hover:bg-red-700",children:"   "})]})]},f.id))]})]})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"  "})}),e.jsx(M,{children:e.jsx("div",{className:"bg-gray-50 p-4 rounded max-h-64 overflow-y-auto",children:r.length===0?e.jsx("div",{className:"text-gray-500 text-center",children:"   "}):r.map((f,p)=>e.jsx("div",{className:"text-sm font-mono mb-1",children:f},p))})})]})]})}const E5=()=>{const[s,t]=x.useState({}),[r,n]=x.useState(null),[a,l]=x.useState(""),[c,d]=x.useState(""),[m,h]=x.useState([{name:"get-order",url:"/functions/v1/get-order",status:"unknown"},{name:"auto-assign-orders",url:"/functions/v1/auto-assign-orders",status:"unknown"}]),[f,p]=x.useState([]),[w,v]=x.useState([]),{toast:j}=Xe(),y="https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1";x.useEffect(()=>{b(),C()},[]);const b=async()=>{try{const{data:k}=await I.from("orders").select("id, order_code, customer_name, order_status").order("created_at",{ascending:!1}).limit(5);k&&(p(k),k.length>0&&!a&&l(k[0].id));const{data:P}=await I.from("stores").select("id, name").order("name").limit(10);P&&(v(P),P.length>0&&!c&&d(P[0].id))}catch(k){console.error("Error loading test data:",k)}},C=async()=>{const k=[...m];for(let P=0;P<k.length;P++)try{const F=await fetch(`${y}${k[P].url}`,{method:"GET",headers:{"Content-Type":"application/json"}});k[P].status=F.status<500?"working":"error",k[P].lastTest=new Date,k[P].error=F.status>=500?`HTTP ${F.status}`:void 0}catch(F){k[P].status="error",k[P].lastTest=new Date,k[P].error=F.message}h(k)},E=async()=>{if(!a.trim()){j({title:"",description:"   ",variant:"destructive"});return}n("get-order");const k=Date.now();try{const P=new URL(`${y}/get-order`);P.searchParams.append("orderId",a.trim()),P.searchParams.append("adminMode","true"),console.log(" Testing get-order:",P.toString());const F=await fetch(P.toString(),{method:"GET",headers:{"Content-Type":"application/json"}}),ee=Date.now()-k,ne=await F.json();if(!F.ok)throw new Error(ne.error||`HTTP ${F.status}`);t(pe=>({...pe,getOrder:{success:!0,data:ne,message:`      ${ee}ms`,duration:ee}})),j({title:" ",description:`   : ${ne.order?.customer_name||" "}`})}catch(P){const F=Date.now()-k;console.error(" get-order test failed:",P),t(ee=>({...ee,getOrder:{success:!1,error:P.message,duration:F}})),j({title:" ",description:P.message,variant:"destructive"})}finally{n(null)}},S=async()=>{n("auto-assign");const k=Date.now();try{console.log(" Testing auto-assign-orders");const P=await fetch(`${y}/auto-assign-orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),F=Date.now()-k,ee=await P.json();if(!P.ok)throw new Error(ee.error||`HTTP ${P.status}`);t(ne=>({...ne,autoAssign:{success:!0,data:ee,message:`  ${ee.assigned_count||0}    ${F}ms`,duration:F}})),j({title:"  ",description:`  ${ee.assigned_count||0}    ${ee.total_orders||0}`})}catch(P){const F=Date.now()-k;console.error(" auto-assign test failed:",P),t(ee=>({...ee,autoAssign:{success:!1,error:P.message,duration:F}})),j({title:"  ",description:P.message,variant:"destructive"})}finally{n(null)}},O=async()=>{if(!a.trim()||!c.trim()){j({title:"",description:"     ",variant:"destructive"});return}n("manual-assign");const k=Date.now();try{console.log(" Testing manual assignment:",{orderId:a,storeId:c});const P=await fetch(`${y}/auto-assign-orders`,{method:"POST",headers:{"Content-Type":"application/json","x-store-id":c.trim()},body:JSON.stringify({orderId:a.trim(),storeId:c.trim(),mode:"manual"})}),F=Date.now()-k,ee=await P.json();if(!P.ok)throw new Error(ee.error||`HTTP ${P.status}`);t(ne=>({...ne,manualAssign:{success:!0,data:ee,message:`    "${ee.store_name}"  ${F}ms`,duration:F}})),j({title:"  ",description:ee.message||`    "${ee.store_name}"`})}catch(P){const F=Date.now()-k;console.error(" manual assign test failed:",P),t(ee=>({...ee,manualAssign:{success:!1,error:P.message,duration:F}})),j({title:"  ",description:P.message,variant:"destructive"})}finally{n(null)}},R=(k,P)=>P?e.jsxs(At,{className:P.success?"border-green-500":"border-red-500",children:[P.success?e.jsx(Se,{className:"h-4 w-4 text-green-600"}):e.jsx(lt,{className:"h-4 w-4 text-red-600"}),e.jsx(Dt,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"font-semibold",children:[P.success?" ":" ",": ",k,P.duration&&e.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(",P.duration,"ms)"]})]}),P.message&&e.jsx("div",{className:"text-sm",children:P.message}),P.error&&e.jsxs("div",{className:"text-sm text-red-600",children:[": ",P.error]}),P.data&&e.jsxs("details",{className:"text-xs",children:[e.jsx("summary",{className:"cursor-pointer font-medium",children:" "}),e.jsx("pre",{className:"mt-2 p-2 bg-gray-100 rounded overflow-auto max-h-40",children:JSON.stringify(P.data,null,2)})]})]})})]}):null;return e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"  Edge Functions"}),e.jsx("p",{className:"text-muted-foreground",children:"     Edge Functions"})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"h-5 w-5"})," ",e.jsxs(L,{variant:"outline",size:"sm",onClick:C,className:"mr-auto",children:[e.jsx(ft,{className:"h-4 w-4"}),""]})]})}),e.jsx(M,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m.map(k=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:k.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:k.url}),k.lastTest&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[" : ",k.lastTest.toLocaleTimeString("ar")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:k.status==="working"?"default":k.status==="error"?"destructive":"secondary",children:k.status==="working"?" ":k.status==="error"?" ":"  "}),k.error&&e.jsx("span",{className:"text-xs text-red-600",children:k.error})]})]},k.name))})})]}),e.jsxs(dn,{defaultValue:"test",className:"w-full",children:[e.jsxs($r,{className:"grid w-full grid-cols-3",children:[e.jsx(ht,{value:"test",children:""}),e.jsx(ht,{value:"data",children:" "}),e.jsx(ht,{value:"deployment",children:""})]}),e.jsx(mt,{value:"test",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsxs(q,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(qn,{className:"h-5 w-5"}),"get-order"]}),e.jsx(Ze,{children:"     /    "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:" "}),e.jsxs("select",{className:"w-full mt-1 p-2 border rounded",value:a,onChange:k=>l(k.target.value),children:[e.jsx("option",{value:"",children:" "}),f.map(k=>e.jsxs("option",{value:k.id,children:[k.order_code||k.id.slice(0,8)," - ",k.customer_name," (",k.order_status,")"]},k.id))]})]}),e.jsx(L,{onClick:E,disabled:r==="get-order",className:"w-full",children:r==="get-order"?e.jsxs(e.Fragment,{children:[e.jsx(Jr,{className:"w-4 h-4 animate-spin ml-2"}),"  ..."]}):"  "}),R("get-order",s.getOrder)]})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(rn,{className:"h-5 w-5"}),"auto-assign-orders"]}),e.jsx(Ze,{children:"      "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsx(L,{onClick:S,disabled:r==="auto-assign",className:"w-full",children:r==="auto-assign"?e.jsxs(e.Fragment,{children:[e.jsx(Jr,{className:"w-4 h-4 animate-spin ml-2"}),"  ..."]}):"  "}),R("auto-assign-orders",s.autoAssign)]})]}),e.jsxs($,{className:"lg:col-span-2",children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsx(Ze,{children:"    "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:" "}),e.jsxs("select",{className:"w-full mt-1 p-2 border rounded",value:a,onChange:k=>l(k.target.value),children:[e.jsx("option",{value:"",children:" "}),f.map(k=>e.jsxs("option",{value:k.id,children:[k.order_code||k.id.slice(0,8)," - ",k.customer_name]},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:" "}),e.jsxs("select",{className:"w-full mt-1 p-2 border rounded",value:c,onChange:k=>d(k.target.value),children:[e.jsx("option",{value:"",children:" "}),w.map(k=>e.jsx("option",{value:k.id,children:k.name},k.id))]})]})]}),e.jsx(L,{onClick:O,disabled:r==="manual-assign",className:"w-full",children:r==="manual-assign"?e.jsxs(e.Fragment,{children:[e.jsx(Jr,{className:"w-4 h-4 animate-spin ml-2"}),"  ..."]}):"  "}),R("manual-assign",s.manualAssign)]})]})]})}),e.jsx(mt,{value:"data",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:f.map(k=>e.jsxs("div",{className:"p-2 border rounded text-sm",children:[e.jsx("div",{className:"font-medium",children:k.order_code||k.id.slice(0,8)}),e.jsx("div",{className:"text-muted-foreground",children:k.customer_name}),e.jsxs("div",{className:"text-xs",children:[": ",k.order_status]})]},k.id))})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:w.map(k=>e.jsxs("div",{className:"p-2 border rounded text-sm",children:[e.jsx("div",{className:"font-medium",children:k.name}),e.jsx("div",{className:"text-muted-foreground text-xs",children:k.id})]},k.id))})})]})]})}),e.jsx(mt,{value:"deployment",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs(At,{children:[e.jsx(nt,{className:"h-4 w-4"}),e.jsx(Dt,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"  Supabase:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"   Supabase CLI"}),e.jsxs("li",{children:["  : ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"supabase link --project-ref your-project-ref"})]}),e.jsxs("li",{children:[" : ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"supabase functions deploy"})]}),e.jsxs("li",{children:["   : ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"supabase functions deploy get-order"})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("div",{className:"font-medium mb-2",children:" URLs :"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{children:["get-order: ",y,"/get-order"]}),e.jsxs("div",{children:["auto-assign-orders: ",y,"/auto-assign-orders"]})]})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("div",{className:"font-medium mb-2",children:"  :"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsx("div",{children:"supabase/functions/get-order/index.ts"}),e.jsx("div",{children:"supabase/functions/auto-assign-orders/index.ts"})]})]})]})]})]})})]})]})},C5=async s=>{const r=`https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1/${s}`;try{console.log(`  Edge Function: ${r}`);const n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndrempvdmhsbGplYXF6b3l0cGViIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkwNDY2MjIsImV4cCI6MjA2NDYyMjYyMn0.mx8PnQJaMochaPbjYUmwzlVNIULM05LUDBIM7OFFjZ8"},body:JSON.stringify({test:!0})});if(console.log(`  : ${n.status} ${n.statusText}`),n.status===404)return{exists:!1,error:"Edge Function  "};const a=n.headers.get("content-type");let l;return a&&a.includes("application/json")?l=await n.json():l=await n.text(),{exists:!0,status:n.status,result:l}}catch(n){return console.error("    Edge Function:",n),{exists:!1,error:n instanceof Error?n.message:"  "}}},wa={id:"test-order-123",items:[{name:" ",quantity:2,price:50,discounted_price:45,main_store:" "},{name:" ",quantity:1,price:100,main_store:" "},{name:" ",quantity:3,price:30,discounted_price:25,main_store:" "},{name:" ",quantity:1,price:75,main_store:" "}]},T5=()=>{const[s,t]=x.useState(null),[r,n]=x.useState(!1),a=async()=>{n(!0);try{const l=await C5("test-split");console.log("   Edge Function:",l),t(l)}catch(l){console.error("    Edge Function:",l),t({exists:!1,error:String(l)})}finally{n(!1)}};return e.jsxs("div",{className:"p-8 max-w-2xl mx-auto",dir:"rtl",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"   "}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:" Edge Function"}),e.jsx(L,{onClick:a,disabled:r,className:"mb-4",children:r?" ...":" Edge Function"}),s&&e.jsxs("div",{className:"bg-white border rounded p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:" :"}),e.jsx("pre",{className:"text-sm bg-gray-100 p-2 rounded overflow-auto",children:JSON.stringify(s,null,2)})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:" "}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",wa.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",wa.items.length]}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",new Set(wa.items.map(l=>l.main_store)).size]})]}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsx("h3",{className:"font-semibold",children:" :"}),wa.items.map((l,c)=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded text-sm",children:[e.jsx("span",{className:"font-medium",children:l.name})," -",e.jsxs("span",{className:"text-blue-600",children:[" ",l.main_store]})," - : ",l.quantity," - : ",l.price,l.discounted_price&&l.discounted_price!==l.price&&e.jsxs("span",{className:"text-green-600",children:[" ( : ",l.discounted_price,")"]})]},c))]}),e.jsx(Qm,{orderId:wa.id,orderItems:wa.items,onSplitComplete:()=>{console.log("     !"),alert("     ! (  )")}})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:":"}),"    .     Edge Function    ."]}),e.jsx("p",{children:"           ."})]})]})},k5=()=>{const s=ur(),{toast:t}=Xe(),[r,n]=x.useState([]),[a,l]=x.useState(null),[c,d]=x.useState(!0),{divisions:m,loading:h,refreshDivisions:f}=db(a||void 0),p=async()=>{try{d(!0);const{data:j,error:y}=await I.from("orders").select("id, customer_name, order_code, order_status, created_at, order_details, total_amount").like("order_details","%    %").order("created_at",{ascending:!1}).limit(20);if(y)throw y;n(j||[]),j&&j.length>0&&!a&&l(j[0].id)}catch(j){console.error("Error fetching split orders:",j),t({title:"   ",description:"    ",variant:"destructive"})}finally{d(!1)}};x.useEffect(()=>{p()},[]);const w=j=>{const y={pending:{label:" ",color:"bg-yellow-100 text-yellow-800",icon:Rt},assigned:{label:"",color:"bg-blue-100 text-blue-800",icon:Me},preparing:{label:" ",color:"bg-orange-100 text-orange-800",icon:Bt},ready:{label:"",color:"bg-green-100 text-green-800",icon:Se},delivered:{label:"",color:"bg-green-100 text-green-800",icon:Se},cancelled:{label:"",color:"bg-red-100 text-red-800",icon:lt},rejected:{label:"",color:"bg-red-100 text-red-800",icon:lt}};return y[j]||y.pending},v=()=>[{id:"div-1",store_name:"  ",assigned_store_id:"store-1",store_response_status:"available",order_status:"delivered",store_response_at:new Date(Date.now()-864e5).toISOString(),items_count:3,total_amount:45e4},{id:"div-2",store_name:"  ",assigned_store_id:"store-2",store_response_status:"pending",order_status:"assigned",items_count:2,total_amount:32e4},{id:"div-3",store_name:"  ",assigned_store_id:"store-3",store_response_status:"unavailable",order_status:"rejected",store_response_at:new Date(Date.now()-36e5).toISOString(),rejection_reason:"   ",items_count:1,total_amount:18e4}];return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(L,{variant:"outline",onClick:()=>s("/admin"),className:"flex items-center gap-2",children:[e.jsx(bd,{className:"w-4 h-4"}),e.jsx(D,{children:"  "})]}),e.jsx("h1",{className:"text-2xl font-bold",children:e.jsx(D,{children:"   "})})]}),e.jsxs(L,{onClick:()=>{p(),f()},disabled:c||h,className:"flex items-center gap-2",children:[e.jsx(ft,{className:`w-4 h-4 ${c||h?"animate-spin":""}`}),e.jsx(D,{children:""})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs($,{className:"lg:col-span-1",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),e.jsx(D,{children:" "}),e.jsx(Q,{variant:"secondary",children:r.length})]})}),e.jsx(M,{children:c?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(j=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-16 bg-gray-200 rounded"})},j))}):r.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Me,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx(D,{children:"   "})]}):e.jsx("div",{className:"space-y-3",children:r.map(j=>{const y=w(j.order_status),b=y.icon,C=a===j.id;return e.jsx($,{className:`cursor-pointer transition-all ${C?"ring-2 ring-blue-500 bg-blue-50":"hover:shadow-md"}`,onClick:()=>l(j.id),children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:e.jsxs(D,{children:[" #",j.order_code||j.id.slice(0,8)]})}),e.jsxs(Q,{className:y.color,children:[e.jsx(b,{className:"w-3 h-3 ml-1"}),e.jsx(D,{children:y.label})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsx("div",{children:e.jsxs(D,{children:[": ",j.customer_name]})}),e.jsxs("div",{children:[": ",j.total_amount.toLocaleString()," ."]}),e.jsx("div",{children:new Date(j.created_at).toLocaleDateString("ar-SA")})]}),C&&e.jsxs("div",{className:"mt-2 text-xs text-blue-600 flex items-center gap-1",children:[e.jsx(qn,{className:"w-3 h-3"}),e.jsx(D,{children:" "})]})]})},j.id)})})})]}),e.jsx("div",{className:"lg:col-span-2 space-y-6",children:a?e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(qn,{className:"w-5 h-5"}),e.jsx(D,{children:"  "})]})}),e.jsx(M,{children:(()=>{const j=r.find(y=>y.id===a);return j?e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:" : "}),e.jsxs("span",{className:"font-medium",children:["#",j.order_code||j.id.slice(0,8)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:": "}),e.jsx("span",{className:"font-medium",children:e.jsx(D,{children:j.customer_name})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:": "}),e.jsxs("span",{className:"font-medium",children:[j.total_amount.toLocaleString()," ."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:": "}),e.jsx("span",{className:"font-medium",children:new Date(j.created_at).toLocaleDateString("ar-SA")})]})]}):e.jsx("div",{children:"  "})})()})]}),m.length>0?e.jsx(ef,{divisions:m,originalOrderId:a}):h?e.jsx($,{children:e.jsxs(M,{className:"p-8 text-center",children:[e.jsx(ft,{className:"w-8 h-8 mx-auto mb-4 animate-spin text-blue-500"}),e.jsx(D,{children:"   ..."})]})}):e.jsx($,{children:e.jsxs(M,{className:"p-8 text-center",children:[e.jsx(Bt,{className:"w-8 h-8 mx-auto mb-4 text-yellow-500"}),e.jsx(D,{children:"    "}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:e.jsx(D,{children:"          "})})]})}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),e.jsx(D,{children:"  "}),e.jsx(Q,{variant:"outline",children:" "})]})}),e.jsxs(M,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:e.jsx(D,{children:"        :"})}),e.jsx(ef,{divisions:v(),originalOrderId:"mock-order"})]})]})]}):e.jsx($,{children:e.jsxs(M,{className:"p-8 text-center",children:[e.jsx(Me,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:e.jsx(D,{children:"   "})}),e.jsx("p",{className:"text-gray-600",children:e.jsx(D,{children:"          "})})]})})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Bt,{className:"w-5 h-5"}),e.jsx(D,{children:"  "})]})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Se,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium text-green-800",children:e.jsx(D,{children:""})})]}),e.jsx("p",{className:"text-sm text-green-700",children:e.jsx(D,{children:"    "})})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-yellow-600"}),e.jsx("span",{className:"font-medium text-yellow-800",children:e.jsx(D,{children:" "})})]}),e.jsx("p",{className:"text-sm text-yellow-700",children:e.jsx(D,{children:"     "})})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Me,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-medium text-blue-800",children:e.jsx(D,{children:""})})]}),e.jsx("p",{className:"text-sm text-blue-700",children:e.jsx(D,{children:"    "})})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(lt,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"font-medium text-red-800",children:e.jsx(D,{children:""})})]}),e.jsx("p",{className:"text-sm text-red-700",children:e.jsx(D,{children:"   "})})]})]})})]})]})},O5=async s=>{try{console.log("    :",s.originalOrderCode);const t=[];for(const r of s.divisions){const n={customer_name:s.customerName,customer_phone:s.customerPhone,customer_address:" ",customer_notes:"   ",order_status:r.status,main_store_name:r.storeName,items:r.items,total_amount:r.totalAmount,order_details:`     ${s.originalOrderCode}`,store_response_status:r.storeResponseStatus||null,rejection_reason:r.rejectionReason||null,store_response_at:r.storeResponseStatus?new Date().toISOString():null,created_at:new Date().toISOString()},{data:a,error:l}=await I.from("orders").insert(n).select().single();if(l)console.error(`      ${r.storeName}:`,l),t.push({storeName:r.storeName,success:!1,error:l.message});else{console.log(`     ${r.storeName}:`,a.id);const c=r.items.map(m=>({order_id:a.id,product_name:m.name||m.product_name,quantity:m.quantity||1,price:m.price||0,discounted_price:m.discounted_price||m.price||0,main_store_name:r.storeName})),{error:d}=await I.from("order_items").insert(c);d&&console.warn(`    order_items  ${r.storeName}:`,d),t.push({storeName:r.storeName,success:!0,orderId:a.id,status:r.status,storeResponseStatus:r.storeResponseStatus})}}return{success:!0,originalOrderCode:s.originalOrderCode,totalDivisions:s.divisions.length,results:t}}catch(t){throw console.error("     :",t),t}},$b=[{originalOrderCode:"TEST-001",customerName:" ",customerPhone:"07801234567",divisions:[{storeName:"  ",items:[{name:" ",quantity:1,price:5e5,discounted_price:45e4},{name:" ",quantity:2,price:75e3,discounted_price:7e4}],totalAmount:59e4,status:"delivered",storeResponseStatus:"available"},{storeName:"  ",items:[{name:" ",quantity:1,price:12e4,discounted_price:11e4}],totalAmount:11e4,status:"assigned",storeResponseStatus:"pending"},{storeName:"  ",items:[{name:" ",quantity:3,price:5e4,discounted_price:45e3}],totalAmount:135e3,status:"rejected",storeResponseStatus:"unavailable",rejectionReason:"   "}]},{originalOrderCode:"TEST-002",customerName:" ",customerPhone:"07701234567",divisions:[{storeName:"  ",items:[{name:" ",quantity:2,price:8e4,discounted_price:75e3},{name:" ",quantity:1,price:45e3,discounted_price:4e4}],totalAmount:19e4,status:"delivered",storeResponseStatus:"available"},{storeName:"  ",items:[{name:" ",quantity:1,price:2e5,discounted_price:18e4}],totalAmount:18e4,status:"delivered",storeResponseStatus:"available"}]}],R5=async()=>{const s=[];for(const t of $b)try{const r=await O5(t);s.push(r)}catch(r){console.error(`      ${t.originalOrderCode}:`,r),s.push({success:!1,originalOrderCode:t.originalOrderCode,error:r instanceof Error?r.message:"  "})}return s},P5=()=>{const s=ur(),{toast:t}=Xe(),[r,n]=x.useState(!1),[a,l]=x.useState([]),c=async()=>{try{n(!0),t({title:"  ",description:"    ..."});const d=await R5();l(d);const m=d.filter(f=>f.success).length,h=d.length;t({title:"   ",description:`  ${m}   ${h}   `,variant:m===h?"default":"destructive"})}catch(d){console.error("     :",d),t({title:"   ",description:"    ",variant:"destructive"})}finally{n(!1)}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(L,{variant:"outline",onClick:()=>s("/admin-aa-smn-justme9003"),className:"flex items-center gap-2",children:[e.jsx(bd,{className:"w-4 h-4"}),e.jsx(D,{children:"  "})]}),e.jsx("h1",{className:"text-2xl font-bold",children:e.jsx(D,{children:"   "})})]})}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5"}),e.jsx(D,{children:"  "})]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:e.jsx(D,{children:"  :"})}),e.jsx("div",{className:"space-y-2",children:$b.map((d,m)=>e.jsxs("div",{className:"text-sm text-blue-700",children:[e.jsxs("span",{className:"font-medium",children:[d.originalOrderCode," - ",d.customerName]}),e.jsxs("span",{className:"text-blue-600",children:[" ","(",d.divisions.length," )"]}),e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:d.divisions.map(h=>e.jsxs("span",{className:"inline-block ml-2",children:[h.storeName,": ",h.status,h.storeResponseStatus&&` (${h.storeResponseStatus})`]},h.storeName))})]},m))})]}),e.jsx(L,{onClick:c,disabled:r,className:"w-full",children:r?e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"w-4 h-4 ml-2 animate-spin"}),e.jsx(D,{children:" ..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"w-4 h-4 ml-2"}),e.jsx(D,{children:"  "})]})}),a.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("h4",{className:"font-medium",children:e.jsx(D,{children:" :"})}),a.map((d,m)=>e.jsxs("div",{className:`p-3 rounded-lg border flex items-center gap-2 ${d.success?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:[d.success?e.jsx(Se,{className:"w-4 h-4"}):e.jsx(Bt,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:d.originalOrderCode}),d.success?e.jsxs("span",{children:["-   ",d.totalDivisions,"  "]}):e.jsxs("span",{children:["- : ",d.error]})]},m))]})]})]}),e.jsx(wb,{}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),e.jsx(D,{children:" "})]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:e.jsx(D,{children:"  :"})}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-yellow-700",children:[e.jsx("li",{children:e.jsx(D,{children:'  "  "   '})}),e.jsx("li",{children:e.jsx(D,{children:'  "   " '})}),e.jsx("li",{children:e.jsx(D,{children:"  :     "})}),e.jsx("li",{children:e.jsx(D,{children:"     "})}),e.jsx("li",{children:e.jsx(D,{children:'  ""     '})})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-green-800 mb-2",children:e.jsx(D,{children:" :"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-green-700",children:[e.jsxs("li",{children:[e.jsx("strong",{children:":"})," ",e.jsx(D,{children:"   (available/accepted)"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:" :"})," ",e.jsx(D,{children:"     (pending/assigned)"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:":"})," ",e.jsx(D,{children:"   (delivered)"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:":"})," ",e.jsx(D,{children:"   "})]})]})]})]})})]})]})};function I5(){const[s,t]=x.useState(""),[r,n]=x.useState(!1),[a,l]=x.useState(null),{toast:c}=Xe(),d=async()=>{if(!s.trim()){c({title:"",description:"    ",variant:"destructive"});return}n(!0);try{console.log("     :",s);const f=await yl(s);l({type:"completion_status",data:f}),c({title:" ",description:`   : ${f.statusLabel}`})}catch(f){console.error("      :",{message:f instanceof Error?f.message:String(f),stack:f instanceof Error?f.stack:void 0,originalOrderId:s}),c({title:" ",description:f instanceof Error?f.message:"  ",variant:"destructive"})}finally{n(!1)}},m=async()=>{if(!s.trim()){c({title:"",description:"    ",variant:"destructive"});return}n(!0);try{console.log("       :",s);const f=await Sb(s);l({type:"divisions_with_status",data:f}),c({title:" ",description:`  ${f.divisions.length}    `})}catch(f){console.error("     :",{message:f instanceof Error?f.message:String(f),stack:f instanceof Error?f.stack:void 0,originalOrderId:s}),c({title:" ",description:f instanceof Error?f.message:"  ",variant:"destructive"})}finally{n(!1)}},h=async()=>{if(!s.trim()){c({title:"",description:"    ",variant:"destructive"});return}n(!0);try{console.log("       :",s);const f=await Eb(s);l({type:"update_original",data:f}),f.success?c({title:" ",description:"     "}):c({title:" ",description:f.error||"    ",variant:"destructive"})}catch(f){console.error("      :",{message:f instanceof Error?f.message:String(f),stack:f instanceof Error?f.stack:void 0,originalOrderId:s}),c({title:" ",description:f instanceof Error?f.message:"  ",variant:"destructive"})}finally{n(!1)}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ds,{className:"w-6 h-6 text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold",children:e.jsx(D,{children:"     "})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:e.jsx(D,{children:" "})})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(et,{htmlFor:"originalOrderId",children:e.jsx(D,{children:"   ()"})}),e.jsx(it,{id:"originalOrderId",value:s,onChange:f=>t(f.target.value),placeholder:": ORD_123    ",className:"text-right"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"         "})]}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsxs(L,{onClick:d,disabled:r,className:"flex items-center gap-2",children:[e.jsx(ft,{className:`w-4 h-4 ${r?"animate-spin":""}`}),e.jsx(D,{children:"   "})]}),e.jsxs(L,{onClick:m,disabled:r,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(qn,{className:"w-4 h-4"}),e.jsx(D,{children:"   "})]}),e.jsxs(L,{onClick:h,disabled:r,variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(ft,{className:`w-4 h-4 ${r?"animate-spin":""}`}),e.jsx(D,{children:"  "})]})]})]})]}),s.trim()&&e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:e.jsx(D,{children:"    "})})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold mb-2",children:e.jsx(D,{children:" :"})}),e.jsx(rl,{originalOrderId:s,autoRefresh:!0,showDetails:!1})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold mb-2",children:e.jsx(D,{children:" :"})}),e.jsx(rl,{originalOrderId:s,autoRefresh:!0,showDetails:!0})]})]})]}),a&&e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:e.jsx(D,{children:" "})})}),e.jsx(M,{children:e.jsx("pre",{className:"bg-gray-100 p-4 rounded-lg text-xs overflow-auto max-h-96 text-left",dir:"ltr",children:JSON.stringify(a,null,2)})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:e.jsx(D,{children:" "})})}),e.jsxs(M,{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:e.jsx(D,{children:" :"})}),e.jsxs("ul",{className:"list-disc mr-6 space-y-1",children:[e.jsx("li",{children:e.jsx(D,{children:"1.      "})}),e.jsx("li",{children:e.jsx(D,{children:'2.   "   "  '})}),e.jsx("li",{children:e.jsx(D,{children:"3.     "})}),e.jsx("li",{children:e.jsx(D,{children:"4.     ()"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:e.jsx(D,{children:" :"})}),e.jsxs("ul",{className:"list-disc mr-6 space-y-1",children:[e.jsx("li",{children:e.jsx(D,{children:" :     "})}),e.jsx("li",{children:e.jsx(D,{children:"  :          "})}),e.jsx("li",{children:e.jsx(D,{children:"  :     "})})]})]}),e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsx("p",{className:"text-blue-800",children:e.jsx(D,{children:" :             "})})})]})]})]})}function A5(){const[s,t]=x.useState(""),[r,n]=x.useState(!1),[a,l]=x.useState(null),{toast:c}=Xe(),d=async()=>{if(!s.trim()){c({title:"  ",description:"    ",variant:"destructive"});return}n(!0);try{console.log("    ...");const h=await yl(s);l({type:"success",data:h,message:"   -   "}),c({title:"  ",description:`    : ${s}`})}catch(h){console.log("    -       "),l({type:"error",data:h,message:h instanceof Error?h.message:String(h)}),c({title:"   ",description:"  console     ",variant:"destructive"})}finally{n(!1)}},m=async()=>{t("FAKE_ORDER_"+Math.random().toString(36).substr(2,9)),setTimeout(()=>d(),100)};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ds,{className:"w-6 h-6 text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold",children:e.jsx(D,{children:"  "})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:e.jsx(D,{children:"  "})})}),e.jsx(M,{className:"space-y-4",children:e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Se,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:" :"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[e.jsx("li",{children:'   "[object Object]"   '}),e.jsx("li",{children:"     (message, code, details, hint)"}),e.jsx("li",{children:"    Supabase"}),e.jsx("li",{children:" utility functions   "}),e.jsx("li",{children:"      "})]})]})]})})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:e.jsx(D,{children:"  "})})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(et,{htmlFor:"originalOrderId",children:e.jsx(D,{children:"   "})}),e.jsx(it,{id:"originalOrderId",value:s,onChange:h=>t(h.target.value),placeholder:": ORD_123   ",className:"text-right"})]}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsxs(L,{onClick:d,disabled:r,className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-4 h-4"}),e.jsx(D,{children:"  "})]}),e.jsxs(L,{onClick:m,disabled:r,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(nt,{className:"w-4 h-4"}),e.jsx(D,{children:"   "})]})]}),e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(nt,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-semibold mb-1",children:" :"}),e.jsx("p",{children:"1.    (   )"}),e.jsx("p",{children:'2.   "  "'}),e.jsx("p",{children:"3.  Developer Console   "}),e.jsx("p",{children:'4.   "   "  '})]})]})})]})]}),a&&e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:e.jsx(D,{children:" "})})}),e.jsx(M,{children:e.jsxs("div",{className:`p-4 rounded-lg ${a.type==="success"?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[e.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[a.type==="success"?e.jsx(Se,{className:"w-5 h-5 text-green-600 mt-0.5"}):e.jsx(nt,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-semibold ${a.type==="success"?"text-green-800":"text-red-800"}`,children:a.type==="success"?" ":"   "}),e.jsx("p",{className:`text-sm ${a.type==="success"?"text-green-700":"text-red-700"}`,children:a.message})]})]}),e.jsxs("details",{className:"mt-3",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium",children:"  "}),e.jsx("pre",{className:"mt-2 text-xs bg-white p-3 rounded border overflow-auto max-h-48",dir:"ltr",children:JSON.stringify(a.data,null,2)})]})]})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:e.jsx(D,{children:" "})})}),e.jsxs(M,{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:e.jsx(D,{children:" :"})}),e.jsx("code",{className:"block bg-red-50 p-2 rounded text-red-800 mt-1",children:"      : [object Object]"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:e.jsx(D,{children:" :"})}),e.jsxs("code",{className:"block bg-green-50 p-2 rounded text-green-800 mt-1 text-xs",children:["    : ","{",e.jsx("br",{}),'message: "No rows found",',e.jsx("br",{}),'code: "PGRST116",',e.jsx("br",{}),'originalOrderId: "ORD_123",',e.jsx("br",{}),'timestamp: "2024-01-01T12:00:00Z"',e.jsx("br",{}),"}"]})]}),e.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:e.jsx("p",{className:"text-green-800",children:e.jsx(D,{children:"       console        !"})})})]})]})]})}const Lb={fast_order_created_customer:{type:"order_created",recipient_type:"customer",title_ar:"   ",message_ar:"    {{order_code}}     30 ",url_pattern:"/customer/orders/{{order_id}}",priority:"high",action_required:!1},fast_order_confirmed_customer:{type:"order_confirmed",recipient_type:"customer",title_ar:"   ",message_ar:"    {{order_code}}  {{store_name}}  ",url_pattern:"/customer/orders/{{order_id}}",priority:"high",action_required:!1},fast_order_prepared_customer:{type:"order_prepared",recipient_type:"customer",title_ar:"   ",message_ar:"  {{order_code}}     ",url_pattern:"/customer/orders/{{order_id}}",priority:"urgent",action_required:!1},fast_order_shipped_customer:{type:"order_shipped",recipient_type:"customer",title_ar:"   ",message_ar:"  {{order_code}}    ",url_pattern:"/customer/orders/{{order_id}}",priority:"urgent",action_required:!1},fast_order_delivered_customer:{type:"order_delivered",recipient_type:"customer",title_ar:"   ",message_ar:"    {{order_code}} .   ",url_pattern:"/customer/orders/{{order_id}}",priority:"medium",action_required:!1},fast_order_rejected_customer:{type:"order_rejected",recipient_type:"customer",title_ar:"    ",message_ar:"    {{order_code}}  {{store_name}}. {{rejection_reason}}",url_pattern:"/customer/orders/{{order_id}}",priority:"high",action_required:!0},unified_order_created_customer:{type:"order_created",recipient_type:"customer",title_ar:"   ",message_ar:"    {{order_code}}     {{product_count}} ",url_pattern:"/customer/orders/{{order_id}}",priority:"medium",action_required:!1},unified_order_all_confirmed_customer:{type:"order_confirmed",recipient_type:"customer",title_ar:"    ",message_ar:"      {{order_code}}   ",url_pattern:"/customer/orders/{{order_id}}",priority:"high",action_required:!1},unified_order_partial_confirmed_customer:{type:"order_partial_confirmed",recipient_type:"customer",title_ar:"   ",message_ar:"      {{order_code}}.      ",url_pattern:"/customer/orders/{{order_id}}",priority:"medium",action_required:!1},unified_order_shipped_customer:{type:"order_shipped",recipient_type:"customer",title_ar:"   ",message_ar:"    {{order_code}}    {{estimated_delivery}}",url_pattern:"/customer/orders/{{order_id}}",priority:"high",action_required:!1},unified_order_delivered_customer:{type:"order_delivered",recipient_type:"customer",title_ar:"   ",message_ar:"    {{order_code}} .  ",url_pattern:"/customer/orders/{{order_id}}",priority:"medium",action_required:!1},fast_order_assigned_store:{type:"order_assigned",recipient_type:"store",title_ar:"   - ",message_ar:"    {{order_code}}  {{customer_name}}.   ",url_pattern:"/store/orders/{{order_id}}",priority:"urgent",action_required:!0},fast_order_reminder_store:{type:"order_reminder",recipient_type:"store",title_ar:":     ",message_ar:"  {{order_code}}     .   ",url_pattern:"/store/orders/{{order_id}}",priority:"urgent",action_required:!0},unified_order_assigned_store:{type:"order_assigned",recipient_type:"store",title_ar:"    ",message_ar:"  {{product_count}}      {{order_code}}",url_pattern:"/store/orders/{{order_id}}",priority:"high",action_required:!0},unified_order_reminder_store:{type:"order_reminder",recipient_type:"store",title_ar:":      ",message_ar:"    {{order_code}}    ",url_pattern:"/store/orders/{{order_id}}",priority:"high",action_required:!0},unified_order_ready_for_pickup_store:{type:"order_pickup_ready",recipient_type:"store",title_ar:"   ",message_ar:"    {{order_code}}    ",url_pattern:"/store/orders/{{order_id}}",priority:"high",action_required:!1},fast_order_created_admin:{type:"order_created",recipient_type:"admin",title_ar:"  ",message_ar:"   {{order_code}}  {{customer_name}} - : {{total_amount}} ",url_pattern:"/admin/orders/{{order_id}}",priority:"medium",action_required:!1},fast_order_rejected_admin:{type:"order_rejected",recipient_type:"admin",title_ar:"   ",message_ar:"    {{order_code}}  {{store_name}}",url_pattern:"/admin/orders/{{order_id}}",priority:"high",action_required:!0},fast_order_timeout_admin:{type:"order_timeout",recipient_type:"admin",title_ar:"   ",message_ar:"     {{order_code}}  {{store_name}}",url_pattern:"/admin/orders/{{order_id}}",priority:"urgent",action_required:!0},unified_order_created_admin:{type:"order_created",recipient_type:"admin",title_ar:"  ",message_ar:"   {{order_code}}  {{customer_name}} - {{product_count}}  - {{total_amount}} ",url_pattern:"/admin/orders/{{order_id}}",priority:"medium",action_required:!1},unified_order_split_completed_admin:{type:"order_split_completed",recipient_type:"admin",title_ar:"   ",message_ar:"    {{order_code}}   ",url_pattern:"/admin/orders/{{order_id}}",priority:"medium",action_required:!1},unified_order_all_confirmed_admin:{type:"order_confirmed",recipient_type:"admin",title_ar:"   ",message_ar:"      {{order_code}}   ",url_pattern:"/admin/orders/{{order_id}}",priority:"medium",action_required:!1},unified_order_partial_rejection_admin:{type:"order_partial_rejected",recipient_type:"admin",title_ar:"   ",message_ar:"       {{order_code}}.  ",url_pattern:"/admin/orders/{{order_id}}",priority:"high",action_required:!0},system_error_admin:{type:"system_error",recipient_type:"admin",title_ar:"  ",message_ar:"     {{order_code}}.   ",url_pattern:"/admin/orders/{{order_id}}",priority:"urgent",action_required:!0},payment_issue_admin:{type:"payment_issue",recipient_type:"admin",title_ar:"  ",message_ar:"     {{order_code}} -  {{total_amount}} ",url_pattern:"/admin/orders/{{order_id}}",priority:"urgent",action_required:!0}},D5=(s,t,r)=>{const n=Lb[s];if(!n)return console.error(`Template ${s} not found`),null;let a=n.message_ar,l=n.url_pattern;const c={"{{order_code}}":t.order_code,"{{customer_name}}":t.customer_name||"","{{store_name}}":t.store_name||"","{{product_count}}":t.product_count?.toString()||"0","{{total_amount}}":t.total_amount?.toString()||"0","{{rejection_reason}}":t.rejection_reason||"   ","{{estimated_delivery}}":t.estimated_delivery||" ","{{order_id}}":t.order_id,...r};return Object.entries(c).forEach(([d,m])=>{m&&(a=a.replace(new RegExp(d,"g"),m),l=l.replace(new RegExp(d,"g"),m))}),{title:n.title_ar,message:a,type:n.recipient_type,order_id:t.order_id,order_code:t.order_code,customer_name:t.customer_name,store_name:t.store_name,shipping_type:t.shipping_type,order_status:t.order_status,product_count:t.product_count,total_amount:t.total_amount,url:l,action_required:n.action_required}};class $5{baseUrl="https://wkzjovhlljeaqzoytpeb.supabase.co/functions/v1";async sendNotification(t){try{const r=await fetch(`${this.baseUrl}/send-notification`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${I.supabaseKey}`},body:JSON.stringify(t)});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();return console.log(" Notification sent successfully:",n),!0}catch(r){return console.error(" Failed to send notification:",r),!1}}async sendOrderNotification(t,r,n,a){const l=D5(t,n,a);if(!l)return console.error(`Failed to create notification from template: ${t}`),!1;const c=Lb[t],d={recipient_type:l.type,recipient_id:r,title:l.title,message:l.message,order_id:n.order_id,priority:c.priority};return await this.sendNotification(d)}async notifyFastOrderCreated(t){const r=[];t.customer_id&&r.push(this.sendOrderNotification("fast_order_created_customer",t.customer_id,t)),r.push(this.sendOrderNotification("fast_order_created_admin","admin",t)),await Promise.all(r),console.log(" Fast order creation notifications sent")}async notifyFastOrderAssigned(t){if(!t.store_id){console.error("Store ID is required for fast order assignment notification");return}await this.sendOrderNotification("fast_order_assigned_store",t.store_id,t),console.log(" Fast order assignment notification sent to store")}async notifyFastOrderConfirmed(t){const r=[];t.customer_id&&r.push(this.sendOrderNotification("fast_order_confirmed_customer",t.customer_id,t)),await Promise.all(r),console.log(" Fast order confirmation notifications sent")}async notifyFastOrderPrepared(t){t.customer_id&&(await this.sendOrderNotification("fast_order_prepared_customer",t.customer_id,t),console.log(" Fast order preparation notification sent"))}async notifyFastOrderShipped(t){t.customer_id&&(await this.sendOrderNotification("fast_order_shipped_customer",t.customer_id,t),console.log(" Fast order shipment notification sent"))}async notifyFastOrderDelivered(t){t.customer_id&&(await this.sendOrderNotification("fast_order_delivered_customer",t.customer_id,t),console.log(" Fast order delivery notification sent"))}async notifyFastOrderRejected(t){const r=[];t.customer_id&&r.push(this.sendOrderNotification("fast_order_rejected_customer",t.customer_id,t)),r.push(this.sendOrderNotification("fast_order_rejected_admin","admin",t)),await Promise.all(r),console.log(" Fast order rejection notifications sent")}async notifyFastOrderTimeout(t){await this.sendOrderNotification("fast_order_timeout_admin","admin",t),console.log(" Fast order timeout notification sent")}async notifyUnifiedOrderCreated(t){const r=[];t.customer_id&&r.push(this.sendOrderNotification("unified_order_created_customer",t.customer_id,t)),r.push(this.sendOrderNotification("unified_order_created_admin","admin",t)),await Promise.all(r),console.log(" Unified order creation notifications sent")}async notifyUnifiedOrderSplit(t,r){const n=[];r.forEach(a=>{n.push(this.sendOrderNotification("unified_order_assigned_store",a,t))}),n.push(this.sendOrderNotification("unified_order_split_completed_admin","admin",t,{"{{store_count}}":r.length.toString()})),await Promise.all(n),console.log(` Unified order split notifications sent to ${r.length} stores`)}async notifyUnifiedOrderStoreResponse(t,r,n){console.log(` Store ${r} ${n} their part of unified order ${t.order_code}`)}async notifyUnifiedOrderAllConfirmed(t){const r=[];t.customer_id&&r.push(this.sendOrderNotification("unified_order_all_confirmed_customer",t.customer_id,t)),r.push(this.sendOrderNotification("unified_order_all_confirmed_admin","admin",t)),await Promise.all(r),console.log(" Unified order full confirmation notifications sent")}async notifyUnifiedOrderPartialConfirmed(t){t.customer_id&&(await this.sendOrderNotification("unified_order_partial_confirmed_customer",t.customer_id,t),console.log(" Unified order partial confirmation notification sent"))}async notifyUnifiedOrderPartialRejection(t){const r=[];r.push(this.sendOrderNotification("unified_order_partial_rejection_admin","admin",t)),await Promise.all(r),console.log(" Unified order partial rejection notifications sent")}async notifyUnifiedOrderShipped(t){t.customer_id&&(await this.sendOrderNotification("unified_order_shipped_customer",t.customer_id,t),console.log(" Unified order shipment notification sent"))}async notifyUnifiedOrderDelivered(t){t.customer_id&&(await this.sendOrderNotification("unified_order_delivered_customer",t.customer_id,t),console.log(" Unified order delivery notification sent"))}async sendReminderNotification(t,r){const n=t.shipping_type==="fast"?"fast_order_reminder_store":"unified_order_reminder_store";await this.sendOrderNotification(n,r,t),console.log(` Reminder notification sent to store ${r}`)}async notifySystemError(t,r){await this.sendOrderNotification("system_error_admin","admin",t,{"{{error_details}}":r}),console.log(" System error notification sent to admin")}async notifyPaymentIssue(t){await this.sendOrderNotification("payment_issue_admin","admin",t),console.log(" Payment issue notification sent to admin")}async processFastOrderCreation(t){try{console.log(` Processing fast order notifications for ${t.order_code}`),await this.notifyFastOrderCreated(t),t.store_id&&await this.notifyFastOrderAssigned(t),console.log(` Fast order notifications completed for ${t.order_code}`)}catch(r){console.error(" Error processing fast order notifications:",r),await this.notifySystemError(t,r.message)}}async processUnifiedOrderCreation(t,r){try{console.log(` Processing unified order notifications for ${t.order_code}`),await this.notifyUnifiedOrderCreated(t),await this.notifyUnifiedOrderSplit(t,r),console.log(` Unified order notifications completed for ${t.order_code}`)}catch(n){console.error(" Error processing unified order notifications:",n),await this.notifySystemError(t,n.message)}}async processOrderStatusChange(t,r){try{if(console.log(` Processing status change notifications for ${t.order_code}: ${r}  ${t.order_status}`),t.shipping_type==="fast")switch(t.order_status){case"confirmed":await this.notifyFastOrderConfirmed(t);break;case"prepared":await this.notifyFastOrderPrepared(t);break;case"shipped":await this.notifyFastOrderShipped(t);break;case"delivered":await this.notifyFastOrderDelivered(t);break;case"rejected":await this.notifyFastOrderRejected(t);break}else if(t.shipping_type==="unified")switch(t.order_status){case"confirmed":await this.notifyUnifiedOrderAllConfirmed(t);break;case"shipped":await this.notifyUnifiedOrderShipped(t);break;case"delivered":await this.notifyUnifiedOrderDelivered(t);break}console.log(` Status change notifications completed for ${t.order_code}`)}catch(n){console.error(" Error processing status change notifications:",n),await this.notifySystemError(t,n.message)}}}const wr=new $5,L5=()=>{const{toast:s}=Xe(),[t,r]=x.useState(!1),[n,a]=x.useState([]),[l,c]=x.useState({order_id:"demo-"+Date.now(),order_code:"ORDER-"+Date.now().toString().slice(-6),customer_id:"customer-1",customer_name:" ",store_id:"store-1",store_name:"  ",shipping_type:"fast",order_status:"pending",product_count:3,total_amount:150,estimated_delivery:" 30 "}),d=(f,p)=>{c(w=>({...w,[f]:p}))},m=async f=>{if(!l.order_id||!l.order_code){s({title:"",description:"   ",variant:"destructive"});return}r(!0);try{let p=!1;const w=l;switch(f){case"fast_order_created":await wr.processFastOrderCreation(w),p=!0;break;case"fast_order_assigned":await wr.notifyFastOrderAssigned(w),p=!0;break;case"fast_order_confirmed":await wr.notifyFastOrderConfirmed(w),p=!0;break;case"fast_order_shipped":await wr.notifyFastOrderShipped(w),p=!0;break;case"fast_order_delivered":await wr.notifyFastOrderDelivered(w),p=!0;break;case"fast_order_rejected":const j={...w,rejection_reason:"   "};await wr.notifyFastOrderRejected(j),p=!0;break;case"unified_order_created":await wr.processUnifiedOrderCreation(w,["store-1","store-2","store-3"]),p=!0;break;case"unified_order_split":await wr.notifyUnifiedOrderSplit(w,["store-1","store-2","store-3"]),p=!0;break;case"unified_order_confirmed":await wr.notifyUnifiedOrderAllConfirmed(w),p=!0;break;case"system_error":await wr.notifySystemError(w,"    "),p=!0;break;default:throw new Error("  ")}const v={scenario:f,success:p,timestamp:new Date().toLocaleTimeString("ar"),orderCode:l.order_code};a(j=>[v,...j].slice(0,10)),s({title:p?" ":"",description:p?`   ${f}`:`    ${f}`,variant:p?"default":"destructive"})}catch(p){console.error("Error testing notification:",p),s({title:"",description:p.message||"    ",variant:"destructive"})}finally{r(!1)}},h=[{id:"fast_order_created",title:"  ",description:"      ",icon:Me,color:"bg-blue-500"},{id:"fast_order_assigned",title:"  ",description:"    ",icon:is,color:"bg-purple-500"},{id:"fast_order_confirmed",title:"  ",description:"   ",icon:Se,color:"bg-green-500"},{id:"fast_order_shipped",title:"  ",description:"     ",icon:Me,color:"bg-orange-500"},{id:"fast_order_delivered",title:"  ",description:"   ",icon:Se,color:"bg-green-600"},{id:"fast_order_rejected",title:"  ",description:"    ",icon:nt,color:"bg-red-500"},{id:"unified_order_created",title:"  ",description:"     ",icon:Me,color:"bg-indigo-500"},{id:"unified_order_split",title:"  ",description:"   ",icon:Me,color:"bg-cyan-500"},{id:"unified_order_confirmed",title:"  ",description:"     ",icon:Se,color:"bg-green-500"},{id:"system_error",title:"  ",description:"    ",icon:nt,color:"bg-red-600"}];return e.jsx("div",{className:"min-h-screen bg-background p-6",dir:"rtl",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx(dt,{className:"w-8 h-8 text-primary"}),e.jsx("h1",{className:"text-3xl font-bold",children:"  "})]}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"       "})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsxs($,{children:[e.jsxs(q,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(tn,{className:"w-5 h-5"})," "]}),e.jsx(Ze,{children:"   "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(et,{htmlFor:"order_code",children:" "}),e.jsx(it,{id:"order_code",value:l.order_code||"",onChange:f=>d("order_code",f.target.value),placeholder:"ORDER-123456"})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"customer_name",children:" "}),e.jsx(it,{id:"customer_name",value:l.customer_name||"",onChange:f=>d("customer_name",f.target.value),placeholder:" "})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"store_name",children:" "}),e.jsx(it,{id:"store_name",value:l.store_name||"",onChange:f=>d("store_name",f.target.value),placeholder:"  "})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"shipping_type",children:" "}),e.jsxs(ln,{value:l.shipping_type,onValueChange:f=>d("shipping_type",f),children:[e.jsx(Pr,{children:e.jsx(cn,{})}),e.jsxs(Ir,{children:[e.jsx(Nt,{value:"fast",children:""}),e.jsx(Nt,{value:"unified",children:""})]})]})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"total_amount",children:" "}),e.jsx(it,{id:"total_amount",type:"number",value:l.total_amount||"",onChange:f=>d("total_amount",parseInt(f.target.value)),placeholder:"150"})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"product_count",children:" "}),e.jsx(it,{id:"product_count",type:"number",value:l.product_count||"",onChange:f=>d("product_count",parseInt(f.target.value)),placeholder:"3"})]})]})]}),n.length>0&&e.jsxs($,{className:"mt-6",children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2",children:n.map((f,p)=>e.jsxs("div",{className:`p-3 rounded-lg border ${f.success?"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950":"border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-950"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f.success?e.jsx(Se,{className:"w-4 h-4 text-green-600"}):e.jsx(nt,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"font-medium text-sm",children:h.find(w=>w.id===f.scenario)?.title})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:f.timestamp})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[": ",f.orderCode]})]},p))})})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.map(f=>e.jsxs($,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${f.color}`,children:e.jsx(f.icon,{className:"w-5 h-5 text-white"})}),e.jsx("div",{children:e.jsx(V,{className:"text-lg",children:f.title})})]}),e.jsx(Ze,{className:"text-sm",children:f.description})]}),e.jsx(M,{children:e.jsxs(L,{onClick:()=>m(f.id),disabled:t,className:"w-full",size:"sm",children:[e.jsx(Ei,{className:"w-4 h-4 ml-2"}),t?" ...":" "]})})]},f.id))})})]}),e.jsxs($,{className:"mt-8",children:[e.jsx(q,{children:e.jsx(V,{children:"   "})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Me,{className:"w-8 h-8 text-blue-500 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-1",children:" "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"      "})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Me,{className:"w-8 h-8 text-purple-500 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-1",children:" "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"     "})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(dt,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-1",children:" "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"     "})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Se,{className:"w-8 h-8 text-orange-500 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-1",children:" "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"     "})]})]})})]})]})})};let sd=!1,Un=null,bi=null,Ni=null;const M5=()=>sd?(console.log(" Order notification triggers already initialized, skipping..."),()=>{}):(console.log(" Initializing order notification triggers..."),sd=!0,bi=I.channel("orders-notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"orders"},async s=>{console.log(" New order detected:",s.new);const t=s.new;t.assigned_store_id&&t.customer_name&&await X$(t.id,t.order_code||t.id.slice(0,8),t.assigned_store_id,t.customer_name)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders"},async s=>{console.log(" Order updated:",s);const t=s.old,r=s.new;if(!t.assigned_store_id&&r.assigned_store_id&&(console.log(" Order assigned to store, sending notification..."),await _i.notifyStore(r.assigned_store_id,"  !",`    ${r.order_code||r.id.slice(0,8)}   ${r.customer_name||""}.    .`,r.id)),t.order_status!==r.order_status&&r.assigned_store_id){let n="",a="";switch(r.order_status){case"urgent":a=" !",n=`    ${r.order_code}  .   !`;break;case"cancelled":a="  ",n=`    ${r.order_code}   .`;break;default:return}n&&await ys.sendSystemNotification(r.assigned_store_id,a,n)}}).subscribe(),Ni=I.channel("order-divisions-notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"order_divisions"},async s=>{console.log(" New order division detected:",s.new);const t=s.new;if(t.store_id&&t.order_id)try{const{data:r,error:n}=await I.from("orders").select("order_code, customer_name").eq("id",t.order_id).single();!n&&r&&await ys.notifyNewOrder(t.store_id,r.order_code||" ",r.customer_name||"",t.order_id)}catch(r){console.error(" Error sending order division notification:",{error:r,formattedError:JSON.stringify(r,null,2),operation:"sendOrderDivisionNotification",divisionId:t.id,storeId:t.store_id,orderId:t.order_id,stack:r?.stack})}}).subscribe(),console.log(" Order notification triggers initialized"),()=>{console.log(" Cleaning up order notification triggers..."),sd=!1,bi&&(I.removeChannel(bi),bi=null),Ni&&(I.removeChannel(Ni),Ni=null),console.log(" Order notification triggers cleaned up")}),F5=()=>{if(Un!==null)return console.log(" Periodic reminder system already running, skipping..."),()=>{};console.log(" Starting periodic reminder system...");const s=async()=>{try{console.log(" Checking for orders needing reminders...");const t=new Date;t.setMinutes(t.getMinutes()-5);const{data:r,error:n}=await I.from("orders").select("id, order_code, assigned_store_id, created_at").eq("order_status","assigned").is("store_response_status",null).lt("created_at",t.toISOString());if(n){console.error(" Error fetching orders for reminders:",{error:n,formattedError:JSON.stringify(n,null,2),timeWindow:t.toISOString(),operation:"fetchOrdersForReminders",query:"orders.eq(order_status, assigned).is(store_response_status, null).lt(created_at, timeWindow)"});return}if(r&&r.length>0){console.log(` Found ${r.length} orders needing reminders`);for(const a of r)a.assigned_store_id&&await ys.sendOrderReminder(a.assigned_store_id,a.order_code||a.id.slice(0,8),a.id)}else console.log(" No orders need reminders at this time")}catch(t){console.error(" Error in periodic reminder system:",{error:t,formattedError:JSON.stringify(t,null,2),operation:"periodicReminderSystem",timeWindow:fiveMinutesAgo?.toISOString(),stack:t?.stack})}};return Un=setInterval(s,300*1e3),s(),console.log(" Periodic reminder system started"),()=>{console.log(" Stopping periodic reminder system..."),Un&&(clearInterval(Un),Un=null),console.log(" Periodic reminder system stopped")}},sf=()=>{console.log(" Cleaning up all notification systems..."),sd=!1,bi&&(I.removeChannel(bi),bi=null),Ni&&(I.removeChannel(Ni),Ni=null),Un&&(clearInterval(Un),Un=null),console.log(" All notification systems cleaned up")},U5=async()=>{const s=new Date().toLocaleTimeString("ar");return await ys.sendBroadcastNotification(" ",`         ${s}`,"general")},z5=async()=>{try{const{data:s,error:t}=await I.from("notifications").select("recipient_id, read, created_at").eq("recipient_type","store");if(t||!s)return{totalStores:0,totalNotifications:0,unreadNotifications:0,storeStats:{}};const r={};return s.forEach(n=>{const a=n.recipient_id;r[a]||(r[a]={total:0,unread:0}),r[a].total++,n.read||r[a].unread++}),{totalStores:Object.keys(r).length,totalNotifications:s.length,unreadNotifications:s.filter(n=>!n.read).length,storeStats:r}}catch(s){return console.error(" Error getting global notification stats:",{error:s,formattedError:JSON.stringify(s,null,2),operation:"getGlobalNotificationStats",stack:s?.stack}),{totalStores:0,totalNotifications:0,unreadNotifications:0,storeStats:{}}}},W5=()=>{const{toast:s}=Xe(),[t,r]=x.useState(!1),[n,a]=x.useState([]),[l,c]=x.useState(""),[d,m]=x.useState(null),[h,f]=x.useState([]),[p,w]=x.useState(""),[v,j]=x.useState(""),[y,b]=x.useState("general"),[C,E]=x.useState(""),[S,O]=x.useState("");x.useEffect(()=>{R(),k(),P()},[]);const R=async()=>{try{const{data:H,error:G}=await I.from("stores").select("id, name").order("name");!G&&H&&(a(H),H.length>0&&!l&&c(H[0].id))}catch(H){console.error("Error loading stores:",H)}},k=async()=>{try{const H=await z5();m(H)}catch(H){console.error("Error loading notification stats:",H)}},P=async()=>{try{const{data:H,error:G}=await I.from("notifications").select(`
          id,
          message,
          prompt,
          created_at,
          read,
          recipient_id,
          stores!notifications_recipient_id_fkey(name)
        `).eq("recipient_type","store").order("created_at",{ascending:!1}).limit(10);!G&&H&&f(H)}catch(H){console.error("Error loading recent notifications:",H)}},F=async()=>{if(!l){s({title:"",description:"  ",variant:"destructive"});return}r(!0);try{const H=await Q$(l);s({title:H?" ":"",description:H?"   ":"   ",variant:H?"default":"destructive"}),H&&(await k(),await P())}catch{s({title:"",description:"   ",variant:"destructive"})}finally{r(!1)}},ee=async()=>{if(!l||!p||!v){s({title:"",description:"    ",variant:"destructive"});return}r(!0);try{const H=await ys.sendNotification({storeId:l,title:p,message:v,type:y,priority:"medium"});s({title:H?" ":"",description:H?"   ":"   ",variant:H?"default":"destructive"}),H&&(w(""),j(""),await k(),await P())}catch{s({title:"",description:"   ",variant:"destructive"})}finally{r(!1)}},ne=async()=>{if(!C||!S){s({title:"",description:"   ",variant:"destructive"});return}r(!0);try{const H=await U5();s({title:" ",description:`     ${H} `}),E(""),O(""),await k(),await P()}catch{s({title:"",description:"    ",variant:"destructive"})}finally{r(!1)}},pe=H=>{switch(H){case"order_assigned":return"";case"order_reminder":return"";case"system":return"";default:return""}},re=H=>{switch(H){case"order_assigned":return"bg-blue-100 text-blue-800";case"order_reminder":return"bg-orange-100 text-orange-800";case"system":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsx("div",{className:"min-h-screen bg-background p-6",dir:"rtl",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx(dt,{className:"w-8 h-8 text-primary"}),e.jsx("h1",{className:"text-3xl font-bold",children:"  "})]}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"   "})]}),d&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(is,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:d.totalStores}),e.jsx("p",{className:"text-muted-foreground",children:" "})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ra,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:d.totalNotifications}),e.jsx("p",{className:"text-muted-foreground",children:" "})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Bt,{className:"w-8 h-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:d.unreadNotifications}),e.jsx("p",{className:"text-muted-foreground",children:" "})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"p-6",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(L,{onClick:()=>{k(),P()},variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(ft,{className:"w-4 h-4"}),""]})})})})]}),e.jsxs(dn,{defaultValue:"individual",className:"w-full",children:[e.jsxs($r,{className:"grid w-full grid-cols-3",children:[e.jsx(ht,{value:"individual",children:" "}),e.jsx(ht,{value:"broadcast",children:" "}),e.jsx(ht,{value:"recent",children:" "})]}),e.jsx(mt,{value:"individual",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:"  "}),e.jsx(Ze,{children:"     "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(et,{htmlFor:"store-select",children:" "}),e.jsxs(ln,{value:l,onValueChange:c,children:[e.jsx(Pr,{children:e.jsx(cn,{placeholder:" "})}),e.jsx(Ir,{children:n.map(H=>e.jsx(Nt,{value:H.id,children:H.name},H.id))})]})]}),e.jsxs(L,{onClick:F,disabled:t||!l,className:"w-full",children:[e.jsx(Ei,{className:"w-4 h-4 ml-2"}),t?" ...":"  "]})]})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsx(Ze,{children:"   "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(et,{htmlFor:"notification-type",children:" "}),e.jsxs(ln,{value:y,onValueChange:H=>b(H),children:[e.jsx(Pr,{children:e.jsx(cn,{})}),e.jsxs(Ir,{children:[e.jsx(Nt,{value:"general",children:""}),e.jsx(Nt,{value:"order_assigned",children:" "}),e.jsx(Nt,{value:"order_reminder",children:""}),e.jsx(Nt,{value:"system",children:""})]})]})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"custom-title",children:""}),e.jsx(it,{id:"custom-title",value:p,onChange:H=>w(H.target.value),placeholder:" "})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"custom-message",children:""}),e.jsx(Ar,{id:"custom-message",value:v,onChange:H=>j(H.target.value),placeholder:" ",rows:3})]}),e.jsxs(L,{onClick:ee,disabled:t||!l||!p||!v,className:"w-full",children:[e.jsx(Ei,{className:"w-4 h-4 ml-2"}),t?" ...":" "]})]})]})]})}),e.jsx(mt,{value:"broadcast",className:"space-y-6",children:e.jsxs($,{className:"max-w-2xl mx-auto",children:[e.jsxs(q,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Hn,{className:"w-5 h-5"})," "]}),e.jsx(Ze,{children:"     "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(et,{htmlFor:"broadcast-title",children:" "}),e.jsx(it,{id:"broadcast-title",value:C,onChange:H=>E(H.target.value),placeholder:"  "})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"broadcast-message",children:" "}),e.jsx(Ar,{id:"broadcast-message",value:S,onChange:H=>O(H.target.value),placeholder:"     ",rows:4})]}),e.jsxs(L,{onClick:ne,disabled:t||!C||!S,className:"w-full",variant:"secondary",children:[e.jsx(Hn,{className:"w-4 h-4 ml-2"}),t?" ...":`   (${n.length})`]})]})]})}),e.jsx(mt,{value:"recent",className:"space-y-6",children:e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsx(Ze,{children:" 10    "})]}),e.jsx(M,{children:h.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Ra,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"  "})]}):e.jsx("div",{className:"space-y-3",children:h.map(H=>e.jsx("div",{className:`p-4 border rounded-lg ${H.read?"bg-gray-50":"bg-blue-50 border-blue-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("span",{className:"text-lg",children:pe(H.recipient_type||"general")}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium",children:H.title||""}),e.jsx(Q,{className:re(H.recipient_type||"general"),children:H.recipient_type||"general"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:H.message}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[": ",H.stores?.name||" "]}),e.jsx("span",{children:new Date(H.created_at).toLocaleString("ar")})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:H.read?e.jsx(Se,{className:"w-4 h-4 text-green-500"}):e.jsx(Rt,{className:"w-4 h-4 text-orange-500"})})]})},H.id))})})]})})]})]})})};async function Mb(){console.log(" Checking notifications table...");try{const{data:s,error:t}=await I.from("notifications").select("id, title").limit(1);return t?(console.error(" Notifications table check failed:",t),t.message.includes('relation "notifications" does not exist')?{exists:!1,error:"Table does not exist",needsMigration:!0}:t.message.includes("title")?{exists:!0,error:"Title column missing",needsMigration:!0}:{exists:!1,error:t.message,needsMigration:!0}):(console.log(" Notifications table exists and is accessible"),{exists:!0,error:null,needsMigration:!1})}catch(s){return console.error(" Exception checking notifications table:",s),{exists:!1,error:String(s),needsMigration:!0}}}async function Fb(){console.log(" Creating notifications table...");const s=`
    CREATE TABLE IF NOT EXISTS notifications (
      id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
      recipient_type TEXT NOT NULL CHECK (recipient_type IN ('admin', 'store', 'customer')),
      recipient_id TEXT NOT NULL,
      title TEXT NOT NULL,
      message TEXT NOT NULL,
      order_id TEXT,
      created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
      read BOOLEAN DEFAULT false,
      sent BOOLEAN DEFAULT false,
      sent_at TIMESTAMP WITH TIME ZONE
    );

    CREATE INDEX IF NOT EXISTS idx_notifications_recipient ON notifications(recipient_id, recipient_type);
    CREATE INDEX IF NOT EXISTS idx_notifications_created_at ON notifications(created_at DESC);
    CREATE INDEX IF NOT EXISTS idx_notifications_read ON notifications(read);
  `;try{const{error:t}=await I.rpc("execute_sql",{sql_query:s});return t?(console.error(" Failed to create notifications table:",t),{success:!1,error:t.message||String(t)}):(console.log(" Notifications table created successfully"),{success:!0,error:null})}catch(t){return console.error(" Exception creating notifications table:",t),{success:!1,error:String(t)}}}async function Ub(){console.log(" Checking if notifications table exists...");try{const s=await Mb();if(s.exists&&!s.needsMigration)return console.log(" Notifications table already exists and is working properly"),!0;if(s.needsMigration||!s.exists){console.log(" Creating notifications table...");const t=await Fb();if(t.success){console.log(" Notifications table created successfully");const r=`
          ALTER TABLE notifications 
          ADD COLUMN IF NOT EXISTS url TEXT,
          ADD COLUMN IF NOT EXISTS priority TEXT CHECK (priority IN ('low', 'medium', 'high', 'urgent')) DEFAULT 'medium',
          ADD COLUMN IF NOT EXISTS type TEXT DEFAULT 'general',
          ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP WITH TIME ZONE DEFAULT now();

          CREATE INDEX IF NOT EXISTS idx_notifications_priority ON notifications(priority);
          CREATE INDEX IF NOT EXISTS idx_notifications_type ON notifications(type);
          CREATE INDEX IF NOT EXISTS idx_notifications_url ON notifications(url);
        `,{error:n}=await I.rpc("execute_sql",{sql_query:r});return n?console.warn(" Failed to add enhancement columns:",n):console.log(" Notifications table enhanced successfully"),!0}else return console.error(" Failed to create notifications table:",t.error),!1}return!0}catch(s){return console.error(" Error ensuring notifications table exists:",s),!1}}const Uy=({current_store:s,className:t="",maxHeight:r="400px",showHeader:n=!0})=>{const[a,l]=x.useState([]),[c,d]=x.useState(!0),[m,h]=x.useState(null),[f,p]=x.useState(0),{toast:w}=Xe(),v=x.useCallback(async()=>{try{if(d(!0),h(null),!await Ub())throw new Error("Failed to setup notifications table");const{data:S,error:O}=await I.from("notifications").select("*").eq("recipient_type","store").eq("recipient_id",s.id).order("created_at",{ascending:!1}).limit(50);if(O)throw O;const R=S||[];l(R),p(R.filter(k=>!k.read).length),console.log(` Loaded ${R.length} notifications for store ${s.id}`)}catch(E){console.error(" Error setting up notifications:",E),h(E instanceof Error?E.message:"Failed to load notifications")}finally{d(!1)}},[s.id]);x.useEffect(()=>{let E=null;const S=async()=>{await v();const O=I.channel("notifications_channel").on("broadcast",{event:"new_notification"},R=>{console.log(" New notification event received:",R);const k=R.payload;k.recipient_type==="store"&&k.recipient_id===s.id&&(l(P=>[k,...P]),p(P=>P+1),console.log(" Added new notification to store list"))}).subscribe(R=>{console.log(" notifications_channel status:",R),R==="SUBSCRIBED"?console.log(` Successfully subscribed to notifications_channel for store: ${s.id}`):R==="CHANNEL_ERROR"&&(console.error(" Channel error for notifications_channel"),h("Connection error. Please refresh the page."))});E=()=>{I.removeChannel(O),console.log(" Unsubscribed from notifications_channel")}};return s?.id&&S(),()=>{E&&E()}},[s.id,v]);const j=async E=>{try{const{error:S}=await I.from("notifications").update({read:!0}).eq("id",E.id);if(S)throw S;l(O=>O.map(R=>R.id===E.id?{...R,read:!0}:R)),p(O=>Math.max(0,O-1)),console.log(" Notification marked as read:",E.id),E.url&&(window.location.href=E.url)}catch(S){console.error(" Error handling notification click:",S),w({title:"",description:"    ",variant:"destructive"})}},y=async()=>{try{const{error:E}=await I.from("notifications").update({read:!0}).eq("recipient_id",s.id).eq("recipient_type","store").eq("read",!1);if(E)throw E;l(S=>S.map(O=>({...O,read:!0}))),p(0),w({title:"",description:"    "})}catch(E){console.error(" Error marking all notifications as read:",E),w({title:"",description:"   ",variant:"destructive"})}},b=E=>{switch(E){case"urgent":return"bg-red-500 text-white";case"high":return"bg-orange-500 text-white";case"medium":return"bg-blue-500 text-white";case"low":return"bg-gray-500 text-white";default:return"bg-gray-400 text-white"}},C=E=>{switch(E){case"urgent":return"";case"high":return"";case"medium":return"";case"low":return"";default:return""}};return c?e.jsxs($,{className:t,children:[n&&e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"w-5 h-5"}),""]})}),e.jsx(M,{children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("span",{className:"ml-2",children:" ..."})]})})]}):m?e.jsxs($,{className:t,children:[n&&e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"w-5 h-5"}),""]})}),e.jsx(M,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-600 mb-4",children:m}),e.jsx(L,{onClick:v,variant:"outline",children:" "})]})})]}):e.jsxs($,{className:t,children:[n&&e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(V,{className:"flex items-center gap-2",children:[f>0?e.jsx(uf,{className:"w-5 h-5 text-orange-500"}):e.jsx(dt,{className:"w-5 h-5"}),"",f>0&&e.jsx(Q,{variant:"destructive",className:"ml-2",children:f})]}),f>0&&e.jsx(L,{onClick:y,variant:"outline",size:"sm",className:"text-xs",children:"  "})]})}),e.jsx(M,{className:"p-0",children:e.jsx(ei,{className:"h-full",style:{maxHeight:r},children:a.length===0?e.jsxs("div",{className:"text-center py-8 px-4 text-muted-foreground",children:[e.jsx(dt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"   "})]}):e.jsx("div",{className:"space-y-1",children:a.map((E,S)=>e.jsxs("div",{children:[e.jsx("div",{className:Ue("p-4 cursor-pointer transition-colors hover:bg-muted/50",!E.read&&"bg-blue-50 border-r-4 border-blue-500"),onClick:()=>j(E),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:E.read?e.jsx("div",{className:"w-2 h-2"}):e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("h4",{className:Ue("text-sm font-medium text-right",!E.read&&"font-semibold"),children:[C(E.priority)," ",E.title]}),e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[E.priority&&e.jsx(Q,{variant:"outline",className:Ue("text-xs px-1 py-0",b(E.priority)),children:E.priority}),E.url&&e.jsx(ji,{className:"w-3 h-3 text-muted-foreground"})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 text-right",children:E.message}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Rt,{className:"w-3 h-3"}),vl(new Date(E.created_at),{addSuffix:!0,locale:Zd})]}),!E.read&&e.jsx(L,{onClick:O=>{O.stopPropagation(),j(E)},variant:"ghost",size:"sm",className:"text-xs p-1 h-auto",children:e.jsx(Se,{className:"w-3 h-3"})})]})]})]})}),S<a.length-1&&e.jsx(jl,{})]},E.id))})})})]})},zy=({current_store:s,autoHideDuration:t=1e4})=>{const[r,n]=x.useState([]);x.useEffect(()=>{console.log(` Setting up toast notifications for store: ${s.id}`);const d=I.channel("notifications_channel").on("broadcast",{event:"new_notification"},m=>{console.log(" New toast notification event received:",m);const h=m.payload;if(h.recipient_type==="store"&&h.recipient_id===s.id&&(h.priority==="urgent"||h.priority==="high")){const p={...h,show:!0};n(v=>[...v,p]);const w=setTimeout(()=>{a(h.id)},t);n(v=>v.map(j=>j.id===h.id?{...j,autoHideTimer:w}:j)),console.log(" Showing toast for urgent/high priority notification")}}).subscribe(m=>{console.log(" Toast notifications_channel status:",m)});return()=>{I.removeChannel(d),console.log(" Unsubscribed from toast notifications_channel")}},[s.id,t]);const a=x.useCallback(d=>{n(m=>{const h=m.find(f=>f.id===d);return h?.autoHideTimer&&clearTimeout(h.autoHideTimer),m.filter(f=>f.id!==d)})},[]),l=x.useCallback(d=>{d.url&&(window.location.href=d.url),a(d.id)},[a]),c=d=>{switch(d){case"urgent":return{className:"border-red-500 bg-red-50 text-red-900",icon:"",badgeClass:"bg-red-500 text-white"};case"high":return{className:"border-orange-500 bg-orange-50 text-orange-900",icon:"",badgeClass:"bg-orange-500 text-white"};case"medium":return{className:"border-blue-500 bg-blue-50 text-blue-900",icon:"",badgeClass:"bg-blue-500 text-white"};case"low":return{className:"border-gray-500 bg-gray-50 text-gray-900",icon:"",badgeClass:"bg-gray-500 text-white"};default:return{className:"border-gray-400 bg-gray-50 text-gray-900",icon:"",badgeClass:"bg-gray-400 text-white"}}};return x.useEffect(()=>()=>{r.forEach(d=>{d.autoHideTimer&&clearTimeout(d.autoHideTimer)})},[r]),r.length===0?null:e.jsxs(T0,{children:[e.jsx(ff,{className:"fixed top-4 right-4 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:flex-col md:max-w-[420px]"}),r.map(d=>{const m=c(d.priority);return e.jsxs(pf,{className:Ue("border-2 shadow-lg max-w-md",m.className,d.url&&"cursor-pointer hover:shadow-xl transition-shadow"),onClick:d.url?()=>l(d):void 0,children:[e.jsxs("div",{className:"flex items-start gap-3 w-full",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"text-lg",children:m.icon})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx(xf,{className:"text-right font-semibold text-sm",children:d.title}),e.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[d.priority&&e.jsx(Q,{variant:"outline",className:Ue("text-xs px-1 py-0",m.badgeClass),children:d.priority}),d.url&&e.jsx(ji,{className:"w-3 h-3 opacity-60"})]})]}),e.jsx(vf,{className:"text-right text-sm",children:d.message}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[d.url&&e.jsx(L,{onClick:h=>{h.stopPropagation(),l(d)},variant:"outline",size:"sm",className:"text-xs",children:" "}),e.jsxs("div",{className:"flex items-center gap-2 text-xs opacity-60",children:[e.jsx(Rt,{className:"w-3 h-3"}),""]})]})]})]}),e.jsx(gf,{onClick:h=>{h.stopPropagation(),a(d.id)},className:"absolute top-2 left-2",children:e.jsx(Vn,{className:"w-4 h-4"})})]},d.id)})]})},B5=()=>{const[s,t]=x.useState("demo-store-001"),[r,n]=x.useState(" "),[a,l]=x.useState("     "),[c,d]=x.useState("medium"),[m,h]=x.useState("/store-dashboard"),[f,p]=x.useState(!1),{toast:w}=Xe(),v=[{id:"demo-store-001",name:" "},{id:"demo-store-002",name:" "},{id:"demo-store-003",name:" "},{id:"test-store-004",name:" "}],j={id:s},y=async()=>{p(!0);try{const b={recipient_type:"store",recipient_id:s,title:r,message:a,priority:c,url:m,read:!1,sent:!0,created_at:new Date().toISOString()},{error:C}=await I.from("notifications").insert(b);if(C)throw C;const{error:E}=await I.channel("notifications_channel").send({type:"broadcast",event:"new_notification",payload:b});if(E)throw E;w({title:" ",description:`   ${c}  ${s}`})}catch(b){console.error("Error sending test notification:",b),w({title:"",description:"    ",variant:"destructive"})}finally{p(!1)}};return e.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-6xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(dt,{className:"w-8 h-8 text-primary"}),e.jsx("h1",{className:"text-3xl font-bold",children:"   -  "})]}),e.jsx("p",{className:"text-muted-foreground",children:"     Supabase Realtime     "})]}),e.jsxs($,{className:"mb-6",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(J1,{className:"w-5 h-5"}),"  "]})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"Supabase Integration:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Table:"}),e.jsx(Q,{variant:"outline",className:"font-mono",children:"notifications"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Realtime Channel:"}),e.jsx(Q,{variant:"outline",className:"font-mono",children:"notifications_channel"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Event Name:"}),e.jsx(Q,{variant:"outline",className:"font-mono",children:"new_notification"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Store Context:"}),e.jsx(Q,{variant:"outline",className:"font-mono",children:"current_store.id"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"Query Filters:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"recipient_type:"}),e.jsx(Q,{variant:"outline",className:"font-mono",children:"'store'"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"recipient_id:"}),e.jsx(Q,{variant:"outline",className:"font-mono",children:"current_store.id"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Order:"}),e.jsx(Q,{variant:"outline",className:"font-mono",children:"created_at DESC"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Toast Filter:"}),e.jsx(Q,{variant:"outline",className:"font-mono",children:"'urgent' | 'high'"})]})]})]})]})})]}),e.jsxs($,{className:"mb-6",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-5 h-5"}),"  (current_store.id)"]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:v.map(b=>e.jsx(L,{onClick:()=>t(b.id),variant:s===b.id?"default":"outline",size:"sm",children:b.name},b.id))}),e.jsxs(At,{children:[e.jsx(is,{className:"h-4 w-4"}),e.jsxs(Dt,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"  :"}),e.jsx(Q,{variant:"outline",className:"font-mono",children:s})]})]})]})})]}),e.jsxs(dn,{defaultValue:"live",className:"space-y-6",children:[e.jsxs($r,{className:"grid w-full grid-cols-2",children:[e.jsx(ht,{value:"live",children:" "}),e.jsx(ht,{value:"testing",children:" "})]}),e.jsxs(mt,{value:"live",className:"space-y-6",children:[e.jsxs(At,{children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsx(Dt,{children:"   .         /   ."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ov,{className:"w-5 h-5"}),""]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx(dt,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm",children:" "}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" notifications_channel"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(Se,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm",children:" "}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"   read"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-purple-50 rounded-lg",children:[e.jsx(rn,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm",children:" "}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"urgent, high, medium, low"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-orange-50 rounded-lg",children:[e.jsx(Ra,{className:"w-5 h-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm",children:" "}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" urgent & high"})]})]})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(Uy,{current_store:j,maxHeight:"500px",showHeader:!0,className:"shadow-md"})})]}),e.jsx(zy,{current_store:j,autoHideDuration:1e4})]}),e.jsxs(mt,{value:"testing",className:"space-y-6",children:[e.jsxs(At,{children:[e.jsx(ds,{className:"h-4 w-4"}),e.jsx(Dt,{children:"            ."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"  "})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(et,{htmlFor:"title",children:""}),e.jsx(it,{id:"title",value:r,onChange:b=>n(b.target.value),placeholder:" "})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"message",children:""}),e.jsx(it,{id:"message",value:a,onChange:b=>l(b.target.value),placeholder:" "})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"priority",children:""}),e.jsxs(ln,{value:c,onValueChange:b=>d(b),children:[e.jsx(Pr,{children:e.jsx(cn,{})}),e.jsxs(Ir,{children:[e.jsx(Nt,{value:"low",children:" (low)"}),e.jsx(Nt,{value:"medium",children:" (medium)"}),e.jsx(Nt,{value:"high",children:" (high) -  toast"}),e.jsx(Nt,{value:"urgent",children:" (urgent) -  toast"})]})]})]}),e.jsxs("div",{children:[e.jsx(et,{htmlFor:"url",children:" (URL)"}),e.jsx(it,{id:"url",value:m,onChange:b=>h(b.target.value),placeholder:"/store-dashboard"})]}),e.jsx(jl,{}),e.jsx(L,{onClick:y,disabled:f||!r||!a,className:"w-full",children:f?" ...":"  "}),e.jsxs(At,{children:[e.jsx(ov,{className:"h-4 w-4"}),e.jsxs(Dt,{className:"text-xs",children:[e.jsx("strong",{children:":"}),'    ""  ""         .']})]})]})]}),e.jsx(Uy,{current_store:j,maxHeight:"400px",showHeader:!0,className:"shadow-md"})]}),e.jsx(zy,{current_store:j,autoHideDuration:8e3})]})]}),e.jsxs($,{className:"mt-8",children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:" :   (Store Notification Center)"}),e.jsxs("ul",{className:"space-y-1 text-muted-foreground list-disc list-inside",children:[e.jsxs("li",{children:["   : ",e.jsx("code",{children:"recipient_type='store' AND recipient_id=current_store.id"})]}),e.jsxs("li",{children:["  : ",e.jsx("code",{children:"created_at DESC"})]}),e.jsxs("li",{children:["  : ",e.jsx("code",{children:"store_notifications"})," state variable"]}),e.jsxs("li",{children:["  : ",e.jsx("code",{children:"notifications_channel"}),"   ",e.jsx("code",{children:"new_notification"})]}),e.jsx("li",{children:"     "}),e.jsx("li",{children:"     ( )"}),e.jsxs("li",{children:[" :  ",e.jsx("code",{children:"read=true"}),"   ",e.jsx("code",{children:"url"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:" :   (Toast Notifications)"}),e.jsxs("ul",{className:"space-y-1 text-muted-foreground list-disc list-inside",children:[e.jsxs("li",{children:["  : ",e.jsx("code",{children:"notifications_channel / new_notification"})]}),e.jsxs("li",{children:["  : ",e.jsx("code",{children:"priority='urgent' OR priority='high'"})]}),e.jsx("li",{children:"  overlay    "}),e.jsx("li",{children:"  "}),e.jsx("li",{children:"   (X)"}),e.jsx("li",{children:"   10 "}),e.jsxs("li",{children:["     ",e.jsx("code",{children:"url"})]})]})]})]})})]})]})};async function q5(){try{console.log(" Setting up admin_notifications table...");const{error:s}=await I.rpc("execute_sql",{sql_query:`
        -- Create admin_notifications table
        CREATE TABLE IF NOT EXISTS admin_notifications (
          id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
          title TEXT NOT NULL,
          message TEXT NOT NULL,
          type TEXT NOT NULL CHECK (type IN ('new_order', 'pending_order', 'store_response', 'system')),
          order_id UUID NULL,
          customer_name TEXT NULL,
          order_code TEXT NULL,
          url TEXT NULL,
          is_read BOOLEAN DEFAULT FALSE,
          created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
          updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
        );

        -- Create indexes
        CREATE INDEX IF NOT EXISTS idx_admin_notifications_created_at ON admin_notifications (created_at DESC);
        CREATE INDEX IF NOT EXISTS idx_admin_notifications_is_read ON admin_notifications (is_read);
        CREATE INDEX IF NOT EXISTS idx_admin_notifications_type ON admin_notifications (type);

        -- Enable RLS
        ALTER TABLE admin_notifications ENABLE ROW LEVEL SECURITY;
      `});if(s)return console.error(" Error creating table:",s),{success:!1,error:s};const{error:t}=await I.rpc("execute_sql",{sql_query:`
        -- Drop existing policy if it exists
        DROP POLICY IF EXISTS "Admin can manage notifications" ON admin_notifications;
        
        -- Create policy for admin access
        CREATE POLICY "Admin can manage notifications" ON admin_notifications
          FOR ALL USING (
            EXISTS (
              SELECT 1 FROM users 
              WHERE users.id = auth.uid() 
              AND users.is_admin = true
            )
          );
      `});return t&&console.warn("  Warning creating RLS policy (table still created):",t),console.log(" admin_notifications table setup completed"),{success:!0}}catch(s){return console.error(" Exception during table setup:",s),{success:!1,error:s}}}async function H5(){try{console.log(" Testing admin_notifications table...");const{data:s,error:t}=await I.from("admin_notifications").select("count(*)").limit(1);return t?(console.error(" Table test failed:",t),{success:!1,error:t}):(console.log(" admin_notifications table is accessible"),{success:!0,data:s})}catch(s){return console.error(" Exception during table test:",s),{success:!1,error:s}}}function V5(){const{toast:s}=Xe(),[t,r]=x.useState(!1),[n,a]=x.useState(null),[l,c]=x.useState(null),d=async()=>{r(!0);try{const h=await q5();a(h),h.success?s({title:"   ",description:"   admin_notifications   "}):s({title:"   ",description:"    ",variant:"destructive"})}catch(h){console.error("Setup error:",h),s({title:"   ",description:"   ",variant:"destructive"})}finally{r(!1)}},m=async()=>{r(!0);try{const h=await H5();c(h),h.success?s({title:"  ",description:" admin_notifications   "}):s({title:"  ",description:"   ",variant:"destructive"})}catch(h){console.error("Test error:",h),s({title:"   ",description:"   ",variant:"destructive"})}finally{r(!1)}};return e.jsx("div",{className:"container mx-auto p-6 space-y-6",children:e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:"   "}),e.jsx(Ze,{children:"     "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx(L,{onClick:d,disabled:t,children:" "}),e.jsx(L,{onClick:m,disabled:t,variant:"outline",children:" "})]}),n&&e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{className:"text-lg",children:" "})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(Q,{variant:n.success?"default":"destructive",children:n.success?"":""})}),n.error&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded",children:e.jsx("pre",{children:JSON.stringify(n.error,null,2)})})]})})]}),l&&e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{className:"text-lg",children:" "})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(Q,{variant:l.success?"default":"destructive",children:l.success?"":""})}),l.error&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded",children:e.jsx("pre",{children:JSON.stringify(l.error,null,2)})}),l.data&&e.jsx("div",{className:"text-sm text-green-600 bg-green-50 p-3 rounded",children:"    "})]})})]})]})]})})}function G5(){const{toast:s}=Xe(),[t,r]=x.useState(!1),[n,a]=x.useState([]),[l,c]=x.useState([]),d=async()=>{try{const{data:f,error:p}=await I.from("notifications").select("*").eq("recipient_type","admin").eq("recipient_id","admin").order("created_at",{ascending:!1}).limit(10);p?console.error("Error loading from unified database:",p):a(f||[])}catch(f){console.error("Exception loading from database:",f)}c(It.getNotifications())};x.useEffect(()=>{d()},[]);const m=async()=>{r(!0);try{await It.addTestNotification(),s({title:"   ",description:"       "}),setTimeout(()=>{d()},1e3)}catch(f){console.error("Error creating test notification:",f),s({title:"    ",description:"     ",variant:"destructive"})}finally{r(!1)}},h=async()=>{r(!0);try{const{data:f,error:p}=await I.from("notifications").select("count(*)").eq("recipient_type","admin").limit(1);s(p?{title:"  ",description:`    : ${p.message}`,variant:"destructive"}:{title:"  ",description:"   notifications  "})}catch{s({title:"   ",description:"    ",variant:"destructive"})}finally{r(!1)}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"  "}),e.jsx(ob,{})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsx(Ze,{children:"       "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsx(L,{onClick:m,disabled:t,className:"w-full",children:"  "}),e.jsx(L,{onClick:h,disabled:t,variant:"outline",className:"w-full",children:"   "}),e.jsx(L,{onClick:d,disabled:t,variant:"secondary",className:"w-full",children:" "}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" : ",l.length]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["  : ",n.length]})]})]})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsx(Ze,{children:"   localStorage"})]}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:l.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"   "}):l.map((f,p)=>e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium text-sm",children:f.title}),e.jsx(Q,{variant:f.isRead?"secondary":"default",children:f.isRead?"":""})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:f.message}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(f.timestamp).toLocaleString("ar-SA")})]},p))})})]})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:"  "}),e.jsx(Ze,{children:"    notifications  ( )"})]}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:n.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"     "}):n.map((f,p)=>e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium text-sm",children:f.title}),e.jsx(Q,{variant:f.read?"secondary":"default",children:f.read?"":""})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:f.message}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["ID: ",f.id," | : ",f.type," | : ",f.recipient_type]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[": ",f.priority||""," | : ",f.sent?"":""]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(f.created_at).toLocaleString("ar-SA")})]},f.id))})})]})]})}function Y5(){const{toast:s}=Xe(),[t,r]=x.useState(!1),[n,a]=x.useState([]),[l,c]=x.useState("disconnected"),[d,m]=x.useState({customer_name:" ",customer_phone:"07701234567",customer_address:"  ",customer_city:"",total_amount:5e4,order_details:"    ",main_store_name:" "}),[h,f]=x.useState({orderId:"",orderStatus:"assigned",storeResponseStatus:"available"});x.useEffect(()=>{console.log(" Setting up Realtime test subscriptions...");const y=I.channel("realtime-test-channel").on("postgres_changes",{event:"*",schema:"public",table:"orders"},b=>{console.log(" Realtime event received:",b);const C={id:Date.now(),timestamp:new Date().toISOString(),event:b.eventType,table:"orders",data:b.new||b.old,payload:b};a(E=>[C,...E.slice(0,19)]),s({title:"  Realtime",description:`${b.eventType}   orders`})}).on("postgres_changes",{event:"*",schema:"public",table:"orders"},b=>{console.log(" Store response event received:",b);const C={id:Date.now(),timestamp:new Date().toISOString(),event:b.eventType,table:"orders",data:b.new||b.old,payload:b};a(E=>[C,...E.slice(0,19)]),s({title:"  ",description:`${b.eventType}   store_order_responses`})}).subscribe(b=>{console.log(" Test channel status:",b),c(b),b==="SUBSCRIBED"&&s({title:"   Realtime",description:"   -   "})});return()=>{console.log(" Cleaning up test channel..."),I.removeChannel(y)}},[s]);const p=async()=>{r(!0);try{console.log(" Creating test order:",d);const{data:y,error:b}=await I.from("orders").insert([{...d,order_code:`TEST-${Date.now()}`,order_status:"pending",created_at:new Date().toISOString()}]).select().single();if(b)throw b;console.log(" Test order created:",y),f(C=>({...C,orderId:y.id})),s({title:"    ",description:` ${y.order_code} -     `})}catch(y){console.error(" Error creating test order:",y),s({title:"    ",description:y instanceof Error?y.message:"  ",variant:"destructive"})}finally{r(!1)}},w=async()=>{if(!h.orderId){s({title:" ",description:"    ",variant:"destructive"});return}r(!0);try{console.log(" Updating test order:",h);const{error:y}=await I.from("orders").update({order_status:h.orderStatus,store_response_status:h.storeResponseStatus,updated_at:new Date().toISOString()}).eq("id",h.orderId);if(y)throw y;s({title:"   ",description:"     "})}catch(y){console.error(" Error updating test order:",y),s({title:"   ",description:y instanceof Error?y.message:"  ",variant:"destructive"})}finally{r(!1)}},v=async()=>{if(!h.orderId){s({title:" ",description:"   ",variant:"destructive"});return}r(!0);try{console.log(" Deleting test order:",h.orderId);const{error:y}=await I.from("orders").delete().eq("id",h.orderId);if(y)throw y;f(b=>({...b,orderId:""})),s({title:"   ",description:"     "})}catch(y){console.error(" Error deleting test order:",y),s({title:"   ",description:y instanceof Error?y.message:"  ",variant:"destructive"})}finally{r(!1)}},j=()=>{a([]),s({title:"   ",description:"   "})};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"   (Realtime)"}),e.jsx(Q,{variant:l==="SUBSCRIBED"?"default":"destructive",children:l==="SUBSCRIBED"?" ":"  "})]}),e.jsxs(dn,{defaultValue:"test",className:"w-full",children:[e.jsxs($r,{className:"grid w-full grid-cols-2",children:[e.jsx(ht,{value:"test",children:" "}),e.jsxs(ht,{value:"events",children:["  (",n.length,")"]})]}),e.jsx(mt,{value:"test",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:"  "}),e.jsx(Ze,{children:"     "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{htmlFor:"customer_name",children:" "}),e.jsx(it,{id:"customer_name",value:d.customer_name,onChange:y=>m(b=>({...b,customer_name:y.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{htmlFor:"customer_phone",children:" "}),e.jsx(it,{id:"customer_phone",value:d.customer_phone,onChange:y=>m(b=>({...b,customer_phone:y.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{htmlFor:"total_amount",children:" "}),e.jsx(it,{id:"total_amount",type:"number",value:d.total_amount,onChange:y=>m(b=>({...b,total_amount:Number(y.target.value)}))})]}),e.jsx(L,{onClick:p,disabled:t,className:"w-full",children:"  "})]})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsx(Ze,{children:"    "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{htmlFor:"order_status",children:" "}),e.jsxs("select",{id:"order_status",className:"w-full p-2 border rounded",value:h.orderStatus,onChange:y=>f(b=>({...b,orderStatus:y.target.value})),children:[e.jsx("option",{value:"pending",children:""}),e.jsx("option",{value:"assigned",children:""}),e.jsx("option",{value:"delivered",children:""}),e.jsx("option",{value:"returned",children:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{htmlFor:"store_response",children:" "}),e.jsxs("select",{id:"store_response",className:"w-full p-2 border rounded",value:h.storeResponseStatus,onChange:y=>f(b=>({...b,storeResponseStatus:y.target.value})),children:[e.jsx("option",{value:"",children:"  "}),e.jsx("option",{value:"available",children:""}),e.jsx("option",{value:"unavailable",children:" "})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{onClick:w,disabled:t||!h.orderId,className:"flex-1",children:" "}),e.jsx(L,{onClick:v,disabled:t||!h.orderId,variant:"destructive",className:"flex-1",children:" "})]}),h.orderId&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" : ",h.orderId.slice(0,8),"..."]})]})]})]})}),e.jsx(mt,{value:"events",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(V,{children:"  Realtime"}),e.jsx(Ze,{children:"       "})]}),e.jsx(L,{onClick:j,variant:"outline",size:"sm",children:" "})]})}),e.jsx(M,{children:e.jsx(ei,{className:"h-[500px]",children:n.length===0?e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:["    ...",e.jsx("br",{}),"      "]}):e.jsx("div",{className:"space-y-4",children:n.map(y=>e.jsxs("div",{className:"border rounded-lg p-4 bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Q,{variant:y.event==="INSERT"?"default":y.event==="UPDATE"?"secondary":y.event==="DELETE"?"destructive":"outline",children:y.event}),e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(y.timestamp).toLocaleTimeString("ar-SA")})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:":"})," ",y.table]}),y.data?.customer_name&&e.jsxs("div",{children:[e.jsx("strong",{children:":"})," ",y.data.customer_name]}),y.data?.order_code&&e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",y.data.order_code]}),y.data?.order_status&&e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",y.data.order_status]}),y.data?.store_response_status&&e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",y.data.store_response_status]})]}),e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-xs text-muted-foreground cursor-pointer",children:"  "}),e.jsx("pre",{className:"text-xs bg-background p-2 rounded mt-2 overflow-auto",children:JSON.stringify(y.data,null,2)})]})]},y.id))})})})]})})]})]})}function K5(){const{toast:s}=Xe(),[t,r]=x.useState(!1),[n,a]=x.useState(null),[l,c]=x.useState({}),[d,m]=x.useState([]),[h,f]=x.useState(0),p=async()=>{r(!0),f(0);try{const C=await Sa.runDiagnostics();a(C),f(100),C.realtimeConnection?s({title:"  ",description:"    "}):s({title:"   ",description:"   ",variant:"destructive"})}catch(C){console.error("Diagnostics error:",C),s({title:"   ",description:"    ",variant:"destructive"})}finally{r(!1)}},w=()=>{console.log(" Testing live Realtime connection...");const C=I.channel("diagnostic-test-"+Date.now()).on("postgres_changes",{event:"*",schema:"public",table:"orders"},E=>{console.log(" Test event received:",E);const S={id:Date.now(),timestamp:new Date().toISOString(),event:E.eventType,table:"orders",data:E.new||E.old,payload:E};m(O=>[S,...O.slice(0,9)]),s({title:"  !",description:`  ${E.eventType}   orders`})}).subscribe(E=>{console.log(" Test channel status:",E),c(S=>({...S,liveTest:{status:E,timestamp:new Date().toISOString()}})),E==="SUBSCRIBED"?s({title:"   ",description:"   "}):E==="CHANNEL_ERROR"&&s({title:"   ",description:"   ",variant:"destructive"})});setTimeout(()=>{I.removeChannel(C),c(E=>({...E,liveTest:{...E.liveTest,status:"disconnected"}}))},3e4)},v=async()=>{try{console.log(" Creating test order for Realtime...");const{data:C,error:E}=await I.from("orders").insert([{customer_name:"  Realtime",customer_phone:"07700000000",customer_address:" ",customer_city:"",total_amount:1e3,order_details:"   Realtime - "+new Date().toISOString(),order_code:`RT-TEST-${Date.now()}`,order_status:"pending",main_store_name:" "}]).select().single();if(E)throw E;return s({title:"    ",description:` ${C.order_code} -   `}),C}catch(C){console.error("Error creating test order:",C),s({title:"    ",description:C instanceof Error?C.message:"  ",variant:"destructive"})}},j=async()=>{const{data:C}=await I.from("orders").select("*").like("order_code","RT-TEST-%").order("created_at",{ascending:!1}).limit(1);if(!C||C.length===0){s({title:"    ",description:"   ",variant:"destructive"});return}const E=C[0];try{const{error:S}=await I.from("orders").update({order_status:E.order_status==="pending"?"assigned":"pending",store_response_status:E.store_response_status==="available"?"unavailable":"available",updated_at:new Date().toISOString()}).eq("id",E.id);if(S)throw S;s({title:"   ",description:` ${E.order_code} -   `})}catch(S){console.error("Error updating test order:",S),s({title:"   ",description:S instanceof Error?S.message:"  ",variant:"destructive"})}};x.useEffect(()=>{const C=setInterval(()=>{const E=Sa.getConnectionsStatus();c(S=>({...S,...E}))},5e3);return()=>clearInterval(C)},[]);const y=C=>C===!0||C==="SUBSCRIBED"?e.jsx(Se,{className:"h-5 w-5 text-green-600"}):C===!1||C==="CHANNEL_ERROR"?e.jsx(lt,{className:"h-5 w-5 text-red-600"}):e.jsx(nt,{className:"h-5 w-5 text-yellow-600"}),b=C=>C===!0||C==="SUBSCRIBED"?"bg-green-100 text-green-800":C===!1||C==="CHANNEL_ERROR"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800";return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:" Realtime"}),e.jsx(L,{onClick:p,disabled:t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"})," ..."]}):" "})]}),t&&e.jsx($,{children:e.jsx(M,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"  ..."}),e.jsxs("span",{children:[h,"%"]})]}),e.jsx(Ho,{value:h,className:"w-full"})]})})}),e.jsxs(dn,{defaultValue:"status",className:"w-full",children:[e.jsxs($r,{className:"grid w-full grid-cols-4",children:[e.jsx(ht,{value:"status",children:""}),e.jsx(ht,{value:"test",children:" "}),e.jsxs(ht,{value:"events",children:[" (",d.length,")"]}),e.jsx(ht,{value:"recommendations",children:""})]}),e.jsxs(mt,{value:"status",className:"space-y-4",children:[n&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[y(n.databaseConnection),"  "]})}),e.jsx(M,{children:e.jsx(Q,{className:b(n.databaseConnection),children:n.databaseConnection?"":" "})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[y(n.realtimeConnection)," Realtime"]})}),e.jsx(M,{children:e.jsx(Q,{className:b(n.realtimeConnection),children:n.realtimeConnection?"":" "})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[y(n.ordersTableAccess)," "]})}),e.jsx(M,{children:e.jsx(Q,{className:b(n.ordersTableAccess),children:n.ordersTableAccess?"":" "})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[y(n.storeResponsesTableAccess),"  "]})}),e.jsx(M,{children:e.jsx(Q,{className:b(n.storeResponsesTableAccess),children:n.storeResponsesTableAccess?"":" "})})]})]}),Object.keys(l).length>0&&e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2",children:Object.entries(l).map(([C,E])=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsx("span",{className:"font-medium",children:C}),e.jsxs("div",{className:"flex items-center gap-2",children:[y(E.status),e.jsx(Q,{className:b(E.status),children:E.status}),E.timestamp&&e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(E.timestamp).toLocaleTimeString("ar-SA")})]})]},C))})})]})]}),e.jsxs(mt,{value:"test",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(L,{onClick:w,className:"w-full",children:"  "}),e.jsx(L,{onClick:v,className:"w-full",children:"  "}),e.jsx(L,{onClick:j,className:"w-full",children:"   "})]}),e.jsxs(At,{children:[e.jsx(nt,{className:"h-4 w-4"}),e.jsx(tf,{children:" "}),e.jsxs(Dt,{children:['1.  "  "   Realtime',e.jsx("br",{}),"2.        ",e.jsx("br",{}),"3.      "]})]})]}),e.jsx(mt,{value:"events",children:e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsx(Ze,{children:"   Realtime   "})]}),e.jsx(M,{children:e.jsx(ei,{className:"h-[400px]",children:d.length===0?e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:["    ...",e.jsx("br",{}),"      "]}):e.jsx("div",{className:"space-y-3",children:d.map(C=>e.jsxs("div",{className:"border rounded-lg p-3 bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Q,{variant:C.event==="INSERT"?"default":C.event==="UPDATE"?"secondary":C.event==="DELETE"?"destructive":"outline",children:C.event}),e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(C.timestamp).toLocaleTimeString("ar-SA")})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:":"})," ",C.table]}),C.data?.customer_name&&e.jsxs("div",{children:[e.jsx("strong",{children:":"})," ",C.data.customer_name]}),C.data?.order_code&&e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",C.data.order_code]}),C.data?.order_status&&e.jsxs("div",{children:[e.jsx("strong",{children:" :"})," ",C.data.order_status]})]})]},C.id))})})})]})}),e.jsx(mt,{value:"recommendations",children:n&&n.recommendations.length>0&&e.jsx("div",{className:"space-y-4",children:n.recommendations.map((C,E)=>e.jsxs(At,{children:[e.jsx(nt,{className:"h-4 w-4"}),e.jsxs(tf,{children:[" ",E+1]}),e.jsx(Dt,{children:C})]},E))})})]})]})}function X5(){console.group(" Testing Error Handling"),[{name:"Standard Error",error:new Error("Test error message")},{name:"String Error",error:"Simple string error"},{name:"Supabase Error Object",error:{message:"Database connection failed",details:"Connection timeout after 30 seconds",hint:"Check your internet connection",code:"CONNECTION_TIMEOUT"}},{name:"Complex Supabase Error",error:{error:{message:"Nested error message"},details:"Complex error details",code:"COMPLEX_ERROR"}},{name:"Empty Object",error:{}},{name:"Object without message",error:{code:"NO_MESSAGE",details:"Error without message field"}}].forEach(t=>{console.log(`
Testing: ${t.name}`);const r=up(t.error);console.log("Original:",t.error),console.log("Extracted:",r),console.log('Is "[object Object]"?',r==="[object Object]")}),console.groupEnd()}function Q5(){console.group(" Testing Supabase Error Handling");const s={message:'INSERT INTO "notifications" failed',details:"Foreign key constraint violation",hint:"Check that recipient_id exists in the referenced table",code:"FOREIGN_KEY_VIOLATION"};console.log("Testing handleSupabaseError with mock data...");const t=Ob(s,"test operation",{testData:"sample"});console.log("Result:",t),console.groupEnd()}function J5(){const[s,t]=x.useState([]),r=c=>{t(d=>[...d,`${new Date().toLocaleTimeString()}: ${c}`])},n=async()=>{r("Testing store notification with invalid data...");try{const c=await ys.sendNotification({storeId:"invalid-store-id-that-does-not-exist",title:"Test Error Notification",message:"This should trigger an error",type:"general"});r(`Notification result: ${c}`)}catch(c){r(`Caught error: ${c}`)}},a=()=>{r("Running error handling tests..."),X5(),Q5(),r("Check console for test results")},l=()=>{t([])};return e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"Error Handling Test Page"})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(L,{onClick:a,children:"Run Error Handling Tests"}),e.jsx(L,{onClick:n,variant:"outline",children:"Test Store Notification Error"}),e.jsx(L,{onClick:l,variant:"secondary",children:"Clear Results"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Test Results:"}),s.length===0?e.jsx("p",{className:"text-gray-500",children:"No test results yet"}):e.jsx("div",{className:"space-y-1 max-h-64 overflow-y-auto",children:s.map((c,d)=>e.jsx("div",{className:"text-sm font-mono bg-white p-2 rounded",children:c},d))})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Instructions:"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsx("li",{children:'1. Click "Run Error Handling Tests" to test error message extraction'}),e.jsx("li",{children:'2. Click "Test Store Notification Error" to trigger a real Supabase error'}),e.jsx("li",{children:"3. Check both the results above and the browser console"}),e.jsx("li",{children:'4. Look for any "[object Object]" messages that should now be fixed'})]})]})]})]})})}const Z5=`
-- Create notifications table
CREATE TABLE IF NOT EXISTS notifications (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  recipient_type TEXT NOT NULL CHECK (recipient_type IN ('admin', 'store', 'customer')),
  recipient_id TEXT NOT NULL,
  title TEXT NOT NULL,
  message TEXT NOT NULL,
  order_id TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  read BOOLEAN DEFAULT false,
  sent BOOLEAN DEFAULT false,
  sent_at TIMESTAMP WITH TIME ZONE
);

-- Create notification_subscriptions table
CREATE TABLE IF NOT EXISTS notification_subscriptions (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id TEXT NOT NULL,
  user_type TEXT NOT NULL CHECK (user_type IN ('admin', 'store', 'customer')),
  subscription JSONB NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  active BOOLEAN DEFAULT true,
  UNIQUE(user_id)
);

-- Create indexes for better performance
CREATE INDEX IF NOT EXISTS idx_notifications_recipient ON notifications(recipient_id, recipient_type);
CREATE INDEX IF NOT EXISTS idx_notifications_created_at ON notifications(created_at DESC);
CREATE INDEX IF NOT EXISTS idx_notifications_read ON notifications(read);
CREATE INDEX IF NOT EXISTS idx_notification_subscriptions_user ON notification_subscriptions(user_id, user_type);
CREATE INDEX IF NOT EXISTS idx_notification_subscriptions_active ON notification_subscriptions(active);

-- Enable Row Level Security (RLS)
ALTER TABLE notifications ENABLE ROW LEVEL SECURITY;
ALTER TABLE notification_subscriptions ENABLE ROW LEVEL SECURITY;

-- Drop existing policies if they exist (to avoid conflicts)
DROP POLICY IF EXISTS "Users can view their own notifications" ON notifications;
DROP POLICY IF EXISTS "Users can update their own notifications" ON notifications;
DROP POLICY IF EXISTS "Admin can view all notifications" ON notifications;
DROP POLICY IF EXISTS "Service role can insert notifications" ON notifications;
DROP POLICY IF EXISTS "Users can manage their own subscriptions" ON notification_subscriptions;
DROP POLICY IF EXISTS "Admin can view all subscriptions" ON notification_subscriptions;
DROP POLICY IF EXISTS "Service role can manage subscriptions" ON notification_subscriptions;

-- Create RLS policies for notifications table
CREATE POLICY "Users can view their own notifications" ON notifications
  FOR SELECT USING (recipient_id = auth.jwt() ->> 'phone' OR recipient_id = auth.jwt() ->> 'email');

CREATE POLICY "Users can update their own notifications" ON notifications
  FOR UPDATE USING (recipient_id = auth.jwt() ->> 'phone' OR recipient_id = auth.jwt() ->> 'email');

-- Admin can view all notifications
CREATE POLICY "Admin can view all notifications" ON notifications
  FOR ALL USING (
    auth.jwt() ->> 'role' = 'admin' OR 
    auth.jwt() ->> 'user_metadata' ->> 'role' = 'admin'
  );

-- Service role can insert notifications
CREATE POLICY "Service role can insert notifications" ON notifications
  FOR INSERT WITH CHECK (auth.role() = 'service_role');

-- Create RLS policies for notification_subscriptions table
CREATE POLICY "Users can manage their own subscriptions" ON notification_subscriptions
  FOR ALL USING (user_id = auth.jwt() ->> 'phone' OR user_id = auth.jwt() ->> 'email');

-- Admin can view all subscriptions
CREATE POLICY "Admin can view all subscriptions" ON notification_subscriptions
  FOR SELECT USING (
    auth.jwt() ->> 'role' = 'admin' OR 
    auth.jwt() ->> 'user_metadata' ->> 'role' = 'admin'
  );

-- Service role can manage subscriptions
CREATE POLICY "Service role can manage subscriptions" ON notification_subscriptions
  FOR ALL WITH CHECK (auth.role() = 'service_role');
`,eL=`
-- Create function to get unread notifications count
CREATE OR REPLACE FUNCTION get_unread_notifications_count(user_id_param TEXT)
RETURNS INTEGER AS $$
BEGIN
  RETURN (
    SELECT COUNT(*)::INTEGER
    FROM notifications
    WHERE recipient_id = user_id_param AND read = false
  );
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- Create function to mark notification as read
CREATE OR REPLACE FUNCTION mark_notification_as_read(notification_id_param UUID)
RETURNS BOOLEAN AS $$
BEGIN
  UPDATE notifications
  SET read = true
  WHERE id = notification_id_param;
  
  RETURN FOUND;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- Create function to clean old notifications (older than 30 days)
CREATE OR REPLACE FUNCTION cleanup_old_notifications()
RETURNS INTEGER AS $$
DECLARE
  deleted_count INTEGER;
BEGIN
  DELETE FROM notifications
  WHERE created_at < now() - INTERVAL '30 days';
  
  GET DIAGNOSTICS deleted_count = ROW_COUNT;
  RETURN deleted_count;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;
`,tL=`
-- Create notification templates table
CREATE TABLE IF NOT EXISTS notification_templates (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  type TEXT NOT NULL,
  recipient_type TEXT NOT NULL CHECK (recipient_type IN ('admin', 'store', 'customer')),
  title_ar TEXT NOT NULL,
  message_ar TEXT NOT NULL,
  url_pattern TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  UNIQUE(type, recipient_type)
);

-- Insert default notification templates
INSERT INTO notification_templates (type, recipient_type, title_ar, message_ar, url_pattern) VALUES
('order_created', 'customer', '  ', '    {{order_code}}    ', '/my-orders/{{order_id}}'),
('order_confirmed', 'customer', '  ', '    {{order_code}}     ', '/my-orders/{{order_id}}'),
('order_rejected', 'customer', '   ', '    {{order_code}}  .    ', '/my-orders/{{order_id}}'),
('order_completed', 'customer', '  ', '    {{order_code}} .  ', '/my-orders/{{order_id}}'),
('order_assigned', 'store', ' ', '    {{order_code}}  {{customer_name}}', '/store/orders/{{order_id}}'),
('order_created', 'admin', ' ', '    {{customer_name}}  : {{order_code}}', '/admin/orders/{{order_id}}'),
('order_confirmed', 'admin', ' ', '    {{order_code}}  ', '/admin/orders/{{order_id}}'),
('order_rejected', 'admin', ' ', '    {{order_code}}  ', '/admin/orders/{{order_id}}')
ON CONFLICT (type, recipient_type) DO NOTHING;
`;async function sL(){try{console.log(" Starting notifications table migration..."),console.log("Creating notifications and notification_subscriptions tables...");const{error:s}=await I.rpc("execute_sql",{sql_query:Z5});if(s)return console.error(" Error creating tables:",s),{success:!1,message:"Failed to create notifications tables",details:s};console.log("Creating notification functions...");const{error:t}=await I.rpc("execute_sql",{sql_query:eL});if(t)return console.error(" Error creating functions:",t),{success:!1,message:"Failed to create notification functions",details:t};console.log("Creating notification templates...");const{error:r}=await I.rpc("execute_sql",{sql_query:tL});return r?(console.error(" Error creating templates:",r),{success:!1,message:"Failed to create notification templates",details:r}):(console.log(" Notifications migration completed successfully!"),{success:!0,message:"Notifications migration completed successfully"})}catch(s){return console.error(" Migration failed:",s),{success:!1,message:"Migration failed with exception",details:s}}}async function rL(){try{const{data:s,error:t}=await I.from("notifications").select("id").limit(1);return t?(t.message.includes('relation "notifications" does not exist')||console.warn("Error checking notifications table:",t),!1):!0}catch(s){return console.error("Error checking notifications table:",s),!1}}async function nL(){try{if(!await rL())return{exists:!1,canInsert:!1};const t={recipient_type:"admin",recipient_id:"test-admin",message:"Test notification for migration verification",prompt:{title:"Test",message:"Test message",type:"test",action_required:!1}},{error:r}=await I.from("notifications").insert(t);return r?{exists:!0,canInsert:!1,error:r}:(await I.from("notifications").delete().eq("recipient_id","test-admin").eq("message","Test notification for migration verification"),{exists:!0,canInsert:!0})}catch(s){return{exists:!1,canInsert:!1,error:s}}}function iL(){const[s,t]=x.useState({running:!1,completed:!1,success:!1,message:""}),[r,n]=x.useState({checking:!1,exists:!1,canInsert:!1}),[a,l]=x.useState([]),c=p=>{l(w=>[...w,`${new Date().toLocaleTimeString()}: ${p}`])},d=async()=>{n(p=>({...p,checking:!0}));try{const p=await nL();n({checking:!1,exists:p.exists,canInsert:p.canInsert,error:p.error}),c(`Table check: exists=${p.exists}, canInsert=${p.canInsert}`)}catch(p){n({checking:!1,exists:!1,canInsert:!1,error:p}),c(`Table check failed: ${p}`)}},m=async()=>{t({running:!0,completed:!1,success:!1,message:"Starting migration..."});try{const p=await sL();t({running:!1,completed:!0,success:p.success,message:p.message,details:p.details}),c(`Migration ${p.success?"succeeded":"failed"}: ${p.message}`),p.success&&setTimeout(d,1e3)}catch(p){t({running:!1,completed:!0,success:!1,message:"Migration failed with exception",details:p}),c(`Migration exception: ${p}`)}},h=async()=>{c("Testing store notification service...");try{const p=await ys.sendNotification({storeId:"test-store-migration",title:"Test Migration Notification",message:"This is a test notification to verify the migration worked",type:"general"});c(`Store notification test: ${p?"SUCCESS":"FAILED"}`)}catch(p){c(`Store notification test failed: ${p}`)}},f=()=>{l([])};return e.jsx("div",{className:"container mx-auto p-6 space-y-6",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"Database Migration - Notifications System"})}),e.jsxs(M,{className:"space-y-4",children:[e.jsx(At,{children:e.jsx(Dt,{children:`This page helps fix the "Could not find the 'prompt' column of 'notifications' in the schema cache" error by running the notifications table migration manually.`})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{className:"text-lg",children:"Table Status"})}),e.jsxs(M,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Notifications Table:"}),e.jsx(Q,{variant:r.exists?"default":"destructive",children:r.exists?"EXISTS":"MISSING"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Can Insert:"}),e.jsx(Q,{variant:r.canInsert?"default":"secondary",children:r.canInsert?"YES":"NO"})]}),e.jsx(L,{onClick:d,disabled:r.checking,variant:"outline",size:"sm",children:r.checking?"Checking...":"Check Status"}),r.error&&e.jsx(At,{children:e.jsxs(Dt,{children:["Error: ",JSON.stringify(r.error,null,2)]})})]})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{className:"text-lg",children:"Migration Status"})}),e.jsxs(M,{className:"space-y-3",children:[s.completed&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Last Migration:"}),e.jsx(Q,{variant:s.success?"default":"destructive",children:s.success?"SUCCESS":"FAILED"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:s.message||"Ready to run migration"}),e.jsx(L,{onClick:m,disabled:s.running,variant:"default",children:s.running?"Running Migration...":"Run Migration"}),s.details&&e.jsx(At,{children:e.jsxs(Dt,{children:["Details: ",JSON.stringify(s.details,null,2)]})})]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(L,{onClick:h,variant:"outline",children:"Test Store Notification"}),e.jsx(L,{onClick:f,variant:"secondary",children:"Clear Test Results"})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{className:"text-lg",children:"Test Results"})}),e.jsx(M,{children:a.length===0?e.jsx("p",{className:"text-gray-500",children:"No test results yet"}):e.jsx("div",{className:"space-y-1 max-h-64 overflow-y-auto",children:a.map((p,w)=>e.jsx("div",{className:"text-sm font-mono bg-gray-50 p-2 rounded",children:p},w))})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{className:"text-lg",children:"Instructions"})}),e.jsx(M,{children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm",children:[e.jsx("li",{children:'First, click "Check Status" to see if the notifications table exists'}),e.jsx("li",{children:'If the table is missing, click "Run Migration" to create it'}),e.jsx("li",{children:'After migration, click "Check Status" again to verify'}),e.jsx("li",{children:'Test the fix by clicking "Test Store Notification"'}),e.jsx("li",{children:"Check the test results for any remaining errors"})]})})]})]})]})})}function aL(){const[s,t]=x.useState(!1),[r,n]=x.useState(!1),[a,l]=x.useState(!1),[c,d]=x.useState({exists:!1,error:null,needsMigration:!0,fixed:!1}),[m,h]=x.useState([]),f=j=>{const y=new Date().toLocaleTimeString();h(b=>[...b,`[${y}] ${j}`]),console.log(j)},p=async()=>{t(!0),f(" Checking notifications table status...");try{const j=await Mb();d({exists:j.exists,error:j.error,needsMigration:j.needsMigration,fixed:!j.needsMigration}),j.exists&&!j.needsMigration?f(" Notifications table exists and is working correctly"):j.exists&&j.needsMigration?f(" Notifications table exists but has issues"):f(" Notifications table does not exist"),j.error&&f(`Error: ${j.error}`)}catch(j){f(` Error checking table: ${Mt(j,"   ")}`)}finally{t(!1)}},w=async()=>{n(!0),f(" Creating notifications table...");try{const j=await Fb();j.success?(f(" Notifications table created successfully!"),d(y=>({...y,exists:!0,needsMigration:!1,fixed:!0})),setTimeout(p,1e3)):f(` Failed to create table: ${j.error}`)}catch(j){f(` Exception fixing table: ${Mt(j,"   ")}`)}finally{n(!1)}},v=async()=>{l(!0),f(" Testing store notification...");try{await ys.sendNotification({storeId:"test-store-fix",title:"Test Notification After Fix",message:"This is a test notification to verify the fix worked correctly.",type:"general"})?(f(" Store notification sent successfully!"),f(" The notification error has been fixed!")):f(" Store notification failed")}catch(j){f(` Exception testing notification: ${Mt(j,"   ")}`)}finally{l(!1)}};return x.useEffect(()=>{p()},[]),e.jsx("div",{className:"container mx-auto p-6 space-y-6",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"Notification Error Fix - Emergency Repair"})}),e.jsxs(M,{className:"space-y-4",children:[e.jsx(At,{children:e.jsxs(Dt,{children:[e.jsx("strong",{children:"Error:"}),` "Could not find the 'prompt' column of 'notifications' in the schema cache"`,e.jsx("br",{}),e.jsx("strong",{children:"Cause:"})," The notifications table is missing from your database.",e.jsx("br",{}),e.jsx("strong",{children:"Solution:"})," Create the table immediately using the fix button below."]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx($,{children:e.jsx(M,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Table Exists:"}),e.jsx(Q,{variant:c.exists?"default":"destructive",children:c.exists?"YES":"NO"})]})})}),e.jsx($,{children:e.jsx(M,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Needs Fix:"}),e.jsx(Q,{variant:c.needsMigration?"destructive":"default",children:c.needsMigration?"YES":"NO"})]})})}),e.jsx($,{children:e.jsx(M,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Status:"}),e.jsx(Q,{variant:c.fixed?"default":"secondary",children:c.fixed?"FIXED":"NEEDS REPAIR"})]})})})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(L,{onClick:p,disabled:s,variant:"outline",children:s?" Checking...":" Check Status"}),e.jsx(L,{onClick:w,disabled:r||!c.needsMigration,variant:"default",children:r?" Fixing...":" Fix Now"}),e.jsx(L,{onClick:v,disabled:a||c.needsMigration,variant:"secondary",children:a?" Testing...":" Test Fix"})]}),c.error&&e.jsx(At,{children:e.jsxs(Dt,{children:[e.jsx("strong",{children:"Current Error:"})," ",c.error]})}),c.fixed&&e.jsx(At,{children:e.jsxs(Dt,{children:[e.jsx("strong",{children:" Success!"}),' The notifications table has been created. The "[object Object]" and "prompt column" errors should now be resolved.']})}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{className:"text-lg",children:"Repair Log"})}),e.jsx(M,{children:e.jsx("div",{className:"bg-black text-green-400 p-4 rounded-lg font-mono text-sm max-h-64 overflow-y-auto",children:m.length===0?e.jsx("div",{className:"text-gray-500",children:"Waiting for actions..."}):m.map((j,y)=>e.jsx("div",{className:"mb-1",children:j},y))})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{className:"text-lg",children:"Quick Fix Instructions"})}),e.jsx(M,{children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm",children:[e.jsx("li",{children:"The page auto-checks the table status on load"}),e.jsxs("li",{children:["If the table is missing, click ",e.jsx("strong",{children:'"Fix Now"'})," to create it"]}),e.jsxs("li",{children:["After fixing, click ",e.jsx("strong",{children:'"Test Fix"'})," to verify it works"]}),e.jsx("li",{children:"Monitor the repair log for detailed information"}),e.jsx("li",{children:"Once fixed, the notification errors should stop appearing"})]})})]})]})]})})}function oL(){const[s,t]=x.useState([]),[r,n]=x.useState(!1),[a,l]=x.useState({total:0,pending:0,assigned:0,delivered:0,returned:0,customer_rejected:0,rejected:0}),c=async()=>{n(!0);try{const{data:p,error:w}=await I.from("orders").select(`
          id,
          order_code,
          order_status,
          store_response_status,
          customer_name,
          assigned_store_id,
          created_at
        `).order("created_at",{ascending:!1});if(w){console.error("Error fetching orders:",w);return}t(p||[]);const v={total:p?.length||0,pending:p?.filter(j=>j.order_status==="pending").length||0,assigned:p?.filter(j=>j.order_status==="assigned").length||0,delivered:p?.filter(j=>j.order_status==="delivered").length||0,returned:p?.filter(j=>j.order_status==="returned").length||0,customer_rejected:p?.filter(j=>j.order_status==="customer_rejected").length||0,rejected:p?.filter(j=>j.order_status==="rejected").length||0};l(v),console.log("Orders debug info:",{total:v.total,stats:v,returnedOrders:p?.filter(j=>j.order_status==="returned")||[]})}catch(p){console.error("Error:",p)}finally{n(!1)}},d=async p=>{n(!0);try{const{data:w,error:v}=await I.from("orders").select(`
          id,
          order_code,
          order_status,
          store_response_status,
          customer_name,
          assigned_store_id,
          created_at
        `).eq("assigned_store_id",p).in("order_status",["assigned","delivered","returned","customer_rejected"]).order("created_at",{ascending:!1});if(v){console.error("Error fetching store orders:",v);return}console.log(`Orders for store ${p}:`,{total:w?.length||0,returned:w?.filter(j=>j.order_status==="returned").length||0,returnedOrders:w?.filter(j=>j.order_status==="returned")||[]})}catch(w){console.error("Error:",w)}finally{n(!1)}},m=async()=>{n(!0);try{const{data:p}=await I.from("stores").select("id, name").limit(1);if(!p||p.length===0){alert("     ");return}const w=p[0],{data:v,error:j}=await I.from("orders").insert({customer_name:"  -  ",customer_phone:"07701234567",customer_address:" ",total_amount:5e4,subtotal:5e4,order_status:"returned",assigned_store_id:w.id,store_response_status:"available",order_details:'      "" - Return reason:   ',order_code:`TEST-RET-${Date.now()}`}).select().single();if(j){console.error("Error creating test order:",j),alert("    ");return}alert(`     : ${v.order_code}`),c()}catch(p){console.error("Error:",p),alert("     ")}finally{n(!1)}};x.useEffect(()=>{c()},[]);const h=p=>{switch(p){case"pending":return"bg-yellow-100 text-yellow-800";case"assigned":return"bg-blue-100 text-blue-800";case"delivered":return"bg-green-100 text-green-800";case"returned":return"bg-red-100 text-red-800";case"customer_rejected":return"bg-purple-100 text-purple-800";case"rejected":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},f=p=>{switch(p){case"pending":return"";case"assigned":return"";case"delivered":return"";case"returned":return"";case"customer_rejected":return" ";case"rejected":return"";default:return p}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"  "})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{onClick:c,disabled:r,children:" "}),e.jsx(L,{onClick:m,disabled:r,variant:"outline",children:"   "}),e.jsx(L,{onClick:()=>d("d3b1f7e5-4a2c-4d8b-9e6f-1a2b3c4d5e6f"),disabled:r,variant:"secondary",children:"   "})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:a.total}),e.jsx("div",{className:"text-sm text-gray-600",children:""})]}),e.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:a.pending}),e.jsx("div",{className:"text-sm text-gray-600",children:""})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:a.assigned}),e.jsx("div",{className:"text-sm text-gray-600",children:""})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:a.delivered}),e.jsx("div",{className:"text-sm text-gray-600",children:""})]}),e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:a.returned}),e.jsx("div",{className:"text-sm text-gray-600",children:""})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:a.customer_rejected}),e.jsx("div",{className:"text-sm text-gray-600",children:" "})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:a.rejected}),e.jsx("div",{className:"text-sm text-gray-600",children:""})]})]}),r&&e.jsx("div",{className:"text-center py-4",children:" ..."})]})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{children:["  (",a.returned,")"]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[s.filter(p=>p.order_status==="returned").map(p=>e.jsx("div",{className:"border rounded-lg p-3 bg-red-50",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:p.order_code||p.id.slice(0,8)}),e.jsx("div",{className:"text-sm text-gray-600",children:p.customer_name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[": ",p.assigned_store_id?.slice(0,8)||" "]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx(Q,{className:h(p.order_status),children:f(p.order_status)}),p.store_response_status&&e.jsx(Q,{variant:"outline",className:"text-xs",children:p.store_response_status}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(p.created_at).toLocaleDateString("ar")})]})]})},p.id)),a.returned===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"    "})]})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{children:["  (",a.total,")"]})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.map(p=>e.jsx("div",{className:"border rounded-lg p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:p.order_code||p.id.slice(0,8)}),e.jsx("div",{className:"text-sm text-gray-600",children:p.customer_name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[": ",p.assigned_store_id?.slice(0,8)||" "]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx(Q,{className:h(p.order_status),children:f(p.order_status)}),p.store_response_status&&e.jsx(Q,{variant:"outline",className:"text-xs",children:p.store_response_status}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(p.created_at).toLocaleDateString("ar")})]})]})},p.id))})})]})]})}function lL(){const[s,t]=x.useState([]),[r,n]=x.useState(!1),[a,l]=x.useState([]),c=f=>{t(p=>[...p,f])},d=async()=>{n(!0),t([]),l([]);try{const{data:w,error:v}=await I.from("orders").select("count").limit(1);c(v?{test:"Database Connection",status:"error",message:"   ",details:v}:{test:"Database Connection",status:"success",message:"     "})}catch(w){c({test:"Database Connection",status:"error",message:"    ",details:w})}try{const{data:w}=await I.auth.getSession();w.session?c({test:"Authentication Status",status:"success",message:`  : ${w.session.user?.email||""}`}):c({test:"Authentication Status",status:"warning",message:"   -  anon key"})}catch(w){c({test:"Authentication Status",status:"error",message:"    ",details:w})}const f=`test-channel-${Date.now()}`;try{await new Promise((w,v)=>{const j=I.channel(f).on("postgres_changes",{event:"*",schema:"public",table:"orders"},y=>{console.log("Test payload received:",y)});j.subscribe(y=>{if(console.log(`Test channel ${f} status:`,y),y==="SUBSCRIBED")c({test:"Realtime Channel Test",status:"success",message:" Real-time   "}),I.removeChannel(j),w(!0);else if(y==="CHANNEL_ERROR"){const b=`   Real-time: CHANNEL_ERROR  ${f}`;l(C=>[...C,b]),c({test:"Realtime Channel Test",status:"error",message:"CHANNEL_ERROR -     Real-time"}),I.removeChannel(j),w(!1)}else y==="TIMED_OUT"&&(c({test:"Realtime Channel Test",status:"warning",message:"    Real-time"}),I.removeChannel(j),w(!1))}),setTimeout(()=>{c({test:"Realtime Channel Test",status:"error",message:"    Real-time (10 )"}),I.removeChannel(j),v(new Error("Test timeout"))},1e4)})}catch(w){c({test:"Realtime Channel Test",status:"error",message:"   Real-time",details:w})}const p=["orders","notifications"];for(const w of p)try{const{data:v,error:j}=await I.from(w).select("*").limit(1);c(j?{test:`Table Access: ${w}`,status:"error",message:`     ${w}`,details:j}:{test:`Table Access: ${w}`,status:"success",message:`   ${w}   `})}catch(v){c({test:`Table Access: ${w}`,status:"error",message:`    ${w}`,details:v})}n(!1)},m=f=>{switch(f){case"success":return e.jsx(Se,{className:"h-5 w-5 text-green-500"});case"error":return e.jsx(lt,{className:"h-5 w-5 text-red-500"});case"warning":return e.jsx(nt,{className:"h-5 w-5 text-yellow-500"})}},h=f=>{switch(f){case"success":return"border-green-200 bg-green-50";case"error":return"border-red-200 bg-red-50";case"warning":return"border-yellow-200 bg-yellow-50"}};return x.useEffect(()=>{d()},[]),e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"   Real-time"}),e.jsx("p",{className:"text-muted-foreground",children:"    CHANNEL_ERROR"})]}),e.jsxs(L,{onClick:d,disabled:r,className:"gap-2",children:[r&&e.jsx(ft,{className:"h-4 w-4 animate-spin"}),r?" ...":" "]})]}),a.length>0&&e.jsxs(At,{className:"border-red-200 bg-red-50",children:[e.jsx(lt,{className:"h-4 w-4"}),e.jsxs(Dt,{children:[e.jsx("div",{className:"font-medium mb-2",children:" Real-time :"}),a.map((f,p)=>e.jsx("div",{className:"text-sm font-mono",children:f},p))]})]}),e.jsx("div",{className:"grid gap-4",children:s.map((f,p)=>e.jsx($,{className:`${h(f.status)} transition-all duration-200`,children:e.jsx(M,{className:"pt-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[m(f.status),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium",children:f.test}),e.jsx(Q,{variant:f.status==="success"?"default":f.status==="error"?"destructive":"secondary",children:f.status==="success"?"":f.status==="error"?"":""})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.message}),f.details&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-xs cursor-pointer text-muted-foreground hover:text-foreground",children:" "}),e.jsx("pre",{className:"mt-2 text-xs bg-muted p-2 rounded overflow-x-auto",children:JSON.stringify(f.details,null,2)})]})]})]})})},p))}),s.length===0&&!r&&e.jsx($,{children:e.jsx(M,{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:'   .  " "  .'})})}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"   CHANNEL_ERROR"})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"1.    Supabase Dashboard:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 mr-4",children:[e.jsx("li",{children:"    Realtime : orders, notifications"}),e.jsx("li",{children:"   Row Level Security (RLS) policies"}),e.jsx("li",{children:"    anon key    "})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"2.  :"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 mr-4",children:[e.jsx("li",{children:"    "}),e.jsx("li",{children:"     WebSocket connections"}),e.jsx("li",{children:"       "})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"3.  :"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 mr-4",children:[e.jsx("li",{children:"  cache "}),e.jsx("li",{children:"     WebSockets  "}),e.jsx("li",{children:"    incognito/private"})]})]})]})]})]})}class cL{channels=new Map;retryAttempts=new Map;maxRetries=3;retryDelay=2e3;async createChannelWithRetry(t,r,n){const{name:a,table:l,events:c,filter:d,schema:m="public"}=t;this.removeChannel(a),console.log(`   Real-time: ${a}  ${l}`);try{let h=I.channel(a);return c.forEach(f=>{const p={event:f,schema:m,table:l};d&&(p.filter=d),h=h.on("postgres_changes",p,w=>{console.log(`  Real-time  ${a}:`,{table:l,event:w.eventType,data:w.new||w.old})})}),new Promise((f,p)=>{let w=!1;h.subscribe(v=>{if(console.log(`   ${a}:`,v),!w)if(v==="SUBSCRIBED")console.log(`     ${a}`),this.channels.set(a,h),this.retryAttempts.delete(a),w=!0,r&&r(h),f(h);else if(v==="CHANNEL_ERROR"){console.error(`    ${a}: CHANNEL_ERROR`);const j=this.retryAttempts.get(a)||0;j<this.maxRetries?(this.retryAttempts.set(a,j+1),console.log(`   ${j+1}/${this.maxRetries}  ${a}  ${this.retryDelay}ms`),setTimeout(()=>{this.createChannelWithRetry(t,r,n)},this.retryDelay*(j+1))):(console.error(`     ${a}  ${this.maxRetries} `),w=!0,n&&n(`CHANNEL_ERROR  ${this.maxRetries} `),p(new Error(`CHANNEL_ERROR for ${a}`)))}else v==="TIMED_OUT"?(console.warn(`    ${a}  ...`),setTimeout(()=>{this.createChannelWithRetry(t,r,n)},this.retryDelay)):v==="CLOSED"&&(console.log(`    ${a}`),w=!0,f(null))}),setTimeout(()=>{w||(console.error(`       ${a}`),w=!0,I.removeChannel(h),p(new Error(`Subscription timeout for ${a}`)))},15e3)})}catch(h){return console.error(`     ${a}:`,h),n&&n(h instanceof Error?h.message:String(h)),null}}removeChannel(t){const r=this.channels.get(t);r&&(console.log(`   ${t}`),I.removeChannel(r),this.channels.delete(t),this.retryAttempts.delete(t))}removeAllChannels(){console.log("   ..."),this.channels.forEach((t,r)=>{I.removeChannel(t)}),this.channels.clear(),this.retryAttempts.clear()}getChannelsStatus(){const t={};return this.channels.forEach((r,n)=>{t[n]=!0}),t}async testConnection(){const t={database:!1,realtime:!1,auth:!1,errors:[]};try{const{data:r,error:n}=await I.from("orders").select("count").limit(1);n?t.errors.push(`Database error: ${n.message}`):t.database=!0}catch(r){t.errors.push(`Database exception: ${r}`)}try{const{data:r,error:n}=await I.auth.getSession();n?t.errors.push(`Auth error: ${n.message}`):t.auth=!0}catch(r){t.errors.push(`Auth exception: ${r}`)}try{await this.createChannelWithRetry({name:`connection-test-${Date.now()}`,table:"orders",events:["INSERT"]})?(t.realtime=!0,this.removeChannel(`connection-test-${Date.now()}`)):t.errors.push("Realtime connection failed")}catch(r){t.errors.push(`Realtime exception: ${r}`)}return t}}const dL=new cL;function uL(){const[s,t]=x.useState([]),[r,n]=x.useState(!1),[a,l]=x.useState(null),[c,d]=x.useState([]),m=(v,j,y)=>{t(b=>b.find(E=>E.name===v)?b.map(E=>E.name===v?{...E,status:j,lastUpdate:new Date,errorCount:j==="error"?E.errorCount+1:E.errorCount,details:y}:E):[...b,{name:v,status:j,lastUpdate:new Date,errorCount:j==="error"?1:0,details:y}])},h=v=>{const j=new Date().toLocaleTimeString("ar");d(y=>[`[${j}] ${v}`,...y.slice(0,19)])},f=async()=>{n(!0),t([]),d([]),h("   Real-time...");try{const{data:v,error:j}=await I.from("orders").select("count").limit(1);j?(m("Database","error",j),h(`   : ${j.message}`)):(m("Database","connected"),h("    "))}catch(v){m("Database","error",v),h(`   : ${v}`)}try{const v=I.channel("monitor-admin-notifications").on("postgres_changes",{event:"*",schema:"public",table:"orders"},j=>{h("   admin-notifications")}).subscribe(j=>{h(` admin-notifications: ${j}`),j==="SUBSCRIBED"?m("Admin Notifications","connected"):j==="CHANNEL_ERROR"?(m("Admin Notifications","error"),h("    Admin Notifications: CHANNEL_ERROR")):j==="TIMED_OUT"&&(m("Admin Notifications","timeout"),h("    Admin Notifications"))});setTimeout(()=>{I.removeChannel(v)},3e4)}catch(v){m("Admin Notifications","error",v),h(`    Admin Notifications: ${v}`)}try{const v=I.channel("monitor-orders").on("postgres_changes",{event:"*",schema:"public",table:"orders"},j=>{h("   orders channel")}).subscribe(j=>{h(` orders: ${j}`),j==="SUBSCRIBED"?m("Orders Channel","connected"):j==="CHANNEL_ERROR"?(m("Orders Channel","error"),h("    Orders: CHANNEL_ERROR")):j==="TIMED_OUT"&&(m("Orders Channel","timeout"),h("    Orders"))});setTimeout(()=>{I.removeChannel(v)},3e4)}catch(v){m("Orders Channel","error",v),h(`    Orders: ${v}`)}try{const v=It.getStatus();m("Admin Service",v.isListening?"connected":"error",v),h(`  Admin Service: ${v.isListening?"":" "}`)}catch(v){m("Admin Service","error",v),h(`  Admin Service: ${v}`)}try{const v=await dL.testConnection();l(v),m("Connection Test",v.database&&v.realtime?"connected":"error",v),h(`   : ${v.database&&v.realtime?"":""}`),v.errors.length>0&&v.errors.forEach(j=>h(` ${j}`))}catch(v){m("Connection Test","error",v),h(`   : ${v}`)}h("  "),n(!1)},p=v=>{switch(v){case"connected":return e.jsx(Se,{className:"h-4 w-4 text-green-500"});case"error":return e.jsx(lt,{className:"h-4 w-4 text-red-500"});case"timeout":return e.jsx(nt,{className:"h-4 w-4 text-yellow-500"});case"closed":return e.jsx(sn,{className:"h-4 w-4 text-gray-500"});default:return e.jsx(ft,{className:"h-4 w-4 text-blue-500"})}},w=v=>{switch(v){case"connected":return"border-green-200 bg-green-50";case"error":return"border-red-200 bg-red-50";case"timeout":return"border-yellow-200 bg-yellow-50";case"closed":return"border-gray-200 bg-gray-50";default:return"border-blue-200 bg-blue-50"}};return x.useEffect(()=>{f()},[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"  Real-time"}),e.jsx("p",{className:"text-muted-foreground",children:"    Real-time  "})]}),e.jsxs(L,{onClick:f,disabled:r,className:"gap-2",children:[r&&e.jsx(ft,{className:"h-4 w-4 animate-spin"}),r?" ...":" "]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(v=>e.jsx($,{className:`${w(v.status)} transition-all duration-200`,children:e.jsx(M,{className:"pt-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[p(v.status),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium",children:v.name}),e.jsx(Q,{variant:v.status==="connected"?"default":v.status==="error"?"destructive":"secondary",children:v.status==="connected"?"":v.status==="error"?"":v.status==="timeout"?" ":""})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" : ",v.lastUpdate.toLocaleTimeString("ar")]}),v.errorCount>0&&e.jsxs("p",{className:"text-xs text-red-600",children:[" : ",v.errorCount]}),v.details&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-xs cursor-pointer text-muted-foreground hover:text-foreground",children:" "}),e.jsx("pre",{className:"mt-1 text-xs bg-muted p-2 rounded overflow-x-auto max-w-full",children:JSON.stringify(v.details,null,2)})]})]})]})})},v.name))}),a&&e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"  "})}),e.jsx(M,{children:e.jsxs("div",{className:"grid gap-2 md:grid-cols-3",children:[e.jsx("div",{className:`p-3 rounded-lg ${a.database?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.database?e.jsx(Se,{className:"h-4 w-4 text-green-500"}):e.jsx(lt,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"font-medium",children:" "})]})}),e.jsx("div",{className:`p-3 rounded-lg ${a.realtime?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.realtime?e.jsx(Se,{className:"h-4 w-4 text-green-500"}):e.jsx(lt,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"font-medium",children:"Real-time"})]})}),e.jsx("div",{className:`p-3 rounded-lg ${a.auth?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.auth?e.jsx(Se,{className:"h-4 w-4 text-green-500"}):e.jsx(nt,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{className:"font-medium",children:""})]})})]})})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:"  "}),e.jsx(Ze,{children:" 20    Real-time"})]}),e.jsx(M,{children:e.jsx("div",{className:"space-y-1 max-h-96 overflow-y-auto",children:c.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"   "}):c.map((v,j)=>e.jsx("div",{className:`text-sm p-2 rounded font-mono ${v.includes("")?"bg-red-50 text-red-800":v.includes("")?"bg-green-50 text-green-800":v.includes("")?"bg-yellow-50 text-yellow-800":"bg-muted text-muted-foreground"}`,children:v},j))})})]})]})}function hL(){return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"container mx-auto p-6",children:e.jsx(uL,{})})})}function mL(){const[s,t]=x.useState([]),[r,n]=x.useState(!1),[a,l]=x.useState(0),[c,d]=x.useState(0),[m,h]=x.useState({}),[f,p]=x.useState(0),[w,v]=x.useState({storeId:"store_1",title:"  ",message:"    ",orderId:"test-order-123",type:"order_assigned",iterations:3,intervalMs:1e3}),j=(R,k,P)=>{p(ne=>ne+1);const F=f+1,ee={id:`${Date.now()}-${F}`,type:R,message:k,timestamp:new Date,details:P};t(ne=>[ee,...ne.slice(0,49)]),R==="success"?l(ne=>ne+1):R==="duplicate"&&d(ne=>ne+1)},y=async()=>{n(!0),t([]),l(0),d(0),p(0),j("success","   ...");try{for(let k=0;k<w.iterations;k++)j("success",`  ${k+1}/${w.iterations}`),await _i.notifyStore(w.storeId,w.title,`${w.message} -  ${k+1}`,w.orderId,w.type)?j("success",`   ${k+1} `):j("duplicate",`    ${k+1} `),k<w.iterations-1&&await new Promise(F=>setTimeout(F,w.intervalMs));const R=_i.getCacheStatus();h(R),j("success",`   ${R.size}   cache   `),j("success","  ")}catch(R){const k=R instanceof Error?R.message:String(R);j("error",`  : ${k}`,R)}finally{n(!1)}},b=async()=>{n(!0),p(0);try{j("success"," storeNotificationService..."),await ys.sendNotification({storeId:w.storeId,title:w.title,message:w.message+" -  StoreNotificationService",type:w.type,orderId:w.orderId})?j("success","    StoreNotificationService "):j("duplicate","     StoreNotificationService ")}catch(R){const k=R instanceof Error?R.message:String(R);j("error",`  StoreNotificationService: ${k}`,R)}finally{n(!1)}},C=()=>{_i.clearCache(),h({size:0,keys:[]}),j("success","  cache   ")},E=async()=>{n(!0),p(0);try{j("success","    ...");const{data:R,error:k}=await I.from("notifications").select("title, message, recipient_id, created_at").eq("recipient_id",w.storeId).eq("title",w.title).order("created_at",{ascending:!1}).limit(10);if(k){j("error",`    : ${k.message}`,k);return}if(R&&R.length>0){j("success",`   ${R.length}      `);const P=R.filter((F,ee,ne)=>ne.findIndex(pe=>pe.title===F.title&&pe.message===F.message)!==ee);P.length>0?j("error",`   ${P.length}     !`,P):j("success","       ")}else j("success","      ")}catch(R){const k=R instanceof Error?R.message:String(R);j("error",`    : ${k}`,R)}finally{n(!1)}},S=R=>{switch(R){case"success":return e.jsx(Se,{className:"h-4 w-4 text-green-500"});case"duplicate":return e.jsx(Bt,{className:"h-4 w-4 text-blue-500"});case"error":return e.jsx(lt,{className:"h-4 w-4 text-red-500"})}},O=R=>{switch(R){case"success":return"border-green-200 bg-green-50";case"duplicate":return"border-blue-200 bg-blue-50";case"error":return"border-red-200 bg-red-50"}};return x.useEffect(()=>{const R=setInterval(()=>{const k=_i.getCacheStatus();h(k)},5e3);return()=>clearInterval(R)},[]),e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"  "}),e.jsx("p",{className:"text-muted-foreground",children:"    "})]}),e.jsxs(L,{onClick:C,variant:"outline",className:"gap-2",children:[e.jsx(ft,{className:"h-4 w-4"})," Cache"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsx($,{children:e.jsx(M,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:a}),e.jsx("div",{className:"text-sm text-muted-foreground",children:" "})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bt,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:c}),e.jsx("div",{className:"text-sm text-muted-foreground",children:" "})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ft,{className:"h-5 w-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.size||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"  Cache"})]})]})})}),e.jsx($,{children:e.jsx(M,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[c>0?Math.round(c/(a+c)*100):0,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:" "})]})]})})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{children:" "}),e.jsx(it,{value:w.storeId,onChange:R=>v(k=>({...k,storeId:R.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{children:" "}),e.jsx(it,{value:w.title,onChange:R=>v(k=>({...k,title:R.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{children:" "}),e.jsxs(ln,{value:w.type,onValueChange:R=>v(k=>({...k,type:R})),children:[e.jsx(Pr,{children:e.jsx(cn,{})}),e.jsxs(Ir,{children:[e.jsx(Nt,{value:"order_assigned",children:" "}),e.jsx(Nt,{value:"order_reminder",children:" "}),e.jsx(Nt,{value:"system",children:""}),e.jsx(Nt,{value:"general",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{children:" "}),e.jsx(it,{type:"number",min:"1",max:"10",value:w.iterations,onChange:R=>v(k=>({...k,iterations:parseInt(R.target.value)}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{children:"  (ms)"}),e.jsx(it,{type:"number",min:"100",max:"5000",value:w.intervalMs,onChange:R=>v(k=>({...k,intervalMs:parseInt(R.target.value)}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(et,{children:" "}),e.jsx(it,{value:w.message,onChange:R=>v(k=>({...k,message:R.target.value}))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(L,{onClick:y,disabled:r,className:"gap-2",children:[r&&e.jsx(ft,{className:"h-4 w-4 animate-spin"})," "]}),e.jsxs(L,{onClick:b,disabled:r,variant:"outline",className:"gap-2",children:[e.jsx(Ei,{className:"h-4 w-4"})," StoreService"]}),e.jsxs(L,{onClick:E,disabled:r,variant:"outline",className:"gap-2",children:[e.jsx(dt,{className:"h-4 w-4"}),"  "]})]})]})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsx(Ze,{children:" 50  "})]}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'   .  " "  '}):s.map(R=>e.jsx("div",{className:`p-3 rounded-lg border transition-all duration-200 ${O(R.type)}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[S(R.type),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(D,{className:"font-medium",children:R.message}),e.jsx(Q,{variant:"outline",className:"text-xs",children:R.timestamp.toLocaleTimeString("ar")})]}),R.details&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-xs cursor-pointer text-muted-foreground hover:text-foreground",children:" "}),e.jsx("pre",{className:"mt-1 text-xs bg-muted p-2 rounded overflow-x-auto",children:JSON.stringify(R.details,null,2)})]})]})]})},R.id))})})]})]})}function fL(){const[s,t]=x.useState([]),[r,n]=x.useState(!1),{toast:a}=Xe();x.useEffect(()=>{l()},[]);const l=async()=>{try{const{data:h,error:f}=await I.from("stores").select("id, name");if(f){console.error("Error fetching stores:",f);return}t(h||[])}catch(h){console.error("Error:",h)}},c=async()=>{if(s.length===0){a({title:"",description:"   ",variant:"destructive"});return}n(!0);try{const h=s[0],f=`RET-${Date.now()}`,{data:p,error:w}=await I.from("orders").insert({order_code:f,customer_name:"  -  ",customer_phone:"07701234567",customer_address:"   ",customer_notes:"    ",total_amount:15e4,subtotal:15e4,order_status:"returned",assigned_store_id:h.id,store_response_status:"available",store_response_at:new Date().toISOString(),order_details:"Return reason:   -     ",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(w){console.error("Error creating order:",w),a({title:"",description:"   : "+w.message,variant:"destructive"});return}const{error:v}=await I.from("order_items").insert([{order_id:p.id,product_name:"  55  ()",quantity:1,price:15e4,discounted_price:15e4,availability_status:"available",main_store_name:h.name}]);v&&console.error("Error creating order items:",v),a({title:"  ",description:`    : ${f}`}),console.log("     :",{orderId:p.id,orderCode:p.order_code,storeId:h.id,storeName:h.name,orderStatus:p.order_status,returnReason:p.order_details})}catch(h){console.error("Error:",h),a({title:"",description:"    ",variant:"destructive"})}finally{n(!1)}},d=async()=>{for(let h=0;h<3;h++)await c(),await new Promise(f=>setTimeout(f,500))},m=async()=>{try{const{data:h,error:f}=await I.from("orders").select(`
          id,
          order_code,
          order_status,
          store_response_status,
          assigned_store_id,
          customer_name,
          order_details,
          created_at
        `).eq("order_status","returned").order("created_at",{ascending:!1});if(f){console.error("Error:",f);return}console.log("     :",h),a({title:"  ",description:`   ${h?.length||0}  .   Console .`})}catch(h){console.error("Error:",h)}};return e.jsx("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"   "})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(L,{onClick:c,disabled:r||s.length===0,className:"w-full",children:r?" ...":"   "}),e.jsx(L,{onClick:d,disabled:r||s.length===0,variant:"outline",className:"w-full",children:" 3  "}),e.jsx(L,{onClick:m,disabled:r,variant:"secondary",className:"w-full",children:"  "})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:" :"}),s.length>0?e.jsx("div",{className:"space-y-1",children:s.map(h=>e.jsxs("div",{className:"text-sm",children:[" ",h.name," (",h.id.slice(0,8),")"]},h.id))}):e.jsx("p",{className:"text-gray-600",children:"  ..."})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:":"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsx("li",{children:'     "returned" '}),e.jsx("li",{children:"      "}),e.jsx("li",{children:"     "}),e.jsx("li",{children:'         ""'})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:" :"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("a",{href:"/store-dashboard",target:"_blank",className:"block text-blue-600 hover:underline",children:"   "}),e.jsx("a",{href:"/check-returned-orders",target:"_blank",className:"block text-blue-600 hover:underline",children:"    "})]})]})]})]})})}const pL=()=>{const[s,t]=x.useState(!1),[r,n]=x.useState(null),{toast:a}=Xe(),l=async()=>{t(!0);try{a({title:"  ",description:"      ..."});const h=await Db();n(h.results),h.success?a({title:"   ",description:"      "}):a({title:"  ",description:"      ",variant:"default"})}catch(h){console.error("   :",h),a({title:"  ",description:"    ",variant:"destructive"})}finally{t(!1)}},c=async()=>{t(!0);try{const h=await Pb();h.success?a({title:"   ",description:`  ${h.created}   `}):a({title:"  ",description:h.error,variant:"destructive"})}catch{a({title:"",description:"    ",variant:"destructive"})}finally{t(!1)}},d=async()=>{t(!0);try{const h=await Ib();h.success?a({title:"   ",description:`  ${h.updated}    `}):a({title:"  ",description:h.error,variant:"destructive"})}catch{a({title:"",description:"    ",variant:"destructive"})}finally{t(!1)}},m=async()=>{t(!0);try{const h=await Ab();h.success?a({title:"    ",description:`  ${h.updated}    `}):a({title:"   ",description:h.error,variant:"destructive"})}catch{a({title:"",description:"     ",variant:"destructive"})}finally{t(!1)}};return e.jsx("div",{className:"container mx-auto p-6",dir:"rtl",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-center mb-8",children:"    "}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),"  "]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"     :"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"   (products)"}),e.jsx("li",{children:"  (orders.items)"}),e.jsx("li",{children:"   (order_items)"})]}),e.jsx(L,{onClick:l,disabled:s,className:"w-full",size:"lg",children:s?e.jsxs(e.Fragment,{children:[e.jsx(Jr,{className:"w-4 h-4 animate-spin ml-2"})," ..."]}):"  "})]})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5"})," "]})}),e.jsxs(M,{className:"space-y-3",children:[e.jsx(L,{onClick:c,disabled:s,variant:"outline",className:"w-full",children:"  "}),e.jsx(L,{onClick:d,disabled:s,variant:"outline",className:"w-full",children:" "}),e.jsx(L,{onClick:m,disabled:s,variant:"outline",className:"w-full",children:"  "})]})]})]}),r&&e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"w-5 h-5"})," "]})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-800",children:" "}),e.jsxs("p",{className:"text-sm text-blue-600",children:[": ",r.products?.success?" ":" "]}),r.products?.created&&e.jsxs("p",{className:"text-xs text-blue-500",children:[" : ",r.products.created," "]}),r.products?.error&&e.jsxs("p",{className:"text-xs text-red-500",children:[": ",r.products.error]})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-green-800",children:""}),e.jsxs("p",{className:"text-sm text-green-600",children:[": ",r.orders?.success?" ":" "]}),r.orders?.updated&&e.jsxs("p",{className:"text-xs text-green-500",children:[" : ",r.orders.updated," "]}),r.orders?.error&&e.jsxs("p",{className:"text-xs text-red-500",children:[": ",r.orders.error]})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-purple-800",children:" "}),e.jsxs("p",{className:"text-sm text-purple-600",children:[": ",r.orderItems?.success?" ":" "]}),r.orderItems?.updated&&e.jsxs("p",{className:"text-xs text-purple-500",children:[" : ",r.orderItems.updated," "]}),r.orderItems?.error&&e.jsxs("p",{className:"text-xs text-red-500",children:[": ",r.orderItems.error]})]})]})})})]}),e.jsxs("div",{className:"mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:" :"}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsx("li",{children:"       "}),e.jsx("li",{children:"         "}),e.jsx("li",{children:'      ( " 1")  '}),e.jsx("li",{children:"      "})]})]})]})})},Wy=[{type:"order_received",title:"  ",message:"     {{customer_name}} - : {{order_code}}",actions:["","",""]},{type:"order_status",title:"   ",message:"    {{order_code}}",actions:["",""]},{type:"system_alert",title:"  ",message:"   ",actions:["",""]}],gL=()=>{const[s,t]=x.useState({supported:!1,registered:!1,subscribed:!1,permission:"default"}),[r,n]=x.useState(!1),[a,l]=x.useState({type:"order_received",title:" ",message:"    ",orderId:"test-"+Date.now(),customerId:"test-customer"}),{toast:c}=Xe();x.useEffect(()=>{d()},[]);const d=async()=>{const y="serviceWorker"in navigator&&"PushManager"in window;let b=!1,C=!1,E=null,S="default";if(y){S=Notification.permission;try{const O=await navigator.serviceWorker.getRegistration();b=!!O,O?.pushManager&&(E=await O.pushManager.getSubscription(),C=!!E)}catch(O){console.error("Error checking service worker status:",O)}}t({supported:y,registered:b,subscribed:C,permission:S,subscription:E})},m=async()=>{n(!0);try{if(await Uo.registerServiceWorker())c({title:"  ",description:"  Service Worker "}),await d();else throw new Error("Failed to register service worker")}catch{c({title:"  ",description:"   Service Worker",variant:"destructive"})}finally{n(!1)}},h=async()=>{n(!0);try{const y=await Uo.requestNotificationPermission();c(y==="granted"?{title:"  ",description:"    "}:{title:"  ",description:"   ",variant:"destructive"}),await d()}catch{c({title:"   ",description:"    ",variant:"destructive"})}finally{n(!1)}},f=async()=>{n(!0);try{if(await Uo.subscribeToPushNotifications("admin-test","admin"))c({title:"  ",description:"    "}),await d();else throw new Error("Failed to subscribe")}catch{c({title:"  ",description:"    ",variant:"destructive"})}finally{n(!1)}},p=async()=>{n(!0);try{if("serviceWorker"in navigator){const y=await navigator.serviceWorker.ready,b={title:a.title,message:a.message,type:a.type,order_id:a.orderId,url:`/orders/${a.orderId}`};await y.showNotification(a.title,{body:a.message,icon:"/icons/icon-192x192.svg",badge:"/icons/badge-72x72.svg",vibrate:[200,100,200],lang:"ar",dir:"rtl",data:b,tag:a.orderId,renotify:!0,requireInteraction:!0,actions:[{action:"accept",title:"  ",icon:"/icons/view.svg"},{action:"reject",title:"  ",icon:"/icons/close.svg"},{action:"view",title:"  ",icon:"/icons/view.svg"}]}),c({title:"   ",description:"    "})}}catch(y){console.error("Test notification error:",y),c({title:"   ",description:"    ",variant:"destructive"})}finally{n(!1)}},w=async()=>{n(!0);try{if(await Uo.createTestNotification("admin-test"))c({title:"    ",description:"      "});else throw new Error("Failed to create database notification")}catch{c({title:"   ",description:"      ",variant:"destructive"})}finally{n(!1)}},v=y=>y?e.jsx(Se,{className:"w-5 h-5 text-green-600"}):e.jsx(lt,{className:"w-5 h-5 text-red-600"}),j=y=>{const b={granted:"default",denied:"destructive",default:"secondary"},C={granted:"",denied:"",default:" "};return e.jsx(Q,{variant:b[y],children:C[y]})};return e.jsxs("div",{className:"space-y-6 p-6",dir:"rtl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold text-primary mb-2 flex items-center gap-3",children:[e.jsx(dt,{className:"w-8 h-8"}),"  "]}),e.jsx("p",{className:"text-muted-foreground",children:"   Service Worker    "})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Wa,{className:"w-5 h-5"})," "]})}),e.jsxs(M,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:" Service Workers"}),v(s.supported)]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Service Worker "}),v(s.registered)]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:" Push Notifications"}),v(s.subscribed)]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:" "}),j(s.permission)]}),s.subscription&&e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium",children:" :"}),e.jsxs("p",{className:"text-muted-foreground truncate",children:[s.subscription.endpoint.slice(0,50),"..."]})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[!s.registered&&e.jsxs(L,{onClick:m,disabled:r||!s.supported,children:[e.jsx(Er,{className:"w-4 h-4 mr-2"})," Service Worker"]}),s.permission!=="granted"&&e.jsxs(L,{onClick:h,disabled:r,children:[e.jsx(dt,{className:"w-4 h-4 mr-2"}),"  "]}),!s.subscribed&&s.permission==="granted"&&e.jsxs(L,{onClick:f,disabled:r,children:[e.jsx(Hn,{className:"w-4 h-4 mr-2"}),"  "]})]})]})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5"})," "]})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:" "}),e.jsxs(ln,{value:a.type,onValueChange:y=>l(b=>({...b,type:y})),children:[e.jsx(Pr,{children:e.jsx(cn,{})}),e.jsx(Ir,{children:Wy.map(y=>e.jsx(Nt,{value:y.type,children:y.title},y.type))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:""}),e.jsx(it,{value:a.title,onChange:y=>l(b=>({...b,title:y.target.value})),placeholder:" "})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:""}),e.jsx(Ar,{value:a.message,onChange:y=>l(b=>({...b,message:y.target.value})),placeholder:" ",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:" "}),e.jsx(it,{value:a.orderId,onChange:y=>l(b=>({...b,orderId:y.target.value})),placeholder:" "})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:" "}),e.jsx(it,{value:a.customerId,onChange:y=>l(b=>({...b,customerId:y.target.value})),placeholder:" "})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:" "}),e.jsxs("div",{className:"bg-white p-3 rounded border shadow-sm",children:[e.jsx("div",{className:"font-medium text-sm",children:a.title}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:a.message}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(Q,{variant:"outline",className:"text-xs",children:""}),e.jsx(Q,{variant:"outline",className:"text-xs",children:""}),e.jsx(Q,{variant:"outline",className:"text-xs",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{onClick:p,disabled:r||!s.registered,className:"w-full",children:[e.jsx(Ei,{className:"w-4 h-4 mr-2"}),"  "]}),e.jsxs(L,{onClick:w,disabled:r,variant:"outline",className:"w-full",children:[e.jsx(ds,{className:"w-4 h-4 mr-2"}),"  "]})]})]})]})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"w-5 h-5"}),"  "]})}),e.jsx(M,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Wy.map(y=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:y.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:y.message}),e.jsx("div",{className:"flex flex-wrap gap-1",children:y.actions.map(b=>e.jsx(Q,{variant:"secondary",className:"text-xs",children:b},b))}),e.jsx(L,{size:"sm",variant:"outline",className:"w-full mt-2",onClick:()=>l(b=>({...b,type:y.type,title:y.title,message:y.message})),children:"  "})]},y.type))})})]})]})};function xL(s,t={}){const{limit:r=50,enableRealtime:n=!0,autoMarkAsRead:a=!1}=t,[l,c]=x.useState([]),[d,m]=x.useState(!0),[h,f]=x.useState(null),[p,w]=x.useState(0),[v,j]=x.useState(!1),[y,b]=x.useState(!1),C=x.useCallback(async()=>{try{m(!0),f(null),console.log(` Fetching notifications for ${s.type} ${s.id}`);let k=I.from("notifications").select("*").eq("recipient_type",s.type);(s.type==="store"||s.type==="customer"||s.type==="admin")&&(k=k.eq("recipient_id",s.id)),k=k.order("created_at",{ascending:!1}).limit(r);const{data:P,error:F}=await k;if(F)throw F;const ee=P||[];c(ee),w(ee.filter(ne=>!ne.read).length),b(!0),console.log(` Loaded ${ee.length} notifications for ${s.type} ${s.id}`)}catch(k){console.error(" Error fetching notifications:",k),k.code==="PGRST116"||k.message?.includes("does not exist")?(b(!1),f("Notifications table not found. Please ensure it exists in your database.")):f(k.message||"Failed to fetch notifications"),c([]),w(0)}finally{m(!1)}},[s.type,s.id,r]);x.useEffect(()=>{if(!n||!s.id)return;console.log(` Setting up real-time subscription for ${s.type} ${s.id}`);const k=I.channel("notifications_channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:s.type==="admin"?`recipient_type=eq.${s.type}`:`recipient_type=eq.${s.type}.and.recipient_id=eq.${s.id}`},P=>{if(console.log(" New notification received via postgres_changes:",P),P.new){const F=P.new;F.recipient_type===s.type&&(s.type==="admin"||F.recipient_id===s.id)&&(c(ne=>[F,...ne]),w(ne=>ne+1),console.log(" Added new notification to list"))}}).subscribe(P=>{console.log(` notifications_channel status for ${s.type} ${s.id}:`,P),P==="SUBSCRIBED"?(j(!0),console.log(" Successfully subscribed to notifications_channel")):P==="CHANNEL_ERROR"?(j(!1),console.error(" Channel error for notifications_channel"),f("Real-time connection error. Please refresh the page.")):P==="TIMED_OUT"?(j(!1),console.warn(" Real-time connection timed out")):P==="CLOSED"&&(j(!1),console.log(" Real-time connection closed"))});return()=>{I.removeChannel(k),j(!1),console.log(" Unsubscribed from notifications_channel")}},[s.type,s.id,n]),x.useEffect(()=>{(async()=>{const P=await Ub();b(P),P&&s.id&&await C()})()},[C,s.id]);const E=x.useCallback(async k=>{try{const{error:P}=await I.from("notifications").update({read:!0}).eq("id",k);if(P)throw P;return c(F=>F.map(ee=>ee.id===k?{...ee,read:!0}:ee)),w(F=>Math.max(0,F-1)),console.log(" Notification marked as read:",k),!0}catch(P){return console.error(" Error marking notification as read:",P),f(P.message||"Failed to mark notification as read"),!1}},[]),S=x.useCallback(async()=>{try{let k=I.from("notifications").update({read:!0}).eq("recipient_type",s.type).eq("read",!1);s.type!=="admin"&&(k=k.eq("recipient_id",s.id));const{error:P}=await k;if(P)throw P;return c(F=>F.map(ee=>({...ee,read:!0}))),w(0),console.log(" All notifications marked as read"),!0}catch(k){return console.error(" Error marking all notifications as read:",k),f(k.message||"Failed to mark all notifications as read"),!1}},[s.type,s.id]),O=x.useCallback(k=>{a&&!k.read&&E(k.id),k.url&&(window.location.href=k.url)},[a,E]),R=x.useCallback(async()=>{await C()},[C]);return{notifications:l,loading:d,error:h,unreadCount:p,refreshNotifications:R,markAsRead:E,markAllAsRead:S,navigateToNotification:O,isConnected:v,tableExists:y}}const vL=({userContext:s,className:t="",maxHeight:r="400px",showHeader:n=!0,showConnectionStatus:a=!0,limit:l=50,autoMarkAsRead:c=!1})=>{const{toast:d}=Xe(),{notifications:m,loading:h,error:f,unreadCount:p,refreshNotifications:w,markAsRead:v,markAllAsRead:j,navigateToNotification:y,isConnected:b,tableExists:C}=xL(s,{limit:l,enableRealtime:!0,autoMarkAsRead:c}),E=async k=>{try{if(!k.read&&!await v(k.id)){d({title:"",description:"    ",variant:"destructive"});return}y(k)}catch(P){console.error(" Error handling notification click:",P),d({title:"",description:"    ",variant:"destructive"})}},S=async()=>{const k=await j();d(k?{title:"",description:"    "}:{title:"",description:"   ",variant:"destructive"})},O=k=>{switch(k){case"urgent":return{color:"bg-red-500 text-white",icon:""};case"high":return{color:"bg-orange-500 text-white",icon:""};case"medium":return{color:"bg-blue-500 text-white",icon:""};case"low":return{color:"bg-gray-500 text-white",icon:""};default:return{color:"bg-gray-400 text-white",icon:""}}},R=k=>{switch(k){case"store":return"";case"admin":return"";case"customer":return"";default:return k}};return h?e.jsxs($,{className:t,children:[n&&e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"w-5 h-5"})," - ",R(s.type)]})}),e.jsx(M,{children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("span",{className:"ml-2",children:" ..."})]})})]}):f||!C?e.jsxs($,{className:t,children:[n&&e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"w-5 h-5"})," - ",R(s.type)]})}),e.jsxs(M,{children:[e.jsxs(At,{variant:"destructive",children:[e.jsx(nt,{className:"h-4 w-4"}),e.jsx(Dt,{children:f||"   .       ."})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs(L,{onClick:w,variant:"outline",className:"gap-2",children:[e.jsx(ft,{className:"w-4 h-4"})," "]})})]})]}):e.jsxs($,{className:t,children:[n&&e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(V,{className:"flex items-center gap-2",children:[p>0?e.jsx(uf,{className:"w-5 h-5 text-orange-500"}):e.jsx(dt,{className:"w-5 h-5"})," - ",R(s.type),p>0&&e.jsx(Q,{variant:"destructive",className:"ml-2",children:p})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsx("div",{className:"flex items-center gap-1",children:b?e.jsx(sn,{className:"w-4 h-4 text-green-500",title:"   "}):e.jsx(ll,{className:"w-4 h-4 text-red-500",title:" "})}),e.jsx(L,{onClick:w,variant:"ghost",size:"sm",className:"h-8 w-8 p-0",title:"",children:e.jsx(ft,{className:"w-4 h-4"})}),p>0&&e.jsx(L,{onClick:S,variant:"outline",size:"sm",className:"text-xs h-8",children:"  "})]})]})}),e.jsx(M,{className:"p-0",children:e.jsx(ei,{className:"h-full",style:{maxHeight:r},children:m.length===0?e.jsxs("div",{className:"text-center py-8 px-4 text-muted-foreground",children:[e.jsx(dt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"   "}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"    "})]}):e.jsx("div",{className:"space-y-1",children:m.map((k,P)=>{const F=O(k.priority);return e.jsxs("div",{children:[e.jsx("div",{className:Ue("p-4 cursor-pointer transition-colors hover:bg-muted/50",!k.read&&"bg-blue-50 border-r-4 border-blue-500"),onClick:()=>E(k),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:k.read?e.jsx("div",{className:"w-2 h-2"}):e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full",title:" "})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("h4",{className:Ue("text-sm font-medium text-right",!k.read&&"font-semibold"),children:[F.icon," ",k.title]}),e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[k.priority&&e.jsx(Q,{variant:"outline",className:Ue("text-xs px-1 py-0",F.color),children:k.priority}),k.url&&e.jsx(ji,{className:"w-3 h-3 text-muted-foreground"})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 text-right",children:k.message}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Rt,{className:"w-3 h-3"}),vl(new Date(k.created_at),{addSuffix:!0,locale:Zd})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[k.order_id&&e.jsxs("span",{className:"bg-muted px-1 rounded",children:[": ",k.order_id.slice(0,8),"..."]}),!k.read&&e.jsx(L,{onClick:ee=>{ee.stopPropagation(),v(k.id)},variant:"ghost",size:"sm",className:"text-xs p-1 h-auto",title:" ",children:e.jsx(Se,{className:"w-3 h-3"})})]})]})]})]})}),P<m.length-1&&e.jsx(jl,{})]},k.id)})})})})]})},yL=({showDetails:s=!1,compact:t=!1})=>{const[r,n]=x.useState({isConnected:!1,subscribersCount:0,channelState:null}),[a,l]=x.useState(new Date),[c,d]=x.useState(!1);x.useEffect(()=>{const v=()=>{const y=As.getStatus();n(y),l(new Date)};v();const j=setInterval(v,5e3);return()=>clearInterval(j)},[]);const m=async()=>{d(!0);try{await As.reconnect(),n(As.getStatus())}catch(v){console.error("Failed to reconnect:",v)}finally{d(!1)}},h=()=>c?e.jsx(ft,{className:"w-4 h-4 animate-spin text-blue-500"}):r.isConnected?e.jsx(sn,{className:"w-4 h-4 text-green-600"}):e.jsx(ll,{className:"w-4 h-4 text-red-600"}),f=()=>c?"text-blue-600":r.isConnected?"text-green-600":"text-red-600",p=()=>c?e.jsx(Q,{variant:"secondary",className:"text-blue-600",children:" ..."}):e.jsx(Q,{variant:r.isConnected?"default":"destructive",children:r.isConnected?"":" "}),w=()=>a.toLocaleTimeString("ar",{hour:"2-digit",minute:"2-digit",second:"2-digit"});return t?e.jsxs(Zf,{children:[e.jsx(ep,{asChild:!0,children:e.jsxs(L,{variant:"ghost",size:"sm",className:"h-8 px-2",children:[h(),e.jsx("span",{className:`ml-1 text-xs ${f()}`,children:"Realtime"})]})}),e.jsx(Xd,{className:"w-80",align:"end",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:" Realtime"}),p()]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Hn,{className:"w-3 h-3"}),""]}),e.jsx(Q,{variant:"outline",children:r.subscribersCount})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Hs,{className:"w-3 h-3"})," "]}),e.jsx(Q,{variant:"outline",children:r.channelState||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Rt,{className:"w-3 h-3"})," "]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:w()})]})]}),!r.isConnected&&e.jsxs(L,{onClick:m,disabled:c,size:"sm",className:"w-full",children:[e.jsx(ft,{className:"w-3 h-3 mr-1"})," "]})]})})]}):s?e.jsx($,{className:"w-full",children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[e.jsx(rn,{className:"w-4 h-4"})," Realtime"]}),p()]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H1,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:`text-sm font-medium ${f()}`,children:r.isConnected?"":""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hn,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm font-medium",children:r.subscribersCount})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:" "}),e.jsx("p",{className:"text-sm font-medium",children:r.channelState||" "})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(Rt,{className:"w-3 h-3"})," : ",w()]}),!r.isConnected&&e.jsxs(L,{onClick:m,disabled:c,size:"sm",variant:"outline",children:[e.jsx(ft,{className:`w-3 h-3 mr-1 ${c?"animate-spin":""}`})," "]})]})]})})}):e.jsxs("div",{className:"flex items-center gap-2",children:[h(),e.jsx("span",{className:`text-sm font-medium ${f()}`,children:"Realtime"}),p()]})},jL=()=>e.jsxs("div",{className:"container mx-auto p-6",dir:"rtl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-4xl font-bold text-primary mb-2 flex items-center gap-3",children:[e.jsx(dt,{className:"w-10 h-10"}),"  "]}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"     Service Worker  "})]}),e.jsxs(dn,{defaultValue:"manager",className:"space-y-6",children:[e.jsxs($r,{className:"grid w-full grid-cols-6",children:[e.jsxs(ht,{value:"manager",className:"flex items-center gap-2",children:[e.jsx(Wa,{className:"w-4 h-4"}),""]}),e.jsxs(ht,{value:"realtime",className:"flex items-center gap-2",children:[e.jsx(rn,{className:"w-4 h-4"}),"Realtime"]}),e.jsxs(ht,{value:"history",className:"flex items-center gap-2",children:[e.jsx(av,{className:"w-4 h-4"}),""]}),e.jsxs(ht,{value:"features",className:"flex items-center gap-2",children:[e.jsx(Er,{className:"w-4 h-4"}),""]}),e.jsxs(ht,{value:"testing",className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-4 h-4"}),""]}),e.jsxs(ht,{value:"code",className:"flex items-center gap-2",children:[e.jsx(iv,{className:"w-4 h-4"}),""]})]}),e.jsx(mt,{value:"manager",children:e.jsx(gL,{})}),e.jsx(mt,{value:"realtime",children:e.jsx("div",{className:"space-y-6",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(rn,{className:"w-5 h-5"})," Realtime "]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(yL,{showDetails:!0}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"  "}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"default",children:""}),e.jsx("span",{children:" Realtime   Supabase"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"default",children:""}),e.jsx("span",{children:"Edge Function  "})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"default",children:""}),e.jsx("span",{children:"   Service Worker"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"default",children:""}),e.jsx("span",{children:"    "})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"default",children:""}),e.jsx("span",{children:"     "})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"   "}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"1. "}),e.jsx("p",{className:"text-blue-700",children:"Edge Function      notifications"})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"font-medium text-green-800 mb-1",children:"2. Realtime"}),e.jsx("p",{className:"text-green-700",children:"Supabase Realtime    "})]}),e.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("h4",{className:"font-medium text-purple-800 mb-1",children:"3. Service Worker"}),e.jsx("p",{className:"text-purple-700",children:"Frontend   Service Worker   "})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(Qr,{to:"/realtime-notification-test",children:e.jsxs(Button,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-4 h-4"}),"  "]})}),e.jsx(Qr,{to:"/service-worker-demo",children:e.jsxs(Button,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Er,{className:"w-4 h-4"})," "]})})]})]})})]})})}),e.jsx(mt,{value:"history",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(av,{className:"w-5 h-5"})," "]})}),e.jsx(M,{children:e.jsx(vL,{})})]})}),e.jsx(mt,{value:"features",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Er,{className:"w-5 h-5"}),"  "]})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"  "}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"default",children:""}),e.jsx("span",{children:"Service Worker    "})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"default",children:""}),e.jsx("span",{children:"    "})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"default",children:""}),e.jsx("span",{children:" VAPID "})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"default",children:""}),e.jsx("span",{children:"    RTL"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"default",children:""}),e.jsx("span",{children:"  "})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"  "}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"secondary",children:""}),e.jsx("span",{children:"  Service Worker"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"secondary",children:""}),e.jsx("span",{children:"  "})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"secondary",children:""}),e.jsx("span",{children:"    "})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"secondary",children:""}),e.jsx("span",{children:"    "})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"secondary",children:""}),e.jsx("span",{children:"   "})]})]})]})]})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"   "})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"  "}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{variant:"outline",children:"  "}),e.jsx(Q,{variant:"outline",children:"  "}),e.jsx(Q,{variant:"outline",children:"  "})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"  "}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{variant:"outline",children:"  "}),e.jsx(Q,{variant:"outline",children:" "})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"  "}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{variant:"outline",children:" "}),e.jsx(Q,{variant:"outline",children:" "})]})]})]})})]})]})}),e.jsx(mt,{value:"testing",children:e.jsx("div",{className:"grid gap-6",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5"})," "]})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"  "}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{children:e.jsx("strong",{children:"1.  Service Worker:"})}),e.jsx("p",{className:"text-muted-foreground mr-4",children:"-   Service Worker"}),e.jsx("p",{className:"text-muted-foreground mr-4",children:"-    "}),e.jsx("p",{children:e.jsx("strong",{children:"2.  :"})}),e.jsx("p",{className:"text-muted-foreground mr-4",children:"-  "}),e.jsx("p",{className:"text-muted-foreground mr-4",children:"-   "}),e.jsx("p",{className:"text-muted-foreground mr-4",children:"-   "}),e.jsx("p",{children:e.jsx("strong",{children:"3.   :"})}),e.jsx("p",{className:"text-muted-foreground mr-4",children:"-  "}),e.jsx("p",{className:"text-muted-foreground mr-4",children:"-  "}),e.jsx("p",{className:"text-muted-foreground mr-4",children:"- Real-time updates"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"  "}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{children:e.jsx("strong",{children:" :"})}),e.jsx("p",{className:"text-muted-foreground mr-4",children:" Chrome Desktop/Mobile"}),e.jsx("p",{className:"text-muted-foreground mr-4",children:" Firefox Desktop/Mobile"}),e.jsx("p",{className:"text-muted-foreground mr-4",children:" Edge Desktop/Mobile"}),e.jsx("p",{className:"text-muted-foreground mr-4",children:" Safari Desktop"}),e.jsx("p",{className:"text-muted-foreground mr-4",children:" Safari Mobile ()"}),e.jsx("p",{children:e.jsx("strong",{children:" :"})}),e.jsx("p",{className:"text-muted-foreground mr-4",children:"  "}),e.jsx("p",{className:"text-muted-foreground mr-4",children:" "}),e.jsx("p",{className:"text-muted-foreground mr-4",children:"  "}),e.jsx("p",{className:"text-muted-foreground mr-4",children:"  "})]})]})]})})]})})}),e.jsx(mt,{value:"code",children:e.jsx("div",{className:"grid gap-6",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(iv,{className:"w-5 h-5"})," "]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"  "}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"/public/service-worker.js"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Service Worker    "}),e.jsx("p",{children:e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"/src/services/notificationService.ts"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"   "})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"/src/components/admin/PushNotificationManager.tsx"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"  "}),e.jsx("p",{children:e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"/public/manifest.json"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"  PWA"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"  "}),e.jsx("div",{className:"bg-muted p-4 rounded-lg text-sm",children:e.jsx("pre",{className:"overflow-x-auto",children:`//    Service Worker
self.addEventListener('push', e => {
  const data = e.data ? e.data.json() : {};
  const options = {
    body: data.message,
    icon: '/icons/icon-192x192.svg',
    badge: '/icons/badge-72x72.svg',
    actions: [
      { action: 'accept', title: ' ' },
      { action: 'reject', title: ' ' },
      { action: 'view', title: ' ' }
    ],
    lang: 'ar',
    dir: 'rtl',
    requireInteraction: true
  };
  
  e.waitUntil(
    self.registration.showNotification(data.title, options)
  );
});`})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"  VAPID"}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:" Push Notifications    VAPID keys :"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsx("li",{children:" Supabase Edge Functions"}),e.jsx("li",{children:"   VAPID_PUBLIC_KEY"}),e.jsx("li",{children:"  Firebase Cloud Messaging ()"})]})]})]})]})})]})})})]})]}),wL=()=>{const[s,t]=x.useState({supported:!1,registered:!1,permission:"default"}),[r,n]=x.useState(!1),{toast:a}=Xe();x.useEffect(()=>{l()},[]);const l=async()=>{const h="serviceWorker"in navigator&&"PushManager"in window;let f=!1,p="default";if(h){p=Notification.permission;try{f=!!await navigator.serviceWorker.getRegistration()}catch(w){console.error("Error checking SW status:",w)}}t({supported:h,registered:f,permission:p})},c=async()=>{n(!0);try{if(!s.supported)throw new Error("Service Workers not supported");if(s.registered||(await navigator.serviceWorker.register("/service-worker.js"),a({title:" ",description:"  Service Worker"})),s.permission!=="granted"&&await Notification.requestPermission()!=="granted")throw new Error("Notification permission denied");await(await navigator.serviceWorker.ready).showNotification("  ",{body:"     ",icon:"/icons/icon-192x192.svg",badge:"/icons/badge-72x72.svg",lang:"ar",dir:"rtl",tag:"quick-test",data:{url:"/advanced-notifications"},actions:[{action:"open",title:"   ",icon:"/icons/view.svg"},{action:"dismiss",title:" ",icon:"/icons/close.svg"}]}),a({title:"  ",description:"    "}),await l()}catch(h){a({title:" ",description:h instanceof Error?h.message:"  ",variant:"destructive"})}finally{n(!1)}},d=h=>h?e.jsx(Se,{className:"w-4 h-4 text-green-600"}):e.jsx(lt,{className:"w-4 h-4 text-red-600"}),m=h=>{switch(h){case"granted":return"text-green-600";case"denied":return"text-red-600";default:return"text-yellow-600"}};return e.jsxs($,{className:"w-full",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2 text-lg",children:[e.jsx(ds,{className:"w-5 h-5"}),"  "]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Service Worker"}),e.jsxs("div",{className:"flex items-center gap-1",children:[d(s.registered),e.jsx(Q,{variant:s.registered?"default":"secondary",children:s.registered?"":" "})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:""}),e.jsxs("div",{className:"flex items-center gap-1",children:[d(s.supported),e.jsx(Q,{variant:s.supported?"default":"destructive",children:s.supported?"":" "})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:""}),e.jsx(Q,{variant:s.permission==="granted"?"default":"secondary",className:m(s.permission),children:s.permission==="granted"?"":s.permission==="denied"?"":" "})]})]}),e.jsxs(L,{onClick:c,disabled:r||!s.supported,className:"w-full",size:"lg",children:[e.jsx(dt,{className:"w-4 h-4 mr-2"}),r?" ...":" "]}),e.jsxs("div",{className:"text-xs text-muted-foreground p-3 bg-muted rounded-lg",children:[e.jsx("p",{className:"font-medium mb-1",children:" :"}),e.jsx("p",{children:"       "}),e.jsx("p",{children:"  Service Worker    "}),e.jsx("p",{children:"      "}),e.jsx("p",{children:"      "})]}),!s.supported&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Er,{className:"w-4 h-4"}),e.jsx("strong",{children:"  "})]}),e.jsx("p",{className:"mt-1",children:"    Service Workers  Push Notifications"})]})]})})]})},_L=()=>e.jsxs($,{className:"mb-6",children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"w-5 h-5"}),"  ",e.jsxs(Q,{variant:"default",className:"mr-2",children:[e.jsx(rn,{className:"w-3 h-3 mr-1"}),"!"]})]})}),e.jsxs(M,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsx(Qr,{to:"/advanced-notifications",children:e.jsxs(L,{variant:"default",className:"w-full h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(Er,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:" "}),e.jsx("div",{className:"text-xs opacity-80",children:"Service Worker + Push"})]})]})}),e.jsx(Qr,{to:"/notification-test",children:e.jsxs(L,{variant:"outline",className:"w-full h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(ds,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:" "}),e.jsx("div",{className:"text-xs opacity-80",children:" "})]})]})}),e.jsx(Qr,{to:"/admin-notifications-test",children:e.jsxs(L,{variant:"outline",className:"w-full h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(Wa,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:" "}),e.jsx("div",{className:"text-xs opacity-80",children:" "})]})]})}),e.jsx(Qr,{to:"/realtime-test",children:e.jsxs(L,{variant:"outline",className:"w-full h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(dt,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:"Real-time"}),e.jsx("div",{className:"text-xs opacity-80",children:" "})]})]})}),e.jsx(Qr,{to:"/service-worker-demo",children:e.jsxs(L,{variant:"outline",className:"w-full h-auto p-4 flex flex-col items-center gap-2 border-blue-200 hover:bg-blue-50",children:[e.jsx(Er,{className:"w-6 h-6 text-blue-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-blue-600",children:" "}),e.jsx("div",{className:"text-xs text-blue-500",children:"Service Worker"})]})]})}),e.jsx(Qr,{to:"/realtime-notification-test",children:e.jsxs(L,{variant:"outline",className:"w-full h-auto p-4 flex flex-col items-center gap-2 border-green-200 hover:bg-green-50",children:[e.jsx(rn,{className:"w-6 h-6 text-green-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-green-600",children:"Realtime "}),e.jsx("div",{className:"text-xs text-green-500",children:"Edge Function + SW"})]})]})})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"   :"}),e.jsxs("div",{className:"mt-1 text-xs space-y-1",children:[e.jsx("div",{children:" Service Worker    "}),e.jsx("div",{children:" Realtime   Edge Function"}),e.jsx("div",{children:"    Supabase Realtime"}),e.jsx("div",{children:"  VAPID   "}),e.jsx("div",{children:"     "}),e.jsx("div",{children:"    Frontend  Service Worker"})]})]})})]})]}),um=[{id:"order-001",type:"order_received",title:"     ",message:" #ORD-2024-001  150  - 3 ",actions:[" "," "," "]},{id:"order-002",type:"order_status",title:"   ",message:"   #ORD-2024-001   ",actions:[" ",""]},{id:"system-001",type:"system_alert",title:"    ",message:" 5        ",actions:[" ",""]}],bL=()=>{const[s,t]=x.useState({notificationsSent:0,actionsClicked:0,testsRun:0}),{toast:r}=Xe(),n=async d=>{try{if(!("serviceWorker"in navigator))throw new Error("Service Workers not supported");const m=await navigator.serviceWorker.ready;let h=[];d.type==="order_received"?h=[{action:"accept",title:"  ",icon:"/icons/view.svg"},{action:"reject",title:"  ",icon:"/icons/close.svg"},{action:"view",title:"  ",icon:"/icons/view.svg"}]:d.type==="order_status"?h=[{action:"view",title:"  ",icon:"/icons/view.svg"},{action:"dismiss",title:" ",icon:"/icons/close.svg"}]:h=[{action:"view",title:" ",icon:"/icons/view.svg"},{action:"dismiss",title:" ",icon:"/icons/close.svg"}],await m.showNotification(d.title,{body:d.message,icon:"/icons/icon-192x192.svg",badge:"/icons/badge-72x72.svg",vibrate:[200,100,200,100,200],lang:"ar",dir:"rtl",data:{url:`/orders/${d.id}`,orderId:d.id,type:d.type,timestamp:Date.now()},tag:d.id,renotify:!0,requireInteraction:!0,actions:h,silent:!1,timestamp:Date.now()}),t(f=>({...f,notificationsSent:f.notificationsSent+1})),r({title:"   ",description:`: ${d.type} -   `})}catch(m){r({title:"  ",description:m instanceof Error?m.message:"  ",variant:"destructive"})}},a=async()=>{try{if(Notification.permission!=="granted"&&await Notification.requestPermission()!=="granted")throw new Error("Notification permission required");r({title:"   ",description:"  3  "});for(let d=0;d<um.length;d++)setTimeout(async()=>{await n(um[d])},d*3e3);t(d=>({...d,testsRun:d.testsRun+1}))}catch(d){r({title:"   ",description:d instanceof Error?d.message:"  ",variant:"destructive"})}},l=d=>{switch(d){case"order_received":return e.jsx(Me,{className:"w-4 h-4"});case"order_status":return e.jsx(Se,{className:"w-4 h-4"});case"system_alert":return e.jsx(Bt,{className:"w-4 h-4"});default:return e.jsx(dt,{className:"w-4 h-4"})}},c=d=>{switch(d){case"order_received":return"bg-blue-500";case"order_status":return"bg-green-500";case"system_alert":return"bg-orange-500";default:return"bg-gray-500"}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-4xl font-bold text-primary mb-2 flex items-center gap-3",children:[e.jsx(Er,{className:"w-10 h-10"}),"  Service Worker"]}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"        "})]}),e.jsx(_L,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(wL,{})}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5"})," "]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:" "}),e.jsx(Q,{variant:"default",children:s.notificationsSent})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:" "}),e.jsx(Q,{variant:"secondary",children:s.testsRun})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:" "}),e.jsx(Q,{variant:"outline",children:s.actionsClicked})]})]})})]})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"w-5 h-5"}),"  "]})}),e.jsxs(M,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:um.map(d=>e.jsxs($,{className:"relative",children:[e.jsx(q,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-2 rounded-full ${c(d.type)} text-white`,children:l(d.type)}),e.jsx(Q,{variant:"outline",children:d.type})]})}),e.jsxs(M,{children:[e.jsx("h4",{className:"font-semibold mb-2 text-sm",children:d.title}),e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:d.message}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsx("p",{className:"text-xs font-medium",children:" :"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:d.actions.map((m,h)=>e.jsx(Q,{variant:"secondary",className:"text-xs",children:m},h))})]}),e.jsxs(L,{size:"sm",className:"w-full",onClick:()=>n(d),children:[e.jsx(Cd,{className:"w-3 h-3 mr-1"}),""]})]})]},d.id))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(L,{onClick:a,size:"lg",className:"flex-1",children:[e.jsx(rn,{className:"w-4 h-4 mr-2"}),"  "]}),e.jsx(Qr,{to:"/advanced-notifications",children:e.jsxs(L,{variant:"outline",size:"lg",children:[" ",e.jsx(gm,{className:"w-4 h-4 mr-2"})]})})]})]})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Wa,{className:"w-5 h-5"})," "]})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Er,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("h4",{className:"font-semibold mb-1",children:"Service Worker"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"      "})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(dt,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("h4",{className:"font-semibold mb-1",children:"Push Notifications"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"   "})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Hn,{className:"w-8 h-8 mx-auto mb-2 text-purple-500"}),e.jsx("h4",{className:"font-semibold mb-1",children:" "}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"   "})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Me,{className:"w-8 h-8 mx-auto mb-2 text-orange-500"}),e.jsx("h4",{className:"font-semibold mb-1",children:" "}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"   "})]})]})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:"  "})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"  :"}),e.jsxs("ol",{className:"space-y-1 mr-4",children:[e.jsx("li",{children:'1.   " " '}),e.jsx("li",{children:"2.     "}),e.jsx("li",{children:"3.    "}),e.jsx("li",{children:"4.     "})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"  :"}),e.jsxs("ol",{className:"space-y-1 mr-4",children:[e.jsx("li",{children:"1.     "}),e.jsx("li",{children:'2.  ""   '}),e.jsx("li",{children:'3.   "  " '}),e.jsx("li",{children:"4.   "})]})]})]})})]})]})},NL=()=>{const[s,t]=x.useState({isConnected:!1,subscribersCount:0,channelState:null}),[r,n]=x.useState([]),[a,l]=x.useState(!1),[c,d]=x.useState({title:"   Realtime",message:"       Realtime ",type:"test",recipient_id:"admin-test",recipient_type:"admin",order_id:"",url:"/realtime-test"}),{toast:m}=Xe();x.useEffect(()=>{h();const S=As.subscribe(R=>{console.log(" Received notification in UI:",R),n(k=>[R,...k].slice(0,10)),m({title:"   Realtime",description:R.message})}),O=setInterval(h,5e3);return()=>{S(),clearInterval(O)}},[m]);const h=()=>{const S=As.getStatus();t(S)},f=async()=>{l(!0);try{if(await As.sendNotification(c))m({title:"  ",description:"      Edge Function"});else throw new Error("Failed to send notification")}catch{m({title:"  ",description:"    ",variant:"destructive"})}finally{l(!1)}},p=async()=>{l(!0);try{if(await As.sendOrderNotification({order_id:`order-${Date.now()}`,order_code:`ORD-${Date.now()}`,customer_name:" ",store_id:"store-test",total_amount:150.75}))m({title:"   ",description:"     "});else throw new Error("Failed to send order notification")}catch{m({title:"    ",description:"    ",variant:"destructive"})}finally{l(!1)}},w=async()=>{l(!0);try{if(await As.sendOrderStatusNotification({order_id:`order-${Date.now()}`,order_code:`ORD-${Date.now()}`,status:" ",customer_id:"customer-test"}))m({title:"   ",description:"     "});else throw new Error("Failed to send status notification")}catch{m({title:"    ",description:"     ",variant:"destructive"})}finally{l(!1)}},v=async()=>{l(!0);try{await As.reconnect(),h(),m({title:"  ",description:"    Realtime "})}catch{m({title:"   ",description:"     Realtime",variant:"destructive"})}finally{l(!1)}},j=()=>{n([]),m({title:"  ",description:"    "})},y=()=>s.isConnected?e.jsx(sn,{className:"w-5 h-5 text-green-600"}):e.jsx(ll,{className:"w-5 h-5 text-red-600"}),b=()=>e.jsx(Q,{variant:s.isConnected?"default":"destructive",children:s.isConnected?"":" "}),C=S=>new Date(S).toLocaleTimeString("ar",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),E=S=>{switch(S){case"order_received":return"";case"order_status":return"";case"test":return"";default:return""}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-4xl font-bold text-primary mb-2 flex items-center gap-3",children:[e.jsx(rn,{className:"w-10 h-10"}),"  Realtime "]}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"    Edge Function Service Worker"})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[y(),"  Realtime"]})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:""}),b()]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:""}),e.jsx(Q,{variant:"secondary",children:s.subscribersCount})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:" "}),e.jsx(Q,{variant:"outline",children:s.channelState||"N/A"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(L,{onClick:v,disabled:a,size:"sm",children:[e.jsx(ft,{className:"w-4 h-4 mr-2"})," "]})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Ei,{className:"w-5 h-5"}),"  "]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:""}),e.jsx(it,{value:c.title,onChange:S=>d(O=>({...O,title:S.target.value})),placeholder:" "})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:""}),e.jsxs(ln,{value:c.type,onValueChange:S=>d(O=>({...O,type:S})),children:[e.jsx(Pr,{children:e.jsx(cn,{})}),e.jsxs(Ir,{children:[e.jsx(Nt,{value:"test",children:""}),e.jsx(Nt,{value:"order_received",children:" "}),e.jsx(Nt,{value:"order_status",children:" "}),e.jsx(Nt,{value:"system_alert",children:" "})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:""}),e.jsx(Ar,{value:c.message,onChange:S=>d(O=>({...O,message:S.target.value})),placeholder:" ",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:" "}),e.jsx(it,{value:c.recipient_id,onChange:S=>d(O=>({...O,recipient_id:S.target.value})),placeholder:" "})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:" "}),e.jsxs(ln,{value:c.recipient_type,onValueChange:S=>d(O=>({...O,recipient_type:S})),children:[e.jsx(Pr,{children:e.jsx(cn,{})}),e.jsxs(Ir,{children:[e.jsx(Nt,{value:"admin",children:""}),e.jsx(Nt,{value:"store",children:""}),e.jsx(Nt,{value:"customer",children:""})]})]})]})]}),e.jsxs(L,{onClick:f,disabled:a,className:"w-full",children:[e.jsx(Ei,{className:"w-4 h-4 mr-2"})," "]})]})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5"})," "]})}),e.jsxs(M,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(L,{onClick:p,disabled:a,className:"w-full",children:[e.jsx(Hn,{className:"w-4 h-4 mr-2"}),"   "]}),e.jsxs(L,{onClick:w,disabled:a,variant:"outline",className:"w-full",children:[e.jsx(Hs,{className:"w-4 h-4 mr-2"}),"   "]}),e.jsxs(L,{onClick:()=>As.sendTestNotification("admin-test"),disabled:a,variant:"secondary",className:"w-full",children:[e.jsx(dt,{className:"w-4 h-4 mr-2"}),"  "]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"  "}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"    Service Worker "}),e.jsx("li",{children:"    Realtime "}),e.jsx("li",{children:"  console  "}),e.jsx("li",{children:"    browser notifications"})]})]})]})]})]}),e.jsxs($,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between",children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"w-5 h-5"}),"  (",r.length,")"]}),e.jsx(L,{onClick:j,variant:"outline",size:"sm",children:""})]}),e.jsx(M,{children:r.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(dt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"   "}),e.jsx("p",{className:"text-sm",children:"      "})]}):e.jsx("div",{className:"space-y-3",children:r.map((S,O)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:E(S.type)}),e.jsx("h4",{className:"font-medium",children:S.title}),e.jsx(Q,{variant:"outline",children:S.type})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:C(S.created_at)})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:S.message}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[": ",S.recipient_type]}),e.jsxs("span",{children:[": ",S.recipient_id]}),S.order_id&&e.jsxs("span",{children:[": ",S.order_id]})]})]},`${S.id}-${O}`))})})]})]})},SL=()=>{const[s,t]=x.useState({serviceWorkerRegistered:!1,notificationPermission:"default",isSupported:!1}),[r,n]=x.useState(!1),a=async()=>{const h="serviceWorker"in navigator&&"Notification"in window,f=await navigator.serviceWorker.getRegistration(),p="Notification"in window?Notification.permission:"denied";t({serviceWorkerRegistered:!!f,notificationPermission:p,isSupported:h})};x.useEffect(()=>{a()},[]);const l=async()=>{n(!0);try{if(!("serviceWorker"in navigator))throw new Error("Service Worker not supported");console.log(" Registering Service Worker...");const h=await navigator.serviceWorker.register("/service-worker.js");console.log(" Service Worker registered:",h);const f=await Notification.requestPermission();if(console.log("Notification permission:",f),f!=="granted"){t(w=>({...w,lastTestResult:"Permission denied"})),n(!1);return}const p=async()=>{if(!navigator.serviceWorker.controller){console.warn("No service worker controller");return}navigator.serviceWorker.controller.postMessage({type:"TEST_NOTIFICATION",title:" NeoMart",message:"    Builder.io Frontend"})};navigator.serviceWorker.addEventListener("message",w=>{console.log("Message from SW:",w.data),w.data?.action==="view-order"&&t(v=>({...v,lastTestResult:`Order view requested: ${w.data.order_id}`}))}),await new Promise(w=>setTimeout(w,1e3)),await p(),t(w=>({...w,lastTestResult:"Integration successful! Test notification sent."})),await a()}catch(h){console.error(" Service Worker registration failed:",h),t(f=>({...f,lastTestResult:`Error: ${h.message}`}))}finally{n(!1)}},c=async()=>{if(!navigator.serviceWorker.controller){alert("Service Worker not ready. Please run the integration first.");return}navigator.serviceWorker.controller.postMessage({type:"TEST_NOTIFICATION",title:" ",message:"   "}),t(h=>({...h,lastTestResult:"Manual test notification sent"}))},d=async()=>{if(!navigator.serviceWorker.controller){alert("Service Worker not ready. Please run the integration first.");return}navigator.serviceWorker.controller.postMessage({type:"NEW_NOTIFICATION",payload:{title:" ",message:"      ",order_id:"ORDER_123",type:"order_received"}}),t(h=>({...h,lastTestResult:"Realtime notification simulated"}))},m=h=>{switch(h){case"granted":return"default";case"denied":return"destructive";default:return"secondary"}};return e.jsxs($,{className:"w-full max-w-2xl mx-auto",children:[e.jsxs(q,{children:[e.jsx(V,{children:"Builder.io Frontend Integration"}),e.jsx(Ze,{children:"    Builder.io  Service Worker"})]}),e.jsxs(M,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Service Worker"}),e.jsx(Q,{variant:s.serviceWorkerRegistered?"default":"secondary",children:s.serviceWorkerRegistered?"":" "})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Notification Permission"}),e.jsx(Q,{variant:m(s.notificationPermission),children:s.notificationPermission})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Browser Support"}),e.jsx(Q,{variant:s.isSupported?"default":"destructive",children:s.isSupported?"":" "})]}),s.lastTestResult&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Last Test Result"}),e.jsx("div",{className:"p-3 bg-muted rounded-md text-sm",children:s.lastTestResult})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx(L,{onClick:l,disabled:r||!s.isSupported,className:"w-full",children:r?"...":" "}),e.jsx(L,{onClick:c,variant:"outline",disabled:!s.serviceWorkerRegistered,className:"w-full",children:" "}),e.jsx(L,{onClick:d,variant:"outline",disabled:!s.serviceWorkerRegistered,className:"w-full",children:" Realtime"})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-md",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:" :"}),e.jsxs("ol",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:'1.   " "  Service Worker  '}),e.jsx("li",{children:"2.     "}),e.jsx("li",{children:'3.  " "  '}),e.jsx("li",{children:'4.  " Realtime"   '})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"  Builder.io Custom Code:"}),e.jsx("div",{className:"bg-gray-100 p-3 rounded-md text-xs font-mono overflow-auto",children:e.jsx("pre",{children:`//     Custom Code  Builder.io
(async () => {
  if (!('serviceWorker' in navigator)) return;
  
  try {
    const registration = await navigator.serviceWorker.register('/service-worker.js');
    const permission = await Notification.requestPermission();
    
    if (permission === 'granted' && navigator.serviceWorker.controller) {
      navigator.serviceWorker.controller.postMessage({
        type: 'TEST_NOTIFICATION',
        title: ' NeoMart',
        message: '   '
      });
    }
  } catch (err) {
    console.error('Service Worker error:', err);
  }
})();`})})]})]})]})},EL=()=>e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Builder.io Integration"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"      Builder.io.     Service Worker     Builder.io."})]}),e.jsx(SL,{}),e.jsxs("div",{className:"max-w-4xl mx-auto mt-8 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-green-700",children:"  "}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:" Service Worker  "}),e.jsx("li",{children:"   "}),e.jsx("li",{children:"   "}),e.jsx("li",{children:"     Builder.io"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-red-700",children:"  "}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"    Service Workers"}),e.jsx("li",{children:"    "}),e.jsx("li",{children:"    "}),e.jsx("li",{children:"  HTTPS (  Service Workers)"})]})]})]}),e.jsx("div",{className:"max-w-4xl mx-auto mt-8",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:" "}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Service Worker Path:"}),e.jsx("code",{className:"block bg-gray-100 p-1 rounded mt-1",children:"/service-worker.js"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Scope:"}),e.jsx("code",{className:"block bg-gray-100 p-1 rounded mt-1",children:"/"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Icons Path:"}),e.jsx("code",{className:"block bg-gray-100 p-1 rounded mt-1",children:"/icons/"})]})]})]})})]})});class Ls{static instance;isRegistered=!1;registration=null;constructor(){}static getInstance(){return Ls.instance||(Ls.instance=new Ls),Ls.instance}async registerServiceWorker(){if(!("serviceWorker"in navigator))return console.warn("Service Workers not supported"),!1;try{return this.registration=await navigator.serviceWorker.register("/service-worker.js"),console.log("Service Worker registered:",this.registration),this.isRegistered=!0,await navigator.serviceWorker.ready,this.setupMessageListener(),!0}catch(t){return console.error("SW registration failed:",t),!1}}setupMessageListener(){navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",t=>{const{action:r,order_id:n,type:a,clickAction:l}=t.data;switch(r){case"accept-order":this.handleOrderAcceptance(n,a);break;case"reject-order":this.handleOrderRejection(n,a);break;case"navigate":this.handleNavigation(t.data.url);break;default:console.log("Unknown action from Service Worker:",r)}})}handleOrderAcceptance(t,r){console.log(`Order ${t} accepted via notification`),window.dispatchEvent(new CustomEvent("orderAccepted",{detail:{orderId:t,type:r,source:"notification"}}))}handleOrderRejection(t,r){console.log(`Order ${t} rejected via notification`),window.dispatchEvent(new CustomEvent("orderRejected",{detail:{orderId:t,type:r,source:"notification"}}))}handleNavigation(t){t&&typeof window<"u"&&(window.location.href=t)}async requestPermission(){return"Notification"in window?Notification.permission!=="granted"?await Notification.requestPermission():Notification.permission:(console.warn("Notifications not supported"),"denied")}async showOrderNotification(t,r){if(await this.requestPermission()!=="granted")return console.warn("Notification permission not granted"),!1;if(!this.isRegistered&&!await this.registerServiceWorker())return console.warn("No active Service Worker to show notification"),!1;if(!navigator.serviceWorker.controller)return console.warn("No active Service Worker controller"),!1;try{return navigator.serviceWorker.controller.postMessage({action:"show-notification",title:t,options:{body:r.body,icon:r.icon||"/icons/icon-192x192.svg",badge:"/icons/badge-72x72.svg",actions:r.actions||[],tag:r.tag||(r.order_id?`order-${r.order_id}`:"general"),renotify:r.renotify!==!1,requireInteraction:r.requireInteraction!==!1,data:{order_id:r.order_id,type:r.type||"general"}}}),console.log("Notification request sent to Service Worker:",t),!0}catch(a){return console.error("Failed to show notification:",a),!1}}async testNotification(){return this.showOrderNotification("  ",{body:"    #TEST-1234",actions:[{action:"accept",title:""},{action:"reject",title:""}],tag:"test-order",order_id:"TEST-1234",type:"order"})}async showWelcomeNotification(){return this.showOrderNotification(" !",{body:"     ",actions:[{action:"explore",title:""},{action:"dismiss",title:""}],tag:"welcome",type:"welcome"})}getPermissionStatus(){return"Notification"in window?Notification.permission:"denied"}isServiceWorkerSupported(){return"serviceWorker"in navigator}isNotificationSupported(){return"Notification"in window}getSystemInfo(){return{serviceWorkerSupported:this.isServiceWorkerSupported(),notificationSupported:this.isNotificationSupported(),permission:this.getPermissionStatus(),registered:this.isRegistered,hasController:!!navigator.serviceWorker?.controller}}}async function Vo(s,t){return Ls.getInstance().showOrderNotification(s,t)}async function CL(){return Ls.getInstance().requestPermission()}async function TL(){return Ls.getInstance().testNotification()}const zb=()=>{const[s,t]=x.useState("default"),[r,n]=x.useState({}),[a,l]=x.useState(!1),[c,d]=x.useState([]),[m,h]=x.useState(1234);x.useEffect(()=>{f();const C=S=>{p(`    ${S.detail.orderId}   `)},E=S=>{p(`    ${S.detail.orderId}   `)};return window.addEventListener("orderAccepted",C),window.addEventListener("orderRejected",E),()=>{window.removeEventListener("orderAccepted",C),window.removeEventListener("orderRejected",E)}},[]);const f=()=>{if(typeof window<"u"){const C=Ls.getInstance();n(C.getSystemInfo()),t(C.getPermissionStatus())}},p=C=>{d(E=>[...E.slice(-4),`${new Date().toLocaleTimeString()}: ${C}`])},w=async()=>{l(!0);try{const C=await CL();t(C),p(`  : ${C}`)}catch(C){p(`   : ${C}`)}finally{l(!1)}},v=async()=>{l(!0);try{const C=await TL();p(C?"     ":"     ")}catch(C){p(`    : ${C}`)}finally{l(!1)}},j=async()=>{l(!0);const C=m.toString();h(E=>E+1);try{const E=await Vo(`  #${C}`,{body:"     . : 250 ",actions:[{action:"accept",title:" "},{action:"reject",title:" "}],order_id:C,type:"order",tag:`order-${C}`,icon:"/icons/icon-192x192.svg"});p(E?`     #${C}`:`      #${C}`)}catch(E){p(`    : ${E}`)}finally{l(!1)}},y=async()=>{l(!0);const C=`URGENT-${Date.now()}`;try{const E=await Vo("  !",{body:"     -  VIP",actions:[{action:"accept",title:"  "},{action:"reject",title:" "},{action:"later",title:" "}],order_id:C,type:"urgent",tag:`urgent-${C}`,icon:"/icons/icon-192x192.svg"});p(E?"    ":"     ")}catch(E){p(`    : ${E}`)}finally{l(!1)}},b=()=>{switch(s){case"granted":return e.jsxs(Q,{className:"bg-green-500",children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),""]});case"denied":return e.jsxs(Q,{variant:"destructive",children:[e.jsx(lt,{className:"w-3 h-3 mr-1"}),""]});default:return e.jsxs(Q,{variant:"secondary",children:[e.jsx(nt,{className:"w-3 h-3 mr-1"}),"  "]})}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-primary",children:"   "}),e.jsx("p",{className:"text-muted-foreground",children:"       "})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"w-5 h-5"})," "]}),e.jsx(Ze,{children:"     "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Service Worker"}),r.serviceWorkerSupported?e.jsxs(Q,{className:"bg-green-500",children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),""]}):e.jsxs(Q,{variant:"destructive",children:[e.jsx(lt,{className:"w-3 h-3 mr-1"})," "]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.notificationSupported?e.jsxs(Q,{className:"bg-green-500",children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),""]}):e.jsxs(Q,{variant:"destructive",children:[e.jsx(lt,{className:"w-3 h-3 mr-1"})," "]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),b()]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.registered?e.jsxs(Q,{className:"bg-green-500",children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),""]}):e.jsxs(Q,{variant:"secondary",children:[e.jsx(nt,{className:"w-3 h-3 mr-1"})," "]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(L,{onClick:w,disabled:a||s==="granted",children:[e.jsx(dt,{className:"w-4 h-4 mr-2"}),"  "]}),e.jsxs(L,{variant:"outline",onClick:f,children:[e.jsx(ft,{className:"w-4 h-4 mr-2"})," "]})]})]})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Cd,{className:"w-5 h-5"})," "]}),e.jsx(Ze,{children:"       "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(L,{onClick:v,disabled:a||s!=="granted",className:"h-20 flex-col gap-2",children:[e.jsx(dt,{className:"w-6 h-6"}),"  "]}),e.jsxs(L,{onClick:j,disabled:a||s!=="granted",className:"h-20 flex-col gap-2",variant:"default",children:[e.jsx(Se,{className:"w-6 h-6"}),"  "]}),e.jsxs(L,{onClick:y,disabled:a||s!=="granted",className:"h-20 flex-col gap-2",variant:"destructive",children:[e.jsx(nt,{className:"w-6 h-6"}),"  "]})]}),s!=="granted"&&e.jsxs(At,{children:[e.jsx(nt,{className:"h-4 w-4"}),e.jsx(Dt,{children:"      "})]})]})]}),c.length>0&&e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsx(Ze,{children:"  "})]}),e.jsx(M,{children:e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:c.map((C,E)=>e.jsx("div",{className:"text-sm p-2 bg-muted rounded-md font-mono",children:C},E))})})]}),e.jsxs($,{children:[e.jsx(q,{children:e.jsx(V,{children:" "})}),e.jsxs(M,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"1."}),'   "  "    ']}),e.jsxs("p",{children:[e.jsx("strong",{children:"2."}),"      "]}),e.jsxs("p",{children:[e.jsx("strong",{children:"3."}),'        ""  ""']}),e.jsxs("p",{children:[e.jsx("strong",{children:"4."}),"      "]}),e.jsxs("p",{children:[e.jsx("strong",{children:"5."}),"         "]})]}),e.jsxs(At,{children:[e.jsx(dt,{className:"h-4 w-4"}),e.jsxs(Dt,{children:[e.jsx("strong",{children:":"}),'            " "']})]})]})]})]})};class Sr{static instance;supabase;ordersChannel=null;isConnected=!1;swNotificationService;constructor(){const t="https://wkzjovhlljeaqzoytpeb.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndrempvdmhsbGplYXF6b3l0cGViIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkwNDY2MjIsImV4cCI6MjA2NDYyMjYyMn0.mx8PnQJaMochaPbjYUmwzlVNIULM05LUDBIM7OFFjZ8";this.supabase=Gj(t,r),this.swNotificationService=Ls.getInstance(),console.log(" Enhanced Supabase Notification Service initialized")}static getInstance(){return Sr.instance||(Sr.instance=new Sr),Sr.instance}async initialize(){try{return console.log(" Initializing Supabase realtime connection..."),await this.swNotificationService.registerServiceWorker(),await this.swNotificationService.requestPermission(),this.ordersChannel=this.supabase.channel("orders_channel"),this.ordersChannel.on("postgres_changes",{event:"INSERT",schema:"public",table:"orders"},t=>{console.log(" New order received:",t),this.handleNewOrder(t.new)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders"},t=>{console.log(" Order updated:",t),this.handleOrderUpdate(t.new,t.old)}).on("system",{},t=>{console.log(" Realtime system event:",t)}).subscribe(t=>{console.log(" Realtime subscription status:",t),this.isConnected=t==="SUBSCRIBED",this.isConnected?(console.log(" Successfully connected to Supabase realtime orders channel"),this.notifyConnectionStatus(!0)):t==="CHANNEL_ERROR"&&(console.error(" Failed to connect to Supabase realtime"),this.notifyConnectionStatus(!1))}),!0}catch(t){return console.error(" Failed to initialize Supabase realtime:",t),!1}}async handleNewOrder(t){try{console.log(" Processing new order notification:",t);const r=t.total?`${t.total} `:"",n=t.customer_name||" ",a=[`: ${n}`,r&&`: ${r}`,t.customer_location&&`: ${t.customer_location}`].filter(Boolean).join("  ");await Vo(`  #${t.id}`,{body:a,icon:"/icons/order.svg",actions:[{action:"accept",title:" ",icon:"/icons/check.svg"},{action:"reject",title:" ",icon:"/icons/close.svg"},{action:"view",title:" ",icon:"/icons/view.svg"}],tag:`order-${t.id}`,renotify:!0,requireInteraction:!0,order_id:t.id,type:"order",data:{order_id:t.id,customer_name:n,total:t.total,source:"supabase_realtime"}})?(console.log(` Order notification sent successfully for order #${t.id}`),window.dispatchEvent(new CustomEvent("newOrderNotification",{detail:{order:t,notificationSent:!0,timestamp:new Date().toISOString()}}))):console.warn(` Failed to send notification for order #${t.id}`)}catch(r){console.error(" Error handling new order notification:",r)}}async handleOrderUpdate(t,r){try{if(t.status!==r.status){let n="",a="";switch(t.status){case"accepted":n=`   #${t.id}`,a="      ";break;case"rejected":n=`   #${t.id}`,a="   ";break;case"preparing":n=`   #${t.id}`,a="  ";break;case"ready":n=`  #${t.id}`,a="    ";break;case"completed":n=`   #${t.id}`,a=" !    ";break}n&&(await Vo(n,{body:a,icon:"/icons/order.svg",tag:`order-update-${t.id}`,order_id:t.id,type:"order_update",actions:[{action:"view",title:" ",icon:"/icons/view.svg"}]}),window.dispatchEvent(new CustomEvent("orderStatusUpdate",{detail:{orderId:t.id,oldStatus:r.status,newStatus:t.status,timestamp:new Date().toISOString()}})))}}catch(n){console.error(" Error handling order update notification:",n)}}async notifyConnectionStatus(t){await Vo(t?" ":" ",{body:t?"    ":"    ",icon:"/icons/icon-192x192.svg",tag:"connection-status",type:"system",requireInteraction:!1,actions:[]})}async testNotification(t="TEST-123"){const r={id:t,customer_name:" ",total:150.5,store_id:"store-1",status:"pending",customer_location:"",created_at:new Date().toISOString(),items:[{name:" ",quantity:2,price:45},{name:" ",quantity:1,price:20.5},{name:" ",quantity:2,price:15}]};return console.log(" Testing notification system with mock order:",r),await this.handleNewOrder(r),!0}async sendManualOrderNotification(t){const r={id:t.id||`MANUAL-${Date.now()}`,customer_name:t.customer_name||"",total:t.total||0,status:t.status||"pending",created_at:new Date().toISOString(),...t};return await this.handleNewOrder(r),!0}isRealtimeConnected(){return this.isConnected}getSupabaseClient(){return this.supabase}disconnect(){this.ordersChannel&&(this.supabase.removeChannel(this.ordersChannel),this.ordersChannel=null,this.isConnected=!1,console.log(" Disconnected from Supabase realtime"))}getStatus(){return{connected:this.isConnected,hasChannel:!!this.ordersChannel,supabaseInitialized:!!this.supabase,serviceWorkerReady:this.swNotificationService.getSystemInfo().registered}}}async function Wb(){return Sr.getInstance().initialize()}async function kL(s){return Sr.getInstance().testNotification(s)}const OL=()=>{const[s,t]=x.useState(!1),[r,n]=x.useState(!1),[a,l]=x.useState([]),[c,d]=x.useState({}),[m,h]=x.useState(!1),f=ur();x.useEffect(()=>{(async()=>{try{h(!0),console.log(" Initializing Enhanced Order Notification Handler...");const O=await Wb();if(n(O),O){const R=Sr.getInstance();p(),console.log(" Enhanced Order Notification Handler initialized")}}catch(O){console.error(" Failed to initialize notification handler:",O)}finally{h(!1)}})()},[]),x.useEffect(()=>{const S=F=>{console.log(" New order notification event:",F.detail),w({type:"new_order",order:F.detail.order,timestamp:F.detail.timestamp||new Date().toISOString(),source:"supabase_realtime"})},O=F=>{console.log(" Order status update event:",F.detail),w({type:"status_update",orderId:F.detail.orderId,action:`${F.detail.oldStatus}  ${F.detail.newStatus}`,timestamp:F.detail.timestamp||new Date().toISOString(),source:"supabase_realtime"})},R=F=>{console.log(" Order accepted event:",F.detail),w({type:"order_accepted",orderId:F.detail.orderId,action:"accepted",timestamp:new Date().toISOString(),source:F.detail.source||"notification"})},k=F=>{console.log(" Order rejected event:",F.detail),w({type:"order_rejected",orderId:F.detail.orderId,action:"rejected",timestamp:new Date().toISOString(),source:F.detail.source||"notification"})},P=F=>{F.data?.type==="NOTIFICATION_ACTION"&&(console.log(" Service Worker notification action:",F.data),w({type:"sw_action",orderId:F.data.order_id,action:F.data.action,timestamp:new Date().toISOString(),source:"service_worker"}),F.data.action==="view-order"&&F.data.order_id?f(`/orders/${F.data.order_id}`):F.data.action==="accept-order"?v(F.data.order_id):F.data.action==="reject-order"&&j(F.data.order_id))};return window.addEventListener("newOrderNotification",S),window.addEventListener("orderStatusUpdate",O),window.addEventListener("orderAccepted",R),window.addEventListener("orderRejected",k),navigator.serviceWorker?.addEventListener("message",P),()=>{window.removeEventListener("newOrderNotification",S),window.removeEventListener("orderStatusUpdate",O),window.removeEventListener("orderAccepted",R),window.removeEventListener("orderRejected",k),navigator.serviceWorker?.removeEventListener("message",P)}},[f]),x.useEffect(()=>{const O=setInterval(()=>{p()},5e3);return()=>clearInterval(O)},[]);const p=x.useCallback(()=>{try{const O=Sr.getInstance().getStatus();d(O),t(O.connected)}catch(S){console.error("Failed to update system status:",S)}},[]),w=x.useCallback(S=>{l(O=>[S,...O.slice(0,9)])},[]),v=async S=>{try{console.log(` Processing order acceptance for order ${S}`),w({type:"order_processing",orderId:S,action:"accepting",timestamp:new Date().toISOString(),source:"app_action"}),await new Promise(O=>setTimeout(O,1e3)),window.dispatchEvent(new CustomEvent("orderAccepted",{detail:{orderId:S,source:"app_action"}}))}catch(O){console.error("Failed to accept order:",O)}},j=async S=>{try{console.log(` Processing order rejection for order ${S}`),w({type:"order_processing",orderId:S,action:"rejecting",timestamp:new Date().toISOString(),source:"app_action"}),await new Promise(O=>setTimeout(O,1e3)),window.dispatchEvent(new CustomEvent("orderRejected",{detail:{orderId:S,source:"app_action"}}))}catch(O){console.error("Failed to reject order:",O)}},y=async()=>{try{h(!0);const S=`TEST-${Date.now()}`;await kL(S),w({type:"test_notification",orderId:S,action:"sent",timestamp:new Date().toISOString(),source:"manual_test"})}catch(S){console.error("Failed to send test notification:",S)}finally{h(!1)}},b=async()=>{try{const S=Sr.getInstance(),O=`MANUAL-${Date.now()}`;await S.sendManualOrderNotification({id:O,customer_name:" ",total:125.75,customer_location:" -  ",items:[{name:" ",quantity:1,price:45},{name:"",quantity:1,price:20.75},{name:"",quantity:2,price:30}]}),w({type:"manual_order",orderId:O,action:"created",timestamp:new Date().toISOString(),source:"manual_trigger"})}catch(S){console.error("Failed to send manual order:",S)}},C=S=>{switch(S.type){case"new_order":return e.jsx(dt,{className:"w-4 h-4 text-blue-500"});case"order_accepted":return e.jsx(Se,{className:"w-4 h-4 text-green-500"});case"order_rejected":return e.jsx(lt,{className:"w-4 h-4 text-red-500"});case"status_update":return e.jsx(nt,{className:"w-4 h-4 text-yellow-500"});case"sw_action":return e.jsx(qn,{className:"w-4 h-4 text-purple-500"});default:return e.jsx(nt,{className:"w-4 h-4 text-gray-500"})}},E=S=>{const O=new Date(S.timestamp).toLocaleTimeString("ar-SA");switch(S.type){case"new_order":return`  #${S.order?.id} - ${S.order?.customer_name} (${O})`;case"order_accepted":return`   #${S.orderId} (${O})`;case"order_rejected":return`   #${S.orderId} (${O})`;case"status_update":return`   #${S.orderId}: ${S.action} (${O})`;case"sw_action":return`  Service Worker: ${S.action}  #${S.orderId} (${O})`;case"test_notification":return` : #${S.orderId} (${O})`;case"manual_order":return` : #${S.orderId} (${O})`;default:return`: ${S.type} - ${S.action} (${O})`}};return e.jsxs("div",{className:"space-y-6",dir:"rtl",children:[e.jsxs($,{children:[e.jsxs(q,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[s?e.jsx(sn,{className:"w-5 h-5 text-green-500"}):e.jsx(ll,{className:"w-5 h-5 text-red-500"}),"   "]}),e.jsx(Ze,{children:"   Supabase Realtime   "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Realtime"}),s?e.jsxs(Q,{className:"bg-green-500",children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),""]}):e.jsxs(Q,{variant:"destructive",children:[e.jsx(lt,{className:"w-3 h-3 mr-1"}),""]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Service Worker"}),c.serviceWorkerReady?e.jsxs(Q,{className:"bg-green-500",children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),""]}):e.jsxs(Q,{variant:"secondary",children:[e.jsx(nt,{className:"w-3 h-3 mr-1"})," "]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),c.hasChannel?e.jsxs(Q,{className:"bg-green-500",children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),""]}):e.jsxs(Q,{variant:"secondary",children:[e.jsx(nt,{className:"w-3 h-3 mr-1"})," "]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r?e.jsxs(Q,{className:"bg-green-500",children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),""]}):e.jsxs(Q,{variant:"secondary",children:[e.jsx(nt,{className:"w-3 h-3 mr-1"})," "]})]})]}),!r&&e.jsxs(At,{children:[e.jsx(nt,{className:"h-4 w-4"}),e.jsx(Dt,{children:"    ..."})]})]})]}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsx(Ze,{children:"    Supabase"})]}),e.jsx(M,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(L,{onClick:y,disabled:m||!r,className:"h-12",children:[e.jsx(Cd,{className:"w-4 h-4 mr-2"})," "]}),e.jsxs(L,{onClick:b,disabled:m||!r,variant:"outline",className:"h-12",children:[e.jsx(Z1,{className:"w-4 h-4 mr-2"})," "]})]})})]}),a.length>0&&e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsxs(Ze,{children:[" ",a.length,"   "]})]}),e.jsx(M,{children:e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:a.map((S,O)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted rounded-md",children:[C(S),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium",children:E(S)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[": ",S.source]})]})]},O))})})]})]})},RL=()=>{const[s,t]=x.useState(new Date);x.useEffect(()=>{const n=setInterval(()=>{t(new Date)},1e3);return()=>clearInterval(n)},[]);const r=()=>{window.location.reload()};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-4xl font-bold text-primary",children:"   "}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"Supabase Realtime + Service Worker +   +  "}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[" : ",s.toLocaleString("ar-SA")]})]}),e.jsxs($,{className:"border-2 border-primary",children:[e.jsxs(q,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Wa,{className:"w-6 h-6"}),"   "]}),e.jsx(Ze,{children:"    Supabase Realtime  Service Workers    "})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-blue-50 rounded-lg",children:[e.jsx(Hs,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Supabase Realtime"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"  "})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 rounded-lg",children:[e.jsx(Er,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Service Worker"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" "})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-purple-50 rounded-lg",children:[e.jsx(dt,{className:"w-8 h-8 text-purple-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:" "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"/ "})]})]})]}),e.jsxs(At,{children:[e.jsx(nt,{className:"h-4 w-4"}),e.jsxs(Dt,{children:[e.jsx("strong",{children:" :"})," realtime    /        service worker      Supabase"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(L,{onClick:r,variant:"outline",children:[e.jsx(ft,{className:"w-4 h-4 mr-2"}),"  "]})})]})]}),e.jsxs(dn,{defaultValue:"handler",className:"w-full",children:[e.jsxs($r,{className:"grid w-full grid-cols-3",children:[e.jsx(ht,{value:"handler",children:" "}),e.jsx(ht,{value:"notifications",children:" "}),e.jsx(ht,{value:"instructions",children:""})]}),e.jsx(mt,{value:"handler",className:"space-y-6",children:e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:"   Supabase Realtime"}),e.jsx(Ze,{children:"    Supabase      "})]}),e.jsx(M,{children:e.jsx(OL,{})})]})}),e.jsx(mt,{value:"notifications",className:"space-y-6",children:e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:"  "}),e.jsx(Ze,{children:"        "})]}),e.jsx(M,{children:e.jsx(zb,{})})]})}),e.jsx(mt,{value:"instructions",className:"space-y-6",children:e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(V,{children:" "}),e.jsx(Ze,{children:"   "})]}),e.jsx(M,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"  :"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm",children:[e.jsx("li",{children:"     "}),e.jsx("li",{children:'     Supabase   " "'}),e.jsx("li",{children:'  " "   '}),e.jsx("li",{children:'  " "     Supabase'}),e.jsx("li",{children:'       ""  ""'}),e.jsx("li",{children:"     "})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"  :"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Frontend:"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:" React + TypeScript"}),e.jsx("li",{children:" Supabase Client"}),e.jsx("li",{children:" Service Worker API"}),e.jsx("li",{children:" Notification API"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Backend:"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:" Supabase Database"}),e.jsx("li",{children:" Realtime Subscriptions"}),e.jsx("li",{children:" PostgreSQL Triggers"}),e.jsx("li",{children:" Row Level Security"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"  :"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{children:[e.jsx("strong",{children:":"}),"      action=accept"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lt,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{children:[e.jsx("strong",{children:":"}),"      action=reject"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{children:[e.jsx("strong",{children:":"}),"    "]})]})]})]}),e.jsxs(At,{children:[e.jsx(dt,{className:"h-4 w-4"}),e.jsxs(Dt,{children:[e.jsx("strong",{children:":"}),"          Service Workers   .    Developer Tools  console logs."]})]}),e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"  :"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("p",{children:"  : /src/services/enhancedSupabaseNotifications.ts"}),e.jsx("p",{children:" Service Worker: /public/service-worker.js"}),e.jsx("p",{children:"  : /src/components/orders/EnhancedOrderNotificationHandler.tsx"})]})]})]})})]})})]})]})},PL=({className:s,size:t="md"})=>{const r={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:Ue("animate-spin rounded-full border-4 border-muted border-t-primary mx-auto mb-4",r[t],s)}),e.jsx("p",{className:"text-muted-foreground text-sm",dir:"rtl",children:" ..."})]})})},IL=new TT,AL=()=>e.jsx(OT,{client:IL,children:e.jsx(Rf,{children:e.jsx(Ik,{children:e.jsxs(Pk,{children:[e.jsx(zE,{}),e.jsx(yC,{}),e.jsx(Tk,{children:e.jsx(x.Suspense,{fallback:e.jsx(PL,{}),children:e.jsxs(wk,{children:[e.jsx(Fe,{path:"/",element:e.jsx(zv,{})}),e.jsx(Fe,{path:"/home-space-stars94",element:e.jsx(zv,{})}),e.jsx(Fe,{path:"/admin-login",element:e.jsx(zR,{})}),e.jsx(Fe,{path:"/admin-aa-smn-justme9003",element:e.jsx(w$,{})}),e.jsx(Fe,{path:"/store-login-space9003",element:e.jsx(_$,{})}),e.jsx(Fe,{path:"/store-dashboard",element:e.jsx(A$,{})}),e.jsx(Fe,{path:"/debug-data",element:e.jsx($$,{})}),e.jsx(Fe,{path:"/test-edge-functions",element:e.jsx(U$,{})}),e.jsx(Fe,{path:"/simple-edge-test",element:e.jsx(z$,{})}),e.jsx(Fe,{path:"/quick-diagnostic",element:e.jsx(L$,{})}),e.jsx(Fe,{path:"/data-diagnostic",element:e.jsx(M$,{})}),e.jsx(Fe,{path:"/arabic-text-test",element:e.jsx(q$,{})}),e.jsx(Fe,{path:"/test-store-creator",element:e.jsx(H$,{})}),e.jsx(Fe,{path:"/test-order-update",element:e.jsx(V$,{})}),e.jsx(Fe,{path:"/test-edge-function-fix",element:e.jsx(G$,{})}),e.jsx(Fe,{path:"/database-setup",element:e.jsx(Y$,{})}),e.jsx(Fe,{path:"/database-diagnostic",element:e.jsx(f5,{})}),e.jsx(Fe,{path:"/database-debug",element:e.jsx(v5,{})}),e.jsx(Fe,{path:"/store-order-response-demo",element:e.jsx(j5,{})}),e.jsx(Fe,{path:"/product-name-debug",element:e.jsx(w5,{})}),e.jsx(Fe,{path:"/product-name-analysis",element:e.jsx(_5,{})}),e.jsx(Fe,{path:"/fix-product-names",element:e.jsx(b5,{})}),e.jsx(Fe,{path:"/store-response-debug",element:e.jsx(N5,{})}),e.jsx(Fe,{path:"/store-response-flow-test",element:e.jsx(S5,{})}),e.jsx(Fe,{path:"/edge-function-debugger",element:e.jsx(E5,{})}),e.jsx(Fe,{path:"/test-split-order",element:e.jsx(T5,{})}),e.jsx(Fe,{path:"/order-division-demo",element:e.jsx(k5,{})}),e.jsx(Fe,{path:"/test-order-divisions",element:e.jsx(P5,{})}),e.jsx(Fe,{path:"/division-completion-test",element:e.jsx(I5,{})}),e.jsx(Fe,{path:"/error-fix-test",element:e.jsx(A5,{})}),e.jsx(Fe,{path:"/notification-test",element:e.jsx(r5,{})}),e.jsx(Fe,{path:"/notification-debug",element:e.jsx(n5,{})}),e.jsx(Fe,{path:"/notification-system-demo",element:e.jsx(L5,{})}),e.jsx(Fe,{path:"/store-notifications-test",element:e.jsx(W5,{})}),e.jsx(Fe,{path:"/store-notification-demo",element:e.jsx(B5,{})}),e.jsx(Fe,{path:"/admin-notifications-setup",element:e.jsx(V5,{})}),e.jsx(Fe,{path:"/admin-notifications-test",element:e.jsx(G5,{})}),e.jsx(Fe,{path:"/realtime-test",element:e.jsx(Y5,{})}),e.jsx(Fe,{path:"/realtime-diagnostics",element:e.jsx(K5,{})}),e.jsx(Fe,{path:"/quick-realtime-debug",element:e.jsx(lL,{})}),e.jsx(Fe,{path:"/realtime-monitor",element:e.jsx(hL,{})}),e.jsx(Fe,{path:"/notification-duplication-test",element:e.jsx(mL,{})}),e.jsx(Fe,{path:"/error-handling-test",element:e.jsx(J5,{})}),e.jsx(Fe,{path:"/database-migration",element:e.jsx(iL,{})}),e.jsx(Fe,{path:"/notification-error-fix",element:e.jsx(aL,{})}),e.jsx(Fe,{path:"/check-returned-orders",element:e.jsx(oL,{})}),e.jsx(Fe,{path:"/test-returned-order-creator",element:e.jsx(fL,{})}),e.jsx(Fe,{path:"/fix-product-data",element:e.jsx(pL,{})}),e.jsx(Fe,{path:"/advanced-notifications",element:e.jsx(jL,{})}),e.jsx(Fe,{path:"/service-worker-demo",element:e.jsx(bL,{})}),e.jsx(Fe,{path:"/realtime-notification-test",element:e.jsx(NL,{})}),e.jsx(Fe,{path:"/builder-io-integration",element:e.jsx(EL,{})}),e.jsx(Fe,{path:"/enhanced-notifications-demo",element:e.jsx(zb,{})}),e.jsx(Fe,{path:"/complete-notification-system",element:e.jsx(RL,{})}),e.jsx(Fe,{path:"*",element:e.jsx(Lk,{})})]})})})]})})})});typeof window<"u"&&(window.addEventListener("beforeunload",()=>{sf()}),document.addEventListener("visibilitychange",()=>{document.hidden&&sf()}));function DL(){const s=async()=>{try{if(typeof window<"u"&&"serviceWorker"in navigator&&"PushManager"in window){console.log(" Initializing enhanced Service Worker with Action Buttons...");const a=Ls.getInstance();if(await a.registerServiceWorker()){if(console.log(" Enhanced Service Worker with Actions registered successfully"),Notification.permission==="default"){console.log(" Auto-requesting notification permission...");const c=await a.requestPermission();console.log(" Notification permission:",c)}if(Notification.permission==="granted"){console.log(" Notifications with action buttons are enabled and ready"),setTimeout(()=>{a.showWelcomeNotification()},3e3);const c=a.getSystemInfo();console.log(" Notification System Info:",c)}}else{console.warn(" Failed to register enhanced Service Worker, falling back to basic registration");const c=await navigator.serviceWorker.register("/service-worker.js",{scope:"/"});console.log(" Basic Service Worker registered:",c)}console.log(" Enhanced notification service initialized")}console.log(" Initializing Enhanced Supabase Realtime notification service..."),await Wb()?console.log(" Enhanced Supabase Realtime notification service initialized"):(console.warn(" Enhanced Supabase notifications failed to initialize, falling back to basic realtime"),await As.initialize(),console.log(" Basic Realtime notification service initialized"));const r=M5(),n=F5();console.log(" Store notification systems initialized"),typeof window<"u"&&(window.__notificationCleanup=()=>{r(),n(),sf(),As.disconnect()},window.__testNotifications=()=>Ls.getInstance().testNotification(),window.__showOrderNotification=(a,l)=>Ls.getInstance().showOrderNotification(`  ${a}`,{body:l,actions:[{action:"accept",title:""},{action:"reject",title:""}],order_id:a,type:"order",tag:`order-${a}`}))}catch(t){console.warn(" Failed to initialize notifications:",t)}};"requestIdleCallback"in window?requestIdleCallback(s,{timeout:2e3}):setTimeout(s,1e3)}HS.createRoot(document.getElementById("root")).render(e.jsx(AL,{}));DL();export{Nb as a,bb as b,_b as e,Mt as g,I as s};
